======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 13:52:32
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model qwen2.5-7b-int8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768,65536

命令行参数:
  --model: qwen2.5-7b-int8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768,65536
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: GB10
  Compute Capability: cc121
  VRAM: 119.7 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Qwen2.5-7B-INT8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/Qwen2.5-7B-INT8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cublaslt

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:52:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 13:52:36 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1361249) WARNING 01-26 13:53:30 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 9.70 requests/s, 4975.01 total tokens/s, 9.70 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 13:52:36] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:52:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:52:36] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:52:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:52:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:52:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:52:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:52:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:52:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:52:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:52:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:52:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:52:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:52:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:52:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:52:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:52:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1361249) [2026-01-26 13:52:40] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1361249) [2026-01-26 13:52:40] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1361249) [2026-01-26 13:52:40] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1361249) [2026-01-26 13:52:40] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1361249) [2026-01-26 13:52:40] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1361249) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1361249) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.59s/it]
(EngineCore_DP0 pid=1361249) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.76s/it]
(EngineCore_DP0 pid=1361249) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.74s/it]
(EngineCore_DP0 pid=1361249) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1361249) 2026-01-26 13:53:29,469 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1361249) 2026-01-26 13:53:29,501 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 634.05it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 756.47it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:41,  3.09it/s, est. speed input: 1583.04 toks/s, output: 3.09 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:24,  5.18it/s, est. speed input: 2410.04 toks/s, output: 4.71 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:16,  7.42it/s, est. speed input: 3274.25 toks/s, output: 6.39 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:15,  8.04it/s, est. speed input: 3524.23 toks/s, output: 6.88 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:14,  8.45it/s, est. speed input: 3696.02 toks/s, output: 7.22 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:13,  8.83it/s, est. speed input: 3842.66 toks/s, output: 7.51 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:12,  9.35it/s, est. speed input: 4070.29 toks/s, output: 7.95 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:12,  9.59it/s, est. speed input: 4227.10 toks/s, output: 8.26 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:11,  9.72it/s, est. speed input: 4341.34 toks/s, output: 8.48 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:11,  9.88it/s, est. speed input: 4440.87 toks/s, output: 8.67 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:11,  9.85it/s, est. speed input: 4501.78 toks/s, output: 8.79 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:11,  9.90it/s, est. speed input: 4559.94 toks/s, output: 8.91 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:10,  9.98it/s, est. speed input: 4613.78 toks/s, output: 9.01 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:10,  9.99it/s, est. speed input: 4654.49 toks/s, output: 9.09 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:10, 10.03it/s, est. speed input: 4692.76 toks/s, output: 9.17 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:10, 10.00it/s, est. speed input: 4719.62 toks/s, output: 9.22 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:09,  9.97it/s, est. speed input: 4742.43 toks/s, output: 9.26 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:09, 10.00it/s, est. speed input: 4766.88 toks/s, output: 9.31 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:03<00:09,  9.98it/s, est. speed input: 4784.94 toks/s, output: 9.35 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:03<00:09,  9.98it/s, est. speed input: 4793.76 toks/s, output: 9.36 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:09, 10.03it/s, est. speed input: 4813.90 toks/s, output: 9.40 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:04<00:09,  9.94it/s, est. speed input: 4823.24 toks/s, output: 9.42 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:04<00:08,  9.95it/s, est. speed input: 4836.97 toks/s, output: 9.45 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:04<00:08, 10.01it/s, est. speed input: 4852.73 toks/s, output: 9.48 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:04<00:08, 10.02it/s, est. speed input: 4865.32 toks/s, output: 9.50 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:04<00:08, 10.05it/s, est. speed input: 4878.40 toks/s, output: 9.53 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:05<00:07, 10.07it/s, est. speed input: 4889.92 toks/s, output: 9.55 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:05<00:07,  9.96it/s, est. speed input: 4893.11 toks/s, output: 9.56 toks/s]
Processed prompts:  41%|████      | 52/128 [00:05<00:07,  9.97it/s, est. speed input: 4901.62 toks/s, output: 9.57 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:05<00:07,  9.98it/s, est. speed input: 4909.18 toks/s, output: 9.59 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:05<00:07, 10.03it/s, est. speed input: 4918.76 toks/s, output: 9.61 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:06<00:06, 10.05it/s, est. speed input: 4927.17 toks/s, output: 9.62 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:06<00:06,  9.96it/s, est. speed input: 4929.23 toks/s, output: 9.63 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:06<00:06,  9.99it/s, est. speed input: 4936.12 toks/s, output: 9.64 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:06<00:06, 10.04it/s, est. speed input: 4944.14 toks/s, output: 9.66 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:06<00:06, 10.05it/s, est. speed input: 4950.39 toks/s, output: 9.67 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:07<00:05, 10.04it/s, est. speed input: 4955.46 toks/s, output: 9.68 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:07<00:05,  9.99it/s, est. speed input: 4958.42 toks/s, output: 9.68 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:07<00:05,  9.99it/s, est. speed input: 4960.53 toks/s, output: 9.69 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:07<00:05,  9.98it/s, est. speed input: 4962.16 toks/s, output: 9.69 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:07<00:05, 10.03it/s, est. speed input: 4967.70 toks/s, output: 9.70 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:07<00:05, 10.04it/s, est. speed input: 4972.47 toks/s, output: 9.71 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:08<00:04, 10.05it/s, est. speed input: 4977.17 toks/s, output: 9.72 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:08<00:04, 10.02it/s, est. speed input: 4979.93 toks/s, output: 9.73 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:08<00:04,  9.93it/s, est. speed input: 4980.06 toks/s, output: 9.73 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:08<00:04,  9.99it/s, est. speed input: 4984.76 toks/s, output: 9.74 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:08<00:04,  9.97it/s, est. speed input: 4985.65 toks/s, output: 9.74 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:08<00:04, 10.01it/s, est. speed input: 4989.49 toks/s, output: 9.75 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:09<00:03, 10.00it/s, est. speed input: 4990.89 toks/s, output: 9.75 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:09<00:03,  9.99it/s, est. speed input: 4991.92 toks/s, output: 9.75 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:09<00:03, 10.01it/s, est. speed input: 4995.20 toks/s, output: 9.76 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:09<00:03,  9.91it/s, est. speed input: 4993.96 toks/s, output: 9.75 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:09<00:03,  9.99it/s, est. speed input: 4997.93 toks/s, output: 9.76 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:09<00:03, 10.03it/s, est. speed input: 5001.58 toks/s, output: 9.77 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:09<00:03, 10.02it/s, est. speed input: 5002.65 toks/s, output: 9.77 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:10<00:02, 10.01it/s, est. speed input: 5003.60 toks/s, output: 9.77 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:10<00:02, 10.03it/s, est. speed input: 5006.38 toks/s, output: 9.78 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:10<00:02,  9.89it/s, est. speed input: 5005.18 toks/s, output: 9.78 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:10<00:02,  9.90it/s, est. speed input: 5005.90 toks/s, output: 9.78 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:10<00:02,  9.95it/s, est. speed input: 5008.30 toks/s, output: 9.78 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:10<00:02,  9.98it/s, est. speed input: 5010.74 toks/s, output: 9.79 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:11<00:01, 10.00it/s, est. speed input: 5013.10 toks/s, output: 9.79 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:11<00:01, 10.01it/s, est. speed input: 5015.25 toks/s, output: 9.80 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:11<00:01,  9.95it/s, est. speed input: 5015.60 toks/s, output: 9.80 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:11<00:01,  9.96it/s, est. speed input: 5016.49 toks/s, output: 9.80 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:11<00:01, 10.03it/s, est. speed input: 5019.67 toks/s, output: 9.80 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:12<00:00, 10.04it/s, est. speed input: 5021.77 toks/s, output: 9.81 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:12<00:00, 10.07it/s, est. speed input: 5024.55 toks/s, output: 9.81 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:12<00:00, 10.09it/s, est. speed input: 5027.18 toks/s, output: 9.82 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:12<00:00,  9.97it/s, est. speed input: 5026.27 toks/s, output: 9.82 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:12<00:00, 10.00it/s, est. speed input: 5028.14 toks/s, output: 9.82 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00, 10.02it/s, est. speed input: 5030.20 toks/s, output: 9.82 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00, 10.02it/s, est. speed input: 5030.20 toks/s, output: 9.82 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:13<00:00,  9.82it/s, est. speed input: 5030.20 toks/s, output: 9.82 toks/s]
[rank0]:[W126 13:53:43.982635889 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 74.2s

测试结果:
  Requests/s:   9.70
  Tokens/s:     4975.01
  Total Reqs:   128
  Elapsed:      13.20s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4965.31

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:53:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 13:53:53 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1362508) WARNING 01-26 13:54:45 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.35 requests/s, 5481.69 total tokens/s, 5.35 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 13:53:53] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:53:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:53:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:53:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:53:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:53:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:53:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:53:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:53:57] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:53:57] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:53:57] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:53:57] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:53:57] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:53:57] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:53:57] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:53:57] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:53:57] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1362508) [2026-01-26 13:53:58] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1362508) [2026-01-26 13:53:58] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1362508) [2026-01-26 13:53:58] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1362508) [2026-01-26 13:53:58] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1362508) [2026-01-26 13:53:58] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1362508) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1362508) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.04s/it]
(EngineCore_DP0 pid=1362508) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.12s/it]
(EngineCore_DP0 pid=1362508) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.11s/it]
(EngineCore_DP0 pid=1362508) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1362508) 2026-01-26 13:54:45,020 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1362508) 2026-01-26 13:54:45,094 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  22%|██▏       | 28/128 [00:00<00:00, 276.29it/s]
Adding requests:  59%|█████▉    | 76/128 [00:00<00:00, 393.68it/s]
Adding requests:  93%|█████████▎| 119/128 [00:00<00:00, 408.27it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 385.61it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:27,  4.63it/s, est. speed input: 4744.99 toks/s, output: 4.63 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:28,  4.43it/s, est. speed input: 4568.83 toks/s, output: 4.46 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:25,  4.85it/s, est. speed input: 4862.67 toks/s, output: 4.75 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:24,  5.02it/s, est. speed input: 4993.45 toks/s, output: 4.88 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:01<00:23,  5.17it/s, est. speed input: 5103.01 toks/s, output: 4.98 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:24,  5.04it/s, est. speed input: 5069.91 toks/s, output: 4.95 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:23,  5.17it/s, est. speed input: 5141.46 toks/s, output: 5.02 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:22,  5.27it/s, est. speed input: 5196.52 toks/s, output: 5.07 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:22,  5.35it/s, est. speed input: 5243.37 toks/s, output: 5.12 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:22,  5.36it/s, est. speed input: 5270.34 toks/s, output: 5.15 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:02<00:21,  5.40it/s, est. speed input: 5300.81 toks/s, output: 5.18 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:02<00:21,  5.41it/s, est. speed input: 5322.37 toks/s, output: 5.20 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:21,  5.44it/s, est. speed input: 5345.21 toks/s, output: 5.22 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:20,  5.46it/s, est. speed input: 5364.79 toks/s, output: 5.24 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:20,  5.45it/s, est. speed input: 5377.92 toks/s, output: 5.25 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:03<00:20,  5.43it/s, est. speed input: 5385.16 toks/s, output: 5.26 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:03<00:20,  5.44it/s, est. speed input: 5397.36 toks/s, output: 5.27 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:03<00:20,  5.47it/s, est. speed input: 5411.25 toks/s, output: 5.28 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:03<00:19,  5.47it/s, est. speed input: 5421.63 toks/s, output: 5.29 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:19,  5.51it/s, est. speed input: 5435.94 toks/s, output: 5.31 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:19,  5.46it/s, est. speed input: 5438.97 toks/s, output: 5.31 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:04<00:19,  5.48it/s, est. speed input: 5447.74 toks/s, output: 5.32 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:04<00:19,  5.49it/s, est. speed input: 5456.73 toks/s, output: 5.33 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:04<00:18,  5.49it/s, est. speed input: 5462.73 toks/s, output: 5.33 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:04<00:18,  5.49it/s, est. speed input: 5469.58 toks/s, output: 5.34 toks/s]
Processed prompts:  20%|██        | 26/128 [00:04<00:18,  5.50it/s, est. speed input: 5475.85 toks/s, output: 5.35 toks/s]
Processed prompts:  21%|██        | 27/128 [00:05<00:18,  5.44it/s, est. speed input: 5473.95 toks/s, output: 5.35 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:05<00:18,  5.44it/s, est. speed input: 5477.42 toks/s, output: 5.35 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:05<00:18,  5.47it/s, est. speed input: 5484.37 toks/s, output: 5.36 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:05<00:17,  5.48it/s, est. speed input: 5489.61 toks/s, output: 5.36 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:05<00:17,  5.48it/s, est. speed input: 5492.76 toks/s, output: 5.36 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:05<00:17,  5.50it/s, est. speed input: 5498.56 toks/s, output: 5.37 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:06<00:17,  5.46it/s, est. speed input: 5498.26 toks/s, output: 5.37 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:06<00:17,  5.45it/s, est. speed input: 5500.01 toks/s, output: 5.37 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:06<00:17,  5.45it/s, est. speed input: 5502.56 toks/s, output: 5.37 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:06<00:16,  5.45it/s, est. speed input: 5504.97 toks/s, output: 5.38 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:06<00:16,  5.44it/s, est. speed input: 5505.91 toks/s, output: 5.38 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:07<00:16,  5.44it/s, est. speed input: 5507.37 toks/s, output: 5.38 toks/s]
Processed prompts:  30%|███       | 39/128 [00:07<00:16,  5.39it/s, est. speed input: 5504.92 toks/s, output: 5.38 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:07<00:16,  5.42it/s, est. speed input: 5507.87 toks/s, output: 5.38 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:07<00:15,  5.47it/s, est. speed input: 5512.61 toks/s, output: 5.38 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:07<00:15,  5.46it/s, est. speed input: 5514.00 toks/s, output: 5.38 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:07<00:15,  5.46it/s, est. speed input: 5515.92 toks/s, output: 5.39 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:08<00:15,  5.45it/s, est. speed input: 5517.12 toks/s, output: 5.39 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:08<00:15,  5.40it/s, est. speed input: 5514.38 toks/s, output: 5.39 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:08<00:15,  5.44it/s, est. speed input: 5517.46 toks/s, output: 5.39 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:08<00:14,  5.46it/s, est. speed input: 5520.21 toks/s, output: 5.39 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:08<00:14,  5.43it/s, est. speed input: 5519.45 toks/s, output: 5.39 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:09<00:14,  5.44it/s, est. speed input: 5521.31 toks/s, output: 5.39 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:09<00:14,  5.39it/s, est. speed input: 5518.76 toks/s, output: 5.39 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:09<00:14,  5.43it/s, est. speed input: 5521.36 toks/s, output: 5.39 toks/s]
Processed prompts:  41%|████      | 52/128 [00:09<00:13,  5.45it/s, est. speed input: 5523.45 toks/s, output: 5.39 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:09<00:13,  5.49it/s, est. speed input: 5526.98 toks/s, output: 5.40 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:10<00:13,  5.49it/s, est. speed input: 5528.87 toks/s, output: 5.40 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:10<00:13,  5.49it/s, est. speed input: 5530.50 toks/s, output: 5.40 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:10<00:13,  5.45it/s, est. speed input: 5529.53 toks/s, output: 5.40 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:10<00:13,  5.45it/s, est. speed input: 5530.43 toks/s, output: 5.40 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:10<00:12,  5.47it/s, est. speed input: 5532.53 toks/s, output: 5.40 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:10<00:12,  5.46it/s, est. speed input: 5533.35 toks/s, output: 5.40 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:11<00:12,  5.46it/s, est. speed input: 5534.13 toks/s, output: 5.40 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:11<00:12,  5.45it/s, est. speed input: 5534.36 toks/s, output: 5.40 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:11<00:12,  5.41it/s, est. speed input: 5532.76 toks/s, output: 5.40 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:11<00:11,  5.42it/s, est. speed input: 5533.49 toks/s, output: 5.40 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:11<00:11,  5.44it/s, est. speed input: 5534.87 toks/s, output: 5.41 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:12<00:11,  5.47it/s, est. speed input: 5536.73 toks/s, output: 5.41 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:12<00:11,  5.47it/s, est. speed input: 5537.79 toks/s, output: 5.41 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:12<00:11,  5.45it/s, est. speed input: 5537.79 toks/s, output: 5.41 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:12<00:11,  5.40it/s, est. speed input: 5535.95 toks/s, output: 5.41 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:12<00:10,  5.44it/s, est. speed input: 5537.58 toks/s, output: 5.41 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:12<00:10,  5.48it/s, est. speed input: 5539.94 toks/s, output: 5.41 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:13<00:10,  5.48it/s, est. speed input: 5541.09 toks/s, output: 5.41 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:13<00:10,  5.47it/s, est. speed input: 5541.76 toks/s, output: 5.41 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:13<00:10,  5.47it/s, est. speed input: 5542.48 toks/s, output: 5.41 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:13<00:09,  5.42it/s, est. speed input: 5540.83 toks/s, output: 5.41 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:13<00:09,  5.44it/s, est. speed input: 5541.88 toks/s, output: 5.41 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:14<00:09,  5.44it/s, est. speed input: 5542.33 toks/s, output: 5.41 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:14<00:09,  5.48it/s, est. speed input: 5544.22 toks/s, output: 5.41 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:14<00:09,  5.49it/s, est. speed input: 5545.58 toks/s, output: 5.42 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:14<00:09,  5.43it/s, est. speed input: 5544.17 toks/s, output: 5.41 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:14<00:08,  5.42it/s, est. speed input: 5543.72 toks/s, output: 5.41 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:14<00:08,  5.44it/s, est. speed input: 5544.55 toks/s, output: 5.41 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:15<00:08,  5.44it/s, est. speed input: 5545.01 toks/s, output: 5.42 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:15<00:08,  5.43it/s, est. speed input: 5544.85 toks/s, output: 5.41 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:15<00:08,  5.44it/s, est. speed input: 5545.29 toks/s, output: 5.42 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:15<00:07,  5.40it/s, est. speed input: 5544.05 toks/s, output: 5.41 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:15<00:07,  5.40it/s, est. speed input: 5544.08 toks/s, output: 5.41 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:16<00:07,  5.43it/s, est. speed input: 5544.98 toks/s, output: 5.42 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:16<00:07,  5.43it/s, est. speed input: 5545.14 toks/s, output: 5.42 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:16<00:07,  5.44it/s, est. speed input: 5545.53 toks/s, output: 5.42 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:16<00:06,  5.45it/s, est. speed input: 5546.14 toks/s, output: 5.42 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:16<00:06,  5.40it/s, est. speed input: 5544.87 toks/s, output: 5.41 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:16<00:06,  5.45it/s, est. speed input: 5546.35 toks/s, output: 5.42 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:17<00:06,  5.45it/s, est. speed input: 5546.84 toks/s, output: 5.42 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:17<00:06,  5.44it/s, est. speed input: 5546.96 toks/s, output: 5.42 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:17<00:06,  5.46it/s, est. speed input: 5547.91 toks/s, output: 5.42 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:17<00:05,  5.45it/s, est. speed input: 5547.98 toks/s, output: 5.42 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:17<00:05,  5.39it/s, est. speed input: 5546.09 toks/s, output: 5.42 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:18<00:05,  5.42it/s, est. speed input: 5546.77 toks/s, output: 5.42 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:18<00:05,  5.46it/s, est. speed input: 5548.42 toks/s, output: 5.42 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:18<00:05,  5.48it/s, est. speed input: 5549.40 toks/s, output: 5.42 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:18<00:04,  5.47it/s, est. speed input: 5549.77 toks/s, output: 5.42 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:18<00:04,  5.42it/s, est. speed input: 5548.54 toks/s, output: 5.42 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:19<00:04,  5.42it/s, est. speed input: 5548.73 toks/s, output: 5.42 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:19<00:04,  5.43it/s, est. speed input: 5548.96 toks/s, output: 5.42 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:19<00:04,  5.43it/s, est. speed input: 5549.19 toks/s, output: 5.42 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:19<00:04,  5.43it/s, est. speed input: 5549.25 toks/s, output: 5.42 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:19<00:03,  5.43it/s, est. speed input: 5549.25 toks/s, output: 5.42 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:19<00:03,  5.42it/s, est. speed input: 5549.14 toks/s, output: 5.42 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:20<00:03,  5.43it/s, est. speed input: 5549.31 toks/s, output: 5.42 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:20<00:03,  5.42it/s, est. speed input: 5549.27 toks/s, output: 5.42 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:20<00:03,  5.42it/s, est. speed input: 5549.22 toks/s, output: 5.42 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:20<00:02,  5.44it/s, est. speed input: 5549.76 toks/s, output: 5.42 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:20<00:02,  5.44it/s, est. speed input: 5550.00 toks/s, output: 5.42 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:21<00:02,  5.44it/s, est. speed input: 5550.11 toks/s, output: 5.42 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:21<00:02,  5.45it/s, est. speed input: 5550.65 toks/s, output: 5.42 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:21<00:02,  5.45it/s, est. speed input: 5550.83 toks/s, output: 5.42 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:21<00:02,  5.46it/s, est. speed input: 5551.28 toks/s, output: 5.42 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:21<00:01,  5.47it/s, est. speed input: 5551.89 toks/s, output: 5.42 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:21<00:01,  5.46it/s, est. speed input: 5552.12 toks/s, output: 5.42 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:22<00:01,  5.41it/s, est. speed input: 5551.14 toks/s, output: 5.42 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:22<00:01,  5.44it/s, est. speed input: 5551.84 toks/s, output: 5.42 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:22<00:01,  5.45it/s, est. speed input: 5552.33 toks/s, output: 5.42 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:22<00:00,  5.46it/s, est. speed input: 5552.72 toks/s, output: 5.42 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:22<00:00,  5.44it/s, est. speed input: 5552.39 toks/s, output: 5.42 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:23<00:00,  5.50it/s, est. speed input: 5554.22 toks/s, output: 5.42 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:23<00:00,  5.45it/s, est. speed input: 5553.60 toks/s, output: 5.42 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:23<00:00,  5.45it/s, est. speed input: 5553.72 toks/s, output: 5.42 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:23<00:00,  5.44it/s, est. speed input: 5553.73 toks/s, output: 5.42 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:23<00:00,  5.44it/s, est. speed input: 5553.73 toks/s, output: 5.42 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:23<00:00,  5.42it/s, est. speed input: 5553.73 toks/s, output: 5.42 toks/s]
[rank0]:[W126 13:55:10.185359219 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 85.5s

测试结果:
  Requests/s:   5.35
  Tokens/s:     5481.69
  Total Reqs:   128
  Elapsed:      23.93s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     5476.35

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:55:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 13:55:16 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1363860) WARNING 01-26 13:56:09 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.43 requests/s, 5565.23 total tokens/s, 5.43 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 13:55:16] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:55:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:55:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:55:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:55:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:55:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:55:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:55:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:55:20] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:55:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:55:20] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:55:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:55:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:55:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:55:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:55:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:55:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1363860) [2026-01-26 13:55:21] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1363860) [2026-01-26 13:55:21] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1363860) [2026-01-26 13:55:21] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1363860) [2026-01-26 13:55:21] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1363860) [2026-01-26 13:55:21] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1363860) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1363860) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.47s/it]
(EngineCore_DP0 pid=1363860) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.68s/it]
(EngineCore_DP0 pid=1363860) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.64s/it]
(EngineCore_DP0 pid=1363860) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1363860) 2026-01-26 13:56:08,366 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1363860) 2026-01-26 13:56:08,463 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 36/256 [00:00<00:00, 353.73it/s]
Adding requests:  28%|██▊       | 72/256 [00:00<00:00, 337.15it/s]
Adding requests:  43%|████▎     | 110/256 [00:00<00:00, 352.12it/s]
Adding requests:  58%|█████▊    | 148/256 [00:00<00:00, 361.64it/s]
Adding requests:  75%|███████▍  | 191/256 [00:00<00:00, 383.68it/s]
Adding requests:  91%|█████████▏| 234/256 [00:00<00:00, 396.73it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 377.34it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:19, 13.25it/s, est. speed input: 13572.29 toks/s, output: 13.25 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:30,  8.31it/s, est. speed input: 9199.60 toks/s, output: 8.98 toks/s]  
Processed prompts:   3%|▎         | 8/256 [00:01<00:35,  6.94it/s, est. speed input: 7902.81 toks/s, output: 7.72 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:38,  6.35it/s, est. speed input: 7306.41 toks/s, output: 7.14 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:40,  6.01it/s, est. speed input: 6943.05 toks/s, output: 6.78 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:02<00:41,  5.81it/s, est. speed input: 6703.06 toks/s, output: 6.55 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:42,  5.68it/s, est. speed input: 6535.72 toks/s, output: 6.38 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:42,  5.59it/s, est. speed input: 6405.28 toks/s, output: 6.26 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:03<00:42,  5.55it/s, est. speed input: 6313.59 toks/s, output: 6.17 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:42,  5.52it/s, est. speed input: 6237.49 toks/s, output: 6.09 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:42,  5.47it/s, est. speed input: 6169.70 toks/s, output: 6.03 toks/s]
Processed prompts:  10%|█         | 26/256 [00:04<00:42,  5.48it/s, est. speed input: 6122.70 toks/s, output: 5.98 toks/s]
Processed prompts:  11%|█         | 28/256 [00:04<00:41,  5.47it/s, est. speed input: 6081.99 toks/s, output: 5.94 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:05<00:41,  5.45it/s, est. speed input: 6042.43 toks/s, output: 5.90 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:05<00:41,  5.45it/s, est. speed input: 6011.52 toks/s, output: 5.87 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:05<00:40,  5.46it/s, est. speed input: 5986.42 toks/s, output: 5.85 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:06<00:40,  5.46it/s, est. speed input: 5962.29 toks/s, output: 5.82 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:06<00:39,  5.47it/s, est. speed input: 5943.00 toks/s, output: 5.80 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:06<00:39,  5.48it/s, est. speed input: 5926.90 toks/s, output: 5.79 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:07<00:39,  5.46it/s, est. speed input: 5908.64 toks/s, output: 5.77 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:07<00:38,  5.48it/s, est. speed input: 5895.45 toks/s, output: 5.76 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:08<00:38,  5.47it/s, est. speed input: 5882.17 toks/s, output: 5.74 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:08<00:38,  5.44it/s, est. speed input: 5865.04 toks/s, output: 5.73 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:08<00:37,  5.44it/s, est. speed input: 5852.90 toks/s, output: 5.72 toks/s]
Processed prompts:  20%|██        | 52/256 [00:09<00:37,  5.44it/s, est. speed input: 5840.89 toks/s, output: 5.70 toks/s]
Processed prompts:  21%|██        | 54/256 [00:09<00:37,  5.42it/s, est. speed input: 5827.98 toks/s, output: 5.69 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:09<00:36,  5.42it/s, est. speed input: 5817.45 toks/s, output: 5.68 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:10<00:36,  5.43it/s, est. speed input: 5809.39 toks/s, output: 5.67 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:10<00:36,  5.42it/s, est. speed input: 5798.71 toks/s, output: 5.66 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:10<00:35,  5.42it/s, est. speed input: 5791.28 toks/s, output: 5.66 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:11<00:35,  5.42it/s, est. speed input: 5783.21 toks/s, output: 5.65 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:11<00:35,  5.42it/s, est. speed input: 5776.10 toks/s, output: 5.64 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:12<00:34,  5.43it/s, est. speed input: 5769.92 toks/s, output: 5.63 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:12<00:34,  5.43it/s, est. speed input: 5763.87 toks/s, output: 5.63 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:12<00:33,  5.42it/s, est. speed input: 5757.28 toks/s, output: 5.62 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:13<00:33,  5.44it/s, est. speed input: 5752.77 toks/s, output: 5.62 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:13<00:33,  5.41it/s, est. speed input: 5745.09 toks/s, output: 5.61 toks/s]
Processed prompts:  30%|███       | 78/256 [00:13<00:32,  5.42it/s, est. speed input: 5741.01 toks/s, output: 5.61 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:14<00:32,  5.43it/s, est. speed input: 5737.05 toks/s, output: 5.60 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:14<00:32,  5.40it/s, est. speed input: 5729.99 toks/s, output: 5.60 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:15<00:31,  5.41it/s, est. speed input: 5725.96 toks/s, output: 5.59 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:15<00:31,  5.43it/s, est. speed input: 5723.04 toks/s, output: 5.59 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:15<00:31,  5.41it/s, est. speed input: 5717.73 toks/s, output: 5.58 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:16<00:30,  5.41it/s, est. speed input: 5713.73 toks/s, output: 5.58 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:16<00:30,  5.43it/s, est. speed input: 5711.04 toks/s, output: 5.58 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:16<00:29,  5.41it/s, est. speed input: 5706.30 toks/s, output: 5.57 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:17<00:29,  5.41it/s, est. speed input: 5703.16 toks/s, output: 5.57 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:17<00:29,  5.42it/s, est. speed input: 5700.29 toks/s, output: 5.57 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:17<00:28,  5.41it/s, est. speed input: 5696.37 toks/s, output: 5.56 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:18<00:28,  5.42it/s, est. speed input: 5693.78 toks/s, output: 5.56 toks/s]
Processed prompts:  41%|████      | 104/256 [00:18<00:28,  5.42it/s, est. speed input: 5690.97 toks/s, output: 5.56 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:19<00:27,  5.39it/s, est. speed input: 5686.45 toks/s, output: 5.55 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:19<00:27,  5.41it/s, est. speed input: 5684.43 toks/s, output: 5.55 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:19<00:26,  5.42it/s, est. speed input: 5682.15 toks/s, output: 5.55 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:20<00:26,  5.39it/s, est. speed input: 5677.71 toks/s, output: 5.54 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:20<00:26,  5.40it/s, est. speed input: 5675.94 toks/s, output: 5.54 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:20<00:25,  5.41it/s, est. speed input: 5673.94 toks/s, output: 5.54 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:21<00:25,  5.39it/s, est. speed input: 5670.27 toks/s, output: 5.54 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:21<00:25,  5.40it/s, est. speed input: 5668.60 toks/s, output: 5.54 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:22<00:24,  5.39it/s, est. speed input: 5665.75 toks/s, output: 5.53 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:22<00:24,  5.40it/s, est. speed input: 5663.87 toks/s, output: 5.53 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:22<00:24,  5.41it/s, est. speed input: 5661.95 toks/s, output: 5.53 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:23<00:23,  5.39it/s, est. speed input: 5658.74 toks/s, output: 5.53 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:23<00:23,  5.39it/s, est. speed input: 5656.97 toks/s, output: 5.52 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:23<00:22,  5.40it/s, est. speed input: 5655.48 toks/s, output: 5.52 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:24<00:22,  5.39it/s, est. speed input: 5652.68 toks/s, output: 5.52 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:24<00:22,  5.40it/s, est. speed input: 5651.45 toks/s, output: 5.52 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:25<00:21,  5.42it/s, est. speed input: 5650.74 toks/s, output: 5.52 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:25<00:21,  5.42it/s, est. speed input: 5648.96 toks/s, output: 5.52 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:25<00:21,  5.42it/s, est. speed input: 5647.77 toks/s, output: 5.52 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:26<00:20,  5.43it/s, est. speed input: 5646.76 toks/s, output: 5.51 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:26<00:20,  5.40it/s, est. speed input: 5644.18 toks/s, output: 5.51 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:26<00:19,  5.41it/s, est. speed input: 5643.25 toks/s, output: 5.51 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:27<00:19,  5.43it/s, est. speed input: 5642.54 toks/s, output: 5.51 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:27<00:19,  5.40it/s, est. speed input: 5640.21 toks/s, output: 5.51 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:27<00:18,  5.43it/s, est. speed input: 5639.92 toks/s, output: 5.51 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:28<00:18,  5.43it/s, est. speed input: 5638.90 toks/s, output: 5.51 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:28<00:18,  5.41it/s, est. speed input: 5636.99 toks/s, output: 5.50 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:29<00:17,  5.42it/s, est. speed input: 5636.04 toks/s, output: 5.50 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:29<00:17,  5.42it/s, est. speed input: 5635.14 toks/s, output: 5.50 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:29<00:17,  5.41it/s, est. speed input: 5633.47 toks/s, output: 5.50 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:30<00:16,  5.42it/s, est. speed input: 5632.90 toks/s, output: 5.50 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:30<00:16,  5.43it/s, est. speed input: 5632.09 toks/s, output: 5.50 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:30<00:15,  5.40it/s, est. speed input: 5630.29 toks/s, output: 5.50 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:31<00:15,  5.43it/s, est. speed input: 5630.42 toks/s, output: 5.50 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:31<00:15,  5.18it/s, est. speed input: 5619.06 toks/s, output: 5.49 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:32<00:15,  5.26it/s, est. speed input: 5618.43 toks/s, output: 5.49 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:32<00:14,  5.32it/s, est. speed input: 5618.20 toks/s, output: 5.49 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:32<00:14,  5.33it/s, est. speed input: 5616.74 toks/s, output: 5.49 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:33<00:13,  5.37it/s, est. speed input: 5616.48 toks/s, output: 5.48 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:33<00:13,  5.39it/s, est. speed input: 5615.93 toks/s, output: 5.48 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:33<00:13,  5.38it/s, est. speed input: 5614.65 toks/s, output: 5.48 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:34<00:12,  5.41it/s, est. speed input: 5614.49 toks/s, output: 5.48 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:34<00:12,  5.41it/s, est. speed input: 5613.71 toks/s, output: 5.48 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:35<00:11,  5.39it/s, est. speed input: 5612.22 toks/s, output: 5.48 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:35<00:11,  5.41it/s, est. speed input: 5611.99 toks/s, output: 5.48 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:35<00:11,  5.42it/s, est. speed input: 5611.41 toks/s, output: 5.48 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:36<00:10,  5.43it/s, est. speed input: 5611.08 toks/s, output: 5.48 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:36<00:10,  5.42it/s, est. speed input: 5610.50 toks/s, output: 5.48 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:36<00:08,  6.37it/s, est. speed input: 5637.76 toks/s, output: 5.51 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:37<00:08,  6.03it/s, est. speed input: 5636.41 toks/s, output: 5.50 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:37<00:08,  5.84it/s, est. speed input: 5635.86 toks/s, output: 5.50 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:37<00:08,  5.72it/s, est. speed input: 5635.37 toks/s, output: 5.50 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:38<00:08,  5.61it/s, est. speed input: 5634.05 toks/s, output: 5.50 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:38<00:07,  5.56it/s, est. speed input: 5633.31 toks/s, output: 5.50 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:38<00:07,  5.52it/s, est. speed input: 5632.77 toks/s, output: 5.50 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:39<00:07,  5.50it/s, est. speed input: 5632.16 toks/s, output: 5.50 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:39<00:06,  5.48it/s, est. speed input: 5631.66 toks/s, output: 5.50 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:40<00:06,  5.47it/s, est. speed input: 5631.05 toks/s, output: 5.50 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:40<00:06,  5.44it/s, est. speed input: 5630.05 toks/s, output: 5.50 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:40<00:05,  5.45it/s, est. speed input: 5629.78 toks/s, output: 5.50 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:41<00:05,  5.43it/s, est. speed input: 5628.72 toks/s, output: 5.50 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:41<00:05,  5.41it/s, est. speed input: 5627.39 toks/s, output: 5.50 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:41<00:04,  5.41it/s, est. speed input: 5626.71 toks/s, output: 5.49 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:42<00:04,  5.42it/s, est. speed input: 5626.33 toks/s, output: 5.49 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:42<00:04,  5.40it/s, est. speed input: 5625.14 toks/s, output: 5.49 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:42<00:03,  5.41it/s, est. speed input: 5624.46 toks/s, output: 5.49 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:43<00:03,  5.43it/s, est. speed input: 5624.28 toks/s, output: 5.49 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:43<00:02,  5.41it/s, est. speed input: 5623.08 toks/s, output: 5.49 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:44<00:02,  5.41it/s, est. speed input: 5622.57 toks/s, output: 5.49 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:44<00:02,  5.43it/s, est. speed input: 5622.50 toks/s, output: 5.49 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:44<00:01,  5.40it/s, est. speed input: 5621.03 toks/s, output: 5.49 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:45<00:01,  5.42it/s, est. speed input: 5620.75 toks/s, output: 5.49 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:45<00:01,  5.41it/s, est. speed input: 5619.87 toks/s, output: 5.49 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:45<00:00,  5.40it/s, est. speed input: 5619.13 toks/s, output: 5.49 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:46<00:00,  5.42it/s, est. speed input: 5618.94 toks/s, output: 5.49 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:46<00:00,  6.40it/s, est. speed input: 5641.09 toks/s, output: 5.51 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:46<00:00,  6.40it/s, est. speed input: 5641.09 toks/s, output: 5.51 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:46<00:00,  5.51it/s, est. speed input: 5641.09 toks/s, output: 5.51 toks/s]
[rank0]:[W126 13:56:56.015489235 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 106.8s

测试结果:
  Requests/s:   5.43
  Tokens/s:     5565.23
  Total Reqs:   256
  Elapsed:      47.15s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     5559.80

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:57:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 13:57:04 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1365526) WARNING 01-26 13:57:57 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.52 requests/s, 5656.36 total tokens/s, 5.52 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 13:57:04] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:57:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:57:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:57:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:57:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:57:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:57:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:57:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:57:07] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:57:07] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:57:07] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:57:07] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:57:07] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:57:07] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:57:07] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:57:07] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:57:07] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1365526) [2026-01-26 13:57:08] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1365526) [2026-01-26 13:57:08] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1365526) [2026-01-26 13:57:08] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1365526) [2026-01-26 13:57:08] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1365526) [2026-01-26 13:57:08] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1365526) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1365526) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.88s/it]
(EngineCore_DP0 pid=1365526) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.72s/it]
(EngineCore_DP0 pid=1365526) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.75s/it]
(EngineCore_DP0 pid=1365526) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1365526) 2026-01-26 13:57:56,531 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1365526) 2026-01-26 13:57:56,731 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   7%|▋         | 35/512 [00:00<00:01, 348.90it/s]
Adding requests:  14%|█▎        | 70/512 [00:00<00:01, 333.95it/s]
Adding requests:  21%|██        | 107/512 [00:00<00:01, 348.97it/s]
Adding requests:  28%|██▊       | 145/512 [00:00<00:01, 359.20it/s]
Adding requests:  37%|███▋      | 187/512 [00:00<00:00, 379.54it/s]
Adding requests:  45%|████▍     | 228/512 [00:00<00:00, 388.91it/s]
Adding requests:  52%|█████▏    | 268/512 [00:00<00:00, 392.00it/s]
Adding requests:  60%|██████    | 309/512 [00:00<00:00, 394.82it/s]
Adding requests:  69%|██████▉   | 353/512 [00:00<00:00, 406.60it/s]
Adding requests:  77%|███████▋  | 394/512 [00:01<00:00, 403.86it/s]
Adding requests:  85%|████████▌ | 436/512 [00:01<00:00, 405.97it/s]
Adding requests:  93%|█████████▎| 478/512 [00:01<00:00, 407.12it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 392.48it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:33, 15.12it/s, est. speed input: 15486.72 toks/s, output: 15.12 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:01<01:01,  8.19it/s, est. speed input: 9140.92 toks/s, output: 8.93 toks/s] 
Processed prompts:   3%|▎         | 14/512 [00:01<01:12,  6.83it/s, est. speed input: 7765.84 toks/s, output: 7.58 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:02<01:18,  6.27it/s, est. speed input: 7167.87 toks/s, output: 7.00 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:03<01:21,  6.01it/s, est. speed input: 6849.13 toks/s, output: 6.69 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:04<01:23,  5.84it/s, est. speed input: 6630.13 toks/s, output: 6.47 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:24,  5.72it/s, est. speed input: 6476.14 toks/s, output: 6.32 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:05<01:24,  5.66it/s, est. speed input: 6369.37 toks/s, output: 6.22 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:06<01:24,  5.61it/s, est. speed input: 6282.91 toks/s, output: 6.14 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:24,  5.57it/s, est. speed input: 6212.37 toks/s, output: 6.07 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:07<01:23,  5.56it/s, est. speed input: 6160.31 toks/s, output: 6.02 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:08<01:23,  5.54it/s, est. speed input: 6114.95 toks/s, output: 5.97 toks/s]
Processed prompts:  11%|█         | 54/512 [00:09<01:22,  5.53it/s, est. speed input: 6077.26 toks/s, output: 5.93 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:09<01:22,  5.53it/s, est. speed input: 6046.08 toks/s, output: 5.90 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:10<01:21,  5.52it/s, est. speed input: 6016.38 toks/s, output: 5.88 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:11<01:21,  5.50it/s, est. speed input: 5988.88 toks/s, output: 5.85 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:12<01:20,  5.51it/s, est. speed input: 5970.03 toks/s, output: 5.83 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:12<01:19,  5.50it/s, est. speed input: 5949.47 toks/s, output: 5.81 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:13<01:18,  5.50it/s, est. speed input: 5931.57 toks/s, output: 5.79 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:14<01:18,  5.49it/s, est. speed input: 5915.03 toks/s, output: 5.78 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:14<01:17,  5.49it/s, est. speed input: 5900.77 toks/s, output: 5.76 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:15<01:16,  5.49it/s, est. speed input: 5887.49 toks/s, output: 5.75 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:16<01:16,  5.49it/s, est. speed input: 5875.17 toks/s, output: 5.74 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:17<01:15,  5.50it/s, est. speed input: 5865.54 toks/s, output: 5.73 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:17<01:14,  5.49it/s, est. speed input: 5855.70 toks/s, output: 5.72 toks/s]
Processed prompts:  21%|██        | 106/512 [00:18<01:13,  5.50it/s, est. speed input: 5846.95 toks/s, output: 5.71 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:19<01:13,  5.50it/s, est. speed input: 5839.82 toks/s, output: 5.70 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:20<01:12,  5.50it/s, est. speed input: 5832.47 toks/s, output: 5.70 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:20<01:11,  5.49it/s, est. speed input: 5823.91 toks/s, output: 5.69 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:21<01:10,  5.51it/s, est. speed input: 5819.09 toks/s, output: 5.68 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:22<01:10,  5.50it/s, est. speed input: 5812.87 toks/s, output: 5.68 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:22<01:09,  5.50it/s, est. speed input: 5806.49 toks/s, output: 5.67 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:23<01:08,  5.50it/s, est. speed input: 5801.26 toks/s, output: 5.67 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:24<01:08,  5.50it/s, est. speed input: 5795.80 toks/s, output: 5.66 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:25<01:07,  5.49it/s, est. speed input: 5790.34 toks/s, output: 5.65 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:25<01:06,  5.50it/s, est. speed input: 5786.43 toks/s, output: 5.65 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:26<01:05,  5.49it/s, est. speed input: 5781.81 toks/s, output: 5.65 toks/s]
Processed prompts:  30%|███       | 154/512 [00:27<01:05,  5.49it/s, est. speed input: 5777.54 toks/s, output: 5.64 toks/s]
Processed prompts:  31%|███       | 158/512 [00:28<01:04,  5.51it/s, est. speed input: 5774.87 toks/s, output: 5.64 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:28<01:03,  5.50it/s, est. speed input: 5770.42 toks/s, output: 5.64 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:29<01:03,  5.49it/s, est. speed input: 5766.04 toks/s, output: 5.63 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:30<01:02,  5.50it/s, est. speed input: 5763.51 toks/s, output: 5.63 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:30<01:01,  5.49it/s, est. speed input: 5759.71 toks/s, output: 5.62 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:31<01:00,  5.49it/s, est. speed input: 5756.52 toks/s, output: 5.62 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:32<01:00,  5.50it/s, est. speed input: 5754.25 toks/s, output: 5.62 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:33<00:59,  5.49it/s, est. speed input: 5750.92 toks/s, output: 5.62 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:33<00:58,  5.48it/s, est. speed input: 5747.51 toks/s, output: 5.61 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:34<00:57,  5.49it/s, est. speed input: 5745.33 toks/s, output: 5.61 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:35<00:57,  5.49it/s, est. speed input: 5742.89 toks/s, output: 5.61 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:35<00:52,  5.91it/s, est. speed input: 5768.19 toks/s, output: 5.63 toks/s]
Processed prompts:  40%|████      | 206/512 [00:36<00:52,  5.79it/s, est. speed input: 5765.72 toks/s, output: 5.63 toks/s]
Processed prompts:  41%|████      | 210/512 [00:37<00:52,  5.70it/s, est. speed input: 5763.25 toks/s, output: 5.63 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:38<00:53,  5.62it/s, est. speed input: 5759.65 toks/s, output: 5.62 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:38<00:52,  5.58it/s, est. speed input: 5757.21 toks/s, output: 5.62 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:39<00:52,  5.56it/s, est. speed input: 5754.70 toks/s, output: 5.62 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:40<00:51,  5.54it/s, est. speed input: 5752.33 toks/s, output: 5.62 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:40<00:51,  5.52it/s, est. speed input: 5750.16 toks/s, output: 5.62 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:41<00:50,  5.51it/s, est. speed input: 5747.94 toks/s, output: 5.61 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:42<00:49,  5.50it/s, est. speed input: 5745.49 toks/s, output: 5.61 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:43<00:49,  5.50it/s, est. speed input: 5743.29 toks/s, output: 5.61 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:43<00:48,  5.50it/s, est. speed input: 5741.62 toks/s, output: 5.61 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:44<00:47,  5.50it/s, est. speed input: 5739.53 toks/s, output: 5.61 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:45<00:46,  5.49it/s, est. speed input: 5737.49 toks/s, output: 5.60 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:46<00:46,  5.49it/s, est. speed input: 5735.82 toks/s, output: 5.60 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:46<00:45,  5.49it/s, est. speed input: 5733.82 toks/s, output: 5.60 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:47<00:44,  5.48it/s, est. speed input: 5731.83 toks/s, output: 5.60 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:48<00:44,  5.49it/s, est. speed input: 5730.56 toks/s, output: 5.60 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:48<00:43,  5.49it/s, est. speed input: 5728.88 toks/s, output: 5.59 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:49<00:42,  5.49it/s, est. speed input: 5727.21 toks/s, output: 5.59 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:50<00:41,  5.49it/s, est. speed input: 5725.82 toks/s, output: 5.59 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:51<00:41,  5.49it/s, est. speed input: 5724.05 toks/s, output: 5.59 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:51<00:40,  5.48it/s, est. speed input: 5722.23 toks/s, output: 5.59 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:52<00:39,  5.50it/s, est. speed input: 5721.60 toks/s, output: 5.59 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:53<00:39,  5.48it/s, est. speed input: 5719.35 toks/s, output: 5.59 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:54<00:38,  5.48it/s, est. speed input: 5718.08 toks/s, output: 5.58 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:54<00:34,  5.92it/s, est. speed input: 5735.38 toks/s, output: 5.60 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:55<00:34,  5.78it/s, est. speed input: 5733.62 toks/s, output: 5.60 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:56<00:34,  5.69it/s, est. speed input: 5732.21 toks/s, output: 5.60 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:56<00:34,  5.63it/s, est. speed input: 5730.99 toks/s, output: 5.60 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:57<00:34,  5.59it/s, est. speed input: 5729.50 toks/s, output: 5.60 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:58<00:33,  5.55it/s, est. speed input: 5727.87 toks/s, output: 5.59 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:59<00:32,  5.54it/s, est. speed input: 5726.89 toks/s, output: 5.59 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:59<00:32,  5.52it/s, est. speed input: 5725.39 toks/s, output: 5.59 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [01:00<00:31,  5.50it/s, est. speed input: 5723.90 toks/s, output: 5.59 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [01:01<00:30,  5.50it/s, est. speed input: 5722.83 toks/s, output: 5.59 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [01:01<00:30,  5.49it/s, est. speed input: 5721.29 toks/s, output: 5.59 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [01:02<00:29,  5.49it/s, est. speed input: 5719.93 toks/s, output: 5.59 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [01:03<00:28,  5.50it/s, est. speed input: 5719.13 toks/s, output: 5.59 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [01:04<00:28,  5.49it/s, est. speed input: 5717.75 toks/s, output: 5.58 toks/s]
Processed prompts:  71%|███████   | 362/512 [01:04<00:27,  5.48it/s, est. speed input: 5716.47 toks/s, output: 5.58 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [01:05<00:26,  5.50it/s, est. speed input: 5715.83 toks/s, output: 5.58 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [01:06<00:25,  5.49it/s, est. speed input: 5714.49 toks/s, output: 5.58 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [01:07<00:25,  5.49it/s, est. speed input: 5713.54 toks/s, output: 5.58 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [01:07<00:24,  5.49it/s, est. speed input: 5712.68 toks/s, output: 5.58 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:08<00:23,  5.48it/s, est. speed input: 5711.40 toks/s, output: 5.58 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:09<00:22,  5.48it/s, est. speed input: 5710.34 toks/s, output: 5.58 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:09<00:22,  5.49it/s, est. speed input: 5709.59 toks/s, output: 5.58 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:10<00:21,  5.49it/s, est. speed input: 5708.60 toks/s, output: 5.57 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:11<00:20,  5.48it/s, est. speed input: 5707.44 toks/s, output: 5.57 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:12<00:20,  5.49it/s, est. speed input: 5706.72 toks/s, output: 5.57 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:12<00:19,  5.48it/s, est. speed input: 5705.72 toks/s, output: 5.57 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:13<00:18,  5.48it/s, est. speed input: 5704.70 toks/s, output: 5.57 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:14<00:17,  5.47it/s, est. speed input: 5703.53 toks/s, output: 5.57 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:15<00:17,  5.49it/s, est. speed input: 5703.06 toks/s, output: 5.57 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:15<00:16,  5.48it/s, est. speed input: 5701.95 toks/s, output: 5.57 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:16<00:15,  5.49it/s, est. speed input: 5701.42 toks/s, output: 5.57 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:17<00:14,  5.50it/s, est. speed input: 5700.93 toks/s, output: 5.57 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:17<00:13,  5.92it/s, est. speed input: 5712.97 toks/s, output: 5.58 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:18<00:12,  5.79it/s, est. speed input: 5712.31 toks/s, output: 5.58 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:19<00:12,  5.69it/s, est. speed input: 5711.30 toks/s, output: 5.58 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:19<00:11,  5.62it/s, est. speed input: 5710.32 toks/s, output: 5.58 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:20<00:11,  5.58it/s, est. speed input: 5709.51 toks/s, output: 5.58 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:21<00:10,  5.54it/s, est. speed input: 5708.35 toks/s, output: 5.57 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:22<00:09,  5.52it/s, est. speed input: 5707.41 toks/s, output: 5.57 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:22<00:09,  5.50it/s, est. speed input: 5706.35 toks/s, output: 5.57 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:23<00:08,  5.50it/s, est. speed input: 5705.67 toks/s, output: 5.57 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:24<00:07,  5.49it/s, est. speed input: 5704.66 toks/s, output: 5.57 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:25<00:06,  5.49it/s, est. speed input: 5704.03 toks/s, output: 5.57 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:25<00:06,  5.49it/s, est. speed input: 5703.32 toks/s, output: 5.57 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:26<00:05,  5.49it/s, est. speed input: 5702.51 toks/s, output: 5.57 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:27<00:04,  5.48it/s, est. speed input: 5701.54 toks/s, output: 5.57 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:28<00:04,  5.49it/s, est. speed input: 5701.07 toks/s, output: 5.57 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:28<00:03,  5.48it/s, est. speed input: 5700.10 toks/s, output: 5.57 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:29<00:02,  5.48it/s, est. speed input: 5699.32 toks/s, output: 5.57 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:30<00:01,  5.49it/s, est. speed input: 5698.98 toks/s, output: 5.57 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:30<00:01,  5.49it/s, est. speed input: 5698.26 toks/s, output: 5.56 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:31<00:00,  5.94it/s, est. speed input: 5709.12 toks/s, output: 5.58 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:31<00:00,  5.94it/s, est. speed input: 5731.50 toks/s, output: 5.60 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:31<00:00,  5.60it/s, est. speed input: 5731.50 toks/s, output: 5.60 toks/s]
[rank0]:[W126 13:59:30.151377875 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 154.1s

测试结果:
  Requests/s:   5.52
  Tokens/s:     5656.36
  Total Reqs:   512
  Elapsed:      92.78s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     5650.85

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 13:59:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 13:59:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1367885) WARNING 01-26 14:00:37 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 2.22 requests/s, 2276.54 total tokens/s, 2.22 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 13:59:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:59:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:59:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:59:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:59:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:59:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:59:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:59:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 13:59:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 13:59:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:59:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 13:59:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 13:59:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 13:59:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 13:59:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 13:59:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 13:59:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1367885) [2026-01-26 13:59:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1367885) [2026-01-26 13:59:44] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1367885) [2026-01-26 13:59:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1367885) [2026-01-26 13:59:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1367885) [2026-01-26 13:59:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1367885) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1367885) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.33s/it]
(EngineCore_DP0 pid=1367885) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.36s/it]
(EngineCore_DP0 pid=1367885) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.36s/it]
(EngineCore_DP0 pid=1367885) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1367885) 2026-01-26 14:00:32,413 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1367885) 2026-01-26 14:00:32,743 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▎         | 38/1024 [00:00<00:02, 373.76it/s]
Adding requests:   7%|▋         | 76/1024 [00:00<00:02, 363.49it/s]
Adding requests:  12%|█▏        | 120/1024 [00:00<00:02, 395.13it/s]
Adding requests:  16%|█▋        | 167/1024 [00:00<00:02, 423.10it/s]
Adding requests:  22%|██▏       | 226/1024 [00:00<00:01, 480.57it/s]
Adding requests:  27%|██▋       | 281/1024 [00:00<00:01, 503.15it/s]
Adding requests:  33%|███▎      | 339/1024 [00:00<00:01, 524.53it/s]
Adding requests:  38%|███▊      | 392/1024 [00:00<00:01, 522.00it/s]
Adding requests:  44%|████▍     | 448/1024 [00:00<00:01, 533.24it/s]
Adding requests:  50%|████▉     | 509/1024 [00:01<00:00, 554.40it/s]
Adding requests:  55%|█████▌    | 567/1024 [00:01<00:00, 561.55it/s]
Adding requests:  61%|██████    | 624/1024 [00:01<00:00, 552.61it/s]
Adding requests:  66%|██████▋   | 680/1024 [00:01<00:00, 532.29it/s]
Adding requests:  72%|███████▏  | 734/1024 [00:01<00:00, 520.82it/s]
Adding requests:  77%|███████▋  | 787/1024 [00:01<00:00, 512.01it/s]
Adding requests:  82%|████████▏ | 839/1024 [00:01<00:00, 508.07it/s]
Adding requests:  88%|████████▊ | 897/1024 [00:01<00:00, 526.77it/s]
Adding requests:  93%|█████████▎| 950/1024 [00:01<00:00, 527.00it/s]
Adding requests:  98%|█████████▊| 1003/1024 [00:01<00:00, 515.92it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 509.00it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 2/1024 [00:02<22:11,  1.30s/it, est. speed input: 785.74 toks/s, output: 0.77 toks/s]
Processed prompts:   1%|          | 10/1024 [00:06<10:12,  1.66it/s, est. speed input: 1585.33 toks/s, output: 1.55 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:10<08:45,  1.91it/s, est. speed input: 1824.27 toks/s, output: 1.78 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:13<08:12,  2.02it/s, est. speed input: 1934.53 toks/s, output: 1.89 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:17<07:54,  2.09it/s, est. speed input: 1999.26 toks/s, output: 1.95 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:21<07:42,  2.12it/s, est. speed input: 2042.58 toks/s, output: 1.99 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:24<07:33,  2.15it/s, est. speed input: 2072.82 toks/s, output: 2.02 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:28<07:26,  2.16it/s, est. speed input: 2094.82 toks/s, output: 2.05 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:31<07:20,  2.17it/s, est. speed input: 2112.66 toks/s, output: 2.06 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:35<07:16,  2.18it/s, est. speed input: 2125.94 toks/s, output: 2.08 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:39<07:11,  2.18it/s, est. speed input: 2137.56 toks/s, output: 2.09 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:42<07:07,  2.19it/s, est. speed input: 2146.63 toks/s, output: 2.10 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:46<07:03,  2.19it/s, est. speed input: 2153.70 toks/s, output: 2.10 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:50<06:59,  2.19it/s, est. speed input: 2160.00 toks/s, output: 2.11 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:53<06:56,  2.19it/s, est. speed input: 2165.59 toks/s, output: 2.11 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:57<06:51,  2.19it/s, est. speed input: 2170.70 toks/s, output: 2.12 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [01:01<06:48,  2.19it/s, est. speed input: 2175.19 toks/s, output: 2.12 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [01:04<06:44,  2.19it/s, est. speed input: 2179.16 toks/s, output: 2.13 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [01:08<06:40,  2.19it/s, est. speed input: 2182.80 toks/s, output: 2.13 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [01:12<06:36,  2.19it/s, est. speed input: 2185.96 toks/s, output: 2.13 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [01:15<06:33,  2.19it/s, est. speed input: 2188.45 toks/s, output: 2.14 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [01:19<06:30,  2.19it/s, est. speed input: 2190.76 toks/s, output: 2.14 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [01:23<06:26,  2.19it/s, est. speed input: 2192.99 toks/s, output: 2.14 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [01:26<06:22,  2.19it/s, est. speed input: 2194.96 toks/s, output: 2.14 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [01:30<06:18,  2.19it/s, est. speed input: 2197.23 toks/s, output: 2.15 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [01:32<05:25,  2.53it/s, est. speed input: 2237.32 toks/s, output: 2.18 toks/s]
Processed prompts:  21%|██        | 210/1024 [01:36<05:36,  2.42it/s, est. speed input: 2237.63 toks/s, output: 2.19 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [01:39<05:43,  2.34it/s, est. speed input: 2237.93 toks/s, output: 2.19 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [01:43<05:47,  2.29it/s, est. speed input: 2237.87 toks/s, output: 2.19 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [01:47<05:49,  2.26it/s, est. speed input: 2238.02 toks/s, output: 2.19 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [01:50<05:51,  2.23it/s, est. speed input: 2236.70 toks/s, output: 2.18 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [01:54<05:49,  2.22it/s, est. speed input: 2237.10 toks/s, output: 2.18 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [01:58<05:46,  2.21it/s, est. speed input: 2237.23 toks/s, output: 2.18 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [02:01<05:43,  2.20it/s, est. speed input: 2237.51 toks/s, output: 2.19 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [02:05<05:40,  2.20it/s, est. speed input: 2237.65 toks/s, output: 2.19 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [02:09<05:37,  2.20it/s, est. speed input: 2237.91 toks/s, output: 2.19 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [02:12<05:34,  2.20it/s, est. speed input: 2237.98 toks/s, output: 2.19 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [02:16<05:30,  2.19it/s, est. speed input: 2238.20 toks/s, output: 2.19 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [02:18<04:44,  2.53it/s, est. speed input: 2264.34 toks/s, output: 2.21 toks/s]
Processed prompts:  31%|███       | 314/1024 [02:22<04:55,  2.40it/s, est. speed input: 2262.55 toks/s, output: 2.21 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [02:25<05:00,  2.33it/s, est. speed input: 2262.07 toks/s, output: 2.21 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [02:29<05:03,  2.29it/s, est. speed input: 2261.60 toks/s, output: 2.21 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [02:33<05:04,  2.26it/s, est. speed input: 2261.03 toks/s, output: 2.21 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [02:36<05:03,  2.24it/s, est. speed input: 2260.66 toks/s, output: 2.21 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [02:40<05:01,  2.22it/s, est. speed input: 2260.17 toks/s, output: 2.21 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [02:44<04:59,  2.21it/s, est. speed input: 2259.87 toks/s, output: 2.21 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [02:47<04:56,  2.21it/s, est. speed input: 2259.43 toks/s, output: 2.21 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [02:51<04:53,  2.20it/s, est. speed input: 2259.10 toks/s, output: 2.21 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [02:55<04:52,  2.18it/s, est. speed input: 2257.82 toks/s, output: 2.20 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [02:58<04:48,  2.19it/s, est. speed input: 2257.53 toks/s, output: 2.20 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [03:02<04:44,  2.19it/s, est. speed input: 2257.19 toks/s, output: 2.20 toks/s]
Processed prompts:  40%|████      | 410/1024 [03:06<04:40,  2.19it/s, est. speed input: 2256.92 toks/s, output: 2.20 toks/s]
Processed prompts:  41%|████      | 418/1024 [03:09<04:36,  2.19it/s, est. speed input: 2256.64 toks/s, output: 2.20 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [03:13<04:32,  2.19it/s, est. speed input: 2256.48 toks/s, output: 2.20 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [03:15<03:53,  2.52it/s, est. speed input: 2274.84 toks/s, output: 2.22 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [03:19<04:00,  2.42it/s, est. speed input: 2274.30 toks/s, output: 2.22 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [03:22<04:04,  2.34it/s, est. speed input: 2273.79 toks/s, output: 2.22 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [03:26<04:08,  2.28it/s, est. speed input: 2272.39 toks/s, output: 2.22 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [03:30<04:07,  2.25it/s, est. speed input: 2271.85 toks/s, output: 2.22 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [03:33<04:06,  2.23it/s, est. speed input: 2271.37 toks/s, output: 2.22 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [03:37<04:03,  2.22it/s, est. speed input: 2270.95 toks/s, output: 2.22 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [03:40<04:01,  2.21it/s, est. speed input: 2270.55 toks/s, output: 2.22 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [03:44<03:58,  2.21it/s, est. speed input: 2270.08 toks/s, output: 2.22 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [03:48<03:55,  2.20it/s, est. speed input: 2269.66 toks/s, output: 2.22 toks/s]
Processed prompts:  50%|█████     | 514/1024 [03:51<03:51,  2.20it/s, est. speed input: 2269.25 toks/s, output: 2.22 toks/s]
Processed prompts:  51%|█████     | 522/1024 [03:55<03:48,  2.19it/s, est. speed input: 2268.78 toks/s, output: 2.22 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [03:59<03:46,  2.18it/s, est. speed input: 2267.78 toks/s, output: 2.21 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [04:02<03:42,  2.19it/s, est. speed input: 2267.45 toks/s, output: 2.21 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [04:06<03:38,  2.19it/s, est. speed input: 2267.13 toks/s, output: 2.21 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [04:10<03:34,  2.19it/s, est. speed input: 2266.71 toks/s, output: 2.21 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [04:13<03:31,  2.19it/s, est. speed input: 2266.42 toks/s, output: 2.21 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [04:17<03:27,  2.19it/s, est. speed input: 2266.06 toks/s, output: 2.21 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [04:21<03:23,  2.19it/s, est. speed input: 2265.76 toks/s, output: 2.21 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [04:24<03:20,  2.19it/s, est. speed input: 2265.44 toks/s, output: 2.21 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [04:28<03:16,  2.19it/s, est. speed input: 2265.07 toks/s, output: 2.21 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [04:32<03:13,  2.18it/s, est. speed input: 2264.43 toks/s, output: 2.21 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [04:35<03:09,  2.18it/s, est. speed input: 2264.13 toks/s, output: 2.21 toks/s]
Processed prompts:  60%|██████    | 618/1024 [04:39<03:05,  2.19it/s, est. speed input: 2263.84 toks/s, output: 2.21 toks/s]
Processed prompts:  61%|██████    | 626/1024 [04:43<03:01,  2.19it/s, est. speed input: 2263.66 toks/s, output: 2.21 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [04:46<02:58,  2.19it/s, est. speed input: 2263.33 toks/s, output: 2.21 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [04:50<02:54,  2.19it/s, est. speed input: 2263.12 toks/s, output: 2.21 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [04:54<02:50,  2.19it/s, est. speed input: 2262.85 toks/s, output: 2.21 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [04:57<02:47,  2.19it/s, est. speed input: 2262.61 toks/s, output: 2.21 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [05:01<02:43,  2.18it/s, est. speed input: 2262.14 toks/s, output: 2.21 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [05:05<02:40,  2.19it/s, est. speed input: 2261.92 toks/s, output: 2.21 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [05:08<02:36,  2.19it/s, est. speed input: 2261.69 toks/s, output: 2.21 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [05:12<02:32,  2.19it/s, est. speed input: 2261.50 toks/s, output: 2.21 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [05:16<02:28,  2.19it/s, est. speed input: 2261.23 toks/s, output: 2.21 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [05:19<02:25,  2.19it/s, est. speed input: 2261.03 toks/s, output: 2.21 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [05:23<02:21,  2.19it/s, est. speed input: 2260.82 toks/s, output: 2.21 toks/s]
Processed prompts:  71%|███████   | 722/1024 [05:27<02:17,  2.19it/s, est. speed input: 2260.64 toks/s, output: 2.21 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [05:30<02:14,  2.19it/s, est. speed input: 2260.42 toks/s, output: 2.21 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [05:34<02:10,  2.19it/s, est. speed input: 2260.24 toks/s, output: 2.21 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [05:37<02:06,  2.19it/s, est. speed input: 2260.11 toks/s, output: 2.21 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [05:41<02:03,  2.19it/s, est. speed input: 2259.94 toks/s, output: 2.21 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [05:45<01:59,  2.19it/s, est. speed input: 2259.75 toks/s, output: 2.21 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [05:48<01:55,  2.19it/s, est. speed input: 2259.55 toks/s, output: 2.21 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [05:52<01:52,  2.19it/s, est. speed input: 2259.35 toks/s, output: 2.21 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [05:54<01:34,  2.52it/s, est. speed input: 2269.47 toks/s, output: 2.22 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [05:58<01:35,  2.41it/s, est. speed input: 2269.19 toks/s, output: 2.22 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [06:01<01:34,  2.34it/s, est. speed input: 2268.89 toks/s, output: 2.22 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [06:05<01:33,  2.29it/s, est. speed input: 2268.62 toks/s, output: 2.22 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [06:09<01:31,  2.25it/s, est. speed input: 2267.96 toks/s, output: 2.21 toks/s]
Processed prompts:  81%|████████  | 826/1024 [06:12<01:28,  2.23it/s, est. speed input: 2267.67 toks/s, output: 2.21 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [06:16<01:25,  2.22it/s, est. speed input: 2267.44 toks/s, output: 2.21 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [06:20<01:22,  2.21it/s, est. speed input: 2267.21 toks/s, output: 2.21 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [06:23<01:18,  2.20it/s, est. speed input: 2267.01 toks/s, output: 2.21 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [06:27<01:15,  2.20it/s, est. speed input: 2266.77 toks/s, output: 2.21 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [06:31<01:11,  2.20it/s, est. speed input: 2266.56 toks/s, output: 2.21 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [06:34<01:08,  2.19it/s, est. speed input: 2266.32 toks/s, output: 2.21 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [06:38<01:05,  2.18it/s, est. speed input: 2265.74 toks/s, output: 2.21 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [06:42<01:01,  2.18it/s, est. speed input: 2265.48 toks/s, output: 2.21 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [06:45<00:57,  2.19it/s, est. speed input: 2265.30 toks/s, output: 2.21 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [06:49<00:53,  2.19it/s, est. speed input: 2265.06 toks/s, output: 2.21 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [06:53<00:50,  2.19it/s, est. speed input: 2264.94 toks/s, output: 2.21 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [06:56<00:46,  2.19it/s, est. speed input: 2264.77 toks/s, output: 2.21 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [07:00<00:42,  2.19it/s, est. speed input: 2264.59 toks/s, output: 2.21 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [07:04<00:39,  2.19it/s, est. speed input: 2264.39 toks/s, output: 2.21 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [07:07<00:35,  2.19it/s, est. speed input: 2264.19 toks/s, output: 2.21 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [07:11<00:31,  2.19it/s, est. speed input: 2264.02 toks/s, output: 2.21 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [07:15<00:28,  2.19it/s, est. speed input: 2263.87 toks/s, output: 2.21 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [07:18<00:24,  2.19it/s, est. speed input: 2263.72 toks/s, output: 2.21 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [07:22<00:20,  2.19it/s, est. speed input: 2263.61 toks/s, output: 2.21 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [07:26<00:17,  2.19it/s, est. speed input: 2263.45 toks/s, output: 2.21 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [07:29<00:13,  2.19it/s, est. speed input: 2263.28 toks/s, output: 2.21 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [07:33<00:10,  2.19it/s, est. speed input: 2263.01 toks/s, output: 2.21 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [07:37<00:06,  2.19it/s, est. speed input: 2262.85 toks/s, output: 2.21 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [07:39<00:02,  2.54it/s, est. speed input: 2270.91 toks/s, output: 2.22 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [07:39<00:00,  2.54it/s, est. speed input: 2284.29 toks/s, output: 2.23 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [07:39<00:00,  2.23it/s, est. speed input: 2284.29 toks/s, output: 2.23 toks/s]
[rank0]:[W126 14:08:18.988206030 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 527.8s

测试结果:
  Requests/s:   2.22
  Tokens/s:     2276.54
  Total Reqs:   1024
  Elapsed:      461.05s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     2274.32

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:08:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:08:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1375414) WARNING 01-26 14:09:29 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.65 requests/s, 5795.37 total tokens/s, 5.65 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 14:08:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:08:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:08:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:08:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:08:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:08:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:08:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:08:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:08:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:08:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:08:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:08:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:08:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:08:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:08:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:08:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:08:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1375414) [2026-01-26 14:08:36] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1375414) [2026-01-26 14:08:36] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1375414) [2026-01-26 14:08:36] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1375414) [2026-01-26 14:08:36] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1375414) [2026-01-26 14:08:36] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1375414) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1375414) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.82s/it]
(EngineCore_DP0 pid=1375414) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.42s/it]
(EngineCore_DP0 pid=1375414) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.48s/it]
(EngineCore_DP0 pid=1375414) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1375414) 2026-01-26 14:09:25,356 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1375414) 2026-01-26 14:09:25,726 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 36/2048 [00:00<00:05, 353.17it/s]
Adding requests:   4%|▎         | 72/2048 [00:00<00:05, 340.05it/s]
Adding requests:   5%|▌         | 107/2048 [00:00<00:05, 343.47it/s]
Adding requests:   7%|▋         | 146/2048 [00:00<00:05, 360.22it/s]
Adding requests:   9%|▉         | 191/2048 [00:00<00:04, 388.60it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:04, 402.00it/s]
Adding requests:  13%|█▎        | 275/2048 [00:00<00:04, 388.44it/s]
Adding requests:  15%|█▌        | 317/2048 [00:00<00:04, 395.55it/s]
Adding requests:  18%|█▊        | 359/2048 [00:00<00:04, 402.02it/s]
Adding requests:  20%|█▉        | 400/2048 [00:01<00:04, 403.00it/s]
Adding requests:  22%|██▏       | 443/2048 [00:01<00:03, 408.11it/s]
Adding requests:  24%|██▍       | 490/2048 [00:01<00:03, 425.54it/s]
Adding requests:  26%|██▌       | 534/2048 [00:01<00:03, 428.02it/s]
Adding requests:  28%|██▊       | 577/2048 [00:01<00:03, 418.30it/s]
Adding requests:  30%|███       | 619/2048 [00:01<00:03, 410.86it/s]
Adding requests:  32%|███▏      | 661/2048 [00:01<00:03, 406.03it/s]
Adding requests:  34%|███▍      | 702/2048 [00:01<00:03, 406.45it/s]
Adding requests:  36%|███▋      | 743/2048 [00:01<00:03, 401.48it/s]
Adding requests:  38%|███▊      | 784/2048 [00:01<00:03, 383.91it/s]
Adding requests:  40%|████      | 825/2048 [00:02<00:03, 391.26it/s]
Adding requests:  42%|████▏     | 865/2048 [00:02<00:09, 128.76it/s]
Adding requests:  44%|████▍     | 902/2048 [00:02<00:07, 157.26it/s]
Adding requests:  46%|████▌     | 940/2048 [00:03<00:05, 189.35it/s]
Adding requests:  48%|████▊     | 978/2048 [00:03<00:04, 221.30it/s]
Adding requests:  50%|████▉     | 1017/2048 [00:03<00:04, 253.31it/s]
Adding requests:  52%|█████▏    | 1056/2048 [00:03<00:03, 281.69it/s]
Adding requests:  54%|█████▎    | 1096/2048 [00:03<00:03, 309.03it/s]
Adding requests:  56%|█████▌    | 1137/2048 [00:03<00:02, 332.65it/s]
Adding requests:  57%|█████▋    | 1176/2048 [00:03<00:02, 342.54it/s]
Adding requests:  59%|█████▉    | 1215/2048 [00:03<00:02, 355.21it/s]
Adding requests:  61%|██████▏   | 1255/2048 [00:03<00:02, 367.15it/s]
Adding requests:  63%|██████▎   | 1294/2048 [00:04<00:02, 372.80it/s]
Adding requests:  65%|██████▌   | 1334/2048 [00:04<00:01, 379.40it/s]
Adding requests:  67%|██████▋   | 1376/2048 [00:04<00:01, 389.42it/s]
Adding requests:  69%|██████▉   | 1416/2048 [00:04<00:01, 391.30it/s]
Adding requests:  71%|███████   | 1458/2048 [00:04<00:01, 397.68it/s]
Adding requests:  73%|███████▎  | 1501/2048 [00:04<00:01, 405.17it/s]
Adding requests:  75%|███████▌  | 1542/2048 [00:04<00:01, 405.32it/s]
Adding requests:  77%|███████▋  | 1583/2048 [00:04<00:01, 400.71it/s]
Adding requests:  79%|███████▉  | 1624/2048 [00:04<00:01, 394.49it/s]
Adding requests:  81%|████████▏ | 1664/2048 [00:04<00:01, 376.58it/s]
Adding requests:  83%|████████▎ | 1705/2048 [00:05<00:00, 384.86it/s]
Adding requests:  85%|████████▌ | 1744/2048 [00:05<00:00, 381.08it/s]
Adding requests:  87%|████████▋ | 1787/2048 [00:05<00:00, 391.68it/s]
Adding requests:  89%|████████▉ | 1827/2048 [00:05<00:00, 390.44it/s]
Adding requests:  91%|█████████ | 1867/2048 [00:05<00:00, 384.26it/s]
Adding requests:  93%|█████████▎| 1909/2048 [00:05<00:00, 393.94it/s]
Adding requests:  95%|█████████▌| 1949/2048 [00:05<00:00, 395.03it/s]
Adding requests:  97%|█████████▋| 1990/2048 [00:05<00:00, 397.47it/s]
Adding requests:  99%|█████████▉| 2030/2048 [00:05<00:00, 373.99it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 344.43it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:02<02:48, 11.92it/s, est. speed input: 12207.22 toks/s, output: 11.92 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:05<04:02,  8.24it/s, est. speed input: 9002.02 toks/s, output: 8.79 toks/s]  
Processed prompts:   3%|▎         | 66/2048 [00:08<04:41,  7.05it/s, est. speed input: 7927.81 toks/s, output: 7.74 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:11<05:02,  6.49it/s, est. speed input: 7387.66 toks/s, output: 7.21 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:14<05:15,  6.18it/s, est. speed input: 7060.91 toks/s, output: 6.90 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:17<05:22,  5.99it/s, est. speed input: 6844.42 toks/s, output: 6.68 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:19<05:26,  5.87it/s, est. speed input: 6688.95 toks/s, output: 6.53 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:22<05:28,  5.79it/s, est. speed input: 6571.00 toks/s, output: 6.42 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:25<05:28,  5.74it/s, est. speed input: 6480.21 toks/s, output: 6.33 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:28<05:28,  5.70it/s, est. speed input: 6407.35 toks/s, output: 6.26 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:31<05:21,  5.77it/s, est. speed input: 6379.37 toks/s, output: 6.23 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:33<05:21,  5.72it/s, est. speed input: 6326.03 toks/s, output: 6.18 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:36<05:20,  5.69it/s, est. speed input: 6281.29 toks/s, output: 6.13 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:39<05:18,  5.67it/s, est. speed input: 6243.85 toks/s, output: 6.10 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:42<05:16,  5.65it/s, est. speed input: 6210.69 toks/s, output: 6.07 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:45<05:14,  5.64it/s, est. speed input: 6181.58 toks/s, output: 6.04 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:48<05:11,  5.63it/s, est. speed input: 6156.58 toks/s, output: 6.01 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:50<05:04,  5.72it/s, est. speed input: 6152.61 toks/s, output: 6.01 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:53<05:03,  5.69it/s, est. speed input: 6132.10 toks/s, output: 5.99 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:56<05:01,  5.67it/s, est. speed input: 6112.35 toks/s, output: 5.97 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:59<04:59,  5.65it/s, est. speed input: 6094.90 toks/s, output: 5.95 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [01:02<04:57,  5.64it/s, est. speed input: 6079.06 toks/s, output: 5.94 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [01:05<04:55,  5.63it/s, est. speed input: 6064.57 toks/s, output: 5.92 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:08<04:52,  5.63it/s, est. speed input: 6051.32 toks/s, output: 5.91 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:10<04:49,  5.62it/s, est. speed input: 6039.38 toks/s, output: 5.90 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:13<04:42,  5.71it/s, est. speed input: 6040.59 toks/s, output: 5.90 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:16<04:40,  5.69it/s, est. speed input: 6030.58 toks/s, output: 5.89 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:19<04:39,  5.67it/s, est. speed input: 6020.35 toks/s, output: 5.88 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:22<04:37,  5.65it/s, est. speed input: 6010.66 toks/s, output: 5.87 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:24<04:34,  5.64it/s, est. speed input: 6002.50 toks/s, output: 5.86 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:27<04:32,  5.63it/s, est. speed input: 5993.97 toks/s, output: 5.85 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:30<04:29,  5.63it/s, est. speed input: 5986.13 toks/s, output: 5.85 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:33<04:27,  5.62it/s, est. speed input: 5978.56 toks/s, output: 5.84 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:36<04:24,  5.62it/s, est. speed input: 5971.70 toks/s, output: 5.83 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:39<04:21,  5.62it/s, est. speed input: 5965.21 toks/s, output: 5.83 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:42<04:19,  5.61it/s, est. speed input: 5958.88 toks/s, output: 5.82 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:44<04:16,  5.61it/s, est. speed input: 5953.25 toks/s, output: 5.81 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:47<04:13,  5.62it/s, est. speed input: 5948.17 toks/s, output: 5.81 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:50<04:10,  5.62it/s, est. speed input: 5943.20 toks/s, output: 5.80 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:53<04:07,  5.62it/s, est. speed input: 5938.36 toks/s, output: 5.80 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:56<04:04,  5.62it/s, est. speed input: 5933.69 toks/s, output: 5.79 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:59<04:01,  5.61it/s, est. speed input: 5929.15 toks/s, output: 5.79 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [02:02<03:59,  5.61it/s, est. speed input: 5924.89 toks/s, output: 5.79 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [02:04<03:56,  5.62it/s, est. speed input: 5921.01 toks/s, output: 5.78 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [02:07<03:53,  5.61it/s, est. speed input: 5917.07 toks/s, output: 5.78 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [02:10<03:50,  5.62it/s, est. speed input: 5913.50 toks/s, output: 5.77 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [02:13<03:47,  5.62it/s, est. speed input: 5910.04 toks/s, output: 5.77 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:16<03:40,  5.71it/s, est. speed input: 5913.56 toks/s, output: 5.77 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:18<03:39,  5.68it/s, est. speed input: 5910.00 toks/s, output: 5.77 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:21<03:37,  5.66it/s, est. speed input: 5906.68 toks/s, output: 5.77 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:24<03:35,  5.64it/s, est. speed input: 5903.54 toks/s, output: 5.77 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:27<03:32,  5.63it/s, est. speed input: 5900.39 toks/s, output: 5.76 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:30<03:30,  5.62it/s, est. speed input: 5897.29 toks/s, output: 5.76 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:33<03:27,  5.62it/s, est. speed input: 5894.32 toks/s, output: 5.76 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:36<03:24,  5.62it/s, est. speed input: 5891.64 toks/s, output: 5.75 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:38<03:21,  5.62it/s, est. speed input: 5889.13 toks/s, output: 5.75 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:41<03:19,  5.61it/s, est. speed input: 5886.41 toks/s, output: 5.75 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:44<03:16,  5.62it/s, est. speed input: 5884.26 toks/s, output: 5.75 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:47<03:13,  5.61it/s, est. speed input: 5881.71 toks/s, output: 5.74 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:50<03:10,  5.61it/s, est. speed input: 5879.16 toks/s, output: 5.74 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:53<03:07,  5.61it/s, est. speed input: 5877.12 toks/s, output: 5.74 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:56<03:05,  5.61it/s, est. speed input: 5874.93 toks/s, output: 5.74 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:58<03:02,  5.61it/s, est. speed input: 5872.80 toks/s, output: 5.74 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [03:01<02:59,  5.61it/s, est. speed input: 5870.90 toks/s, output: 5.73 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [03:04<02:56,  5.61it/s, est. speed input: 5868.99 toks/s, output: 5.73 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [03:07<02:53,  5.61it/s, est. speed input: 5867.15 toks/s, output: 5.73 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [03:10<02:50,  5.61it/s, est. speed input: 5865.39 toks/s, output: 5.73 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [03:13<02:47,  5.61it/s, est. speed input: 5863.59 toks/s, output: 5.73 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [03:15<02:44,  5.61it/s, est. speed input: 5862.01 toks/s, output: 5.72 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [03:18<02:42,  5.61it/s, est. speed input: 5860.29 toks/s, output: 5.72 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:21<02:39,  5.61it/s, est. speed input: 5858.61 toks/s, output: 5.72 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:24<02:36,  5.61it/s, est. speed input: 5857.11 toks/s, output: 5.72 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:27<02:33,  5.61it/s, est. speed input: 5855.54 toks/s, output: 5.72 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:30<02:28,  5.70it/s, est. speed input: 5858.31 toks/s, output: 5.72 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:32<02:26,  5.68it/s, est. speed input: 5856.95 toks/s, output: 5.72 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:35<02:21,  5.75it/s, est. speed input: 5859.59 toks/s, output: 5.72 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:38<02:19,  5.71it/s, est. speed input: 5858.29 toks/s, output: 5.72 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:41<02:17,  5.68it/s, est. speed input: 5856.77 toks/s, output: 5.72 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:44<02:15,  5.66it/s, est. speed input: 5855.19 toks/s, output: 5.72 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:47<02:12,  5.64it/s, est. speed input: 5853.88 toks/s, output: 5.72 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:49<02:10,  5.64it/s, est. speed input: 5852.60 toks/s, output: 5.72 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:52<02:05,  5.72it/s, est. speed input: 5855.20 toks/s, output: 5.72 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:55<02:03,  5.69it/s, est. speed input: 5854.09 toks/s, output: 5.72 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:58<02:01,  5.67it/s, est. speed input: 5852.79 toks/s, output: 5.72 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [04:01<01:58,  5.65it/s, est. speed input: 5851.62 toks/s, output: 5.71 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [04:03<01:55,  5.64it/s, est. speed input: 5850.30 toks/s, output: 5.71 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [04:06<01:53,  5.63it/s, est. speed input: 5849.09 toks/s, output: 5.71 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [04:09<01:50,  5.63it/s, est. speed input: 5848.10 toks/s, output: 5.71 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [04:12<01:46,  5.72it/s, est. speed input: 5850.49 toks/s, output: 5.71 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [04:15<01:42,  5.78it/s, est. speed input: 5852.97 toks/s, output: 5.72 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [04:17<01:40,  5.73it/s, est. speed input: 5851.76 toks/s, output: 5.71 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [04:20<01:38,  5.69it/s, est. speed input: 5850.55 toks/s, output: 5.71 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [04:23<01:35,  5.67it/s, est. speed input: 5849.48 toks/s, output: 5.71 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [04:26<01:31,  5.75it/s, est. speed input: 5851.76 toks/s, output: 5.71 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:29<01:29,  5.70it/s, est. speed input: 5850.63 toks/s, output: 5.71 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:31<01:25,  5.77it/s, est. speed input: 5852.97 toks/s, output: 5.72 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:34<01:23,  5.73it/s, est. speed input: 5851.91 toks/s, output: 5.71 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:37<01:21,  5.69it/s, est. speed input: 5850.94 toks/s, output: 5.71 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:40<01:18,  5.67it/s, est. speed input: 5849.84 toks/s, output: 5.71 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:43<01:14,  5.75it/s, est. speed input: 5852.12 toks/s, output: 5.71 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:45<01:12,  5.71it/s, est. speed input: 5851.07 toks/s, output: 5.71 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:48<01:10,  5.68it/s, est. speed input: 5850.07 toks/s, output: 5.71 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:51<01:07,  5.66it/s, est. speed input: 5849.18 toks/s, output: 5.71 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:54<01:04,  5.65it/s, est. speed input: 5848.15 toks/s, output: 5.71 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:57<01:02,  5.63it/s, est. speed input: 5847.14 toks/s, output: 5.71 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [05:00<00:59,  5.63it/s, est. speed input: 5846.22 toks/s, output: 5.71 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [05:02<00:55,  5.72it/s, est. speed input: 5848.25 toks/s, output: 5.71 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [05:05<00:51,  5.90it/s, est. speed input: 5853.71 toks/s, output: 5.72 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [05:08<00:49,  5.81it/s, est. speed input: 5852.67 toks/s, output: 5.72 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [05:11<00:47,  5.74it/s, est. speed input: 5851.56 toks/s, output: 5.71 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [05:13<00:44,  5.70it/s, est. speed input: 5850.62 toks/s, output: 5.71 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [05:16<00:41,  5.67it/s, est. speed input: 5849.68 toks/s, output: 5.71 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [05:19<00:39,  5.65it/s, est. speed input: 5848.70 toks/s, output: 5.71 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [05:22<00:36,  5.64it/s, est. speed input: 5847.87 toks/s, output: 5.71 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [05:25<00:33,  5.63it/s, est. speed input: 5846.99 toks/s, output: 5.71 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [05:28<00:30,  5.63it/s, est. speed input: 5846.21 toks/s, output: 5.71 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [05:30<00:27,  5.72it/s, est. speed input: 5848.04 toks/s, output: 5.71 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [05:33<00:24,  5.68it/s, est. speed input: 5847.17 toks/s, output: 5.71 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:36<00:22,  5.67it/s, est. speed input: 5846.40 toks/s, output: 5.71 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:39<00:19,  5.65it/s, est. speed input: 5845.54 toks/s, output: 5.71 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:42<00:16,  5.63it/s, est. speed input: 5844.62 toks/s, output: 5.71 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:45<00:13,  5.63it/s, est. speed input: 5843.92 toks/s, output: 5.71 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:47<00:10,  5.72it/s, est. speed input: 5845.73 toks/s, output: 5.71 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:50<00:08,  5.69it/s, est. speed input: 5845.00 toks/s, output: 5.71 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:53<00:05,  5.66it/s, est. speed input: 5844.18 toks/s, output: 5.71 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:56<00:02,  5.75it/s, est. speed input: 5846.14 toks/s, output: 5.71 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:56<00:00,  5.75it/s, est. speed input: 5886.37 toks/s, output: 5.75 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:56<00:00,  5.75it/s, est. speed input: 5886.37 toks/s, output: 5.75 toks/s]
[rank0]:[W126 14:15:31.918995221 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 433.1s

测试结果:
  Requests/s:   5.65
  Tokens/s:     5795.37
  Total Reqs:   2048
  Elapsed:      362.22s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     5789.72

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:15:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:15:52 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1381650) WARNING 01-26 14:16:54 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.69 requests/s, 5836.87 total tokens/s, 5.69 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 14:15:51] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:15:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:15:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:15:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:15:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:15:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:15:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:15:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:15:55] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:15:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:15:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:15:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:15:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:15:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:15:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:15:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:15:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1381650) [2026-01-26 14:15:56] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1381650) [2026-01-26 14:15:56] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1381650) [2026-01-26 14:15:56] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1381650) [2026-01-26 14:15:56] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1381650) [2026-01-26 14:15:56] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1381650) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1381650) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:19<00:19, 19.88s/it]
(EngineCore_DP0 pid=1381650) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.06s/it]
(EngineCore_DP0 pid=1381650) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.04s/it]
(EngineCore_DP0 pid=1381650) 
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1381650) 2026-01-26 14:16:47,540 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1381650) 2026-01-26 14:16:48,113 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 41/4096 [00:00<00:10, 401.90it/s]
Adding requests:   2%|▏         | 83/4096 [00:00<00:09, 410.07it/s]
Adding requests:   3%|▎         | 125/4096 [00:00<00:10, 386.92it/s]
Adding requests:   4%|▍         | 164/4096 [00:00<00:10, 381.32it/s]
Adding requests:   5%|▌         | 207/4096 [00:00<00:09, 395.33it/s]
Adding requests:   6%|▌         | 247/4096 [00:00<00:09, 393.66it/s]
Adding requests:   7%|▋         | 287/4096 [00:00<00:09, 393.05it/s]
Adding requests:   8%|▊         | 327/4096 [00:00<00:09, 390.74it/s]
Adding requests:   9%|▉         | 369/4096 [00:00<00:09, 397.37it/s]
Adding requests:  10%|█         | 410/4096 [00:01<00:09, 400.88it/s]
Adding requests:  11%|█         | 451/4096 [00:01<00:09, 401.71it/s]
Adding requests:  12%|█▏        | 497/4096 [00:01<00:08, 417.85it/s]
Adding requests:  13%|█▎        | 539/4096 [00:01<00:08, 417.79it/s]
Adding requests:  14%|█▍        | 581/4096 [00:01<00:08, 412.34it/s]
Adding requests:  15%|█▌        | 623/4096 [00:01<00:08, 410.02it/s]
Adding requests:  16%|█▌        | 665/4096 [00:01<00:08, 409.45it/s]
Adding requests:  17%|█▋        | 707/4096 [00:01<00:08, 412.37it/s]
Adding requests:  18%|█▊        | 749/4096 [00:01<00:08, 407.44it/s]
Adding requests:  19%|█▉        | 792/4096 [00:01<00:08, 411.25it/s]
Adding requests:  20%|██        | 834/4096 [00:02<00:07, 409.44it/s]
Adding requests:  21%|██▏       | 875/4096 [00:02<00:07, 406.86it/s]
Adding requests:  22%|██▏       | 916/4096 [00:02<00:07, 407.36it/s]
Adding requests:  23%|██▎       | 957/4096 [00:02<00:07, 405.74it/s]
Adding requests:  24%|██▍       | 998/4096 [00:02<00:07, 395.25it/s]
Adding requests:  25%|██▌       | 1038/4096 [00:02<00:07, 395.94it/s]
Adding requests:  26%|██▋       | 1078/4096 [00:02<00:07, 392.92it/s]
Adding requests:  27%|██▋       | 1118/4096 [00:02<00:07, 384.12it/s]
Adding requests:  28%|██▊       | 1157/4096 [00:02<00:07, 379.35it/s]
Adding requests:  29%|██▉       | 1195/4096 [00:03<00:08, 352.96it/s]
Adding requests:  30%|███       | 1235/4096 [00:03<00:07, 364.26it/s]
Adding requests:  31%|███       | 1276/4096 [00:03<00:07, 375.39it/s]
Adding requests:  32%|███▏      | 1318/4096 [00:03<00:07, 386.37it/s]
Adding requests:  33%|███▎      | 1361/4096 [00:03<00:06, 398.13it/s]
Adding requests:  34%|███▍      | 1402/4096 [00:03<00:06, 390.07it/s]
Adding requests:  35%|███▌      | 1443/4096 [00:03<00:06, 395.15it/s]
Adding requests:  36%|███▋      | 1486/4096 [00:03<00:06, 404.88it/s]
Adding requests:  37%|███▋      | 1527/4096 [00:03<00:06, 404.28it/s]
Adding requests:  38%|███▊      | 1568/4096 [00:03<00:06, 403.54it/s]
Adding requests:  39%|███▉      | 1609/4096 [00:04<00:06, 391.85it/s]
Adding requests:  40%|████      | 1649/4096 [00:04<00:06, 388.35it/s]
Adding requests:  41%|████▏     | 1690/4096 [00:04<00:06, 393.63it/s]
Adding requests:  42%|████▏     | 1731/4096 [00:04<00:05, 398.17it/s]
Adding requests:  43%|████▎     | 1774/4096 [00:04<00:05, 405.23it/s]
Adding requests:  44%|████▍     | 1815/4096 [00:04<00:05, 398.01it/s]
Adding requests:  45%|████▌     | 1857/4096 [00:04<00:05, 403.51it/s]
Adding requests:  46%|████▋     | 1898/4096 [00:04<00:05, 400.79it/s]
Adding requests:  47%|████▋     | 1940/4096 [00:04<00:05, 405.90it/s]
Adding requests:  48%|████▊     | 1981/4096 [00:04<00:05, 402.10it/s]
Adding requests:  49%|████▉     | 2022/4096 [00:05<00:05, 395.90it/s]
Adding requests:  50%|█████     | 2063/4096 [00:05<00:05, 397.42it/s]
Adding requests:  51%|█████▏    | 2103/4096 [00:05<00:05, 395.25it/s]
Adding requests:  52%|█████▏    | 2143/4096 [00:05<00:04, 395.93it/s]
Adding requests:  53%|█████▎    | 2183/4096 [00:05<00:04, 391.88it/s]
Adding requests:  54%|█████▍    | 2223/4096 [00:05<00:04, 392.03it/s]
Adding requests:  55%|█████▌    | 2263/4096 [00:05<00:04, 392.29it/s]
Adding requests:  56%|█████▋    | 2304/4096 [00:05<00:04, 396.46it/s]
Adding requests:  57%|█████▋    | 2344/4096 [00:05<00:04, 395.44it/s]
Adding requests:  58%|█████▊    | 2384/4096 [00:06<00:04, 384.93it/s]
Adding requests:  59%|█████▉    | 2423/4096 [00:06<00:04, 380.97it/s]
Adding requests:  60%|██████    | 2462/4096 [00:06<00:04, 344.68it/s]
Adding requests:  61%|██████    | 2503/4096 [00:06<00:04, 361.92it/s]
Adding requests:  62%|██████▏   | 2544/4096 [00:06<00:04, 373.95it/s]
Adding requests:  63%|██████▎   | 2586/4096 [00:06<00:03, 385.29it/s]
Adding requests:  64%|██████▍   | 2625/4096 [00:06<00:03, 386.41it/s]
Adding requests:  65%|██████▌   | 2666/4096 [00:06<00:03, 391.30it/s]
Adding requests:  66%|██████▌   | 2706/4096 [00:06<00:03, 393.33it/s]
Adding requests:  67%|██████▋   | 2748/4096 [00:06<00:03, 400.95it/s]
Adding requests:  68%|██████▊   | 2789/4096 [00:07<00:03, 396.51it/s]
Adding requests:  69%|██████▉   | 2833/4096 [00:07<00:03, 405.72it/s]
Adding requests:  70%|███████   | 2876/4096 [00:07<00:02, 411.13it/s]
Adding requests:  71%|███████   | 2918/4096 [00:07<00:02, 413.06it/s]
Adding requests:  72%|███████▏  | 2962/4096 [00:07<00:02, 418.63it/s]
Adding requests:  73%|███████▎  | 3006/4096 [00:07<00:02, 424.17it/s]
Adding requests:  74%|███████▍  | 3049/4096 [00:07<00:02, 417.13it/s]
Adding requests:  75%|███████▌  | 3091/4096 [00:07<00:02, 416.27it/s]
Adding requests:  77%|███████▋  | 3134/4096 [00:07<00:02, 417.72it/s]
Adding requests:  78%|███████▊  | 3176/4096 [00:07<00:02, 413.21it/s]
Adding requests:  79%|███████▊  | 3218/4096 [00:08<00:02, 414.80it/s]
Adding requests:  80%|███████▉  | 3260/4096 [00:08<00:02, 411.23it/s]
Adding requests:  81%|████████  | 3302/4096 [00:08<00:01, 402.58it/s]
Adding requests:  82%|████████▏ | 3346/4096 [00:08<00:01, 410.43it/s]
Adding requests:  83%|████████▎ | 3388/4096 [00:08<00:01, 408.71it/s]
Adding requests:  84%|████████▍ | 3431/4096 [00:08<00:01, 412.03it/s]
Adding requests:  85%|████████▍ | 3474/4096 [00:08<00:01, 414.78it/s]
Adding requests:  86%|████████▌ | 3516/4096 [00:08<00:01, 411.94it/s]
Adding requests:  87%|████████▋ | 3561/4096 [00:08<00:01, 420.54it/s]
Adding requests:  88%|████████▊ | 3604/4096 [00:09<00:01, 412.75it/s]
Adding requests:  89%|████████▉ | 3646/4096 [00:09<00:01, 411.00it/s]
Adding requests:  90%|█████████ | 3688/4096 [00:09<00:00, 408.52it/s]
Adding requests:  91%|█████████ | 3729/4096 [00:09<00:00, 407.90it/s]
Adding requests:  92%|█████████▏| 3770/4096 [00:09<00:00, 405.79it/s]
Adding requests:  93%|█████████▎| 3811/4096 [00:09<00:00, 400.91it/s]
Adding requests:  94%|█████████▍| 3852/4096 [00:09<00:00, 360.84it/s]
Adding requests:  95%|█████████▍| 3891/4096 [00:09<00:00, 366.29it/s]
Adding requests:  96%|█████████▌| 3929/4096 [00:09<00:00, 358.37it/s]
Adding requests:  97%|█████████▋| 3970/4096 [00:10<00:00, 371.78it/s]
Adding requests:  98%|█████████▊| 4010/4096 [00:10<00:00, 378.64it/s]
Adding requests:  99%|█████████▉| 4049/4096 [00:10<00:00, 380.22it/s]
Adding requests: 100%|█████████▉| 4088/4096 [00:10<00:00, 381.90it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 396.64it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 34/4096 [00:01<02:31, 26.73it/s, est. speed input: 27373.06 toks/s, output: 26.73 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:06<07:52,  8.53it/s, est. speed input: 9758.57 toks/s, output: 9.53 toks/s]  
Processed prompts:   2%|▏         | 98/4096 [00:12<09:36,  6.93it/s, est. speed input: 7967.49 toks/s, output: 7.78 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:18<10:23,  6.37it/s, est. speed input: 7290.10 toks/s, output: 7.12 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:23<10:45,  6.09it/s, est. speed input: 6936.84 toks/s, output: 6.77 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:29<10:49,  6.00it/s, est. speed input: 6757.44 toks/s, output: 6.60 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:35<10:57,  5.88it/s, est. speed input: 6600.06 toks/s, output: 6.45 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:40<11:01,  5.80it/s, est. speed input: 6485.79 toks/s, output: 6.33 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:46<10:54,  5.81it/s, est. speed input: 6424.27 toks/s, output: 6.27 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:51<10:55,  5.76it/s, est. speed input: 6354.25 toks/s, output: 6.21 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:57<10:53,  5.72it/s, est. speed input: 6297.15 toks/s, output: 6.15 toks/s]
Processed prompts:   9%|▉         | 386/4096 [01:03<10:50,  5.70it/s, est. speed input: 6251.94 toks/s, output: 6.11 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:08<10:40,  5.74it/s, est. speed input: 6229.16 toks/s, output: 6.08 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:14<10:38,  5.71it/s, est. speed input: 6195.42 toks/s, output: 6.05 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:20<10:34,  5.69it/s, est. speed input: 6165.93 toks/s, output: 6.02 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:25<10:30,  5.68it/s, est. speed input: 6140.49 toks/s, output: 6.00 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:31<10:26,  5.67it/s, est. speed input: 6118.03 toks/s, output: 5.97 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:37<10:21,  5.66it/s, est. speed input: 6098.24 toks/s, output: 5.96 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:42<10:16,  5.65it/s, est. speed input: 6080.39 toks/s, output: 5.94 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:48<10:11,  5.65it/s, est. speed input: 6064.99 toks/s, output: 5.92 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:54<10:05,  5.65it/s, est. speed input: 6050.65 toks/s, output: 5.91 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:59<10:00,  5.65it/s, est. speed input: 6037.96 toks/s, output: 5.90 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [02:05<09:54,  5.65it/s, est. speed input: 6026.05 toks/s, output: 5.88 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [02:10<09:43,  5.70it/s, est. speed input: 6023.40 toks/s, output: 5.88 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:16<09:39,  5.68it/s, est. speed input: 6013.39 toks/s, output: 5.87 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:22<09:35,  5.67it/s, est. speed input: 6004.03 toks/s, output: 5.86 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:27<09:30,  5.66it/s, est. speed input: 5995.32 toks/s, output: 5.85 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:33<09:25,  5.66it/s, est. speed input: 5987.56 toks/s, output: 5.85 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:39<09:19,  5.65it/s, est. speed input: 5980.17 toks/s, output: 5.84 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:44<09:14,  5.65it/s, est. speed input: 5972.85 toks/s, output: 5.83 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:50<09:09,  5.65it/s, est. speed input: 5966.37 toks/s, output: 5.83 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:56<09:03,  5.64it/s, est. speed input: 5960.29 toks/s, output: 5.82 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [03:01<08:58,  5.65it/s, est. speed input: 5954.78 toks/s, output: 5.82 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [03:07<08:52,  5.65it/s, est. speed input: 5949.52 toks/s, output: 5.81 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [03:13<08:46,  5.65it/s, est. speed input: 5944.56 toks/s, output: 5.81 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [03:18<08:41,  5.65it/s, est. speed input: 5939.88 toks/s, output: 5.80 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:24<08:30,  5.70it/s, est. speed input: 5940.64 toks/s, output: 5.80 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:29<08:21,  5.74it/s, est. speed input: 5941.37 toks/s, output: 5.80 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:35<08:18,  5.71it/s, est. speed input: 5937.11 toks/s, output: 5.80 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:41<08:14,  5.69it/s, est. speed input: 5933.38 toks/s, output: 5.79 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:46<08:05,  5.73it/s, est. speed input: 5934.02 toks/s, output: 5.79 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:52<08:02,  5.70it/s, est. speed input: 5930.14 toks/s, output: 5.79 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:58<07:58,  5.68it/s, est. speed input: 5926.42 toks/s, output: 5.79 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [04:03<07:53,  5.67it/s, est. speed input: 5922.94 toks/s, output: 5.78 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [04:09<07:39,  5.77it/s, est. speed input: 5928.07 toks/s, output: 5.79 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [04:14<07:37,  5.73it/s, est. speed input: 5924.74 toks/s, output: 5.79 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [04:20<07:29,  5.76it/s, est. speed input: 5925.76 toks/s, output: 5.79 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [04:25<07:22,  5.78it/s, est. speed input: 5926.53 toks/s, output: 5.79 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:31<07:20,  5.74it/s, est. speed input: 5923.30 toks/s, output: 5.78 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:36<07:12,  5.76it/s, est. speed input: 5924.05 toks/s, output: 5.79 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:42<07:09,  5.73it/s, est. speed input: 5921.28 toks/s, output: 5.78 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:48<07:06,  5.70it/s, est. speed input: 5918.46 toks/s, output: 5.78 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:53<07:01,  5.69it/s, est. speed input: 5915.91 toks/s, output: 5.78 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:59<06:45,  5.84it/s, est. speed input: 5923.63 toks/s, output: 5.78 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [05:04<06:44,  5.78it/s, est. speed input: 5920.96 toks/s, output: 5.78 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [05:10<06:41,  5.74it/s, est. speed input: 5918.34 toks/s, output: 5.78 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [05:16<06:37,  5.71it/s, est. speed input: 5915.98 toks/s, output: 5.78 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [05:21<06:33,  5.69it/s, est. speed input: 5913.59 toks/s, output: 5.77 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [05:27<06:25,  5.73it/s, est. speed input: 5914.38 toks/s, output: 5.78 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [05:32<06:21,  5.70it/s, est. speed input: 5911.97 toks/s, output: 5.77 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [05:38<06:16,  5.68it/s, est. speed input: 5909.73 toks/s, output: 5.77 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:44<06:08,  5.73it/s, est. speed input: 5910.60 toks/s, output: 5.77 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:49<06:04,  5.70it/s, est. speed input: 5908.57 toks/s, output: 5.77 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:55<05:56,  5.74it/s, est. speed input: 5909.45 toks/s, output: 5.77 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [06:00<05:52,  5.71it/s, est. speed input: 5907.18 toks/s, output: 5.77 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [06:06<05:48,  5.69it/s, est. speed input: 5905.36 toks/s, output: 5.77 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [06:12<05:43,  5.68it/s, est. speed input: 5903.49 toks/s, output: 5.77 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [06:17<05:35,  5.72it/s, est. speed input: 5904.30 toks/s, output: 5.77 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [06:23<05:31,  5.69it/s, est. speed input: 5902.35 toks/s, output: 5.76 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [06:29<05:26,  5.68it/s, est. speed input: 5900.56 toks/s, output: 5.76 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [06:34<05:21,  5.67it/s, est. speed input: 5898.94 toks/s, output: 5.76 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [06:40<05:16,  5.66it/s, est. speed input: 5897.30 toks/s, output: 5.76 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [06:45<05:07,  5.71it/s, est. speed input: 5898.14 toks/s, output: 5.76 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:51<05:03,  5.69it/s, est. speed input: 5896.41 toks/s, output: 5.76 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [06:57<04:58,  5.68it/s, est. speed input: 5894.93 toks/s, output: 5.76 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [07:02<04:53,  5.67it/s, est. speed input: 5893.44 toks/s, output: 5.76 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [07:08<04:48,  5.66it/s, est. speed input: 5891.86 toks/s, output: 5.75 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [07:14<04:42,  5.66it/s, est. speed input: 5890.42 toks/s, output: 5.75 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [07:19<04:34,  5.70it/s, est. speed input: 5891.23 toks/s, output: 5.75 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [07:25<04:29,  5.69it/s, est. speed input: 5889.87 toks/s, output: 5.75 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [07:30<04:22,  5.72it/s, est. speed input: 5890.68 toks/s, output: 5.75 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [07:36<04:17,  5.70it/s, est. speed input: 5889.20 toks/s, output: 5.75 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [07:42<04:10,  5.73it/s, est. speed input: 5890.00 toks/s, output: 5.75 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [07:47<04:06,  5.71it/s, est. speed input: 5888.72 toks/s, output: 5.75 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [07:53<03:59,  5.74it/s, est. speed input: 5889.51 toks/s, output: 5.75 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [07:58<03:54,  5.71it/s, est. speed input: 5888.22 toks/s, output: 5.75 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [08:04<03:50,  5.69it/s, est. speed input: 5886.97 toks/s, output: 5.75 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [08:10<03:45,  5.68it/s, est. speed input: 5885.79 toks/s, output: 5.75 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [08:15<03:39,  5.67it/s, est. speed input: 5884.63 toks/s, output: 5.75 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [08:21<03:30,  5.77it/s, est. speed input: 5887.60 toks/s, output: 5.75 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [08:26<03:24,  5.79it/s, est. speed input: 5888.43 toks/s, output: 5.75 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [08:32<03:20,  5.74it/s, est. speed input: 5887.12 toks/s, output: 5.75 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [08:38<03:15,  5.71it/s, est. speed input: 5885.98 toks/s, output: 5.75 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [08:43<03:10,  5.69it/s, est. speed input: 5884.82 toks/s, output: 5.75 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [08:49<03:05,  5.68it/s, est. speed input: 5883.66 toks/s, output: 5.75 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [08:55<03:00,  5.67it/s, est. speed input: 5882.51 toks/s, output: 5.74 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [09:00<02:55,  5.66it/s, est. speed input: 5881.36 toks/s, output: 5.74 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [09:06<02:49,  5.65it/s, est. speed input: 5880.27 toks/s, output: 5.74 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [09:11<02:42,  5.70it/s, est. speed input: 5881.05 toks/s, output: 5.74 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [09:17<02:37,  5.68it/s, est. speed input: 5879.96 toks/s, output: 5.74 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [09:23<02:31,  5.67it/s, est. speed input: 5879.00 toks/s, output: 5.74 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [09:28<02:26,  5.66it/s, est. speed input: 5877.93 toks/s, output: 5.74 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [09:34<02:21,  5.66it/s, est. speed input: 5876.95 toks/s, output: 5.74 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [09:40<02:15,  5.65it/s, est. speed input: 5876.02 toks/s, output: 5.74 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [09:45<02:09,  5.65it/s, est. speed input: 5875.03 toks/s, output: 5.74 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [09:51<02:03,  5.70it/s, est. speed input: 5875.79 toks/s, output: 5.74 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [09:57<01:57,  5.68it/s, est. speed input: 5874.84 toks/s, output: 5.74 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [10:02<01:52,  5.67it/s, est. speed input: 5873.96 toks/s, output: 5.74 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [10:08<01:47,  5.66it/s, est. speed input: 5873.11 toks/s, output: 5.74 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [10:14<01:41,  5.66it/s, est. speed input: 5872.29 toks/s, output: 5.73 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [10:19<01:34,  5.71it/s, est. speed input: 5873.08 toks/s, output: 5.74 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [10:25<01:29,  5.69it/s, est. speed input: 5872.20 toks/s, output: 5.73 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [10:31<01:24,  5.67it/s, est. speed input: 5871.31 toks/s, output: 5.73 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [10:36<01:18,  5.67it/s, est. speed input: 5870.55 toks/s, output: 5.73 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [10:41<01:11,  5.77it/s, est. speed input: 5872.96 toks/s, output: 5.74 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [10:47<01:06,  5.73it/s, est. speed input: 5872.12 toks/s, output: 5.73 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [10:53<01:01,  5.70it/s, est. speed input: 5871.33 toks/s, output: 5.73 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [10:58<00:55,  5.69it/s, est. speed input: 5870.60 toks/s, output: 5.73 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [11:04<00:50,  5.67it/s, est. speed input: 5869.84 toks/s, output: 5.73 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [11:10<00:44,  5.66it/s, est. speed input: 5869.05 toks/s, output: 5.73 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [11:16<00:39,  5.66it/s, est. speed input: 5868.26 toks/s, output: 5.73 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [11:21<00:33,  5.71it/s, est. speed input: 5869.03 toks/s, output: 5.73 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [11:26<00:27,  5.74it/s, est. speed input: 5869.79 toks/s, output: 5.73 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [11:32<00:22,  5.71it/s, est. speed input: 5869.07 toks/s, output: 5.73 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [11:38<00:16,  5.75it/s, est. speed input: 5869.83 toks/s, output: 5.73 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [11:43<00:10,  5.77it/s, est. speed input: 5870.51 toks/s, output: 5.73 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [11:48<00:05,  5.84it/s, est. speed input: 5872.81 toks/s, output: 5.74 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:48<00:00,  5.84it/s, est. speed input: 5916.13 toks/s, output: 5.78 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:48<00:00,  5.78it/s, est. speed input: 5916.13 toks/s, output: 5.78 toks/s]
[rank0]:[W126 14:28:53.936103582 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 802.0s

测试结果:
  Requests/s:   5.69
  Tokens/s:     5836.87
  Total Reqs:   4096
  Elapsed:      719.29s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5831.17

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuBLASLt [INT32 output]                         │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:29:28 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:29:28 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 760, in apply_weights
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 546, in apply
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 194, in cuBLASLt_INT8_linear
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     qinput, scale_a_pad = quant_only_int8_kernel(input, model_name)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 369, in quant_only_int8_kernel
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return torch.ops.slidesparse.quant_only_int8(input, model_name)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 544, in _quant_only_int8_impl
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     return fn(input)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]            ^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/quant_only_triton/build/GB10_cc121_py312_cu129_aarch64/quant_only_tuned_Qwen2.5-7B.py", line 195, in quant_only_int8_triton
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]     out = torch.zeros(M_padded, K_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1393000) ERROR 01-26 14:30:10 [core.py:866] 


─── STDERR ───
[2026-01-26 14:29:28] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:29:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:29:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:29:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:29:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:29:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:29:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:29:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:29:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:29:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:29:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:29:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:29:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:29:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:29:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:29:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:29:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1393000) [2026-01-26 14:29:32] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1393000) [2026-01-26 14:29:32] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1393000) [2026-01-26 14:29:32] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1393000) [2026-01-26 14:29:32] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1393000) [2026-01-26 14:29:32] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuBLASLt, symmetric=True
(EngineCore_DP0 pid=1393000) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1393000) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.01s/it]
(EngineCore_DP0 pid=1393000) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:34<00:00, 17.04s/it]
(EngineCore_DP0 pid=1393000) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:34<00:00, 17.49s/it]
(EngineCore_DP0 pid=1393000) 
(EngineCore_DP0 pid=1393000) [2026-01-26 14:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
[cuBLASLt] INFO: INT8 GEMM only supports INT32 output. inner_dtype parameter is ignored, always using int32.
(EngineCore_DP0 pid=1393000) [2026-01-26 14:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=1393000) [2026-01-26 14:30:09] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=1393000) Process EngineCore_DP0:
(EngineCore_DP0 pid=1393000) Traceback (most recent call last):
(EngineCore_DP0 pid=1393000)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1393000)     self.run()
(EngineCore_DP0 pid=1393000)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1393000)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1393000)     raise e
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1393000)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1393000)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1393000)     super().__init__(
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1393000)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1393000)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1393000)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1393000)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1393000)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1393000)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1393000)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1393000)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1393000)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1393000)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1393000)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1393000)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1393000)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1393000)     outputs = self.model(
(EngineCore_DP0 pid=1393000)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1393000)     hidden_states = self.model(
(EngineCore_DP0 pid=1393000)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1393000)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1393000)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1393000)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1393000)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1393000)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1393000)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1393000)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1393000)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1393000)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1393000)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1393000)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 760, in apply_weights
(EngineCore_DP0 pid=1393000)     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 546, in apply
(EngineCore_DP0 pid=1393000)     return self._linear_fn(
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 194, in cuBLASLt_INT8_linear
(EngineCore_DP0 pid=1393000)     qinput, scale_a_pad = quant_only_int8_kernel(input, model_name)
(EngineCore_DP0 pid=1393000)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/core/kernels.py", line 369, in quant_only_int8_kernel
(EngineCore_DP0 pid=1393000)     return torch.ops.slidesparse.quant_only_int8(input, model_name)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1393000)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/core/kernels.py", line 544, in _quant_only_int8_impl
(EngineCore_DP0 pid=1393000)     return fn(input)
(EngineCore_DP0 pid=1393000)            ^^^^^^^^^
(EngineCore_DP0 pid=1393000)   File "/root/vllmbench/slidesparse/csrc/quant_only_triton/build/GB10_cc121_py312_cu129_aarch64/quant_only_tuned_Qwen2.5-7B.py", line 195, in quant_only_int8_triton
(EngineCore_DP0 pid=1393000)     out = torch.zeros(M_padded, K_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1393000)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1393000) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1393000) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1393000) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1393000) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1393000) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1393000) 
[rank0]:[W126 14:30:10.569546674 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cublaslt/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,9.6979,4975.0124,13.1988
1024,1024,1,128,128,5.3480,5481.6950,23.9342
2048,1024,2,256,128,5.4295,5565.2259,47.1499
4096,1024,4,512,128,5.5184,5656.3634,92.7805
8192,1024,8,1024,128,2.2210,2276.5366,461.0512
16384,1024,16,2048,128,5.6540,5795.3746,362.2199
32768,1024,32,4096,128,5.6945,5836.8670,719.2900
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-INT8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_4

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:30:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:30:16 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1393855) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1393855) WARNING 01-26 14:31:19 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 11.99 requests/s, 6149.81 total tokens/s, 11.99 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 14:30:16] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:30:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:30:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:30:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:30:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:30:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:30:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:30:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:30:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:30:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:30:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:30:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:30:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:30:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:30:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:30:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:30:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1393855) [2026-01-26 14:30:20] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1393855) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1393855) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.47s/it]
(EngineCore_DP0 pid=1393855) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.77s/it]
(EngineCore_DP0 pid=1393855) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.73s/it]
(EngineCore_DP0 pid=1393855) 
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1393855) [2026-01-26 14:31:02] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1393855) 2026-01-26 14:31:11,049 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1393855) 2026-01-26 14:31:11,190 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<02:05,  1.01it/s]
Adding requests:   2%|▏         | 2/128 [00:01<01:12,  1.74it/s]
Adding requests:   2%|▏         | 3/128 [00:01<00:47,  2.64it/s]
Adding requests:   3%|▎         | 4/128 [00:01<00:33,  3.67it/s]
Adding requests:   5%|▍         | 6/128 [00:01<00:20,  5.83it/s]
Adding requests:   6%|▋         | 8/128 [00:01<00:14,  8.06it/s]
Adding requests:   9%|▊         | 11/128 [00:01<00:09, 12.08it/s]
Adding requests:  10%|█         | 13/128 [00:02<00:08, 13.58it/s]
Adding requests:  14%|█▍        | 18/128 [00:02<00:05, 21.04it/s]
Adding requests:  17%|█▋        | 22/128 [00:02<00:04, 25.49it/s]
Adding requests:  23%|██▎       | 30/128 [00:02<00:02, 39.24it/s]
Adding requests:  37%|███▋      | 47/128 [00:02<00:01, 73.63it/s]
Adding requests:  65%|██████▍   | 83/128 [00:02<00:00, 151.59it/s]
Adding requests: 100%|██████████| 128/128 [00:02<00:00, 48.12it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:00, 146.18it/s, est. speed input: 74861.73 toks/s, output: 146.19 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:03, 24.98it/s, est. speed input: 14907.12 toks/s, output: 29.12 toks/s]  
Processed prompts:  33%|███▎      | 42/128 [00:01<00:04, 20.75it/s, est. speed input: 12614.55 toks/s, output: 24.64 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:04, 18.76it/s, est. speed input: 11631.60 toks/s, output: 22.72 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:02<00:04, 17.59it/s, est. speed input: 11082.60 toks/s, output: 21.65 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:02<00:04, 16.84it/s, est. speed input: 10751.95 toks/s, output: 21.00 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:04, 16.18it/s, est. speed input: 10472.41 toks/s, output: 20.45 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:04, 15.81it/s, est. speed input: 10314.06 toks/s, output: 20.14 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 15.36it/s, est. speed input: 10154.49 toks/s, output: 19.83 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:04, 14.97it/s, est. speed input: 10010.85 toks/s, output: 19.55 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:04, 14.74it/s, est. speed input: 9890.72 toks/s, output: 19.32 toks/s] 
Processed prompts:  52%|█████▏    | 67/128 [00:03<00:04, 14.54it/s, est. speed input: 9778.88 toks/s, output: 19.10 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:03<00:04, 14.35it/s, est. speed input: 9672.37 toks/s, output: 18.89 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:03<00:03, 14.29it/s, est. speed input: 9580.87 toks/s, output: 18.71 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:03<00:03, 14.19it/s, est. speed input: 9491.87 toks/s, output: 18.54 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 14.20it/s, est. speed input: 9416.03 toks/s, output: 18.39 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 13.92it/s, est. speed input: 9322.31 toks/s, output: 18.21 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:03, 13.97it/s, est. speed input: 9254.22 toks/s, output: 18.07 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:03, 14.01it/s, est. speed input: 9190.21 toks/s, output: 17.95 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:04<00:03, 13.97it/s, est. speed input: 9125.84 toks/s, output: 17.82 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:04<00:03, 14.03it/s, est. speed input: 9070.85 toks/s, output: 17.72 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:04<00:02, 14.02it/s, est. speed input: 9015.66 toks/s, output: 17.61 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 13.99it/s, est. speed input: 8962.36 toks/s, output: 17.50 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 13.81it/s, est. speed input: 8902.47 toks/s, output: 17.39 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 13.89it/s, est. speed input: 8857.53 toks/s, output: 17.30 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:02, 13.87it/s, est. speed input: 8810.79 toks/s, output: 17.21 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:02, 13.79it/s, est. speed input: 8763.08 toks/s, output: 17.12 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:05<00:02, 13.81it/s, est. speed input: 8721.92 toks/s, output: 17.03 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:05<00:01, 13.88it/s, est. speed input: 8685.07 toks/s, output: 16.96 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 13.92it/s, est. speed input: 8649.59 toks/s, output: 16.89 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 13.79it/s, est. speed input: 8608.57 toks/s, output: 16.81 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 13.78it/s, est. speed input: 8572.69 toks/s, output: 16.74 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 13.85it/s, est. speed input: 8542.43 toks/s, output: 16.68 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:01, 13.87it/s, est. speed input: 8511.97 toks/s, output: 16.62 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:01, 13.89it/s, est. speed input: 8482.72 toks/s, output: 16.57 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:06<00:00, 13.91it/s, est. speed input: 8455.47 toks/s, output: 16.51 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 13.87it/s, est. speed input: 8426.73 toks/s, output: 16.46 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 13.91it/s, est. speed input: 8402.19 toks/s, output: 16.41 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 13.73it/s, est. speed input: 8370.18 toks/s, output: 16.35 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 13.79it/s, est. speed input: 8346.68 toks/s, output: 16.30 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 13.83it/s, est. speed input: 8323.73 toks/s, output: 16.26 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 13.91it/s, est. speed input: 8303.86 toks/s, output: 16.22 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 13.91it/s, est. speed input: 8281.86 toks/s, output: 16.18 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.18it/s, est. speed input: 8281.86 toks/s, output: 16.18 toks/s]
[rank0]:[W126 14:31:31.355243340 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 94.1s

测试结果:
  Requests/s:   11.99
  Tokens/s:     6149.81
  Total Reqs:   128
  Elapsed:      10.68s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     6137.82

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:31:50 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:31:50 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1395360) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1395360) WARNING 01-26 14:32:45 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.36 requests/s, 7548.72 total tokens/s, 7.36 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 14:31:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:31:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:31:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:31:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:31:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:31:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:31:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:31:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:31:53] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:31:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:31:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:31:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:31:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:31:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:31:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:31:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:31:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1395360) [2026-01-26 14:31:54] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1395360) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1395360) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.88s/it]
(EngineCore_DP0 pid=1395360) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.04s/it]
(EngineCore_DP0 pid=1395360) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.02s/it]
(EngineCore_DP0 pid=1395360) 
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1395360) [2026-01-26 14:32:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1395360) 2026-01-26 14:32:44,543 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1395360) 2026-01-26 14:32:44,571 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  37%|███▋      | 47/128 [00:00<00:00, 468.35it/s]
Adding requests:  75%|███████▌  | 96/128 [00:00<00:00, 475.77it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 475.42it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:25,  4.99it/s, est. speed input: 5106.84 toks/s, output: 4.99 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:26,  4.79it/s, est. speed input: 4937.25 toks/s, output: 4.82 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:27,  4.59it/s, est. speed input: 4773.42 toks/s, output: 4.66 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:24,  5.03it/s, est. speed input: 5037.58 toks/s, output: 4.92 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:23,  5.18it/s, est. speed input: 5140.68 toks/s, output: 5.02 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:22,  5.42it/s, est. speed input: 5277.74 toks/s, output: 5.15 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:20,  5.97it/s, est. speed input: 5527.19 toks/s, output: 5.40 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:18,  6.32it/s, est. speed input: 5709.03 toks/s, output: 5.58 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:17,  6.71it/s, est. speed input: 5894.04 toks/s, output: 5.76 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:17,  6.79it/s, est. speed input: 5997.50 toks/s, output: 5.86 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:17,  6.72it/s, est. speed input: 6057.62 toks/s, output: 5.92 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:16,  7.00it/s, est. speed input: 6178.61 toks/s, output: 6.03 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:15,  7.21it/s, est. speed input: 6286.01 toks/s, output: 6.14 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:15,  7.34it/s, est. speed input: 6375.52 toks/s, output: 6.23 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:15,  7.34it/s, est. speed input: 6440.50 toks/s, output: 6.29 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:14,  7.50it/s, est. speed input: 6523.75 toks/s, output: 6.37 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:14,  7.56it/s, est. speed input: 6590.91 toks/s, output: 6.44 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:14,  7.59it/s, est. speed input: 6649.99 toks/s, output: 6.49 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:14,  7.65it/s, est. speed input: 6708.99 toks/s, output: 6.55 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:14,  7.69it/s, est. speed input: 6761.85 toks/s, output: 6.60 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:13,  7.74it/s, est. speed input: 6814.52 toks/s, output: 6.65 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:13,  7.71it/s, est. speed input: 6854.73 toks/s, output: 6.69 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:13,  7.64it/s, est. speed input: 6886.18 toks/s, output: 6.72 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:13,  7.64it/s, est. speed input: 6920.67 toks/s, output: 6.76 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:13,  7.62it/s, est. speed input: 6950.24 toks/s, output: 6.79 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:13,  7.62it/s, est. speed input: 6979.41 toks/s, output: 6.82 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:13,  7.69it/s, est. speed input: 7013.74 toks/s, output: 6.85 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:12,  7.75it/s, est. speed input: 7047.63 toks/s, output: 6.88 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:12,  7.77it/s, est. speed input: 7077.02 toks/s, output: 6.91 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:12,  7.74it/s, est. speed input: 7100.55 toks/s, output: 6.93 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:04<00:12,  7.72it/s, est. speed input: 7122.21 toks/s, output: 6.96 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:04<00:12,  7.61it/s, est. speed input: 7134.81 toks/s, output: 6.97 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:04<00:12,  7.65it/s, est. speed input: 7156.75 toks/s, output: 6.99 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:04<00:12,  7.69it/s, est. speed input: 7178.10 toks/s, output: 7.01 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:04<00:12,  7.71it/s, est. speed input: 7197.83 toks/s, output: 7.03 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:11,  7.70it/s, est. speed input: 7214.94 toks/s, output: 7.05 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:05<00:11,  7.76it/s, est. speed input: 7235.85 toks/s, output: 7.07 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:05<00:11,  7.72it/s, est. speed input: 7249.81 toks/s, output: 7.08 toks/s]
Processed prompts:  30%|███       | 39/128 [00:05<00:11,  7.76it/s, est. speed input: 7268.67 toks/s, output: 7.10 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:05<00:11,  7.66it/s, est. speed input: 7276.78 toks/s, output: 7.11 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:05<00:11,  7.63it/s, est. speed input: 7287.65 toks/s, output: 7.12 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:05<00:11,  7.66it/s, est. speed input: 7301.22 toks/s, output: 7.13 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:06<00:11,  7.73it/s, est. speed input: 7317.53 toks/s, output: 7.15 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:06<00:10,  7.72it/s, est. speed input: 7329.93 toks/s, output: 7.16 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:06<00:10,  7.72it/s, est. speed input: 7341.81 toks/s, output: 7.17 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:06<00:10,  7.71it/s, est. speed input: 7352.13 toks/s, output: 7.18 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:06<00:10,  7.73it/s, est. speed input: 7364.43 toks/s, output: 7.19 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:06<00:10,  7.62it/s, est. speed input: 7368.00 toks/s, output: 7.20 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:06<00:10,  7.59it/s, est. speed input: 7374.37 toks/s, output: 7.20 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:06<00:10,  7.64it/s, est. speed input: 7385.44 toks/s, output: 7.21 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:07<00:09,  7.71it/s, est. speed input: 7397.73 toks/s, output: 7.22 toks/s]
Processed prompts:  41%|████      | 52/128 [00:07<00:09,  7.70it/s, est. speed input: 7405.83 toks/s, output: 7.23 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:07<00:09,  7.70it/s, est. speed input: 7414.33 toks/s, output: 7.24 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:07<00:09,  7.73it/s, est. speed input: 7424.03 toks/s, output: 7.25 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:07<00:09,  7.76it/s, est. speed input: 7434.44 toks/s, output: 7.26 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:07<00:09,  7.63it/s, est. speed input: 7435.91 toks/s, output: 7.26 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:07<00:09,  7.64it/s, est. speed input: 7442.43 toks/s, output: 7.27 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:07<00:09,  7.69it/s, est. speed input: 7451.27 toks/s, output: 7.28 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:08<00:08,  7.71it/s, est. speed input: 7459.22 toks/s, output: 7.28 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:08<00:08,  7.69it/s, est. speed input: 7465.32 toks/s, output: 7.29 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:08<00:08,  7.67it/s, est. speed input: 7470.69 toks/s, output: 7.30 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:08<00:08,  7.68it/s, est. speed input: 7476.92 toks/s, output: 7.30 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:08<00:08,  7.70it/s, est. speed input: 7483.54 toks/s, output: 7.31 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:08<00:08,  7.58it/s, est. speed input: 7483.81 toks/s, output: 7.31 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:08<00:08,  7.67it/s, est. speed input: 7492.37 toks/s, output: 7.32 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:09<00:08,  7.69it/s, est. speed input: 7498.36 toks/s, output: 7.32 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:09<00:07,  7.70it/s, est. speed input: 7504.16 toks/s, output: 7.33 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:09<00:07,  7.71it/s, est. speed input: 7510.09 toks/s, output: 7.33 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:09<00:07,  7.76it/s, est. speed input: 7517.68 toks/s, output: 7.34 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:09<00:07,  7.74it/s, est. speed input: 7522.61 toks/s, output: 7.35 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:09<00:07,  7.79it/s, est. speed input: 7530.03 toks/s, output: 7.35 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:09<00:07,  7.62it/s, est. speed input: 7528.46 toks/s, output: 7.35 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:09<00:07,  7.65it/s, est. speed input: 7533.67 toks/s, output: 7.36 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:10<00:07,  7.68it/s, est. speed input: 7538.86 toks/s, output: 7.36 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:10<00:06,  7.73it/s, est. speed input: 7544.80 toks/s, output: 7.37 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:10<00:06,  7.67it/s, est. speed input: 7547.00 toks/s, output: 7.37 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:10<00:06,  7.70it/s, est. speed input: 7552.28 toks/s, output: 7.38 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:10<00:06,  7.70it/s, est. speed input: 7556.34 toks/s, output: 7.38 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:10<00:06,  7.73it/s, est. speed input: 7561.51 toks/s, output: 7.38 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:10<00:06,  7.60it/s, est. speed input: 7560.69 toks/s, output: 7.38 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:10<00:06,  7.65it/s, est. speed input: 7565.21 toks/s, output: 7.39 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:11<00:05,  7.67it/s, est. speed input: 7569.14 toks/s, output: 7.39 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:11<00:05,  7.68it/s, est. speed input: 7572.87 toks/s, output: 7.40 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:11<00:05,  7.70it/s, est. speed input: 7577.05 toks/s, output: 7.40 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:11<00:05,  7.75it/s, est. speed input: 7582.44 toks/s, output: 7.40 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:11<00:05,  7.77it/s, est. speed input: 7586.98 toks/s, output: 7.41 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:11<00:05,  7.76it/s, est. speed input: 7590.55 toks/s, output: 7.41 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:11<00:05,  7.61it/s, est. speed input: 7589.25 toks/s, output: 7.41 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:12<00:05,  7.64it/s, est. speed input: 7592.49 toks/s, output: 7.41 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:12<00:04,  7.65it/s, est. speed input: 7595.15 toks/s, output: 7.42 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:12<00:04,  7.63it/s, est. speed input: 7597.06 toks/s, output: 7.42 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:12<00:04,  7.64it/s, est. speed input: 7599.75 toks/s, output: 7.42 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:12<00:04,  7.70it/s, est. speed input: 7604.07 toks/s, output: 7.43 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:12<00:04,  7.70it/s, est. speed input: 7606.84 toks/s, output: 7.43 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:12<00:04,  7.71it/s, est. speed input: 7610.12 toks/s, output: 7.43 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:12<00:04,  7.64it/s, est. speed input: 7610.69 toks/s, output: 7.43 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:13<00:04,  7.63it/s, est. speed input: 7612.37 toks/s, output: 7.43 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:13<00:03,  7.64it/s, est. speed input: 7614.92 toks/s, output: 7.44 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:13<00:03,  7.67it/s, est. speed input: 7617.79 toks/s, output: 7.44 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:13<00:03,  7.63it/s, est. speed input: 7618.90 toks/s, output: 7.44 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:13<00:03,  7.64it/s, est. speed input: 7621.02 toks/s, output: 7.44 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:13<00:03,  7.65it/s, est. speed input: 7623.32 toks/s, output: 7.44 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:13<00:03,  7.65it/s, est. speed input: 7625.36 toks/s, output: 7.45 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:13<00:03,  7.52it/s, est. speed input: 7622.99 toks/s, output: 7.44 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:14<00:03,  7.57it/s, est. speed input: 7625.42 toks/s, output: 7.45 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:14<00:02,  7.61it/s, est. speed input: 7627.90 toks/s, output: 7.45 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:14<00:02,  7.66it/s, est. speed input: 7630.84 toks/s, output: 7.45 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:14<00:02,  7.69it/s, est. speed input: 7633.55 toks/s, output: 7.45 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:14<00:02,  7.71it/s, est. speed input: 7636.42 toks/s, output: 7.46 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:14<00:02,  7.72it/s, est. speed input: 7639.07 toks/s, output: 7.46 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:14<00:02,  7.67it/s, est. speed input: 7639.81 toks/s, output: 7.46 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:15<00:02,  7.57it/s, est. speed input: 7638.66 toks/s, output: 7.46 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:15<00:01,  7.57it/s, est. speed input: 7639.74 toks/s, output: 7.46 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:15<00:01,  7.58it/s, est. speed input: 7640.98 toks/s, output: 7.46 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:15<00:01,  7.59it/s, est. speed input: 7642.38 toks/s, output: 7.46 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:15<00:01,  7.60it/s, est. speed input: 7643.82 toks/s, output: 7.46 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:15<00:01,  7.62it/s, est. speed input: 7645.54 toks/s, output: 7.47 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:15<00:01,  7.65it/s, est. speed input: 7647.62 toks/s, output: 7.47 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:15<00:01,  7.68it/s, est. speed input: 7649.99 toks/s, output: 7.47 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:16<00:01,  7.61it/s, est. speed input: 7649.91 toks/s, output: 7.47 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:16<00:00,  7.59it/s, est. speed input: 7650.36 toks/s, output: 7.47 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:16<00:00,  7.61it/s, est. speed input: 7652.08 toks/s, output: 7.47 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:16<00:00,  7.60it/s, est. speed input: 7652.81 toks/s, output: 7.47 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:16<00:00,  7.65it/s, est. speed input: 7655.08 toks/s, output: 7.48 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:16<00:00,  7.65it/s, est. speed input: 7656.60 toks/s, output: 7.48 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:16<00:00,  7.68it/s, est. speed input: 7658.68 toks/s, output: 7.48 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:16<00:00,  7.66it/s, est. speed input: 7659.86 toks/s, output: 7.48 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:17<00:00,  7.63it/s, est. speed input: 7660.40 toks/s, output: 7.48 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:17<00:00,  7.63it/s, est. speed input: 7660.40 toks/s, output: 7.48 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:17<00:00,  7.48it/s, est. speed input: 7660.40 toks/s, output: 7.48 toks/s]
[rank0]:[W126 14:33:02.105125519 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 78.8s

测试结果:
  Requests/s:   7.36
  Tokens/s:     7548.72
  Total Reqs:   128
  Elapsed:      17.38s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     7541.35

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:33:09 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:33:09 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1396662) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1396662) WARNING 01-26 14:34:05 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.55 requests/s, 7738.64 total tokens/s, 7.55 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 14:33:09] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:33:09] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:33:09] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:09] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:33:09] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:33:09] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:33:09] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:33:09] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:33:09] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:33:13] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:33:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:33:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:33:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:33:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:33:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:33:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:33:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:33:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:14] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1396662) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1396662) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.33s/it]
(EngineCore_DP0 pid=1396662) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.50s/it]
(EngineCore_DP0 pid=1396662) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.48s/it]
(EngineCore_DP0 pid=1396662) 
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1396662) [2026-01-26 14:33:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1396662) 2026-01-26 14:34:04,785 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1396662) 2026-01-26 14:34:04,837 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  18%|█▊        | 45/256 [00:00<00:00, 443.64it/s]
Adding requests:  35%|███▌      | 90/256 [00:00<00:00, 410.83it/s]
Adding requests:  52%|█████▏    | 132/256 [00:00<00:00, 414.13it/s]
Adding requests:  68%|██████▊   | 174/256 [00:00<00:00, 411.91it/s]
Adding requests:  85%|████████▍ | 217/256 [00:00<00:00, 416.61it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 415.06it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:11, 22.11it/s, est. speed input: 22640.63 toks/s, output: 22.11 toks/s]
Processed prompts:   3%|▎         | 7/256 [00:00<00:16, 14.83it/s, est. speed input: 16094.95 toks/s, output: 15.72 toks/s]
Processed prompts:   4%|▎         | 9/256 [00:00<00:21, 11.29it/s, est. speed input: 13013.23 toks/s, output: 12.71 toks/s]
Processed prompts:   4%|▍         | 11/256 [00:00<00:24,  9.84it/s, est. speed input: 11647.56 toks/s, output: 11.37 toks/s]
Processed prompts:   5%|▌         | 13/256 [00:01<00:26,  9.02it/s, est. speed input: 10833.66 toks/s, output: 10.58 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:01<00:33,  7.18it/s, est. speed input: 9589.53 toks/s, output: 9.36 toks/s]  
Processed prompts:   6%|▋         | 16/256 [00:01<00:32,  7.33it/s, est. speed input: 9326.57 toks/s, output: 9.11 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:32,  7.40it/s, est. speed input: 9117.43 toks/s, output: 8.90 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:02<00:31,  7.48it/s, est. speed input: 8971.15 toks/s, output: 8.76 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:02<00:31,  7.48it/s, est. speed input: 8833.82 toks/s, output: 8.63 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:02<00:30,  7.50it/s, est. speed input: 8727.50 toks/s, output: 8.52 toks/s]
Processed prompts:  10%|█         | 26/256 [00:03<00:30,  7.56it/s, est. speed input: 8657.41 toks/s, output: 8.45 toks/s]
Processed prompts:  11%|█         | 28/256 [00:03<00:29,  7.60it/s, est. speed input: 8596.70 toks/s, output: 8.40 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:03<00:29,  7.57it/s, est. speed input: 8528.33 toks/s, output: 8.33 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:03<00:29,  7.60it/s, est. speed input: 8483.56 toks/s, output: 8.28 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:04<00:29,  7.61it/s, est. speed input: 8441.74 toks/s, output: 8.24 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:04<00:28,  7.60it/s, est. speed input: 8400.48 toks/s, output: 8.20 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:04<00:28,  7.56it/s, est. speed input: 8357.89 toks/s, output: 8.16 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:04<00:28,  7.57it/s, est. speed input: 8326.42 toks/s, output: 8.13 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:05<00:28,  7.60it/s, est. speed input: 8301.83 toks/s, output: 8.11 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:05<00:27,  7.60it/s, est. speed input: 8277.25 toks/s, output: 8.08 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:05<00:27,  7.57it/s, est. speed input: 8248.94 toks/s, output: 8.06 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:05<00:27,  7.57it/s, est. speed input: 8227.74 toks/s, output: 8.03 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:06<00:27,  7.59it/s, est. speed input: 8210.89 toks/s, output: 8.02 toks/s]
Processed prompts:  20%|██        | 52/256 [00:06<00:26,  7.59it/s, est. speed input: 8192.28 toks/s, output: 8.00 toks/s]
Processed prompts:  21%|██        | 54/256 [00:06<00:26,  7.57it/s, est. speed input: 8173.98 toks/s, output: 7.98 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:07<00:26,  7.59it/s, est. speed input: 8159.83 toks/s, output: 7.97 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:07<00:26,  7.55it/s, est. speed input: 8141.36 toks/s, output: 7.95 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:07<00:25,  7.58it/s, est. speed input: 8130.56 toks/s, output: 7.94 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:07<00:25,  7.57it/s, est. speed input: 8116.90 toks/s, output: 7.93 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:08<00:25,  7.61it/s, est. speed input: 8109.14 toks/s, output: 7.92 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:08<00:24,  7.63it/s, est. speed input: 8101.56 toks/s, output: 7.91 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:08<00:24,  7.62it/s, est. speed input: 8091.47 toks/s, output: 7.90 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:08<00:24,  7.57it/s, est. speed input: 8077.93 toks/s, output: 7.89 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:09<00:24,  7.56it/s, est. speed input: 8067.91 toks/s, output: 7.88 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:09<00:24,  7.58it/s, est. speed input: 8060.13 toks/s, output: 7.87 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:09<00:23,  7.57it/s, est. speed input: 8051.23 toks/s, output: 7.86 toks/s]
Processed prompts:  30%|███       | 78/256 [00:09<00:23,  7.53it/s, est. speed input: 8039.50 toks/s, output: 7.85 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:10<00:23,  7.56it/s, est. speed input: 8033.70 toks/s, output: 7.85 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:10<00:23,  7.56it/s, est. speed input: 8026.52 toks/s, output: 7.84 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:10<00:22,  7.57it/s, est. speed input: 8020.34 toks/s, output: 7.83 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:10<00:22,  7.55it/s, est. speed input: 8012.18 toks/s, output: 7.82 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:11<00:22,  7.56it/s, est. speed input: 8006.22 toks/s, output: 7.82 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:11<00:21,  7.57it/s, est. speed input: 8001.39 toks/s, output: 7.81 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:11<00:21,  7.56it/s, est. speed input: 7994.52 toks/s, output: 7.81 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:12<00:21,  7.53it/s, est. speed input: 7986.97 toks/s, output: 7.80 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:12<00:21,  7.54it/s, est. speed input: 7981.34 toks/s, output: 7.79 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:12<00:20,  7.58it/s, est. speed input: 7979.04 toks/s, output: 7.79 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:12<00:20,  7.59it/s, est. speed input: 7975.04 toks/s, output: 7.79 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:13<00:20,  7.52it/s, est. speed input: 7966.22 toks/s, output: 7.78 toks/s]
Processed prompts:  41%|████      | 104/256 [00:13<00:20,  7.54it/s, est. speed input: 7962.05 toks/s, output: 7.78 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:13<00:19,  7.58it/s, est. speed input: 7960.03 toks/s, output: 7.77 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:13<00:19,  7.59it/s, est. speed input: 7956.98 toks/s, output: 7.77 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:14<00:19,  7.53it/s, est. speed input: 7949.45 toks/s, output: 7.76 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:14<00:19,  7.54it/s, est. speed input: 7945.85 toks/s, output: 7.76 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:14<00:18,  7.55it/s, est. speed input: 7942.33 toks/s, output: 7.76 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:14<00:18,  7.57it/s, est. speed input: 7940.17 toks/s, output: 7.75 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:15<00:18,  7.53it/s, est. speed input: 7934.56 toks/s, output: 7.75 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:15<00:17,  7.58it/s, est. speed input: 7933.40 toks/s, output: 7.75 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:15<00:17,  7.58it/s, est. speed input: 7930.59 toks/s, output: 7.74 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:16<00:17,  7.58it/s, est. speed input: 7927.66 toks/s, output: 7.74 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:16<00:17,  7.53it/s, est. speed input: 7922.11 toks/s, output: 7.74 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:16<00:16,  7.54it/s, est. speed input: 7919.63 toks/s, output: 7.73 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:16<00:16,  7.57it/s, est. speed input: 7917.91 toks/s, output: 7.73 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:17<00:16,  7.58it/s, est. speed input: 7915.83 toks/s, output: 7.73 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:17<00:16,  7.54it/s, est. speed input: 7911.58 toks/s, output: 7.73 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:17<00:15,  7.55it/s, est. speed input: 7909.31 toks/s, output: 7.72 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:17<00:15,  7.56it/s, est. speed input: 7907.07 toks/s, output: 7.72 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:18<00:15,  7.57it/s, est. speed input: 7905.15 toks/s, output: 7.72 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:18<00:15,  7.54it/s, est. speed input: 7901.61 toks/s, output: 7.72 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:18<00:14,  7.55it/s, est. speed input: 7899.28 toks/s, output: 7.71 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:18<00:14,  7.56it/s, est. speed input: 7897.75 toks/s, output: 7.71 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:19<00:14,  7.56it/s, est. speed input: 7895.64 toks/s, output: 7.71 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:19<00:14,  7.51it/s, est. speed input: 7891.08 toks/s, output: 7.71 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:19<00:13,  7.53it/s, est. speed input: 7889.47 toks/s, output: 7.70 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:19<00:13,  7.53it/s, est. speed input: 7887.15 toks/s, output: 7.70 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:20<00:13,  7.56it/s, est. speed input: 7886.02 toks/s, output: 7.70 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:20<00:13,  7.52it/s, est. speed input: 7882.17 toks/s, output: 7.70 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:20<00:12,  7.54it/s, est. speed input: 7880.87 toks/s, output: 7.70 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:21<00:12,  7.57it/s, est. speed input: 7880.07 toks/s, output: 7.70 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:21<00:12,  7.57it/s, est. speed input: 7878.74 toks/s, output: 7.69 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:21<00:11,  7.51it/s, est. speed input: 7874.55 toks/s, output: 7.69 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:21<00:11,  7.52it/s, est. speed input: 7872.83 toks/s, output: 7.69 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:22<00:11,  7.53it/s, est. speed input: 7870.97 toks/s, output: 7.69 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:22<00:11,  7.55it/s, est. speed input: 7869.98 toks/s, output: 7.69 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:22<00:10,  7.52it/s, est. speed input: 7867.01 toks/s, output: 7.68 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:22<00:10,  7.53it/s, est. speed input: 7865.75 toks/s, output: 7.68 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:23<00:10,  7.54it/s, est. speed input: 7864.31 toks/s, output: 7.68 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:23<00:10,  7.56it/s, est. speed input: 7863.33 toks/s, output: 7.68 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:23<00:09,  7.50it/s, est. speed input: 7859.89 toks/s, output: 7.68 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:23<00:09,  7.52it/s, est. speed input: 7858.47 toks/s, output: 7.67 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:24<00:09,  7.55it/s, est. speed input: 7857.91 toks/s, output: 7.67 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:24<00:08,  7.56it/s, est. speed input: 7856.97 toks/s, output: 7.67 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:24<00:08,  7.53it/s, est. speed input: 7854.53 toks/s, output: 7.67 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:25<00:08,  7.53it/s, est. speed input: 7853.08 toks/s, output: 7.67 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:25<00:08,  7.55it/s, est. speed input: 7852.41 toks/s, output: 7.67 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:25<00:07,  7.58it/s, est. speed input: 7852.30 toks/s, output: 7.67 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:25<00:07,  7.51it/s, est. speed input: 7848.71 toks/s, output: 7.66 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:26<00:07,  7.53it/s, est. speed input: 7847.82 toks/s, output: 7.66 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:26<00:06,  8.53it/s, est. speed input: 7877.55 toks/s, output: 7.69 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:26<00:06,  8.22it/s, est. speed input: 7876.44 toks/s, output: 7.69 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:26<00:06,  7.98it/s, est. speed input: 7874.11 toks/s, output: 7.69 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:27<00:06,  7.87it/s, est. speed input: 7873.31 toks/s, output: 7.69 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:27<00:05,  7.78it/s, est. speed input: 7872.38 toks/s, output: 7.69 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:27<00:05,  7.71it/s, est. speed input: 7871.01 toks/s, output: 7.69 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:27<00:05,  7.60it/s, est. speed input: 7867.84 toks/s, output: 7.68 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:28<00:05,  7.60it/s, est. speed input: 7866.79 toks/s, output: 7.68 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:28<00:04,  7.60it/s, est. speed input: 7866.18 toks/s, output: 7.68 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:28<00:04,  7.58it/s, est. speed input: 7864.66 toks/s, output: 7.68 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:28<00:04,  7.52it/s, est. speed input: 7861.99 toks/s, output: 7.68 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:29<00:04,  7.56it/s, est. speed input: 7861.82 toks/s, output: 7.68 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:29<00:03,  7.57it/s, est. speed input: 7860.89 toks/s, output: 7.68 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:29<00:03,  7.57it/s, est. speed input: 7859.89 toks/s, output: 7.68 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:29<00:03,  7.52it/s, est. speed input: 7857.53 toks/s, output: 7.67 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:30<00:03,  7.55it/s, est. speed input: 7856.94 toks/s, output: 7.67 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:30<00:02,  7.55it/s, est. speed input: 7855.96 toks/s, output: 7.67 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:30<00:02,  7.55it/s, est. speed input: 7854.97 toks/s, output: 7.67 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:31<00:02,  7.52it/s, est. speed input: 7852.92 toks/s, output: 7.67 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:31<00:02,  7.53it/s, est. speed input: 7851.99 toks/s, output: 7.67 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:31<00:01,  7.54it/s, est. speed input: 7851.07 toks/s, output: 7.67 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:31<00:01,  7.55it/s, est. speed input: 7850.12 toks/s, output: 7.67 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:32<00:01,  7.51it/s, est. speed input: 7848.18 toks/s, output: 7.66 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:32<00:01,  7.53it/s, est. speed input: 7847.42 toks/s, output: 7.66 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:32<00:00,  7.54it/s, est. speed input: 7846.61 toks/s, output: 7.66 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:32<00:00,  7.56it/s, est. speed input: 7846.03 toks/s, output: 7.66 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:33<00:00,  7.53it/s, est. speed input: 7844.30 toks/s, output: 7.66 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  8.86it/s, est. speed input: 7874.60 toks/s, output: 7.69 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  8.86it/s, est. speed input: 7874.60 toks/s, output: 7.69 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  7.69it/s, est. speed input: 7874.60 toks/s, output: 7.69 toks/s]
[rank0]:[W126 14:34:39.088084054 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 97.1s

测试结果:
  Requests/s:   7.55
  Tokens/s:     7738.64
  Total Reqs:   256
  Elapsed:      33.91s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     7731.09

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:34:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:34:49 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1398210) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1398210) WARNING 01-26 14:35:45 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.56 requests/s, 7754.02 total tokens/s, 7.56 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 14:34:49] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:34:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:34:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:34:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:34:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:34:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:34:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:34:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:34:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:34:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:34:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:34:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:34:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:34:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:34:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:34:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:34:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1398210) [2026-01-26 14:34:54] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1398210) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1398210) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.33s/it]
(EngineCore_DP0 pid=1398210) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.04s/it]
(EngineCore_DP0 pid=1398210) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.09s/it]
(EngineCore_DP0 pid=1398210) 
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:36] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1398210) [2026-01-26 14:35:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1398210) 2026-01-26 14:35:44,174 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1398210) 2026-01-26 14:35:44,227 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 42/512 [00:00<00:01, 416.79it/s]
Adding requests:  16%|█▋        | 84/512 [00:00<00:01, 401.85it/s]
Adding requests:  24%|██▍       | 125/512 [00:00<00:00, 395.68it/s]
Adding requests:  33%|███▎      | 167/512 [00:00<00:00, 404.10it/s]
Adding requests:  41%|████▏     | 212/512 [00:00<00:00, 418.79it/s]
Adding requests:  50%|█████     | 257/512 [00:00<00:00, 426.86it/s]
Adding requests:  59%|█████▉    | 303/512 [00:00<00:00, 434.45it/s]
Adding requests:  68%|██████▊   | 348/512 [00:00<00:00, 438.35it/s]
Adding requests:  77%|███████▋  | 395/512 [00:00<00:00, 445.68it/s]
Adding requests:  87%|████████▋ | 443/512 [00:01<00:00, 452.30it/s]
Adding requests:  96%|█████████▌| 489/512 [00:01<00:00, 453.83it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 433.89it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:00<00:31, 15.99it/s, est. speed input: 16372.65 toks/s, output: 15.99 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:01<00:43, 11.35it/s, est. speed input: 12392.00 toks/s, output: 12.10 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:01<00:50,  9.73it/s, est. speed input: 10961.80 toks/s, output: 10.70 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:02<00:55,  8.89it/s, est. speed input: 10193.71 toks/s, output: 9.95 toks/s] 
Processed prompts:   5%|▌         | 26/512 [00:02<00:57,  8.45it/s, est. speed input: 9736.74 toks/s, output: 9.51 toks/s] 
Processed prompts:   6%|▌         | 30/512 [00:03<00:59,  8.14it/s, est. speed input: 9407.62 toks/s, output: 9.19 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:03<01:00,  7.96it/s, est. speed input: 9181.51 toks/s, output: 8.97 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:04<01:00,  7.82it/s, est. speed input: 9000.70 toks/s, output: 8.79 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:04<01:00,  7.76it/s, est. speed input: 8870.46 toks/s, output: 8.66 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:05<01:00,  7.69it/s, est. speed input: 8755.69 toks/s, output: 8.55 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:05<01:00,  7.67it/s, est. speed input: 8671.57 toks/s, output: 8.47 toks/s]
Processed prompts:  11%|█         | 54/512 [00:06<00:59,  7.64it/s, est. speed input: 8596.62 toks/s, output: 8.40 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:06<00:59,  7.63it/s, est. speed input: 8534.58 toks/s, output: 8.33 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:07<00:59,  7.59it/s, est. speed input: 8474.89 toks/s, output: 8.28 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:08<00:58,  7.59it/s, est. speed input: 8427.60 toks/s, output: 8.23 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:08<00:58,  7.56it/s, est. speed input: 8381.61 toks/s, output: 8.19 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:09<00:57,  7.57it/s, est. speed input: 8346.04 toks/s, output: 8.15 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:09<00:57,  7.55it/s, est. speed input: 8309.72 toks/s, output: 8.11 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:10<00:56,  7.57it/s, est. speed input: 8282.18 toks/s, output: 8.09 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:10<00:56,  7.54it/s, est. speed input: 8250.93 toks/s, output: 8.06 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:11<00:55,  7.55it/s, est. speed input: 8226.97 toks/s, output: 8.03 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:11<00:55,  7.53it/s, est. speed input: 8202.27 toks/s, output: 8.01 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:12<00:54,  7.56it/s, est. speed input: 8185.71 toks/s, output: 7.99 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:12<00:54,  7.54it/s, est. speed input: 8163.60 toks/s, output: 7.97 toks/s]
Processed prompts:  21%|██        | 106/512 [00:13<00:53,  7.55it/s, est. speed input: 8148.07 toks/s, output: 7.96 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:13<00:53,  7.54it/s, est. speed input: 8130.23 toks/s, output: 7.94 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:14<00:52,  7.56it/s, est. speed input: 8118.21 toks/s, output: 7.93 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:14<00:52,  7.55it/s, est. speed input: 8103.17 toks/s, output: 7.91 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:15<00:51,  7.57it/s, est. speed input: 8092.82 toks/s, output: 7.90 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:15<00:51,  7.54it/s, est. speed input: 8078.43 toks/s, output: 7.89 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:16<00:50,  7.55it/s, est. speed input: 8068.34 toks/s, output: 7.88 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:17<00:50,  7.54it/s, est. speed input: 8056.48 toks/s, output: 7.87 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:17<00:49,  7.55it/s, est. speed input: 8047.19 toks/s, output: 7.86 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:18<00:49,  7.54it/s, est. speed input: 8036.65 toks/s, output: 7.85 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:18<00:48,  7.56it/s, est. speed input: 8029.46 toks/s, output: 7.84 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:19<00:48,  7.53it/s, est. speed input: 8018.58 toks/s, output: 7.83 toks/s]
Processed prompts:  30%|███       | 154/512 [00:19<00:47,  7.55it/s, est. speed input: 8012.67 toks/s, output: 7.82 toks/s]
Processed prompts:  31%|███       | 158/512 [00:20<00:46,  7.53it/s, est. speed input: 8003.56 toks/s, output: 7.82 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:20<00:46,  7.54it/s, est. speed input: 7996.30 toks/s, output: 7.81 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:21<00:45,  7.53it/s, est. speed input: 7988.75 toks/s, output: 7.80 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:21<00:45,  7.54it/s, est. speed input: 7983.17 toks/s, output: 7.80 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:22<00:44,  7.54it/s, est. speed input: 7976.40 toks/s, output: 7.79 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:22<00:44,  7.55it/s, est. speed input: 7971.28 toks/s, output: 7.78 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:23<00:43,  7.54it/s, est. speed input: 7964.84 toks/s, output: 7.78 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:23<00:43,  7.54it/s, est. speed input: 7959.78 toks/s, output: 7.77 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:24<00:42,  7.53it/s, est. speed input: 7954.10 toks/s, output: 7.77 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:24<00:42,  7.55it/s, est. speed input: 7950.13 toks/s, output: 7.76 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:25<00:41,  7.55it/s, est. speed input: 7945.48 toks/s, output: 7.76 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:25<00:39,  7.93it/s, est. speed input: 7967.23 toks/s, output: 7.78 toks/s]
Processed prompts:  40%|████      | 206/512 [00:26<00:39,  7.81it/s, est. speed input: 7962.27 toks/s, output: 7.78 toks/s]
Processed prompts:  41%|████      | 210/512 [00:27<00:39,  7.73it/s, est. speed input: 7957.68 toks/s, output: 7.77 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:27<00:38,  7.66it/s, est. speed input: 7952.28 toks/s, output: 7.77 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:28<00:38,  7.64it/s, est. speed input: 7949.00 toks/s, output: 7.76 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:28<00:38,  7.61it/s, est. speed input: 7944.86 toks/s, output: 7.76 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:29<00:37,  7.59it/s, est. speed input: 7940.78 toks/s, output: 7.75 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:29<00:37,  7.57it/s, est. speed input: 7936.52 toks/s, output: 7.75 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:30<00:36,  7.56it/s, est. speed input: 7932.82 toks/s, output: 7.75 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:30<00:36,  7.56it/s, est. speed input: 7929.25 toks/s, output: 7.74 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:31<00:35,  7.57it/s, est. speed input: 7926.75 toks/s, output: 7.74 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:31<00:35,  7.54it/s, est. speed input: 7922.36 toks/s, output: 7.74 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:32<00:34,  7.55it/s, est. speed input: 7919.18 toks/s, output: 7.73 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:32<00:34,  7.53it/s, est. speed input: 7915.19 toks/s, output: 7.73 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:33<00:33,  7.55it/s, est. speed input: 7913.23 toks/s, output: 7.73 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:33<00:33,  7.54it/s, est. speed input: 7909.73 toks/s, output: 7.72 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:34<00:32,  7.55it/s, est. speed input: 7907.19 toks/s, output: 7.72 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:34<00:32,  7.54it/s, est. speed input: 7903.91 toks/s, output: 7.72 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:35<00:31,  7.55it/s, est. speed input: 7901.71 toks/s, output: 7.72 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:36<00:31,  7.52it/s, est. speed input: 7897.97 toks/s, output: 7.71 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:36<00:30,  7.54it/s, est. speed input: 7895.92 toks/s, output: 7.71 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:37<00:30,  7.52it/s, est. speed input: 7892.65 toks/s, output: 7.71 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:37<00:29,  7.55it/s, est. speed input: 7891.04 toks/s, output: 7.71 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:38<00:28,  7.54it/s, est. speed input: 7888.71 toks/s, output: 7.70 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:38<00:28,  7.56it/s, est. speed input: 7887.05 toks/s, output: 7.70 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:39<00:27,  7.55it/s, est. speed input: 7884.96 toks/s, output: 7.70 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:39<00:25,  8.06it/s, est. speed input: 7904.83 toks/s, output: 7.72 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:40<00:25,  7.88it/s, est. speed input: 7901.75 toks/s, output: 7.72 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:40<00:25,  7.78it/s, est. speed input: 7899.48 toks/s, output: 7.71 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:41<00:25,  7.69it/s, est. speed input: 7896.46 toks/s, output: 7.71 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:41<00:24,  7.64it/s, est. speed input: 7894.12 toks/s, output: 7.71 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:42<00:24,  7.61it/s, est. speed input: 7891.84 toks/s, output: 7.71 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:42<00:24,  7.58it/s, est. speed input: 7889.55 toks/s, output: 7.70 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:43<00:23,  7.55it/s, est. speed input: 7886.61 toks/s, output: 7.70 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:43<00:23,  7.55it/s, est. speed input: 7884.86 toks/s, output: 7.70 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:44<00:22,  7.53it/s, est. speed input: 7881.94 toks/s, output: 7.70 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:44<00:22,  7.53it/s, est. speed input: 7880.12 toks/s, output: 7.70 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:45<00:21,  7.52it/s, est. speed input: 7877.56 toks/s, output: 7.69 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:46<00:20,  7.53it/s, est. speed input: 7875.90 toks/s, output: 7.69 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:46<00:20,  7.52it/s, est. speed input: 7873.67 toks/s, output: 7.69 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:47<00:19,  7.53it/s, est. speed input: 7872.04 toks/s, output: 7.69 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:47<00:19,  7.52it/s, est. speed input: 7870.01 toks/s, output: 7.69 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:48<00:18,  7.53it/s, est. speed input: 7868.61 toks/s, output: 7.68 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:48<00:18,  7.53it/s, est. speed input: 7866.72 toks/s, output: 7.68 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:49<00:17,  7.54it/s, est. speed input: 7865.48 toks/s, output: 7.68 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:49<00:17,  7.53it/s, est. speed input: 7863.70 toks/s, output: 7.68 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:50<00:16,  7.55it/s, est. speed input: 7862.57 toks/s, output: 7.68 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:50<00:16,  7.53it/s, est. speed input: 7860.63 toks/s, output: 7.68 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:51<00:15,  7.54it/s, est. speed input: 7859.42 toks/s, output: 7.68 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:51<00:15,  7.52it/s, est. speed input: 7857.44 toks/s, output: 7.67 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:52<00:14,  7.55it/s, est. speed input: 7856.66 toks/s, output: 7.67 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:52<00:14,  7.53it/s, est. speed input: 7854.70 toks/s, output: 7.67 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:53<00:13,  7.54it/s, est. speed input: 7853.81 toks/s, output: 7.67 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:53<00:13,  7.52it/s, est. speed input: 7851.72 toks/s, output: 7.67 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:54<00:12,  7.52it/s, est. speed input: 7850.13 toks/s, output: 7.67 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:55<00:11,  7.51it/s, est. speed input: 7848.42 toks/s, output: 7.66 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:55<00:11,  7.53it/s, est. speed input: 7847.50 toks/s, output: 7.66 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:56<00:10,  7.52it/s, est. speed input: 7845.79 toks/s, output: 7.66 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:56<00:09,  8.04it/s, est. speed input: 7860.34 toks/s, output: 7.68 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:57<00:09,  7.86it/s, est. speed input: 7858.41 toks/s, output: 7.67 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:57<00:09,  7.77it/s, est. speed input: 7857.41 toks/s, output: 7.67 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:58<00:08,  7.69it/s, est. speed input: 7855.92 toks/s, output: 7.67 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:58<00:08,  7.66it/s, est. speed input: 7855.08 toks/s, output: 7.67 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:59<00:07,  7.60it/s, est. speed input: 7853.35 toks/s, output: 7.67 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:59<00:07,  7.58it/s, est. speed input: 7852.05 toks/s, output: 7.67 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:00<00:06,  7.56it/s, est. speed input: 7850.63 toks/s, output: 7.67 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:00<00:06,  7.56it/s, est. speed input: 7849.79 toks/s, output: 7.67 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:01<00:05,  7.56it/s, est. speed input: 7848.65 toks/s, output: 7.66 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:01<00:05,  7.56it/s, est. speed input: 7847.79 toks/s, output: 7.66 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:02<00:04,  7.54it/s, est. speed input: 7846.36 toks/s, output: 7.66 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:02<00:03,  7.55it/s, est. speed input: 7845.66 toks/s, output: 7.66 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:03<00:03,  7.54it/s, est. speed input: 7844.21 toks/s, output: 7.66 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:03<00:02,  7.54it/s, est. speed input: 7843.35 toks/s, output: 7.66 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:04<00:02,  7.54it/s, est. speed input: 7842.27 toks/s, output: 7.66 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:05<00:01,  7.54it/s, est. speed input: 7841.34 toks/s, output: 7.66 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:05<00:01,  7.54it/s, est. speed input: 7840.34 toks/s, output: 7.66 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:06<00:00,  7.55it/s, est. speed input: 7839.58 toks/s, output: 7.66 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:06<00:00,  8.11it/s, est. speed input: 7853.25 toks/s, output: 7.67 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:06<00:00,  8.11it/s, est. speed input: 7884.03 toks/s, output: 7.70 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:06<00:00,  7.70it/s, est. speed input: 7884.03 toks/s, output: 7.70 toks/s]
[rank0]:[W126 14:36:53.293402201 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 133.1s

测试结果:
  Requests/s:   7.56
  Tokens/s:     7754.02
  Total Reqs:   512
  Elapsed:      67.68s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     7746.46

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:37:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:37:02 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1400248) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1400248) WARNING 01-26 14:37:58 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.45 requests/s, 7633.78 total tokens/s, 7.45 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 14:37:02] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:37:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:37:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:37:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:37:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:37:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:37:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:37:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:37:06] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:37:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:37:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:37:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:37:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:37:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:37:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:37:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:37:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:07] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1400248) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1400248) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.08s/it]
(EngineCore_DP0 pid=1400248) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.82s/it]
(EngineCore_DP0 pid=1400248) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.86s/it]
(EngineCore_DP0 pid=1400248) 
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1400248) [2026-01-26 14:37:49] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1400248) 2026-01-26 14:37:56,792 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1400248) 2026-01-26 14:37:57,195 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 30/1024 [00:00<00:03, 293.36it/s]
Adding requests:   7%|▋         | 70/1024 [00:00<00:02, 350.61it/s]
Adding requests:  10%|█         | 106/1024 [00:00<00:02, 343.25it/s]
Adding requests:  14%|█▍        | 144/1024 [00:00<00:02, 355.38it/s]
Adding requests:  18%|█▊        | 186/1024 [00:00<00:02, 377.55it/s]
Adding requests:  22%|██▏       | 229/1024 [00:00<00:02, 393.32it/s]
Adding requests:  26%|██▋       | 271/1024 [00:00<00:01, 401.41it/s]
Adding requests:  31%|███       | 318/1024 [00:00<00:01, 420.24it/s]
Adding requests:  35%|███▌      | 363/1024 [00:00<00:01, 428.42it/s]
Adding requests:  40%|███▉      | 407/1024 [00:01<00:01, 430.27it/s]
Adding requests:  44%|████▍     | 451/1024 [00:01<00:01, 431.68it/s]
Adding requests:  48%|████▊     | 495/1024 [00:01<00:01, 432.51it/s]
Adding requests:  53%|█████▎    | 539/1024 [00:01<00:01, 424.58it/s]
Adding requests:  57%|█████▋    | 582/1024 [00:01<00:01, 416.90it/s]
Adding requests:  61%|██████    | 625/1024 [00:01<00:00, 419.08it/s]
Adding requests:  65%|██████▌   | 667/1024 [00:01<00:00, 412.15it/s]
Adding requests:  69%|██████▉   | 711/1024 [00:01<00:00, 420.06it/s]
Adding requests:  74%|███████▎  | 754/1024 [00:01<00:00, 415.22it/s]
Adding requests:  78%|███████▊  | 797/1024 [00:01<00:00, 418.88it/s]
Adding requests:  82%|████████▏ | 840/1024 [00:02<00:00, 421.37it/s]
Adding requests:  86%|████████▌ | 883/1024 [00:02<00:00, 422.82it/s]
Adding requests:  90%|█████████ | 926/1024 [00:02<00:00, 416.03it/s]
Adding requests:  95%|█████████▍| 968/1024 [00:02<00:00, 411.62it/s]
Adding requests:  99%|█████████▊| 1010/1024 [00:02<00:00, 404.02it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 407.94it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:00<00:52, 19.34it/s, est. speed input: 19803.96 toks/s, output: 19.34 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:02<01:23, 11.94it/s, est. speed input: 13281.19 toks/s, output: 12.97 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:03<01:40,  9.84it/s, est. speed input: 11317.52 toks/s, output: 11.05 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:04<01:50,  8.89it/s, est. speed input: 10372.34 toks/s, output: 10.13 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:05<01:56,  8.37it/s, est. speed input: 9809.35 toks/s, output: 9.58 toks/s]  
Processed prompts:   6%|▌         | 58/1024 [00:06<01:59,  8.06it/s, est. speed input: 9441.67 toks/s, output: 9.22 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:07<02:01,  7.86it/s, est. speed input: 9177.77 toks/s, output: 8.96 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:08<02:02,  7.73it/s, est. speed input: 8979.07 toks/s, output: 8.77 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:09<02:03,  7.64it/s, est. speed input: 8827.45 toks/s, output: 8.62 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:10<02:03,  7.58it/s, est. speed input: 8703.74 toks/s, output: 8.50 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:11<02:02,  7.54it/s, est. speed input: 8604.40 toks/s, output: 8.40 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:12<02:02,  7.51it/s, est. speed input: 8521.68 toks/s, output: 8.32 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:13<02:01,  7.49it/s, est. speed input: 8453.20 toks/s, output: 8.26 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:14<02:00,  7.47it/s, est. speed input: 8391.93 toks/s, output: 8.20 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:15<01:59,  7.46it/s, est. speed input: 8338.58 toks/s, output: 8.14 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:17<01:58,  7.46it/s, est. speed input: 8294.70 toks/s, output: 8.10 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:18<01:57,  7.46it/s, est. speed input: 8256.14 toks/s, output: 8.06 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:19<01:56,  7.45it/s, est. speed input: 8218.97 toks/s, output: 8.03 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:20<01:55,  7.44it/s, est. speed input: 8186.36 toks/s, output: 7.99 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:21<01:54,  7.44it/s, est. speed input: 8157.96 toks/s, output: 7.97 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:22<01:53,  7.44it/s, est. speed input: 8132.14 toks/s, output: 7.94 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:23<01:52,  7.44it/s, est. speed input: 8107.81 toks/s, output: 7.92 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:24<01:51,  7.43it/s, est. speed input: 8085.63 toks/s, output: 7.90 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:25<01:47,  7.64it/s, est. speed input: 8096.96 toks/s, output: 7.91 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:26<01:47,  7.58it/s, est. speed input: 8076.99 toks/s, output: 7.89 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:27<01:46,  7.54it/s, est. speed input: 8059.44 toks/s, output: 7.87 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:28<01:46,  7.51it/s, est. speed input: 8043.31 toks/s, output: 7.85 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:29<01:45,  7.49it/s, est. speed input: 8028.44 toks/s, output: 7.84 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:30<01:44,  7.48it/s, est. speed input: 8014.30 toks/s, output: 7.83 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:31<01:43,  7.47it/s, est. speed input: 8001.06 toks/s, output: 7.81 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:33<01:42,  7.45it/s, est. speed input: 7988.20 toks/s, output: 7.80 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:34<01:41,  7.45it/s, est. speed input: 7976.63 toks/s, output: 7.79 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:35<01:40,  7.44it/s, est. speed input: 7965.05 toks/s, output: 7.78 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:36<01:39,  7.44it/s, est. speed input: 7954.91 toks/s, output: 7.77 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:37<01:38,  7.44it/s, est. speed input: 7945.43 toks/s, output: 7.76 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:38<01:37,  7.45it/s, est. speed input: 7936.62 toks/s, output: 7.75 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:39<01:33,  7.69it/s, est. speed input: 7950.69 toks/s, output: 7.76 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:40<01:33,  7.61it/s, est. speed input: 7941.85 toks/s, output: 7.76 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:41<01:32,  7.55it/s, est. speed input: 7933.02 toks/s, output: 7.75 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:42<01:32,  7.52it/s, est. speed input: 7924.79 toks/s, output: 7.74 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:43<01:31,  7.48it/s, est. speed input: 7916.46 toks/s, output: 7.73 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:44<01:30,  7.47it/s, est. speed input: 7909.28 toks/s, output: 7.72 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:45<01:29,  7.46it/s, est. speed input: 7902.29 toks/s, output: 7.72 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:46<01:28,  7.46it/s, est. speed input: 7895.97 toks/s, output: 7.71 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:48<01:27,  7.45it/s, est. speed input: 7889.89 toks/s, output: 7.70 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:49<01:26,  7.44it/s, est. speed input: 7883.63 toks/s, output: 7.70 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:50<01:25,  7.44it/s, est. speed input: 7877.39 toks/s, output: 7.69 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:51<01:24,  7.43it/s, est. speed input: 7871.73 toks/s, output: 7.69 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:52<01:23,  7.44it/s, est. speed input: 7866.72 toks/s, output: 7.68 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:53<01:22,  7.43it/s, est. speed input: 7861.22 toks/s, output: 7.68 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:54<01:21,  7.43it/s, est. speed input: 7856.19 toks/s, output: 7.67 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:55<01:20,  7.43it/s, est. speed input: 7851.47 toks/s, output: 7.67 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:56<01:16,  7.68it/s, est. speed input: 7863.22 toks/s, output: 7.68 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:57<01:16,  7.60it/s, est. speed input: 7858.14 toks/s, output: 7.67 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:58<01:16,  7.55it/s, est. speed input: 7853.62 toks/s, output: 7.67 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:59<01:15,  7.51it/s, est. speed input: 7849.11 toks/s, output: 7.67 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:00<01:14,  7.48it/s, est. speed input: 7844.66 toks/s, output: 7.66 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:01<01:13,  7.46it/s, est. speed input: 7840.05 toks/s, output: 7.66 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:02<01:12,  7.46it/s, est. speed input: 7836.59 toks/s, output: 7.65 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:04<01:11,  7.45it/s, est. speed input: 7832.53 toks/s, output: 7.65 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:05<01:10,  7.44it/s, est. speed input: 7828.85 toks/s, output: 7.65 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:06<01:09,  7.45it/s, est. speed input: 7825.67 toks/s, output: 7.64 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:07<01:08,  7.44it/s, est. speed input: 7822.32 toks/s, output: 7.64 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:08<01:07,  7.44it/s, est. speed input: 7818.77 toks/s, output: 7.64 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:09<01:06,  7.43it/s, est. speed input: 7815.15 toks/s, output: 7.63 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:10<01:05,  7.43it/s, est. speed input: 7811.98 toks/s, output: 7.63 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:11<01:04,  7.42it/s, est. speed input: 7808.57 toks/s, output: 7.63 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:12<01:03,  7.42it/s, est. speed input: 7805.24 toks/s, output: 7.62 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:13<01:02,  7.41it/s, est. speed input: 7802.03 toks/s, output: 7.62 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:14<01:01,  7.42it/s, est. speed input: 7799.10 toks/s, output: 7.62 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:15<01:00,  7.42it/s, est. speed input: 7796.16 toks/s, output: 7.61 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:16<00:59,  7.42it/s, est. speed input: 7793.51 toks/s, output: 7.61 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:18<00:57,  7.42it/s, est. speed input: 7790.93 toks/s, output: 7.61 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:19<00:56,  7.42it/s, est. speed input: 7788.23 toks/s, output: 7.61 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:20<00:55,  7.42it/s, est. speed input: 7785.72 toks/s, output: 7.60 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:21<00:54,  7.42it/s, est. speed input: 7783.17 toks/s, output: 7.60 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:22<00:53,  7.42it/s, est. speed input: 7780.60 toks/s, output: 7.60 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:23<00:52,  7.43it/s, est. speed input: 7778.79 toks/s, output: 7.60 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:24<00:51,  7.43it/s, est. speed input: 7776.42 toks/s, output: 7.59 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:25<00:50,  7.43it/s, est. speed input: 7774.63 toks/s, output: 7.59 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:26<00:49,  7.43it/s, est. speed input: 7772.39 toks/s, output: 7.59 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:27<00:48,  7.42it/s, est. speed input: 7770.09 toks/s, output: 7.59 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:28<00:47,  7.42it/s, est. speed input: 7768.02 toks/s, output: 7.59 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:29<00:46,  7.42it/s, est. speed input: 7766.05 toks/s, output: 7.58 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:31<00:44,  7.43it/s, est. speed input: 7764.22 toks/s, output: 7.58 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:32<00:43,  7.43it/s, est. speed input: 7762.35 toks/s, output: 7.58 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:33<00:42,  7.43it/s, est. speed input: 7760.65 toks/s, output: 7.58 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [01:34<00:41,  7.42it/s, est. speed input: 7758.65 toks/s, output: 7.58 toks/s]
Processed prompts:  71%|███████   | 722/1024 [01:35<00:40,  7.42it/s, est. speed input: 7756.76 toks/s, output: 7.57 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [01:36<00:39,  7.42it/s, est. speed input: 7754.86 toks/s, output: 7.57 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [01:37<00:38,  7.41it/s, est. speed input: 7753.00 toks/s, output: 7.57 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [01:38<00:37,  7.42it/s, est. speed input: 7751.35 toks/s, output: 7.57 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [01:39<00:36,  7.41it/s, est. speed input: 7749.47 toks/s, output: 7.57 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [01:40<00:35,  7.41it/s, est. speed input: 7747.69 toks/s, output: 7.57 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [01:41<00:34,  7.41it/s, est. speed input: 7746.16 toks/s, output: 7.56 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [01:42<00:33,  7.41it/s, est. speed input: 7744.54 toks/s, output: 7.56 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [01:43<00:31,  7.67it/s, est. speed input: 7751.84 toks/s, output: 7.57 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [01:44<00:30,  7.59it/s, est. speed input: 7750.11 toks/s, output: 7.57 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [01:45<00:29,  7.54it/s, est. speed input: 7748.71 toks/s, output: 7.57 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [01:47<00:28,  7.51it/s, est. speed input: 7747.40 toks/s, output: 7.57 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [01:48<00:27,  7.49it/s, est. speed input: 7745.99 toks/s, output: 7.56 toks/s]
Processed prompts:  81%|████████  | 826/1024 [01:49<00:26,  7.47it/s, est. speed input: 7744.67 toks/s, output: 7.56 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [01:50<00:25,  7.45it/s, est. speed input: 7743.19 toks/s, output: 7.56 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [01:51<00:24,  7.44it/s, est. speed input: 7741.66 toks/s, output: 7.56 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [01:52<00:23,  7.43it/s, est. speed input: 7740.18 toks/s, output: 7.56 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [01:53<00:22,  7.43it/s, est. speed input: 7738.81 toks/s, output: 7.56 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:54<00:21,  7.42it/s, est. speed input: 7737.36 toks/s, output: 7.56 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:55<00:20,  7.42it/s, est. speed input: 7735.94 toks/s, output: 7.55 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:56<00:19,  7.42it/s, est. speed input: 7734.73 toks/s, output: 7.55 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:57<00:18,  7.42it/s, est. speed input: 7733.39 toks/s, output: 7.55 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:58<00:16,  7.41it/s, est. speed input: 7732.02 toks/s, output: 7.55 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:00<00:15,  7.41it/s, est. speed input: 7730.69 toks/s, output: 7.55 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:01<00:14,  7.41it/s, est. speed input: 7729.43 toks/s, output: 7.55 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:02<00:13,  7.42it/s, est. speed input: 7728.56 toks/s, output: 7.55 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:03<00:12,  7.43it/s, est. speed input: 7727.57 toks/s, output: 7.55 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:04<00:11,  7.43it/s, est. speed input: 7726.46 toks/s, output: 7.55 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:05<00:10,  7.42it/s, est. speed input: 7725.27 toks/s, output: 7.54 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:06<00:09,  7.42it/s, est. speed input: 7724.16 toks/s, output: 7.54 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:07<00:08,  7.42it/s, est. speed input: 7722.99 toks/s, output: 7.54 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:08<00:07,  7.41it/s, est. speed input: 7721.87 toks/s, output: 7.54 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:09<00:06,  7.41it/s, est. speed input: 7720.72 toks/s, output: 7.54 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:10<00:05,  7.41it/s, est. speed input: 7719.66 toks/s, output: 7.54 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:11<00:04,  7.41it/s, est. speed input: 7718.57 toks/s, output: 7.54 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:12<00:02,  7.41it/s, est. speed input: 7717.56 toks/s, output: 7.54 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:14<00:01,  7.41it/s, est. speed input: 7716.47 toks/s, output: 7.54 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:14<00:00,  7.68it/s, est. speed input: 7722.75 toks/s, output: 7.54 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:14<00:00,  7.68it/s, est. speed input: 7768.26 toks/s, output: 7.59 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:14<00:00,  7.59it/s, est. speed input: 7768.26 toks/s, output: 7.59 toks/s]
[rank0]:[W126 14:40:16.769512835 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 203.4s

测试结果:
  Requests/s:   7.45
  Tokens/s:     7633.78
  Total Reqs:   1024
  Elapsed:      137.49s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     7626.34

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 14:40:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 14:40:29 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1403297) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1403297) WARNING 01-26 14:41:38 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 1.31 requests/s, 1345.15 total tokens/s, 1.31 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 14:40:29] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:40:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:40:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:40:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:40:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:40:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:40:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:40:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 14:40:33] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 14:40:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:40:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 14:40:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 14:40:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 14:40:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 14:40:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 14:40:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 14:40:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1403297) [2026-01-26 14:40:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1403297) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1403297) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.69s/it]
(EngineCore_DP0 pid=1403297) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.83s/it]
(EngineCore_DP0 pid=1403297) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.81s/it]
(EngineCore_DP0 pid=1403297) 
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1403297) [2026-01-26 14:41:16] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1403297) 2026-01-26 14:41:24,994 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1403297) 2026-01-26 14:41:25,341 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 40/2048 [00:00<00:05, 390.47it/s]
Adding requests:   4%|▍         | 80/2048 [00:00<00:05, 383.59it/s]
Adding requests:   6%|▋         | 128/2048 [00:00<00:04, 424.45it/s]
Adding requests:   9%|▉         | 185/2048 [00:00<00:03, 479.79it/s]
Adding requests:  12%|█▏        | 242/2048 [00:00<00:03, 509.92it/s]
Adding requests:  15%|█▍        | 299/2048 [00:00<00:03, 527.17it/s]
Adding requests:  17%|█▋        | 352/2048 [00:00<00:03, 520.16it/s]
Adding requests:  20%|██        | 411/2048 [00:00<00:03, 540.57it/s]
Adding requests:  23%|██▎       | 469/2048 [00:00<00:02, 549.67it/s]
Adding requests:  26%|██▌       | 532/2048 [00:01<00:02, 572.07it/s]
Adding requests:  29%|██▉       | 590/2048 [00:01<00:02, 542.04it/s]
Adding requests:  32%|███▏      | 646/2048 [00:01<00:02, 544.67it/s]
Adding requests:  34%|███▍      | 703/2048 [00:01<00:02, 549.76it/s]
Adding requests:  37%|███▋      | 759/2048 [00:01<00:02, 544.31it/s]
Adding requests:  40%|███▉      | 814/2048 [00:01<00:02, 531.31it/s]
Adding requests:  42%|████▏     | 868/2048 [00:01<00:03, 384.71it/s]
Adding requests:  45%|████▌     | 923/2048 [00:01<00:02, 421.09it/s]
Adding requests:  48%|████▊     | 974/2048 [00:01<00:02, 441.21it/s]
Adding requests:  50%|█████     | 1030/2048 [00:02<00:02, 470.56it/s]
Adding requests:  53%|█████▎    | 1086/2048 [00:02<00:01, 492.49it/s]
Adding requests:  56%|█████▌    | 1144/2048 [00:02<00:01, 513.89it/s]
Adding requests:  58%|█████▊    | 1198/2048 [00:02<00:01, 510.81it/s]
Adding requests:  61%|██████▏   | 1255/2048 [00:02<00:01, 524.74it/s]
Adding requests:  64%|██████▍   | 1310/2048 [00:02<00:01, 531.14it/s]
Adding requests:  67%|██████▋   | 1368/2048 [00:02<00:01, 544.88it/s]
Adding requests:  70%|██████▉   | 1424/2048 [00:02<00:01, 538.97it/s]
Adding requests:  72%|███████▏  | 1479/2048 [00:02<00:01, 528.22it/s]
Adding requests:  75%|███████▌  | 1536/2048 [00:03<00:00, 538.19it/s]
Adding requests:  78%|███████▊  | 1592/2048 [00:03<00:00, 541.45it/s]
Adding requests:  80%|████████  | 1647/2048 [00:03<00:00, 530.64it/s]
Adding requests:  83%|████████▎ | 1701/2048 [00:03<00:00, 518.13it/s]
Adding requests:  86%|████████▌ | 1759/2048 [00:03<00:00, 533.16it/s]
Adding requests:  89%|████████▊ | 1816/2048 [00:03<00:00, 543.40it/s]
Adding requests:  91%|█████████▏| 1873/2048 [00:03<00:00, 550.59it/s]
Adding requests:  94%|█████████▍| 1929/2048 [00:03<00:00, 540.80it/s]
Adding requests:  97%|█████████▋| 1986/2048 [00:03<00:00, 548.35it/s]
Adding requests: 100%|█████████▉| 2041/2048 [00:03<00:00, 532.79it/s]
Adding requests: 100%|██████████| 2048/2048 [00:03<00:00, 514.25it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 2/2048 [00:08<2:22:29,  4.18s/it, est. speed input: 245.05 toks/s, output: 0.24 toks/s]
Processed prompts:   1%|          | 18/2048 [00:20<34:54,  1.03s/it, est. speed input: 901.01 toks/s, output: 0.88 toks/s] 
Processed prompts:   2%|▏         | 34/2048 [00:32<29:22,  1.14it/s, est. speed input: 1069.42 toks/s, output: 1.04 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:44<27:22,  1.22it/s, est. speed input: 1146.42 toks/s, output: 1.12 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:56<26:18,  1.26it/s, est. speed input: 1190.86 toks/s, output: 1.16 toks/s]
Processed prompts:   4%|▍         | 82/2048 [01:08<25:36,  1.28it/s, est. speed input: 1219.63 toks/s, output: 1.19 toks/s]
Processed prompts:   5%|▍         | 98/2048 [01:20<25:07,  1.29it/s, est. speed input: 1239.69 toks/s, output: 1.21 toks/s]
Processed prompts:   6%|▌         | 114/2048 [01:33<24:44,  1.30it/s, est. speed input: 1254.67 toks/s, output: 1.23 toks/s]
Processed prompts:   6%|▋         | 130/2048 [01:45<24:25,  1.31it/s, est. speed input: 1266.16 toks/s, output: 1.24 toks/s]
Processed prompts:   7%|▋         | 146/2048 [01:57<24:08,  1.31it/s, est. speed input: 1275.26 toks/s, output: 1.25 toks/s]
Processed prompts:   8%|▊         | 162/2048 [02:09<23:53,  1.32it/s, est. speed input: 1282.63 toks/s, output: 1.25 toks/s]
Processed prompts:   9%|▊         | 178/2048 [02:21<23:38,  1.32it/s, est. speed input: 1288.75 toks/s, output: 1.26 toks/s]
Processed prompts:   9%|▉         | 194/2048 [02:34<23:56,  1.29it/s, est. speed input: 1286.40 toks/s, output: 1.26 toks/s]
Processed prompts:  10%|█         | 210/2048 [02:46<23:33,  1.30it/s, est. speed input: 1291.38 toks/s, output: 1.26 toks/s]
Processed prompts:  11%|█         | 226/2048 [02:58<23:14,  1.31it/s, est. speed input: 1295.66 toks/s, output: 1.27 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [03:10<22:56,  1.31it/s, est. speed input: 1299.38 toks/s, output: 1.27 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [03:22<22:41,  1.32it/s, est. speed input: 1302.71 toks/s, output: 1.27 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [03:34<22:26,  1.32it/s, est. speed input: 1305.60 toks/s, output: 1.27 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [03:46<22:12,  1.32it/s, est. speed input: 1308.24 toks/s, output: 1.28 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [03:59<22:28,  1.29it/s, est. speed input: 1305.75 toks/s, output: 1.28 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [04:12<22:06,  1.30it/s, est. speed input: 1308.11 toks/s, output: 1.28 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [04:24<21:47,  1.31it/s, est. speed input: 1310.26 toks/s, output: 1.28 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [04:36<21:30,  1.31it/s, est. speed input: 1312.23 toks/s, output: 1.28 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [04:48<21:15,  1.32it/s, est. speed input: 1313.98 toks/s, output: 1.28 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [05:00<21:01,  1.32it/s, est. speed input: 1315.63 toks/s, output: 1.28 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [05:12<20:47,  1.32it/s, est. speed input: 1317.19 toks/s, output: 1.29 toks/s]
Processed prompts:  20%|██        | 418/2048 [05:24<20:33,  1.32it/s, est. speed input: 1318.62 toks/s, output: 1.29 toks/s]
Processed prompts:  21%|██        | 434/2048 [05:37<20:48,  1.29it/s, est. speed input: 1316.45 toks/s, output: 1.29 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [05:49<20:27,  1.30it/s, est. speed input: 1317.81 toks/s, output: 1.29 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [06:01<20:09,  1.31it/s, est. speed input: 1319.04 toks/s, output: 1.29 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [06:13<19:52,  1.31it/s, est. speed input: 1320.25 toks/s, output: 1.29 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [06:25<19:37,  1.32it/s, est. speed input: 1321.37 toks/s, output: 1.29 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [06:38<19:23,  1.32it/s, est. speed input: 1322.42 toks/s, output: 1.29 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [06:50<19:09,  1.32it/s, est. speed input: 1323.42 toks/s, output: 1.29 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [07:02<18:56,  1.32it/s, est. speed input: 1324.34 toks/s, output: 1.29 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [07:14<18:43,  1.32it/s, est. speed input: 1325.23 toks/s, output: 1.29 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [07:26<18:30,  1.32it/s, est. speed input: 1326.10 toks/s, output: 1.30 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [07:38<18:18,  1.32it/s, est. speed input: 1326.91 toks/s, output: 1.30 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [07:50<18:06,  1.32it/s, est. speed input: 1327.64 toks/s, output: 1.30 toks/s]
Processed prompts:  31%|███       | 626/2048 [08:02<17:53,  1.32it/s, est. speed input: 1328.36 toks/s, output: 1.30 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [08:14<17:41,  1.32it/s, est. speed input: 1329.04 toks/s, output: 1.30 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [08:26<17:29,  1.32it/s, est. speed input: 1329.68 toks/s, output: 1.30 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [08:38<17:17,  1.32it/s, est. speed input: 1330.33 toks/s, output: 1.30 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [08:50<17:05,  1.32it/s, est. speed input: 1330.91 toks/s, output: 1.30 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [09:02<16:53,  1.32it/s, est. speed input: 1331.47 toks/s, output: 1.30 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [09:15<16:41,  1.32it/s, est. speed input: 1332.00 toks/s, output: 1.30 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [09:27<16:29,  1.32it/s, est. speed input: 1332.52 toks/s, output: 1.30 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [09:39<16:17,  1.32it/s, est. speed input: 1333.01 toks/s, output: 1.30 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [09:51<16:04,  1.32it/s, est. speed input: 1333.50 toks/s, output: 1.30 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [10:04<16:13,  1.30it/s, est. speed input: 1332.01 toks/s, output: 1.30 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [10:16<15:54,  1.30it/s, est. speed input: 1332.50 toks/s, output: 1.30 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [10:28<15:38,  1.31it/s, est. speed input: 1332.97 toks/s, output: 1.30 toks/s]
Processed prompts:  41%|████      | 834/2048 [10:40<15:23,  1.31it/s, est. speed input: 1333.41 toks/s, output: 1.30 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [10:52<15:08,  1.32it/s, est. speed input: 1333.85 toks/s, output: 1.30 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [11:04<14:55,  1.32it/s, est. speed input: 1334.26 toks/s, output: 1.30 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [11:16<14:42,  1.32it/s, est. speed input: 1334.65 toks/s, output: 1.30 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [11:28<14:29,  1.32it/s, est. speed input: 1335.03 toks/s, output: 1.30 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [11:40<14:17,  1.32it/s, est. speed input: 1335.39 toks/s, output: 1.30 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [11:52<14:04,  1.32it/s, est. speed input: 1335.74 toks/s, output: 1.30 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [12:05<13:52,  1.32it/s, est. speed input: 1336.11 toks/s, output: 1.30 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [12:17<13:40,  1.32it/s, est. speed input: 1336.43 toks/s, output: 1.31 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [12:29<13:28,  1.32it/s, est. speed input: 1336.74 toks/s, output: 1.31 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [12:41<13:15,  1.32it/s, est. speed input: 1337.07 toks/s, output: 1.31 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [12:53<13:03,  1.32it/s, est. speed input: 1337.37 toks/s, output: 1.31 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [13:05<12:51,  1.32it/s, est. speed input: 1337.65 toks/s, output: 1.31 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [13:17<12:39,  1.32it/s, est. speed input: 1337.94 toks/s, output: 1.31 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [13:29<12:27,  1.32it/s, est. speed input: 1338.20 toks/s, output: 1.31 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [13:41<12:15,  1.32it/s, est. speed input: 1338.48 toks/s, output: 1.31 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [13:53<12:03,  1.32it/s, est. speed input: 1338.73 toks/s, output: 1.31 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [14:05<11:51,  1.32it/s, est. speed input: 1338.99 toks/s, output: 1.31 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [14:17<11:39,  1.32it/s, est. speed input: 1339.24 toks/s, output: 1.31 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [14:29<11:26,  1.32it/s, est. speed input: 1339.49 toks/s, output: 1.31 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [14:42<11:14,  1.32it/s, est. speed input: 1339.72 toks/s, output: 1.31 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [14:54<11:02,  1.32it/s, est. speed input: 1339.94 toks/s, output: 1.31 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [15:06<10:50,  1.33it/s, est. speed input: 1340.18 toks/s, output: 1.31 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [15:19<10:52,  1.30it/s, est. speed input: 1339.09 toks/s, output: 1.31 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [15:31<10:36,  1.30it/s, est. speed input: 1339.32 toks/s, output: 1.31 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [15:44<10:34,  1.28it/s, est. speed input: 1338.28 toks/s, output: 1.31 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [15:56<10:16,  1.29it/s, est. speed input: 1338.51 toks/s, output: 1.31 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [16:08<09:59,  1.30it/s, est. speed input: 1338.74 toks/s, output: 1.31 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [16:20<09:44,  1.31it/s, est. speed input: 1338.97 toks/s, output: 1.31 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [16:32<09:30,  1.31it/s, est. speed input: 1339.19 toks/s, output: 1.31 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [16:44<09:16,  1.32it/s, est. speed input: 1339.40 toks/s, output: 1.31 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [16:57<09:16,  1.29it/s, est. speed input: 1338.42 toks/s, output: 1.31 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [17:09<08:59,  1.30it/s, est. speed input: 1338.64 toks/s, output: 1.31 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [17:21<08:44,  1.31it/s, est. speed input: 1338.85 toks/s, output: 1.31 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [17:33<08:30,  1.31it/s, est. speed input: 1339.06 toks/s, output: 1.31 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [17:45<08:16,  1.32it/s, est. speed input: 1339.27 toks/s, output: 1.31 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [17:57<08:03,  1.32it/s, est. speed input: 1339.48 toks/s, output: 1.31 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [18:09<07:50,  1.32it/s, est. speed input: 1339.67 toks/s, output: 1.31 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [18:22<07:48,  1.29it/s, est. speed input: 1338.78 toks/s, output: 1.31 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [18:35<07:42,  1.28it/s, est. speed input: 1337.90 toks/s, output: 1.31 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [18:47<07:24,  1.29it/s, est. speed input: 1338.11 toks/s, output: 1.31 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [19:00<07:09,  1.30it/s, est. speed input: 1338.30 toks/s, output: 1.31 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [19:12<06:54,  1.31it/s, est. speed input: 1338.49 toks/s, output: 1.31 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [19:25<06:49,  1.28it/s, est. speed input: 1337.67 toks/s, output: 1.31 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [19:37<06:33,  1.30it/s, est. speed input: 1337.85 toks/s, output: 1.31 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [19:50<06:26,  1.28it/s, est. speed input: 1337.05 toks/s, output: 1.31 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [20:02<06:10,  1.29it/s, est. speed input: 1337.26 toks/s, output: 1.31 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [20:14<05:55,  1.30it/s, est. speed input: 1337.45 toks/s, output: 1.31 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [20:26<05:40,  1.31it/s, est. speed input: 1337.64 toks/s, output: 1.31 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [20:39<05:34,  1.28it/s, est. speed input: 1336.85 toks/s, output: 1.31 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [20:51<05:19,  1.30it/s, est. speed input: 1337.05 toks/s, output: 1.31 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [21:03<05:04,  1.31it/s, est. speed input: 1337.25 toks/s, output: 1.31 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [21:15<04:51,  1.31it/s, est. speed input: 1337.44 toks/s, output: 1.31 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [21:27<04:38,  1.32it/s, est. speed input: 1337.61 toks/s, output: 1.31 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [21:39<04:25,  1.32it/s, est. speed input: 1337.80 toks/s, output: 1.31 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [21:51<04:12,  1.32it/s, est. speed input: 1337.98 toks/s, output: 1.31 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [22:04<04:05,  1.29it/s, est. speed input: 1337.26 toks/s, output: 1.31 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [22:16<03:51,  1.31it/s, est. speed input: 1337.58 toks/s, output: 1.31 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [22:28<03:37,  1.31it/s, est. speed input: 1337.74 toks/s, output: 1.31 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [22:40<03:25,  1.32it/s, est. speed input: 1337.92 toks/s, output: 1.31 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [22:52<03:12,  1.32it/s, est. speed input: 1338.08 toks/s, output: 1.31 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [23:04<03:00,  1.32it/s, est. speed input: 1338.25 toks/s, output: 1.31 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [23:17<02:47,  1.32it/s, est. speed input: 1338.41 toks/s, output: 1.31 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [23:29<02:35,  1.32it/s, est. speed input: 1338.56 toks/s, output: 1.31 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [23:41<02:23,  1.32it/s, est. speed input: 1338.72 toks/s, output: 1.31 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [23:53<02:11,  1.32it/s, est. speed input: 1338.87 toks/s, output: 1.31 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [24:06<02:01,  1.30it/s, est. speed input: 1338.20 toks/s, output: 1.31 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [24:18<01:48,  1.30it/s, est. speed input: 1338.35 toks/s, output: 1.31 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [24:30<01:36,  1.31it/s, est. speed input: 1338.50 toks/s, output: 1.31 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [24:42<01:23,  1.31it/s, est. speed input: 1338.65 toks/s, output: 1.31 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [24:54<01:11,  1.32it/s, est. speed input: 1338.80 toks/s, output: 1.31 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [25:06<00:59,  1.32it/s, est. speed input: 1338.94 toks/s, output: 1.31 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [25:19<00:47,  1.29it/s, est. speed input: 1338.29 toks/s, output: 1.31 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [25:31<00:35,  1.30it/s, est. speed input: 1338.45 toks/s, output: 1.31 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [25:43<00:22,  1.31it/s, est. speed input: 1338.59 toks/s, output: 1.31 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [25:56<00:10,  1.29it/s, est. speed input: 1338.07 toks/s, output: 1.31 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [25:56<00:00,  1.29it/s, est. speed input: 1347.28 toks/s, output: 1.32 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [25:56<00:00,  1.32it/s, est. speed input: 1347.28 toks/s, output: 1.32 toks/s]
[rank0]:[W126 15:07:38.165496798 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 1642.3s

测试结果:
  Requests/s:   1.31
  Tokens/s:     1345.15
  Total Reqs:   2048
  Elapsed:      1560.57s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     1343.84

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:07:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:07:59 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1426261) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1426261) WARNING 01-26 15:09:02 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.59 requests/s, 7776.51 total tokens/s, 7.59 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 15:07:58] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:07:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:07:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:07:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:07:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:07:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:07:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:07:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:07:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:08:02] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:08:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:08:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:08:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:08:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:08:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:08:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:08:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:08:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:03] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1426261) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1426261) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.61s/it]
(EngineCore_DP0 pid=1426261) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.77s/it]
(EngineCore_DP0 pid=1426261) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.74s/it]
(EngineCore_DP0 pid=1426261) 
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1426261) [2026-01-26 15:08:45] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1426261) 2026-01-26 15:08:55,724 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1426261) 2026-01-26 15:08:56,458 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 41/4096 [00:00<00:10, 395.49it/s]
Adding requests:   2%|▏         | 81/4096 [00:00<00:10, 385.42it/s]
Adding requests:   3%|▎         | 120/4096 [00:00<00:10, 380.68it/s]
Adding requests:   4%|▍         | 160/4096 [00:00<00:10, 385.64it/s]
Adding requests:   5%|▍         | 204/4096 [00:00<00:09, 403.70it/s]
Adding requests:   6%|▌         | 248/4096 [00:00<00:09, 412.50it/s]
Adding requests:   7%|▋         | 290/4096 [00:00<00:09, 414.85it/s]
Adding requests:   8%|▊         | 336/4096 [00:00<00:08, 426.88it/s]
Adding requests:   9%|▉         | 381/4096 [00:00<00:08, 433.14it/s]
Adding requests:  10%|█         | 427/4096 [00:01<00:08, 440.23it/s]
Adding requests:  12%|█▏        | 472/4096 [00:01<00:08, 442.76it/s]
Adding requests:  13%|█▎        | 519/4096 [00:01<00:07, 449.72it/s]
Adding requests:  14%|█▍        | 567/4096 [00:01<00:07, 458.06it/s]
Adding requests:  15%|█▍        | 613/4096 [00:01<00:07, 445.99it/s]
Adding requests:  16%|█▌        | 658/4096 [00:01<00:07, 436.47it/s]
Adding requests:  17%|█▋        | 706/4096 [00:01<00:07, 447.06it/s]
Adding requests:  18%|█▊        | 751/4096 [00:01<00:07, 433.76it/s]
Adding requests:  19%|█▉        | 795/4096 [00:01<00:07, 427.59it/s]
Adding requests:  20%|██        | 838/4096 [00:01<00:07, 427.08it/s]
Adding requests:  22%|██▏       | 881/4096 [00:02<00:07, 424.38it/s]
Adding requests:  23%|██▎       | 924/4096 [00:02<00:07, 412.33it/s]
Adding requests:  24%|██▎       | 966/4096 [00:02<00:07, 410.27it/s]
Adding requests:  25%|██▍       | 1008/4096 [00:02<00:07, 409.54it/s]
Adding requests:  26%|██▌       | 1049/4096 [00:02<00:07, 406.70it/s]
Adding requests:  27%|██▋       | 1090/4096 [00:02<00:07, 404.22it/s]
Adding requests:  28%|██▊       | 1136/4096 [00:02<00:07, 418.54it/s]
Adding requests:  29%|██▉       | 1178/4096 [00:02<00:07, 410.51it/s]
Adding requests:  30%|██▉       | 1220/4096 [00:02<00:07, 393.14it/s]
Adding requests:  31%|███       | 1263/4096 [00:03<00:07, 402.38it/s]
Adding requests:  32%|███▏      | 1304/4096 [00:03<00:06, 401.08it/s]
Adding requests:  33%|███▎      | 1347/4096 [00:03<00:06, 408.75it/s]
Adding requests:  34%|███▍      | 1390/4096 [00:03<00:06, 414.68it/s]
Adding requests:  35%|███▍      | 1432/4096 [00:03<00:06, 410.58it/s]
Adding requests:  36%|███▌      | 1476/4096 [00:03<00:06, 416.36it/s]
Adding requests:  37%|███▋      | 1519/4096 [00:03<00:06, 415.82it/s]
Adding requests:  38%|███▊      | 1562/4096 [00:03<00:06, 418.07it/s]
Adding requests:  39%|███▉      | 1604/4096 [00:03<00:06, 406.64it/s]
Adding requests:  40%|████      | 1645/4096 [00:03<00:06, 388.70it/s]
Adding requests:  41%|████      | 1688/4096 [00:04<00:06, 396.57it/s]
Adding requests:  42%|████▏     | 1728/4096 [00:04<00:05, 395.98it/s]
Adding requests:  43%|████▎     | 1774/4096 [00:04<00:05, 412.49it/s]
Adding requests:  44%|████▍     | 1816/4096 [00:04<00:05, 409.48it/s]
Adding requests:  45%|████▌     | 1858/4096 [00:04<00:05, 410.05it/s]
Adding requests:  46%|████▋     | 1900/4096 [00:04<00:05, 403.76it/s]
Adding requests:  47%|████▋     | 1945/4096 [00:04<00:05, 415.07it/s]
Adding requests:  49%|████▊     | 1987/4096 [00:04<00:05, 411.19it/s]
Adding requests:  50%|████▉     | 2029/4096 [00:04<00:05, 399.86it/s]
Adding requests:  51%|█████     | 2070/4096 [00:04<00:05, 401.47it/s]
Adding requests:  52%|█████▏    | 2112/4096 [00:05<00:04, 406.31it/s]
Adding requests:  53%|█████▎    | 2153/4096 [00:05<00:04, 404.88it/s]
Adding requests:  54%|█████▎    | 2194/4096 [00:05<00:04, 404.10it/s]
Adding requests:  55%|█████▍    | 2237/4096 [00:05<00:04, 411.71it/s]
Adding requests:  56%|█████▌    | 2281/4096 [00:05<00:04, 418.14it/s]
Adding requests:  57%|█████▋    | 2323/4096 [00:05<00:04, 417.63it/s]
Adding requests:  58%|█████▊    | 2366/4096 [00:05<00:04, 420.70it/s]
Adding requests:  59%|█████▉    | 2409/4096 [00:05<00:04, 418.61it/s]
Adding requests:  60%|█████▉    | 2451/4096 [00:05<00:04, 393.77it/s]
Adding requests:  61%|██████    | 2494/4096 [00:06<00:03, 401.61it/s]
Adding requests:  62%|██████▏   | 2537/4096 [00:06<00:03, 409.58it/s]
Adding requests:  63%|██████▎   | 2582/4096 [00:06<00:03, 419.31it/s]
Adding requests:  64%|██████▍   | 2625/4096 [00:06<00:03, 417.49it/s]
Adding requests:  65%|██████▌   | 2667/4096 [00:06<00:03, 413.02it/s]
Adding requests:  66%|██████▌   | 2709/4096 [00:06<00:03, 409.95it/s]
Adding requests:  67%|██████▋   | 2752/4096 [00:06<00:03, 415.61it/s]
Adding requests:  68%|██████▊   | 2798/4096 [00:06<00:03, 428.00it/s]
Adding requests:  69%|██████▉   | 2841/4096 [00:06<00:02, 427.92it/s]
Adding requests:  70%|███████   | 2884/4096 [00:06<00:02, 424.12it/s]
Adding requests:  71%|███████▏  | 2927/4096 [00:07<00:02, 420.35it/s]
Adding requests:  73%|███████▎  | 2972/4096 [00:07<00:02, 426.51it/s]
Adding requests:  74%|███████▎  | 3016/4096 [00:07<00:02, 426.81it/s]
Adding requests:  75%|███████▍  | 3060/4096 [00:07<00:02, 429.45it/s]
Adding requests:  76%|███████▌  | 3103/4096 [00:07<00:02, 427.18it/s]
Adding requests:  77%|███████▋  | 3147/4096 [00:07<00:02, 427.34it/s]
Adding requests:  78%|███████▊  | 3192/4096 [00:07<00:02, 432.62it/s]
Adding requests:  79%|███████▉  | 3236/4096 [00:07<00:01, 431.78it/s]
Adding requests:  80%|████████  | 3280/4096 [00:07<00:01, 415.66it/s]
Adding requests:  81%|████████  | 3323/4096 [00:07<00:01, 417.40it/s]
Adding requests:  82%|████████▏ | 3365/4096 [00:08<00:01, 405.58it/s]
Adding requests:  83%|████████▎ | 3410/4096 [00:08<00:01, 415.86it/s]
Adding requests:  84%|████████▍ | 3454/4096 [00:08<00:01, 420.38it/s]
Adding requests:  85%|████████▌ | 3497/4096 [00:08<00:01, 417.19it/s]
Adding requests:  87%|████████▋ | 3544/4096 [00:08<00:01, 429.46it/s]
Adding requests:  88%|████████▊ | 3588/4096 [00:08<00:01, 422.88it/s]
Adding requests:  89%|████████▊ | 3634/4096 [00:08<00:01, 430.58it/s]
Adding requests:  90%|████████▉ | 3678/4096 [00:08<00:00, 427.11it/s]
Adding requests:  91%|█████████ | 3722/4096 [00:08<00:00, 428.31it/s]
Adding requests:  92%|█████████▏| 3766/4096 [00:09<00:00, 430.93it/s]
Adding requests:  93%|█████████▎| 3810/4096 [00:09<00:00, 396.76it/s]
Adding requests:  94%|█████████▍| 3851/4096 [00:09<00:00, 398.48it/s]
Adding requests:  95%|█████████▌| 3896/4096 [00:09<00:00, 412.88it/s]
Adding requests:  96%|█████████▌| 3938/4096 [00:09<00:00, 404.17it/s]
Adding requests:  97%|█████████▋| 3982/4096 [00:09<00:00, 413.59it/s]
Adding requests:  98%|█████████▊| 4026/4096 [00:09<00:00, 417.45it/s]
Adding requests:  99%|█████████▉| 4069/4096 [00:09<00:00, 420.70it/s]
Adding requests: 100%|██████████| 4096/4096 [00:09<00:00, 416.18it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:03<03:05, 21.69it/s, est. speed input: 22207.17 toks/s, output: 21.69 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:07<05:24, 12.30it/s, est. speed input: 13803.87 toks/s, output: 13.48 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:11<06:37,  9.99it/s, est. speed input: 11572.12 toks/s, output: 11.30 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:15<07:17,  8.99it/s, est. speed input: 10540.36 toks/s, output: 10.29 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:19<07:38,  8.51it/s, est. speed input: 9977.13 toks/s, output: 9.74 toks/s]  
Processed prompts:   6%|▌         | 226/4096 [00:24<07:53,  8.17it/s, est. speed input: 9581.00 toks/s, output: 9.36 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:28<08:02,  7.96it/s, est. speed input: 9303.29 toks/s, output: 9.09 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:32<08:01,  7.90it/s, est. speed input: 9131.79 toks/s, output: 8.92 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:36<08:04,  7.78it/s, est. speed input: 8967.19 toks/s, output: 8.76 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:41<08:05,  7.70it/s, est. speed input: 8836.44 toks/s, output: 8.63 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:45<08:05,  7.65it/s, est. speed input: 8730.84 toks/s, output: 8.53 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:49<07:59,  7.68it/s, est. speed input: 8663.22 toks/s, output: 8.46 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:53<07:59,  7.61it/s, est. speed input: 8580.50 toks/s, output: 8.38 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:57<07:56,  7.58it/s, est. speed input: 8516.18 toks/s, output: 8.32 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:02<07:53,  7.57it/s, est. speed input: 8461.23 toks/s, output: 8.26 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:06<07:49,  7.55it/s, est. speed input: 8413.05 toks/s, output: 8.22 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:10<07:46,  7.55it/s, est. speed input: 8371.20 toks/s, output: 8.17 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:14<07:42,  7.54it/s, est. speed input: 8333.85 toks/s, output: 8.14 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:19<07:38,  7.54it/s, est. speed input: 8300.15 toks/s, output: 8.11 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:23<07:34,  7.54it/s, est. speed input: 8270.07 toks/s, output: 8.08 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:27<07:30,  7.53it/s, est. speed input: 8241.88 toks/s, output: 8.05 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:31<07:26,  7.53it/s, est. speed input: 8217.26 toks/s, output: 8.02 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:36<07:18,  7.59it/s, est. speed input: 8204.06 toks/s, output: 8.01 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:40<07:15,  7.57it/s, est. speed input: 8182.80 toks/s, output: 7.99 toks/s]
Processed prompts:  20%|██        | 834/4096 [01:44<07:11,  7.56it/s, est. speed input: 8163.73 toks/s, output: 7.97 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:48<07:08,  7.54it/s, est. speed input: 8145.41 toks/s, output: 7.95 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [01:53<07:04,  7.54it/s, est. speed input: 8128.74 toks/s, output: 7.94 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:57<07:00,  7.53it/s, est. speed input: 8113.02 toks/s, output: 7.92 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:01<06:56,  7.53it/s, est. speed input: 8099.36 toks/s, output: 7.91 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:05<06:51,  7.53it/s, est. speed input: 8086.21 toks/s, output: 7.90 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:10<06:47,  7.53it/s, est. speed input: 8073.76 toks/s, output: 7.88 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:14<06:43,  7.53it/s, est. speed input: 8062.37 toks/s, output: 7.87 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:18<06:39,  7.53it/s, est. speed input: 8051.58 toks/s, output: 7.86 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:22<06:35,  7.53it/s, est. speed input: 8041.30 toks/s, output: 7.85 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:27<06:30,  7.53it/s, est. speed input: 8031.34 toks/s, output: 7.84 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:31<06:24,  7.57it/s, est. speed input: 8026.47 toks/s, output: 7.84 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:35<06:17,  7.62it/s, est. speed input: 8023.57 toks/s, output: 7.84 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:39<06:15,  7.59it/s, est. speed input: 8014.77 toks/s, output: 7.83 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [02:43<06:11,  7.56it/s, est. speed input: 8006.52 toks/s, output: 7.82 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [02:48<06:05,  7.61it/s, est. speed input: 8004.19 toks/s, output: 7.82 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [02:52<06:02,  7.58it/s, est. speed input: 7996.65 toks/s, output: 7.81 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [02:56<05:59,  7.57it/s, est. speed input: 7989.72 toks/s, output: 7.80 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:00<05:56,  7.54it/s, est. speed input: 7982.10 toks/s, output: 7.80 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:04<05:46,  7.66it/s, est. speed input: 7985.68 toks/s, output: 7.80 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:09<05:44,  7.62it/s, est. speed input: 7979.50 toks/s, output: 7.79 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:13<05:38,  7.65it/s, est. speed input: 7978.05 toks/s, output: 7.79 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:17<05:33,  7.68it/s, est. speed input: 7977.14 toks/s, output: 7.79 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:21<05:31,  7.63it/s, est. speed input: 7970.92 toks/s, output: 7.78 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [03:25<05:25,  7.66it/s, est. speed input: 7969.71 toks/s, output: 7.78 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:30<05:23,  7.61it/s, est. speed input: 7964.06 toks/s, output: 7.78 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:34<05:21,  7.57it/s, est. speed input: 7957.76 toks/s, output: 7.77 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [03:38<05:17,  7.55it/s, est. speed input: 7952.78 toks/s, output: 7.77 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [03:42<05:05,  7.74it/s, est. speed input: 7961.07 toks/s, output: 7.77 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [03:46<05:03,  7.68it/s, est. speed input: 7956.38 toks/s, output: 7.77 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [03:51<05:01,  7.63it/s, est. speed input: 7951.89 toks/s, output: 7.77 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [03:55<04:58,  7.60it/s, est. speed input: 7947.49 toks/s, output: 7.76 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [03:59<04:55,  7.58it/s, est. speed input: 7943.30 toks/s, output: 7.76 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:03<04:49,  7.62it/s, est. speed input: 7942.81 toks/s, output: 7.76 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:07<04:46,  7.59it/s, est. speed input: 7938.40 toks/s, output: 7.75 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:12<04:43,  7.57it/s, est. speed input: 7934.39 toks/s, output: 7.75 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [04:16<04:37,  7.61it/s, est. speed input: 7934.01 toks/s, output: 7.75 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [04:20<04:33,  7.59it/s, est. speed input: 7930.15 toks/s, output: 7.74 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [04:24<04:25,  7.70it/s, est. speed input: 7933.64 toks/s, output: 7.75 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [04:28<04:23,  7.65it/s, est. speed input: 7930.10 toks/s, output: 7.74 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [04:33<04:20,  7.61it/s, est. speed input: 7926.55 toks/s, output: 7.74 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [04:37<04:17,  7.56it/s, est. speed input: 7922.12 toks/s, output: 7.74 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [04:41<04:11,  7.61it/s, est. speed input: 7921.99 toks/s, output: 7.74 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [04:45<04:08,  7.59it/s, est. speed input: 7918.88 toks/s, output: 7.73 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [04:50<04:05,  7.57it/s, est. speed input: 7915.59 toks/s, output: 7.73 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [04:54<04:01,  7.55it/s, est. speed input: 7912.49 toks/s, output: 7.73 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [04:58<03:57,  7.54it/s, est. speed input: 7909.50 toks/s, output: 7.72 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:02<03:51,  7.59it/s, est. speed input: 7909.39 toks/s, output: 7.72 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [05:06<03:47,  7.57it/s, est. speed input: 7906.60 toks/s, output: 7.72 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [05:11<03:44,  7.56it/s, est. speed input: 7903.66 toks/s, output: 7.72 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [05:15<03:40,  7.55it/s, est. speed input: 7900.95 toks/s, output: 7.72 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [05:19<03:36,  7.54it/s, est. speed input: 7898.22 toks/s, output: 7.71 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [05:23<03:32,  7.53it/s, est. speed input: 7895.52 toks/s, output: 7.71 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [05:28<03:26,  7.58it/s, est. speed input: 7895.57 toks/s, output: 7.71 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [05:32<03:22,  7.57it/s, est. speed input: 7893.16 toks/s, output: 7.71 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [05:36<03:17,  7.61it/s, est. speed input: 7893.40 toks/s, output: 7.71 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [05:40<03:13,  7.59it/s, est. speed input: 7891.13 toks/s, output: 7.71 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [05:44<03:08,  7.63it/s, est. speed input: 7891.35 toks/s, output: 7.71 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [05:49<03:05,  7.60it/s, est. speed input: 7889.03 toks/s, output: 7.70 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [05:53<03:00,  7.63it/s, est. speed input: 7889.23 toks/s, output: 7.70 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [05:57<02:56,  7.60it/s, est. speed input: 7887.10 toks/s, output: 7.70 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [06:01<02:52,  7.58it/s, est. speed input: 7884.93 toks/s, output: 7.70 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [06:06<02:49,  7.56it/s, est. speed input: 7882.85 toks/s, output: 7.70 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [06:10<02:45,  7.55it/s, est. speed input: 7880.78 toks/s, output: 7.70 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [06:14<02:36,  7.74it/s, est. speed input: 7886.27 toks/s, output: 7.70 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [06:18<02:32,  7.74it/s, est. speed input: 7886.69 toks/s, output: 7.70 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [06:22<02:29,  7.67it/s, est. speed input: 7884.69 toks/s, output: 7.70 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [06:26<02:25,  7.69it/s, est. speed input: 7885.07 toks/s, output: 7.70 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [06:30<02:22,  7.64it/s, est. speed input: 7883.17 toks/s, output: 7.70 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [06:35<02:18,  7.60it/s, est. speed input: 7881.16 toks/s, output: 7.70 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [06:39<02:14,  7.58it/s, est. speed input: 7879.28 toks/s, output: 7.69 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [06:43<02:10,  7.56it/s, est. speed input: 7877.49 toks/s, output: 7.69 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [06:48<02:06,  7.55it/s, est. speed input: 7875.53 toks/s, output: 7.69 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [06:52<02:01,  7.60it/s, est. speed input: 7875.84 toks/s, output: 7.69 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [06:56<01:57,  7.58it/s, est. speed input: 7874.11 toks/s, output: 7.69 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [07:00<01:54,  7.56it/s, est. speed input: 7872.38 toks/s, output: 7.69 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [07:04<01:49,  7.55it/s, est. speed input: 7870.64 toks/s, output: 7.69 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [07:09<01:45,  7.54it/s, est. speed input: 7868.87 toks/s, output: 7.68 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [07:13<01:41,  7.53it/s, est. speed input: 7867.22 toks/s, output: 7.68 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [07:17<01:37,  7.53it/s, est. speed input: 7865.64 toks/s, output: 7.68 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [07:21<01:32,  7.57it/s, est. speed input: 7865.60 toks/s, output: 7.68 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [07:26<01:28,  7.56it/s, est. speed input: 7864.05 toks/s, output: 7.68 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [07:30<01:24,  7.55it/s, est. speed input: 7862.47 toks/s, output: 7.68 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [07:34<01:20,  7.54it/s, est. speed input: 7861.18 toks/s, output: 7.68 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [07:38<01:16,  7.54it/s, est. speed input: 7859.69 toks/s, output: 7.68 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [07:43<01:11,  7.59it/s, est. speed input: 7860.20 toks/s, output: 7.68 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [07:47<01:07,  7.58it/s, est. speed input: 7858.87 toks/s, output: 7.67 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [07:51<01:02,  7.61it/s, est. speed input: 7859.06 toks/s, output: 7.67 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [07:55<00:58,  7.59it/s, est. speed input: 7857.68 toks/s, output: 7.67 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [07:59<00:53,  7.70it/s, est. speed input: 7860.31 toks/s, output: 7.68 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [08:03<00:49,  7.64it/s, est. speed input: 7858.87 toks/s, output: 7.67 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [08:08<00:46,  7.61it/s, est. speed input: 7857.54 toks/s, output: 7.67 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [08:12<00:41,  7.58it/s, est. speed input: 7856.21 toks/s, output: 7.67 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [08:16<00:37,  7.57it/s, est. speed input: 7854.95 toks/s, output: 7.67 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [08:20<00:33,  7.55it/s, est. speed input: 7853.58 toks/s, output: 7.67 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [08:25<00:29,  7.54it/s, est. speed input: 7852.20 toks/s, output: 7.67 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [08:29<00:25,  7.60it/s, est. speed input: 7852.80 toks/s, output: 7.67 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [08:33<00:20,  7.63it/s, est. speed input: 7853.21 toks/s, output: 7.67 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [08:37<00:16,  7.60it/s, est. speed input: 7851.97 toks/s, output: 7.67 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [08:41<00:12,  7.64it/s, est. speed input: 7852.53 toks/s, output: 7.67 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [08:46<00:08,  7.67it/s, est. speed input: 7852.99 toks/s, output: 7.67 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [08:50<00:03,  7.75it/s, est. speed input: 7855.26 toks/s, output: 7.67 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [08:50<00:00,  7.75it/s, est. speed input: 7913.21 toks/s, output: 7.73 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [08:50<00:00,  7.73it/s, est. speed input: 7913.21 toks/s, output: 7.73 toks/s]
[rank0]:[W126 15:18:02.605997461 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 623.5s

测试结果:
  Requests/s:   7.59
  Tokens/s:     7776.51
  Total Reqs:   4096
  Elapsed:      539.88s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     7768.92

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:18:37 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:18:37 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1435222) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1435222) ERROR 01-26 15:19:17 [core.py:866] 


─── STDERR ───
[2026-01-26 15:18:37] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:18:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:18:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:18:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:18:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:18:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:18:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:18:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:18:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:18:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:18:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:18:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:18:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:18:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:18:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:18:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:18:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1435222) [2026-01-26 15:18:41] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1435222) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1435222) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:16<00:16, 16.01s/it]
(EngineCore_DP0 pid=1435222) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:32<00:00, 16.49s/it]
(EngineCore_DP0 pid=1435222) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:32<00:00, 16.42s/it]
(EngineCore_DP0 pid=1435222) 
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12386304 bytes
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 9633792 bytes
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 101842944 bytes
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1435222) [2026-01-26 15:19:15] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 50921472 bytes
(EngineCore_DP0 pid=1435222) Process EngineCore_DP0:
(EngineCore_DP0 pid=1435222) Traceback (most recent call last):
(EngineCore_DP0 pid=1435222)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1435222)     self.run()
(EngineCore_DP0 pid=1435222)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1435222)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1435222)     raise e
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1435222)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1435222)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1435222)     super().__init__(
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1435222)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1435222)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1435222)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1435222)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1435222)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1435222)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1435222)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1435222)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1435222)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1435222)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1435222)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1435222)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1435222)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1435222)     outputs = self.model(
(EngineCore_DP0 pid=1435222)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1435222)     hidden_states = self.model(
(EngineCore_DP0 pid=1435222)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1435222)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1435222)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1435222)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1435222)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1435222)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1435222)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1435222)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1435222)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1435222)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1435222)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1435222)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1435222)     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1435222)     return self._linear_fn(
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1435222)     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1435222)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1435222)     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1435222)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1435222)     return fn(input, L)
(EngineCore_DP0 pid=1435222)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1435222)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1435222)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1435222) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1435222) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1435222) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1435222) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1435222) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1435222) 
[rank0]:[W126 15:19:18.549890668 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_4/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,11.9879,6149.8063,10.6774
1024,1024,1,128,128,7.3646,7548.7161,17.3804
2048,1024,2,256,128,7.5499,7738.6407,33.9078
4096,1024,4,512,128,7.5649,7754.0207,67.6810
8192,1024,8,1024,128,7.4476,7633.7849,137.4940
16384,1024,16,2048,128,1.3123,1345.1480,1560.5718
32768,1024,32,4096,128,7.5868,7776.5094,539.8823
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-INT8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_6

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:19:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:19:24 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1436036) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1436036) WARNING 01-26 15:20:36 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 10.35 requests/s, 5309.06 total tokens/s, 10.35 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 15:19:24] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:19:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:19:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:19:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:19:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:19:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:19:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:19:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:19:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:19:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:19:27] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:19:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:19:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:19:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:19:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:19:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:19:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1436036) [2026-01-26 15:19:28] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1436036) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1436036) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.13s/it]
(EngineCore_DP0 pid=1436036) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 29.62s/it]
(EngineCore_DP0 pid=1436036) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 28.80s/it]
(EngineCore_DP0 pid=1436036) 
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1436036) [2026-01-26 15:20:27] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1436036) 2026-01-26 15:20:35,568 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1436036) 2026-01-26 15:20:35,615 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<01:21,  1.56it/s]
Adding requests:   2%|▏         | 2/128 [00:00<00:46,  2.71it/s]
Adding requests:   3%|▎         | 4/128 [00:00<00:22,  5.47it/s]
Adding requests:   5%|▌         | 7/128 [00:01<00:12,  9.62it/s]
Adding requests:   9%|▊         | 11/128 [00:01<00:07, 15.85it/s]
Adding requests:  12%|█▏        | 15/128 [00:01<00:05, 21.02it/s]
Adding requests:  16%|█▋        | 21/128 [00:01<00:03, 29.43it/s]
Adding requests:  24%|██▍       | 31/128 [00:01<00:02, 46.93it/s]
Adding requests:  46%|████▌     | 59/128 [00:01<00:00, 108.00it/s]
Adding requests:  72%|███████▏  | 92/128 [00:01<00:00, 167.28it/s]
Adding requests: 100%|██████████| 128/128 [00:01<00:00, 70.18it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:01, 86.68it/s, est. speed input: 44387.06 toks/s, output: 86.68 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:05, 19.81it/s, est. speed input: 11752.68 toks/s, output: 22.95 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 16.30it/s, est. speed input: 9851.60 toks/s, output: 19.24 toks/s] 
Processed prompts:  23%|██▎       | 30/128 [00:01<00:06, 14.97it/s, est. speed input: 9192.14 toks/s, output: 17.95 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:06, 13.91it/s, est. speed input: 8702.61 toks/s, output: 17.00 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 13.40it/s, est. speed input: 8465.87 toks/s, output: 16.53 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:07, 12.87it/s, est. speed input: 8245.65 toks/s, output: 16.10 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:07, 12.50it/s, est. speed input: 8072.99 toks/s, output: 15.77 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:07, 12.18it/s, est. speed input: 7917.80 toks/s, output: 15.46 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:07, 11.91it/s, est. speed input: 7779.58 toks/s, output: 15.19 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:07, 11.62it/s, est. speed input: 7645.49 toks/s, output: 14.93 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:07, 11.51it/s, est. speed input: 7539.60 toks/s, output: 14.73 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:06, 11.52it/s, est. speed input: 7456.27 toks/s, output: 14.56 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:06, 11.43it/s, est. speed input: 7369.92 toks/s, output: 14.39 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:06, 11.43it/s, est. speed input: 7298.73 toks/s, output: 14.26 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:06, 11.38it/s, est. speed input: 7228.09 toks/s, output: 14.12 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:04<00:06, 11.18it/s, est. speed input: 7148.94 toks/s, output: 13.96 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:06, 11.19it/s, est. speed input: 7089.80 toks/s, output: 13.85 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:05, 11.20it/s, est. speed input: 7036.55 toks/s, output: 13.74 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:05, 11.24it/s, est. speed input: 6989.43 toks/s, output: 13.65 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:05, 11.23it/s, est. speed input: 6942.62 toks/s, output: 13.56 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:05, 11.14it/s, est. speed input: 6893.18 toks/s, output: 13.46 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:05<00:05, 11.08it/s, est. speed input: 6847.44 toks/s, output: 13.37 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:05<00:05, 11.16it/s, est. speed input: 6813.47 toks/s, output: 13.31 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:04, 11.21it/s, est. speed input: 6780.86 toks/s, output: 13.24 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:04, 11.20it/s, est. speed input: 6747.69 toks/s, output: 13.18 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:04, 11.22it/s, est. speed input: 6717.77 toks/s, output: 13.12 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04, 11.16it/s, est. speed input: 6685.68 toks/s, output: 13.06 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:06<00:04, 11.17it/s, est. speed input: 6658.05 toks/s, output: 13.00 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:06<00:04, 11.22it/s, est. speed input: 6634.51 toks/s, output: 12.96 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:06<00:03, 11.28it/s, est. speed input: 6613.83 toks/s, output: 12.92 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:06<00:03, 11.21it/s, est. speed input: 6588.43 toks/s, output: 12.87 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:03, 11.31it/s, est. speed input: 6571.43 toks/s, output: 12.83 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:07<00:03, 11.19it/s, est. speed input: 6546.10 toks/s, output: 12.79 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:07<00:03, 11.19it/s, est. speed input: 6525.92 toks/s, output: 12.75 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:07<00:02, 11.25it/s, est. speed input: 6509.70 toks/s, output: 12.71 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:07<00:02, 11.25it/s, est. speed input: 6492.24 toks/s, output: 12.68 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:07<00:02, 11.20it/s, est. speed input: 6473.70 toks/s, output: 12.64 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:08<00:02, 11.18it/s, est. speed input: 6456.40 toks/s, output: 12.61 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:08<00:02, 11.13it/s, est. speed input: 6438.27 toks/s, output: 12.57 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:08<00:02, 11.18it/s, est. speed input: 6424.28 toks/s, output: 12.55 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:08<00:01, 11.18it/s, est. speed input: 6409.61 toks/s, output: 12.52 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:08<00:01, 11.21it/s, est. speed input: 6396.92 toks/s, output: 12.49 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:08<00:01, 11.17it/s, est. speed input: 6382.14 toks/s, output: 12.47 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:09<00:01, 11.20it/s, est. speed input: 6370.29 toks/s, output: 12.44 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:09<00:01, 11.06it/s, est. speed input: 6352.96 toks/s, output: 12.41 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:09<00:00, 11.12it/s, est. speed input: 6341.70 toks/s, output: 12.39 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:09<00:00, 11.15it/s, est. speed input: 6330.60 toks/s, output: 12.36 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:09<00:00, 11.14it/s, est. speed input: 6318.90 toks/s, output: 12.34 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:09<00:00, 11.17it/s, est. speed input: 6308.85 toks/s, output: 12.32 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:10<00:00, 11.20it/s, est. speed input: 6299.45 toks/s, output: 12.30 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:10<00:00, 11.04it/s, est. speed input: 6284.54 toks/s, output: 12.27 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.04it/s, est. speed input: 6273.81 toks/s, output: 12.25 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.25it/s, est. speed input: 6273.81 toks/s, output: 12.25 toks/s]
[rank0]:[W126 15:20:49.559457279 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 102.1s

测试结果:
  Requests/s:   10.35
  Tokens/s:     5309.06
  Total Reqs:   128
  Elapsed:      12.37s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5298.71

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:21:06 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:21:06 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1437668) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1437668) WARNING 01-26 15:22:19 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.37 requests/s, 6525.70 total tokens/s, 6.37 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 15:21:06] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:21:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:21:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:21:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:21:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:21:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:21:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:21:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:21:10] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:21:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:21:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:21:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:21:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:21:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:21:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:21:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:21:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1437668) [2026-01-26 15:21:11] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1437668) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1437668) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.93s/it]
(EngineCore_DP0 pid=1437668) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.58s/it]
(EngineCore_DP0 pid=1437668) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.73s/it]
(EngineCore_DP0 pid=1437668) 
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1437668) [2026-01-26 15:22:11] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1437668) 2026-01-26 15:22:19,096 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1437668) 2026-01-26 15:22:19,129 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  23%|██▎       | 30/128 [00:00<00:00, 294.21it/s]
Adding requests:  53%|█████▎    | 68/128 [00:00<00:00, 343.19it/s]
Adding requests:  80%|████████  | 103/128 [00:00<00:00, 341.97it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 339.04it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:06, 18.26it/s, est. speed input: 18699.49 toks/s, output: 18.26 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:12,  9.63it/s, est. speed input: 10775.24 toks/s, output: 10.52 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:15,  7.90it/s, est. speed input: 9037.65 toks/s, output: 8.83 toks/s]  
Processed prompts:   6%|▋         | 8/128 [00:00<00:15,  7.51it/s, est. speed input: 8633.56 toks/s, output: 8.43 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:16,  7.24it/s, est. speed input: 8357.93 toks/s, output: 8.16 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:16,  6.97it/s, est. speed input: 8121.04 toks/s, output: 7.93 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:17,  6.88it/s, est. speed input: 7978.18 toks/s, output: 7.79 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:17,  6.76it/s, est. speed input: 7846.34 toks/s, output: 7.66 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:17,  6.67it/s, est. speed input: 7733.72 toks/s, output: 7.55 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:17,  6.52it/s, est. speed input: 7614.62 toks/s, output: 7.44 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:17,  6.50it/s, est. speed input: 7538.05 toks/s, output: 7.36 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:17,  6.47it/s, est. speed input: 7466.87 toks/s, output: 7.29 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:17,  6.46it/s, est. speed input: 7408.76 toks/s, output: 7.24 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:17,  6.45it/s, est. speed input: 7357.73 toks/s, output: 7.19 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:16,  6.42it/s, est. speed input: 7307.16 toks/s, output: 7.14 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:16,  6.35it/s, est. speed input: 7252.53 toks/s, output: 7.08 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:16,  6.38it/s, est. speed input: 7218.43 toks/s, output: 7.05 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:16,  6.40it/s, est. speed input: 7187.75 toks/s, output: 7.02 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:16,  6.42it/s, est. speed input: 7160.44 toks/s, output: 6.99 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:16,  6.41it/s, est. speed input: 7133.55 toks/s, output: 6.97 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:16,  6.41it/s, est. speed input: 7107.57 toks/s, output: 6.94 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:15,  6.41it/s, est. speed input: 7084.82 toks/s, output: 6.92 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:15,  6.35it/s, est. speed input: 7056.39 toks/s, output: 6.89 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:15,  6.35it/s, est. speed input: 7034.47 toks/s, output: 6.87 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:15,  6.40it/s, est. speed input: 7022.12 toks/s, output: 6.86 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:15,  6.43it/s, est. speed input: 7008.49 toks/s, output: 6.84 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:04<00:15,  6.44it/s, est. speed input: 6995.62 toks/s, output: 6.83 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:04<00:14,  6.42it/s, est. speed input: 6980.15 toks/s, output: 6.82 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:04<00:14,  6.43it/s, est. speed input: 6967.99 toks/s, output: 6.80 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:05<00:14,  6.35it/s, est. speed input: 6946.71 toks/s, output: 6.78 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:05<00:14,  6.32it/s, est. speed input: 6930.39 toks/s, output: 6.77 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:14,  6.36it/s, est. speed input: 6920.50 toks/s, output: 6.76 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:05<00:14,  6.39it/s, est. speed input: 6912.49 toks/s, output: 6.75 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:05<00:14,  6.42it/s, est. speed input: 6905.37 toks/s, output: 6.74 toks/s]
Processed prompts:  30%|███       | 39/128 [00:05<00:13,  6.40it/s, est. speed input: 6894.08 toks/s, output: 6.73 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:05<00:13,  6.40it/s, est. speed input: 6885.14 toks/s, output: 6.72 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:06<00:13,  6.36it/s, est. speed input: 6872.97 toks/s, output: 6.71 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:06<00:13,  6.35it/s, est. speed input: 6863.26 toks/s, output: 6.70 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:06<00:13,  6.39it/s, est. speed input: 6858.02 toks/s, output: 6.70 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:06<00:13,  6.39it/s, est. speed input: 6850.55 toks/s, output: 6.69 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:06<00:12,  6.41it/s, est. speed input: 6844.76 toks/s, output: 6.68 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:06<00:12,  6.38it/s, est. speed input: 6836.45 toks/s, output: 6.68 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:07<00:12,  6.33it/s, est. speed input: 6825.46 toks/s, output: 6.67 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:07<00:12,  6.36it/s, est. speed input: 6820.16 toks/s, output: 6.66 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:07<00:12,  6.39it/s, est. speed input: 6816.10 toks/s, output: 6.66 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:07<00:12,  6.41it/s, est. speed input: 6811.67 toks/s, output: 6.65 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:07<00:12,  6.39it/s, est. speed input: 6805.12 toks/s, output: 6.65 toks/s]
Processed prompts:  41%|████      | 52/128 [00:07<00:11,  6.43it/s, est. speed input: 6802.59 toks/s, output: 6.64 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:07<00:11,  6.47it/s, est. speed input: 6801.39 toks/s, output: 6.64 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:08<00:11,  6.38it/s, est. speed input: 6792.01 toks/s, output: 6.63 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:08<00:11,  6.41it/s, est. speed input: 6788.88 toks/s, output: 6.63 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:08<00:11,  6.43it/s, est. speed input: 6786.07 toks/s, output: 6.63 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:08<00:10,  6.46it/s, est. speed input: 6784.25 toks/s, output: 6.63 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:08<00:10,  6.46it/s, est. speed input: 6781.61 toks/s, output: 6.62 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:08<00:10,  6.48it/s, est. speed input: 6779.65 toks/s, output: 6.62 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:09<00:10,  6.48it/s, est. speed input: 6777.31 toks/s, output: 6.62 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:09<00:10,  6.40it/s, est. speed input: 6770.02 toks/s, output: 6.61 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:09<00:10,  6.42it/s, est. speed input: 6767.51 toks/s, output: 6.61 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:09<00:10,  6.40it/s, est. speed input: 6763.29 toks/s, output: 6.60 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:09<00:09,  6.41it/s, est. speed input: 6760.37 toks/s, output: 6.60 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:09<00:09,  6.41it/s, est. speed input: 6757.28 toks/s, output: 6.60 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:10<00:09,  6.43it/s, est. speed input: 6755.49 toks/s, output: 6.60 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:10<00:09,  6.38it/s, est. speed input: 6750.30 toks/s, output: 6.59 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:10<00:09,  6.35it/s, est. speed input: 6745.33 toks/s, output: 6.59 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:10<00:09,  6.40it/s, est. speed input: 6744.11 toks/s, output: 6.59 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:10<00:09,  6.39it/s, est. speed input: 6740.82 toks/s, output: 6.58 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:10<00:08,  6.37it/s, est. speed input: 6737.11 toks/s, output: 6.58 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:10<00:08,  6.36it/s, est. speed input: 6733.48 toks/s, output: 6.58 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:11<00:08,  6.39it/s, est. speed input: 6731.59 toks/s, output: 6.57 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:11<00:08,  6.32it/s, est. speed input: 6725.67 toks/s, output: 6.57 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:11<00:08,  6.36it/s, est. speed input: 6724.14 toks/s, output: 6.57 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:11<00:08,  6.38it/s, est. speed input: 6722.14 toks/s, output: 6.56 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:11<00:07,  6.38it/s, est. speed input: 6719.72 toks/s, output: 6.56 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:11<00:07,  6.39it/s, est. speed input: 6717.74 toks/s, output: 6.56 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:12<00:07,  6.46it/s, est. speed input: 6718.39 toks/s, output: 6.56 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:12<00:07,  6.45it/s, est. speed input: 6716.68 toks/s, output: 6.56 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:12<00:07,  6.37it/s, est. speed input: 6711.64 toks/s, output: 6.55 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:12<00:07,  6.40it/s, est. speed input: 6710.84 toks/s, output: 6.55 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:12<00:07,  6.40it/s, est. speed input: 6708.70 toks/s, output: 6.55 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:12<00:06,  6.39it/s, est. speed input: 6706.60 toks/s, output: 6.55 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:12<00:06,  6.41it/s, est. speed input: 6705.30 toks/s, output: 6.55 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:13<00:06,  6.43it/s, est. speed input: 6704.41 toks/s, output: 6.55 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:13<00:06,  6.42it/s, est. speed input: 6702.53 toks/s, output: 6.55 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:13<00:06,  6.34it/s, est. speed input: 6697.88 toks/s, output: 6.54 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:13<00:06,  6.37it/s, est. speed input: 6696.83 toks/s, output: 6.54 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:13<00:05,  6.38it/s, est. speed input: 6695.21 toks/s, output: 6.54 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:13<00:05,  6.41it/s, est. speed input: 6694.64 toks/s, output: 6.54 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:14<00:05,  6.41it/s, est. speed input: 6693.04 toks/s, output: 6.54 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:14<00:05,  6.40it/s, est. speed input: 6691.25 toks/s, output: 6.53 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:14<00:05,  6.31it/s, est. speed input: 6686.27 toks/s, output: 6.53 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:14<00:05,  6.31it/s, est. speed input: 6683.67 toks/s, output: 6.53 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:14<00:05,  6.36it/s, est. speed input: 6683.41 toks/s, output: 6.53 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:14<00:04,  6.37it/s, est. speed input: 6681.88 toks/s, output: 6.53 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:15<00:04,  6.39it/s, est. speed input: 6680.85 toks/s, output: 6.52 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:15<00:04,  6.40it/s, est. speed input: 6679.98 toks/s, output: 6.52 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:15<00:04,  6.42it/s, est. speed input: 6679.24 toks/s, output: 6.52 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:15<00:04,  6.33it/s, est. speed input: 6675.00 toks/s, output: 6.52 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:15<00:04,  6.38it/s, est. speed input: 6674.87 toks/s, output: 6.52 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:15<00:03,  6.40it/s, est. speed input: 6673.99 toks/s, output: 6.52 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:15<00:03,  6.43it/s, est. speed input: 6673.92 toks/s, output: 6.52 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:16<00:03,  6.43it/s, est. speed input: 6673.05 toks/s, output: 6.52 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:16<00:03,  6.44it/s, est. speed input: 6672.50 toks/s, output: 6.52 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:16<00:03,  6.44it/s, est. speed input: 6671.90 toks/s, output: 6.52 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:16<00:03,  6.33it/s, est. speed input: 6667.46 toks/s, output: 6.51 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:16<00:02,  6.34it/s, est. speed input: 6666.11 toks/s, output: 6.51 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:16<00:02,  6.34it/s, est. speed input: 6664.61 toks/s, output: 6.51 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:17<00:02,  6.39it/s, est. speed input: 6664.51 toks/s, output: 6.51 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:17<00:02,  6.37it/s, est. speed input: 6662.72 toks/s, output: 6.51 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:17<00:02,  6.42it/s, est. speed input: 6662.94 toks/s, output: 6.51 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:17<00:02,  6.34it/s, est. speed input: 6659.64 toks/s, output: 6.50 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:17<00:02,  6.35it/s, est. speed input: 6658.63 toks/s, output: 6.50 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:17<00:01,  6.38it/s, est. speed input: 6658.14 toks/s, output: 6.50 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:17<00:01,  6.41it/s, est. speed input: 6657.97 toks/s, output: 6.50 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:18<00:01,  6.39it/s, est. speed input: 6656.41 toks/s, output: 6.50 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:18<00:01,  6.40it/s, est. speed input: 6655.92 toks/s, output: 6.50 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:18<00:01,  6.40it/s, est. speed input: 6655.08 toks/s, output: 6.50 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:18<00:01,  6.32it/s, est. speed input: 6651.77 toks/s, output: 6.50 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:18<00:00,  6.32it/s, est. speed input: 6650.26 toks/s, output: 6.49 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:18<00:00,  6.36it/s, est. speed input: 6649.84 toks/s, output: 6.49 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:19<00:00,  6.38it/s, est. speed input: 6649.46 toks/s, output: 6.49 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:19<00:00,  6.36it/s, est. speed input: 6647.99 toks/s, output: 6.49 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:19<00:00,  6.40it/s, est. speed input: 6648.03 toks/s, output: 6.49 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:19<00:00,  6.41it/s, est. speed input: 6647.51 toks/s, output: 6.49 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:19<00:00,  6.34it/s, est. speed input: 6644.76 toks/s, output: 6.49 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:19<00:00,  6.34it/s, est. speed input: 6644.76 toks/s, output: 6.49 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:19<00:00,  6.49it/s, est. speed input: 6644.76 toks/s, output: 6.49 toks/s]
[rank0]:[W126 15:22:40.381264062 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 100.2s

测试结果:
  Requests/s:   6.37
  Tokens/s:     6525.70
  Total Reqs:   128
  Elapsed:      20.11s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     6519.34

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:22:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:22:47 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1439256) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1439256) WARNING 01-26 15:24:00 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.44 requests/s, 6598.71 total tokens/s, 6.44 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 15:22:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:22:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:22:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:22:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:22:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:22:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:22:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:22:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:22:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:22:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:22:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:22:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:22:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:22:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:22:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:22:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:22:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1439256) [2026-01-26 15:22:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1439256) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1439256) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.69s/it]
(EngineCore_DP0 pid=1439256) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.41s/it]
(EngineCore_DP0 pid=1439256) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.55s/it]
(EngineCore_DP0 pid=1439256) 
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1439256) [2026-01-26 15:23:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1439256) 2026-01-26 15:23:59,259 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1439256) 2026-01-26 15:23:59,330 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 28/256 [00:00<00:00, 269.54it/s]
Adding requests:  25%|██▌       | 64/256 [00:00<00:00, 318.07it/s]
Adding requests:  40%|███▉      | 102/256 [00:00<00:00, 345.22it/s]
Adding requests:  55%|█████▍    | 140/256 [00:00<00:00, 358.65it/s]
Adding requests:  71%|███████   | 181/256 [00:00<00:00, 376.80it/s]
Adding requests:  87%|████████▋ | 223/256 [00:00<00:00, 389.63it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 369.54it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:11, 22.32it/s, est. speed input: 22854.78 toks/s, output: 22.32 toks/s]
Processed prompts:   3%|▎         | 7/256 [00:00<00:18, 13.33it/s, est. speed input: 14658.88 toks/s, output: 14.32 toks/s]
Processed prompts:   4%|▎         | 9/256 [00:00<00:24,  9.89it/s, est. speed input: 11564.35 toks/s, output: 11.29 toks/s]
Processed prompts:   4%|▍         | 11/256 [00:01<00:28,  8.54it/s, est. speed input: 10246.56 toks/s, output: 10.01 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:37,  6.54it/s, est. speed input: 8720.68 toks/s, output: 8.52 toks/s]  
Processed prompts:   5%|▌         | 14/256 [00:01<00:37,  6.53it/s, est. speed input: 8357.01 toks/s, output: 8.16 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:36,  6.52it/s, est. speed input: 8095.02 toks/s, output: 7.91 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:36,  6.44it/s, est. speed input: 7871.13 toks/s, output: 7.69 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:02<00:36,  6.45it/s, est. speed input: 7726.49 toks/s, output: 7.55 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:02<00:36,  6.46it/s, est. speed input: 7611.54 toks/s, output: 7.43 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:35,  6.46it/s, est. speed input: 7519.25 toks/s, output: 7.34 toks/s]
Processed prompts:  10%|█         | 26/256 [00:03<00:35,  6.45it/s, est. speed input: 7435.99 toks/s, output: 7.26 toks/s]
Processed prompts:  11%|█         | 28/256 [00:03<00:35,  6.45it/s, est. speed input: 7369.84 toks/s, output: 7.20 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:04<00:34,  6.49it/s, est. speed input: 7324.45 toks/s, output: 7.15 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:04<00:34,  6.46it/s, est. speed input: 7270.68 toks/s, output: 7.10 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:04<00:34,  6.49it/s, est. speed input: 7234.91 toks/s, output: 7.07 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:05<00:33,  6.51it/s, est. speed input: 7203.81 toks/s, output: 7.03 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:05<00:33,  6.45it/s, est. speed input: 7161.92 toks/s, output: 6.99 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:05<00:33,  6.47it/s, est. speed input: 7136.20 toks/s, output: 6.97 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:06<00:33,  6.47it/s, est. speed input: 7109.93 toks/s, output: 6.94 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:06<00:32,  6.50it/s, est. speed input: 7091.44 toks/s, output: 6.93 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:06<00:32,  6.48it/s, est. speed input: 7067.91 toks/s, output: 6.90 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:06<00:31,  6.52it/s, est. speed input: 7054.70 toks/s, output: 6.89 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:07<00:31,  6.52it/s, est. speed input: 7038.92 toks/s, output: 6.87 toks/s]
Processed prompts:  20%|██        | 52/256 [00:07<00:31,  6.47it/s, est. speed input: 7017.39 toks/s, output: 6.85 toks/s]
Processed prompts:  21%|██        | 54/256 [00:07<00:31,  6.51it/s, est. speed input: 7007.97 toks/s, output: 6.84 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:08<00:30,  6.50it/s, est. speed input: 6993.34 toks/s, output: 6.83 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:08<00:30,  6.50it/s, est. speed input: 6980.63 toks/s, output: 6.82 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:08<00:30,  6.49it/s, est. speed input: 6968.03 toks/s, output: 6.80 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:09<00:29,  6.48it/s, est. speed input: 6956.70 toks/s, output: 6.79 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:09<00:29,  6.48it/s, est. speed input: 6945.76 toks/s, output: 6.78 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:09<00:29,  6.40it/s, est. speed input: 6927.27 toks/s, output: 6.76 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:10<00:29,  6.42it/s, est. speed input: 6917.12 toks/s, output: 6.75 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:10<00:28,  6.46it/s, est. speed input: 6911.27 toks/s, output: 6.75 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:10<00:28,  6.48it/s, est. speed input: 6904.56 toks/s, output: 6.74 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:10<00:28,  6.42it/s, est. speed input: 6891.49 toks/s, output: 6.73 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:11<00:27,  6.44it/s, est. speed input: 6884.48 toks/s, output: 6.72 toks/s]
Processed prompts:  30%|███       | 78/256 [00:11<00:27,  6.47it/s, est. speed input: 6879.38 toks/s, output: 6.72 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:11<00:27,  6.43it/s, est. speed input: 6868.80 toks/s, output: 6.71 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:12<00:26,  6.45it/s, est. speed input: 6863.93 toks/s, output: 6.70 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:12<00:26,  6.44it/s, est. speed input: 6856.89 toks/s, output: 6.70 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:12<00:26,  6.40it/s, est. speed input: 6847.12 toks/s, output: 6.69 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:13<00:26,  6.41it/s, est. speed input: 6840.50 toks/s, output: 6.68 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:13<00:25,  6.41it/s, est. speed input: 6834.38 toks/s, output: 6.67 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:13<00:25,  6.46it/s, est. speed input: 6831.90 toks/s, output: 6.67 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:14<00:25,  6.41it/s, est. speed input: 6823.75 toks/s, output: 6.66 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:14<00:24,  6.42it/s, est. speed input: 6819.06 toks/s, output: 6.66 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:14<00:24,  6.44it/s, est. speed input: 6814.97 toks/s, output: 6.66 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:15<00:24,  6.40it/s, est. speed input: 6807.59 toks/s, output: 6.65 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:15<00:23,  6.44it/s, est. speed input: 6805.02 toks/s, output: 6.65 toks/s]
Processed prompts:  41%|████      | 104/256 [00:15<00:23,  6.44it/s, est. speed input: 6801.31 toks/s, output: 6.64 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:15<00:23,  6.46it/s, est. speed input: 6798.73 toks/s, output: 6.64 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:16<00:22,  6.44it/s, est. speed input: 6793.98 toks/s, output: 6.63 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:16<00:22,  6.43it/s, est. speed input: 6789.43 toks/s, output: 6.63 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:16<00:22,  6.43it/s, est. speed input: 6785.82 toks/s, output: 6.63 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:17<00:22,  6.41it/s, est. speed input: 6780.66 toks/s, output: 6.62 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:17<00:21,  6.46it/s, est. speed input: 6780.29 toks/s, output: 6.62 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:17<00:21,  6.46it/s, est. speed input: 6777.44 toks/s, output: 6.62 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:18<00:21,  6.42it/s, est. speed input: 6772.24 toks/s, output: 6.61 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:18<00:20,  6.46it/s, est. speed input: 6771.16 toks/s, output: 6.61 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:18<00:20,  6.49it/s, est. speed input: 6770.02 toks/s, output: 6.61 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:19<00:20,  6.45it/s, est. speed input: 6765.71 toks/s, output: 6.61 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:19<00:20,  6.40it/s, est. speed input: 6760.36 toks/s, output: 6.60 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:19<00:19,  6.40it/s, est. speed input: 6757.31 toks/s, output: 6.60 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:20<00:19,  6.42it/s, est. speed input: 6755.04 toks/s, output: 6.60 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:20<00:19,  6.40it/s, est. speed input: 6751.48 toks/s, output: 6.59 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:20<00:18,  6.44it/s, est. speed input: 6750.21 toks/s, output: 6.59 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:20<00:18,  6.42it/s, est. speed input: 6746.97 toks/s, output: 6.59 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:21<00:18,  6.40it/s, est. speed input: 6743.40 toks/s, output: 6.59 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:21<00:17,  6.40it/s, est. speed input: 6740.58 toks/s, output: 6.58 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:21<00:17,  6.43it/s, est. speed input: 6739.49 toks/s, output: 6.58 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:22<00:17,  6.42it/s, est. speed input: 6736.69 toks/s, output: 6.58 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:22<00:16,  6.38it/s, est. speed input: 6732.57 toks/s, output: 6.57 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:22<00:16,  6.38it/s, est. speed input: 6729.98 toks/s, output: 6.57 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:23<00:16,  6.41it/s, est. speed input: 6728.54 toks/s, output: 6.57 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:23<00:15,  6.39it/s, est. speed input: 6725.51 toks/s, output: 6.57 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:23<00:15,  6.42it/s, est. speed input: 6724.48 toks/s, output: 6.57 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:24<00:15,  6.43it/s, est. speed input: 6723.01 toks/s, output: 6.57 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:24<00:14,  6.44it/s, est. speed input: 6721.64 toks/s, output: 6.56 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:24<00:14,  6.41it/s, est. speed input: 6718.84 toks/s, output: 6.56 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:25<00:14,  6.40it/s, est. speed input: 6716.61 toks/s, output: 6.56 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:25<00:14,  6.42it/s, est. speed input: 6715.25 toks/s, output: 6.56 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:25<00:13,  6.40it/s, est. speed input: 6712.65 toks/s, output: 6.56 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:25<00:13,  6.43it/s, est. speed input: 6711.85 toks/s, output: 6.55 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:26<00:13,  6.42it/s, est. speed input: 6710.05 toks/s, output: 6.55 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:26<00:12,  6.42it/s, est. speed input: 6708.26 toks/s, output: 6.55 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:26<00:12,  6.45it/s, est. speed input: 6708.19 toks/s, output: 6.55 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:27<00:12,  6.46it/s, est. speed input: 6707.14 toks/s, output: 6.55 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:27<00:11,  6.46it/s, est. speed input: 6706.03 toks/s, output: 6.55 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:27<00:11,  6.44it/s, est. speed input: 6704.47 toks/s, output: 6.55 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:28<00:11,  6.43it/s, est. speed input: 6702.74 toks/s, output: 6.55 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:28<00:10,  6.46it/s, est. speed input: 6702.77 toks/s, output: 6.55 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:28<00:10,  6.42it/s, est. speed input: 6700.37 toks/s, output: 6.54 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:29<00:10,  6.44it/s, est. speed input: 6699.54 toks/s, output: 6.54 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:29<00:09,  6.46it/s, est. speed input: 6699.31 toks/s, output: 6.54 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:29<00:09,  6.47it/s, est. speed input: 6698.73 toks/s, output: 6.54 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:29<00:09,  6.44it/s, est. speed input: 6696.83 toks/s, output: 6.54 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:30<00:08,  6.47it/s, est. speed input: 6696.96 toks/s, output: 6.54 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:30<00:08,  6.45it/s, est. speed input: 6695.62 toks/s, output: 6.54 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:30<00:07,  7.18it/s, est. speed input: 6717.49 toks/s, output: 6.56 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:31<00:07,  7.01it/s, est. speed input: 6718.16 toks/s, output: 6.56 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:31<00:07,  6.57it/s, est. speed input: 6708.74 toks/s, output: 6.55 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:31<00:07,  6.55it/s, est. speed input: 6708.25 toks/s, output: 6.55 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:32<00:07,  6.45it/s, est. speed input: 6704.94 toks/s, output: 6.55 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:32<00:06,  6.43it/s, est. speed input: 6703.31 toks/s, output: 6.55 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:32<00:06,  6.46it/s, est. speed input: 6703.22 toks/s, output: 6.55 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:33<00:06,  6.40it/s, est. speed input: 6700.49 toks/s, output: 6.54 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:33<00:05,  6.43it/s, est. speed input: 6700.13 toks/s, output: 6.54 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:33<00:05,  6.46it/s, est. speed input: 6699.88 toks/s, output: 6.54 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:33<00:05,  6.46it/s, est. speed input: 6699.22 toks/s, output: 6.54 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:34<00:04,  6.48it/s, est. speed input: 6698.90 toks/s, output: 6.54 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:34<00:04,  6.45it/s, est. speed input: 6697.61 toks/s, output: 6.54 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:34<00:04,  6.47it/s, est. speed input: 6697.46 toks/s, output: 6.54 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:35<00:04,  6.45it/s, est. speed input: 6696.20 toks/s, output: 6.54 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:35<00:03,  6.48it/s, est. speed input: 6696.19 toks/s, output: 6.54 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:35<00:03,  6.48it/s, est. speed input: 6695.61 toks/s, output: 6.54 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:36<00:03,  6.43it/s, est. speed input: 6693.58 toks/s, output: 6.54 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:36<00:02,  6.44it/s, est. speed input: 6693.06 toks/s, output: 6.54 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:36<00:02,  6.42it/s, est. speed input: 6691.53 toks/s, output: 6.53 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:37<00:02,  6.39it/s, est. speed input: 6689.69 toks/s, output: 6.53 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:37<00:01,  6.38it/s, est. speed input: 6688.27 toks/s, output: 6.53 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:37<00:01,  6.42it/s, est. speed input: 6687.94 toks/s, output: 6.53 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:37<00:01,  6.43it/s, est. speed input: 6687.26 toks/s, output: 6.53 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:38<00:00,  6.39it/s, est. speed input: 6685.50 toks/s, output: 6.53 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:38<00:00,  6.39it/s, est. speed input: 6684.33 toks/s, output: 6.53 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:38<00:00,  6.41it/s, est. speed input: 6683.68 toks/s, output: 6.53 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:39<00:00,  7.54it/s, est. speed input: 6709.37 toks/s, output: 6.55 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:39<00:00,  7.54it/s, est. speed input: 6709.37 toks/s, output: 6.55 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:39<00:00,  6.55it/s, est. speed input: 6709.37 toks/s, output: 6.55 toks/s]
[rank0]:[W126 15:24:40.466024224 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 120.0s

测试结果:
  Requests/s:   6.44
  Tokens/s:     6598.71
  Total Reqs:   256
  Elapsed:      39.77s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     6592.27

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:24:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:24:48 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1441129) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1441129) WARNING 01-26 15:26:01 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.28 requests/s, 6438.48 total tokens/s, 6.28 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 15:24:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:24:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:24:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:24:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:24:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:24:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:24:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:24:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:24:51] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:24:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:24:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:24:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:24:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:24:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:24:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:24:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:24:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1441129) [2026-01-26 15:24:52] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1441129) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1441129) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.69s/it]
(EngineCore_DP0 pid=1441129) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 30.27s/it]
(EngineCore_DP0 pid=1441129) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.43s/it]
(EngineCore_DP0 pid=1441129) 
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1441129) [2026-01-26 15:25:52] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1441129) 2026-01-26 15:25:59,952 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1441129) 2026-01-26 15:26:00,080 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 41/512 [00:00<00:01, 409.28it/s]
Adding requests:  16%|█▌        | 82/512 [00:00<00:01, 397.19it/s]
Adding requests:  24%|██▍       | 123/512 [00:00<00:00, 402.06it/s]
Adding requests:  32%|███▏      | 165/512 [00:00<00:00, 406.62it/s]
Adding requests:  41%|████      | 210/512 [00:00<00:00, 421.10it/s]
Adding requests:  50%|████▉     | 254/512 [00:00<00:00, 424.14it/s]
Adding requests:  58%|█████▊    | 298/512 [00:00<00:00, 427.54it/s]
Adding requests:  67%|██████▋   | 344/512 [00:00<00:00, 435.58it/s]
Adding requests:  76%|███████▌  | 389/512 [00:00<00:00, 437.81it/s]
Adding requests:  85%|████████▍ | 434/512 [00:01<00:00, 441.51it/s]
Adding requests:  94%|█████████▎| 479/512 [00:01<00:00, 435.03it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 428.11it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:26, 18.97it/s, est. speed input: 19425.33 toks/s, output: 18.97 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:00<00:52,  9.53it/s, est. speed input: 10722.56 toks/s, output: 10.47 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:01<01:02,  7.91it/s, est. speed input: 9052.02 toks/s, output: 8.84 toks/s]  
Processed prompts:   4%|▎         | 18/512 [00:02<01:08,  7.23it/s, est. speed input: 8310.19 toks/s, output: 8.12 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:02<01:11,  6.88it/s, est. speed input: 7893.25 toks/s, output: 7.71 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:12,  6.69it/s, est. speed input: 7641.51 toks/s, output: 7.46 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:13,  6.57it/s, est. speed input: 7460.89 toks/s, output: 7.29 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:04<01:13,  6.51it/s, est. speed input: 7338.48 toks/s, output: 7.17 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:05<01:13,  6.43it/s, est. speed input: 7226.95 toks/s, output: 7.06 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:13,  6.39it/s, est. speed input: 7144.73 toks/s, output: 6.98 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:06<01:13,  6.37it/s, est. speed input: 7082.57 toks/s, output: 6.92 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:07<01:12,  6.34it/s, est. speed input: 7025.50 toks/s, output: 6.86 toks/s]
Processed prompts:  11%|█         | 54/512 [00:07<01:11,  6.37it/s, est. speed input: 6991.48 toks/s, output: 6.83 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:08<01:11,  6.34it/s, est. speed input: 6947.85 toks/s, output: 6.79 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:09<01:11,  6.31it/s, est. speed input: 6909.65 toks/s, output: 6.75 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:09<01:10,  6.31it/s, est. speed input: 6880.03 toks/s, output: 6.72 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:10<01:10,  6.30it/s, est. speed input: 6852.48 toks/s, output: 6.69 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:11<01:09,  6.32it/s, est. speed input: 6833.77 toks/s, output: 6.67 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:11<01:08,  6.31it/s, est. speed input: 6811.64 toks/s, output: 6.65 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:12<01:08,  6.29it/s, est. speed input: 6790.01 toks/s, output: 6.63 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:12<01:07,  6.31it/s, est. speed input: 6776.85 toks/s, output: 6.62 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:13<01:07,  6.29it/s, est. speed input: 6757.98 toks/s, output: 6.60 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:14<01:06,  6.32it/s, est. speed input: 6749.53 toks/s, output: 6.59 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:14<01:05,  6.31it/s, est. speed input: 6736.50 toks/s, output: 6.58 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:15<01:05,  6.30it/s, est. speed input: 6723.24 toks/s, output: 6.57 toks/s]
Processed prompts:  21%|██        | 106/512 [00:16<01:04,  6.31it/s, est. speed input: 6713.53 toks/s, output: 6.56 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:16<01:04,  6.28it/s, est. speed input: 6699.71 toks/s, output: 6.54 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:17<01:03,  6.29it/s, est. speed input: 6692.02 toks/s, output: 6.54 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:18<01:02,  6.28it/s, est. speed input: 6681.06 toks/s, output: 6.52 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:18<01:02,  6.27it/s, est. speed input: 6671.16 toks/s, output: 6.51 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:19<01:01,  6.27it/s, est. speed input: 6663.06 toks/s, output: 6.51 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:20<01:01,  6.25it/s, est. speed input: 6653.26 toks/s, output: 6.50 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:20<01:00,  6.26it/s, est. speed input: 6646.06 toks/s, output: 6.49 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:21<00:59,  6.26it/s, est. speed input: 6639.56 toks/s, output: 6.48 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:21<00:59,  6.26it/s, est. speed input: 6633.15 toks/s, output: 6.48 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:22<00:58,  6.28it/s, est. speed input: 6628.76 toks/s, output: 6.47 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:23<00:57,  6.28it/s, est. speed input: 6623.20 toks/s, output: 6.47 toks/s]
Processed prompts:  30%|███       | 154/512 [00:23<00:57,  6.26it/s, est. speed input: 6616.09 toks/s, output: 6.46 toks/s]
Processed prompts:  31%|███       | 158/512 [00:24<00:56,  6.26it/s, est. speed input: 6610.99 toks/s, output: 6.46 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:25<00:56,  6.24it/s, est. speed input: 6604.21 toks/s, output: 6.45 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:25<00:55,  6.27it/s, est. speed input: 6601.02 toks/s, output: 6.45 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:26<00:54,  6.26it/s, est. speed input: 6596.19 toks/s, output: 6.44 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:27<00:54,  6.25it/s, est. speed input: 6590.70 toks/s, output: 6.44 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:27<00:53,  6.26it/s, est. speed input: 6587.45 toks/s, output: 6.43 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:28<00:52,  6.26it/s, est. speed input: 6583.16 toks/s, output: 6.43 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:28<00:51,  6.29it/s, est. speed input: 6581.61 toks/s, output: 6.43 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:29<00:51,  6.28it/s, est. speed input: 6578.15 toks/s, output: 6.42 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:30<00:50,  6.26it/s, est. speed input: 6573.65 toks/s, output: 6.42 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:30<00:51,  6.09it/s, est. speed input: 6557.39 toks/s, output: 6.40 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:31<00:47,  6.47it/s, est. speed input: 6577.67 toks/s, output: 6.42 toks/s]
Processed prompts:  40%|████      | 206/512 [00:32<00:47,  6.43it/s, est. speed input: 6575.75 toks/s, output: 6.42 toks/s]
Processed prompts:  41%|████      | 210/512 [00:32<00:47,  6.38it/s, est. speed input: 6572.57 toks/s, output: 6.42 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:33<00:46,  6.35it/s, est. speed input: 6569.72 toks/s, output: 6.42 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:34<00:46,  6.30it/s, est. speed input: 6565.57 toks/s, output: 6.41 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:34<00:46,  6.28it/s, est. speed input: 6562.08 toks/s, output: 6.41 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:35<00:45,  6.30it/s, est. speed input: 6560.75 toks/s, output: 6.41 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:35<00:45,  6.26it/s, est. speed input: 6556.49 toks/s, output: 6.40 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:36<00:44,  6.25it/s, est. speed input: 6553.61 toks/s, output: 6.40 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:37<00:43,  6.24it/s, est. speed input: 6550.37 toks/s, output: 6.40 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:37<00:43,  6.23it/s, est. speed input: 6547.15 toks/s, output: 6.39 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:38<00:42,  6.24it/s, est. speed input: 6544.97 toks/s, output: 6.39 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:39<00:41,  6.25it/s, est. speed input: 6542.85 toks/s, output: 6.39 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:39<00:41,  6.26it/s, est. speed input: 6541.23 toks/s, output: 6.39 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:40<00:40,  6.28it/s, est. speed input: 6540.10 toks/s, output: 6.39 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:41<00:39,  6.27it/s, est. speed input: 6537.70 toks/s, output: 6.38 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:41<00:39,  6.27it/s, est. speed input: 6535.93 toks/s, output: 6.38 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:42<00:38,  6.26it/s, est. speed input: 6533.52 toks/s, output: 6.38 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:42<00:38,  6.26it/s, est. speed input: 6531.70 toks/s, output: 6.38 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:43<00:37,  6.28it/s, est. speed input: 6531.04 toks/s, output: 6.38 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:44<00:36,  6.26it/s, est. speed input: 6528.42 toks/s, output: 6.38 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:44<00:36,  6.26it/s, est. speed input: 6526.85 toks/s, output: 6.37 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:45<00:35,  6.24it/s, est. speed input: 6524.43 toks/s, output: 6.37 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:46<00:34,  6.23it/s, est. speed input: 6522.00 toks/s, output: 6.37 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:46<00:34,  6.26it/s, est. speed input: 6521.46 toks/s, output: 6.37 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:47<00:33,  6.25it/s, est. speed input: 6519.63 toks/s, output: 6.37 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:47<00:30,  6.67it/s, est. speed input: 6536.19 toks/s, output: 6.38 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:48<00:30,  6.53it/s, est. speed input: 6534.05 toks/s, output: 6.38 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:49<00:30,  6.46it/s, est. speed input: 6532.96 toks/s, output: 6.38 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:49<00:30,  6.40it/s, est. speed input: 6531.63 toks/s, output: 6.38 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:50<00:29,  6.35it/s, est. speed input: 6529.62 toks/s, output: 6.38 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:51<00:29,  6.32it/s, est. speed input: 6527.92 toks/s, output: 6.37 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:51<00:28,  6.29it/s, est. speed input: 6526.16 toks/s, output: 6.37 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:52<00:28,  6.30it/s, est. speed input: 6525.39 toks/s, output: 6.37 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:53<00:27,  6.29it/s, est. speed input: 6524.07 toks/s, output: 6.37 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:53<00:27,  6.25it/s, est. speed input: 6521.43 toks/s, output: 6.37 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:54<00:26,  6.25it/s, est. speed input: 6520.19 toks/s, output: 6.37 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:54<00:25,  6.23it/s, est. speed input: 6517.92 toks/s, output: 6.37 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:55<00:25,  6.22it/s, est. speed input: 6515.87 toks/s, output: 6.36 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:56<00:24,  6.25it/s, est. speed input: 6515.20 toks/s, output: 6.36 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:56<00:24,  6.24it/s, est. speed input: 6513.78 toks/s, output: 6.36 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:57<00:23,  6.27it/s, est. speed input: 6513.37 toks/s, output: 6.36 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:58<00:22,  6.25it/s, est. speed input: 6511.63 toks/s, output: 6.36 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:58<00:22,  6.23it/s, est. speed input: 6509.76 toks/s, output: 6.36 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:59<00:21,  6.24it/s, est. speed input: 6508.73 toks/s, output: 6.36 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:00<00:20,  6.25it/s, est. speed input: 6507.79 toks/s, output: 6.36 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:00<00:20,  6.26it/s, est. speed input: 6506.89 toks/s, output: 6.35 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:01<00:19,  6.25it/s, est. speed input: 6505.58 toks/s, output: 6.35 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:02<00:18,  6.25it/s, est. speed input: 6504.34 toks/s, output: 6.35 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:02<00:18,  6.24it/s, est. speed input: 6503.16 toks/s, output: 6.35 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:03<00:17,  6.23it/s, est. speed input: 6501.65 toks/s, output: 6.35 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:03<00:16,  6.25it/s, est. speed input: 6501.11 toks/s, output: 6.35 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:04<00:16,  6.25it/s, est. speed input: 6499.98 toks/s, output: 6.35 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:05<00:15,  6.24it/s, est. speed input: 6498.75 toks/s, output: 6.35 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:05<00:15,  6.26it/s, est. speed input: 6498.20 toks/s, output: 6.35 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:06<00:14,  6.24it/s, est. speed input: 6496.69 toks/s, output: 6.34 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:07<00:13,  6.25it/s, est. speed input: 6496.08 toks/s, output: 6.34 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:07<00:13,  6.25it/s, est. speed input: 6495.12 toks/s, output: 6.34 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:08<00:11,  6.65it/s, est. speed input: 6506.51 toks/s, output: 6.35 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:08<00:11,  6.53it/s, est. speed input: 6505.57 toks/s, output: 6.35 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:09<00:10,  6.42it/s, est. speed input: 6503.99 toks/s, output: 6.35 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:10<00:10,  6.40it/s, est. speed input: 6504.04 toks/s, output: 6.35 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:10<00:09,  6.35it/s, est. speed input: 6502.83 toks/s, output: 6.35 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:11<00:09,  6.31it/s, est. speed input: 6501.73 toks/s, output: 6.35 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:12<00:08,  6.29it/s, est. speed input: 6500.83 toks/s, output: 6.35 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:12<00:07,  6.28it/s, est. speed input: 6499.81 toks/s, output: 6.35 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:13<00:07,  6.29it/s, est. speed input: 6499.49 toks/s, output: 6.35 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:14<00:06,  6.27it/s, est. speed input: 6498.56 toks/s, output: 6.35 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:14<00:06,  6.27it/s, est. speed input: 6497.93 toks/s, output: 6.35 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:15<00:05,  6.27it/s, est. speed input: 6497.09 toks/s, output: 6.34 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:15<00:04,  6.25it/s, est. speed input: 6495.95 toks/s, output: 6.34 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:16<00:04,  6.27it/s, est. speed input: 6495.62 toks/s, output: 6.34 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:17<00:03,  6.24it/s, est. speed input: 6494.35 toks/s, output: 6.34 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:17<00:02,  6.23it/s, est. speed input: 6493.16 toks/s, output: 6.34 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:18<00:02,  6.26it/s, est. speed input: 6493.03 toks/s, output: 6.34 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:19<00:01,  6.24it/s, est. speed input: 6491.92 toks/s, output: 6.34 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:19<00:00,  6.24it/s, est. speed input: 6491.05 toks/s, output: 6.34 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:20<00:00,  6.72it/s, est. speed input: 6502.57 toks/s, output: 6.35 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:20<00:00,  6.72it/s, est. speed input: 6528.06 toks/s, output: 6.38 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:20<00:00,  6.38it/s, est. speed input: 6528.06 toks/s, output: 6.38 toks/s]
[rank0]:[W126 15:27:22.114990975 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 162.6s

测试结果:
  Requests/s:   6.28
  Tokens/s:     6438.48
  Total Reqs:   512
  Elapsed:      81.51s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     6432.20

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:27:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:27:32 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1443585) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1443585) WARNING 01-26 15:28:47 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.27 requests/s, 6426.66 total tokens/s, 6.27 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 15:27:32] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:27:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:27:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:27:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:27:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:27:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:27:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:27:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:27:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:27:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:27:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:27:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:27:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:27:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:27:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:27:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:27:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1443585) [2026-01-26 15:27:36] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1443585) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1443585) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.86s/it]
(EngineCore_DP0 pid=1443585) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.55s/it]
(EngineCore_DP0 pid=1443585) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.69s/it]
(EngineCore_DP0 pid=1443585) 
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1443585) [2026-01-26 15:28:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1443585) 2026-01-26 15:28:45,063 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1443585) 2026-01-26 15:28:45,423 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 33/1024 [00:00<00:03, 327.01it/s]
Adding requests:   7%|▋         | 70/1024 [00:00<00:02, 344.75it/s]
Adding requests:  11%|█         | 111/1024 [00:00<00:02, 373.40it/s]
Adding requests:  15%|█▍        | 150/1024 [00:00<00:02, 376.78it/s]
Adding requests:  19%|█▉        | 194/1024 [00:00<00:02, 397.73it/s]
Adding requests:  23%|██▎       | 238/1024 [00:00<00:01, 410.88it/s]
Adding requests:  27%|██▋       | 280/1024 [00:00<00:01, 407.33it/s]
Adding requests:  32%|███▏      | 323/1024 [00:00<00:01, 413.02it/s]
Adding requests:  36%|███▌      | 368/1024 [00:00<00:01, 423.49it/s]
Adding requests:  40%|████      | 412/1024 [00:01<00:01, 427.18it/s]
Adding requests:  44%|████▍     | 455/1024 [00:01<00:01, 425.74it/s]
Adding requests:  49%|████▊     | 499/1024 [00:01<00:01, 429.43it/s]
Adding requests:  53%|█████▎    | 542/1024 [00:01<00:01, 429.25it/s]
Adding requests:  57%|█████▋    | 585/1024 [00:01<00:01, 427.31it/s]
Adding requests:  61%|██████▏   | 629/1024 [00:01<00:00, 427.59it/s]
Adding requests:  66%|██████▌   | 672/1024 [00:01<00:00, 399.45it/s]
Adding requests:  70%|███████   | 717/1024 [00:01<00:00, 410.39it/s]
Adding requests:  74%|███████▍  | 759/1024 [00:01<00:00, 405.34it/s]
Adding requests:  78%|███████▊  | 801/1024 [00:01<00:00, 409.04it/s]
Adding requests:  83%|████████▎ | 845/1024 [00:02<00:00, 415.50it/s]
Adding requests:  87%|████████▋ | 889/1024 [00:02<00:00, 422.41it/s]
Adding requests:  91%|█████████ | 932/1024 [00:02<00:00, 417.81it/s]
Adding requests:  95%|█████████▌| 975/1024 [00:02<00:00, 421.30it/s]
Adding requests:  99%|█████████▉| 1018/1024 [00:02<00:00, 416.89it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 412.03it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<00:33, 30.40it/s, est. speed input: 31129.00 toks/s, output: 30.40 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:01<01:40,  9.99it/s, est. speed input: 11517.60 toks/s, output: 11.25 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:02<02:04,  8.00it/s, est. speed input: 9300.09 toks/s, output: 9.08 toks/s]  
Processed prompts:   3%|▎         | 34/1024 [00:04<02:16,  7.26it/s, est. speed input: 8432.36 toks/s, output: 8.23 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:05<02:22,  6.89it/s, est. speed input: 7963.98 toks/s, output: 7.78 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:06<02:26,  6.67it/s, est. speed input: 7670.64 toks/s, output: 7.49 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:07<02:27,  6.54it/s, est. speed input: 7472.65 toks/s, output: 7.30 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:09<02:28,  6.46it/s, est. speed input: 7329.23 toks/s, output: 7.16 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:10<02:28,  6.40it/s, est. speed input: 7221.56 toks/s, output: 7.05 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:11<02:27,  6.37it/s, est. speed input: 7137.49 toks/s, output: 6.97 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:13<02:27,  6.34it/s, est. speed input: 7066.38 toks/s, output: 6.90 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:14<02:26,  6.32it/s, est. speed input: 7009.80 toks/s, output: 6.85 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:15<02:25,  6.31it/s, est. speed input: 6963.34 toks/s, output: 6.80 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:16<02:24,  6.30it/s, est. speed input: 6923.26 toks/s, output: 6.76 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:18<02:23,  6.30it/s, est. speed input: 6889.39 toks/s, output: 6.73 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:19<02:22,  6.28it/s, est. speed input: 6857.25 toks/s, output: 6.70 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:20<02:21,  6.28it/s, est. speed input: 6830.12 toks/s, output: 6.67 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:21<02:19,  6.28it/s, est. speed input: 6806.40 toks/s, output: 6.65 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:23<02:18,  6.27it/s, est. speed input: 6785.13 toks/s, output: 6.63 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:24<02:17,  6.28it/s, est. speed input: 6766.70 toks/s, output: 6.61 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:25<02:16,  6.27it/s, est. speed input: 6748.74 toks/s, output: 6.59 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:27<02:14,  6.27it/s, est. speed input: 6733.95 toks/s, output: 6.58 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:28<02:13,  6.28it/s, est. speed input: 6720.89 toks/s, output: 6.56 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:29<02:12,  6.27it/s, est. speed input: 6707.68 toks/s, output: 6.55 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:30<02:12,  6.20it/s, est. speed input: 6684.62 toks/s, output: 6.53 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:32<02:11,  6.21it/s, est. speed input: 6672.84 toks/s, output: 6.52 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:33<02:09,  6.23it/s, est. speed input: 6662.92 toks/s, output: 6.51 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:34<02:07,  6.24it/s, est. speed input: 6654.58 toks/s, output: 6.50 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:36<02:06,  6.25it/s, est. speed input: 6646.41 toks/s, output: 6.49 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:37<02:04,  6.26it/s, est. speed input: 6638.62 toks/s, output: 6.48 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:38<02:03,  6.25it/s, est. speed input: 6630.67 toks/s, output: 6.48 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:39<02:02,  6.26it/s, est. speed input: 6624.03 toks/s, output: 6.47 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:41<02:00,  6.27it/s, est. speed input: 6618.04 toks/s, output: 6.46 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:42<01:59,  6.27it/s, est. speed input: 6612.31 toks/s, output: 6.46 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:43<01:58,  6.27it/s, est. speed input: 6606.61 toks/s, output: 6.45 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:44<01:57,  6.27it/s, est. speed input: 6600.98 toks/s, output: 6.45 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:46<01:55,  6.26it/s, est. speed input: 6595.60 toks/s, output: 6.44 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:47<01:51,  6.46it/s, est. speed input: 6609.08 toks/s, output: 6.45 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:48<01:50,  6.41it/s, est. speed input: 6604.26 toks/s, output: 6.45 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:49<01:50,  6.36it/s, est. speed input: 6599.54 toks/s, output: 6.44 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:51<01:49,  6.33it/s, est. speed input: 6594.25 toks/s, output: 6.44 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:52<01:48,  6.31it/s, est. speed input: 6590.40 toks/s, output: 6.44 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:53<01:47,  6.30it/s, est. speed input: 6586.45 toks/s, output: 6.43 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:55<01:46,  6.29it/s, est. speed input: 6582.53 toks/s, output: 6.43 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:56<01:45,  6.29it/s, est. speed input: 6578.96 toks/s, output: 6.42 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:57<01:44,  6.27it/s, est. speed input: 6574.85 toks/s, output: 6.42 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:58<01:42,  6.27it/s, est. speed input: 6571.59 toks/s, output: 6.42 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:00<01:41,  6.27it/s, est. speed input: 6568.48 toks/s, output: 6.41 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:01<01:40,  6.27it/s, est. speed input: 6565.39 toks/s, output: 6.41 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:02<01:39,  6.27it/s, est. speed input: 6562.49 toks/s, output: 6.41 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:04<01:38,  6.23it/s, est. speed input: 6556.67 toks/s, output: 6.40 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:05<01:37,  6.24it/s, est. speed input: 6553.65 toks/s, output: 6.40 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:06<01:35,  6.24it/s, est. speed input: 6550.65 toks/s, output: 6.40 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:07<01:31,  6.45it/s, est. speed input: 6561.03 toks/s, output: 6.41 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:09<01:31,  6.39it/s, est. speed input: 6558.37 toks/s, output: 6.40 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:10<01:30,  6.34it/s, est. speed input: 6555.15 toks/s, output: 6.40 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:11<01:29,  6.32it/s, est. speed input: 6552.64 toks/s, output: 6.40 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:12<01:28,  6.30it/s, est. speed input: 6550.19 toks/s, output: 6.40 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:14<01:27,  6.29it/s, est. speed input: 6548.03 toks/s, output: 6.39 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:15<01:26,  6.29it/s, est. speed input: 6545.80 toks/s, output: 6.39 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:16<01:25,  6.27it/s, est. speed input: 6543.11 toks/s, output: 6.39 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:17<01:23,  6.27it/s, est. speed input: 6540.93 toks/s, output: 6.39 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:19<01:22,  6.27it/s, est. speed input: 6538.90 toks/s, output: 6.39 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:20<01:21,  6.27it/s, est. speed input: 6536.92 toks/s, output: 6.38 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:21<01:20,  6.26it/s, est. speed input: 6534.95 toks/s, output: 6.38 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:23<01:18,  6.26it/s, est. speed input: 6532.71 toks/s, output: 6.38 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:24<01:17,  6.26it/s, est. speed input: 6530.99 toks/s, output: 6.38 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:25<01:16,  6.26it/s, est. speed input: 6529.09 toks/s, output: 6.38 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:26<01:15,  6.26it/s, est. speed input: 6527.40 toks/s, output: 6.37 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:28<01:13,  6.26it/s, est. speed input: 6525.65 toks/s, output: 6.37 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:29<01:12,  6.25it/s, est. speed input: 6523.61 toks/s, output: 6.37 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:30<01:11,  6.25it/s, est. speed input: 6521.86 toks/s, output: 6.37 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:32<01:10,  6.26it/s, est. speed input: 6520.48 toks/s, output: 6.37 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:33<01:08,  6.26it/s, est. speed input: 6519.01 toks/s, output: 6.37 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:34<01:07,  6.25it/s, est. speed input: 6517.30 toks/s, output: 6.36 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:35<01:06,  6.24it/s, est. speed input: 6514.93 toks/s, output: 6.36 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:37<01:05,  6.24it/s, est. speed input: 6513.54 toks/s, output: 6.36 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:38<01:03,  6.25it/s, est. speed input: 6512.29 toks/s, output: 6.36 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:39<01:02,  6.25it/s, est. speed input: 6510.85 toks/s, output: 6.36 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:40<01:01,  6.25it/s, est. speed input: 6509.31 toks/s, output: 6.36 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:42<00:59,  6.25it/s, est. speed input: 6508.23 toks/s, output: 6.36 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:43<00:58,  6.25it/s, est. speed input: 6506.84 toks/s, output: 6.35 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:44<00:57,  6.26it/s, est. speed input: 6505.77 toks/s, output: 6.35 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:46<00:55,  6.25it/s, est. speed input: 6504.45 toks/s, output: 6.35 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:47<00:54,  6.24it/s, est. speed input: 6502.79 toks/s, output: 6.35 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:48<00:53,  6.25it/s, est. speed input: 6501.65 toks/s, output: 6.35 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:49<00:52,  6.25it/s, est. speed input: 6500.54 toks/s, output: 6.35 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:51<00:50,  6.26it/s, est. speed input: 6499.65 toks/s, output: 6.35 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [01:52<00:49,  6.26it/s, est. speed input: 6498.64 toks/s, output: 6.35 toks/s]
Processed prompts:  71%|███████   | 722/1024 [01:53<00:48,  6.25it/s, est. speed input: 6497.46 toks/s, output: 6.35 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [01:55<00:47,  6.26it/s, est. speed input: 6496.49 toks/s, output: 6.34 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [01:56<00:45,  6.25it/s, est. speed input: 6495.36 toks/s, output: 6.34 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [01:57<00:44,  6.26it/s, est. speed input: 6494.48 toks/s, output: 6.34 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [01:58<00:43,  6.26it/s, est. speed input: 6493.72 toks/s, output: 6.34 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:00<00:41,  6.25it/s, est. speed input: 6492.50 toks/s, output: 6.34 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:01<00:40,  6.25it/s, est. speed input: 6491.66 toks/s, output: 6.34 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:02<00:39,  6.26it/s, est. speed input: 6490.87 toks/s, output: 6.34 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:03<00:36,  6.45it/s, est. speed input: 6496.59 toks/s, output: 6.34 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:05<00:35,  6.39it/s, est. speed input: 6495.71 toks/s, output: 6.34 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:06<00:34,  6.34it/s, est. speed input: 6494.61 toks/s, output: 6.34 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:07<00:33,  6.30it/s, est. speed input: 6493.26 toks/s, output: 6.34 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:09<00:32,  6.29it/s, est. speed input: 6492.57 toks/s, output: 6.34 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:10<00:31,  6.28it/s, est. speed input: 6491.59 toks/s, output: 6.34 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:11<00:30,  6.28it/s, est. speed input: 6490.91 toks/s, output: 6.34 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:12<00:29,  6.27it/s, est. speed input: 6489.98 toks/s, output: 6.34 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:14<00:27,  6.27it/s, est. speed input: 6489.31 toks/s, output: 6.34 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:15<00:26,  6.26it/s, est. speed input: 6488.51 toks/s, output: 6.34 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:16<00:25,  6.26it/s, est. speed input: 6487.82 toks/s, output: 6.34 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:17<00:23,  6.27it/s, est. speed input: 6487.30 toks/s, output: 6.34 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:19<00:22,  6.26it/s, est. speed input: 6486.37 toks/s, output: 6.33 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:20<00:21,  6.26it/s, est. speed input: 6485.62 toks/s, output: 6.33 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:21<00:20,  6.26it/s, est. speed input: 6484.94 toks/s, output: 6.33 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:23<00:18,  6.26it/s, est. speed input: 6484.37 toks/s, output: 6.33 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:24<00:17,  6.26it/s, est. speed input: 6483.81 toks/s, output: 6.33 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:25<00:16,  6.25it/s, est. speed input: 6482.88 toks/s, output: 6.33 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:26<00:15,  6.26it/s, est. speed input: 6482.25 toks/s, output: 6.33 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:28<00:13,  6.26it/s, est. speed input: 6481.78 toks/s, output: 6.33 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:29<00:12,  6.26it/s, est. speed input: 6481.25 toks/s, output: 6.33 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:30<00:11,  6.27it/s, est. speed input: 6480.73 toks/s, output: 6.33 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:32<00:09,  6.26it/s, est. speed input: 6479.93 toks/s, output: 6.33 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:33<00:08,  6.26it/s, est. speed input: 6479.36 toks/s, output: 6.33 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:34<00:07,  6.26it/s, est. speed input: 6478.76 toks/s, output: 6.33 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:35<00:06,  6.26it/s, est. speed input: 6478.23 toks/s, output: 6.33 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:37<00:04,  6.26it/s, est. speed input: 6477.62 toks/s, output: 6.33 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:38<00:03,  6.26it/s, est. speed input: 6477.00 toks/s, output: 6.33 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:39<00:02,  6.24it/s, est. speed input: 6475.94 toks/s, output: 6.32 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:40<00:00,  6.47it/s, est. speed input: 6481.47 toks/s, output: 6.33 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:40<00:00,  6.47it/s, est. speed input: 6519.66 toks/s, output: 6.37 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:40<00:00,  6.37it/s, est. speed input: 6519.66 toks/s, output: 6.37 toks/s]
[rank0]:[W126 15:31:31.214754476 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 248.8s

测试结果:
  Requests/s:   6.27
  Tokens/s:     6426.66
  Total Reqs:   1024
  Elapsed:      163.32s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     6420.39

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:31:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:31:47 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1447287) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1447287) WARNING 01-26 15:33:06 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.30 requests/s, 6456.41 total tokens/s, 6.30 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 15:31:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:31:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:31:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:31:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:31:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:31:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:31:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:31:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:31:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:31:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:31:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:31:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:31:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:31:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:31:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:31:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:31:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1447287) [2026-01-26 15:31:51] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1447287) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1447287) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.93s/it]
(EngineCore_DP0 pid=1447287) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 31.06s/it]
(EngineCore_DP0 pid=1447287) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 30.14s/it]
(EngineCore_DP0 pid=1447287) 
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1447287) [2026-01-26 15:32:53] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1447287) 2026-01-26 15:33:02,288 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1447287) 2026-01-26 15:33:02,989 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 34/2048 [00:00<00:06, 331.18it/s]
Adding requests:   3%|▎         | 69/2048 [00:00<00:05, 341.69it/s]
Adding requests:   5%|▌         | 110/2048 [00:00<00:05, 372.37it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:05, 377.02it/s]
Adding requests:   9%|▉         | 191/2048 [00:00<00:04, 391.41it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:04, 401.85it/s]
Adding requests:  13%|█▎        | 275/2048 [00:00<00:04, 404.03it/s]
Adding requests:  16%|█▌        | 318/2048 [00:00<00:04, 411.04it/s]
Adding requests:  18%|█▊        | 362/2048 [00:00<00:04, 418.99it/s]
Adding requests:  20%|█▉        | 405/2048 [00:01<00:03, 419.12it/s]
Adding requests:  22%|██▏       | 448/2048 [00:01<00:03, 420.75it/s]
Adding requests:  24%|██▍       | 493/2048 [00:01<00:03, 426.97it/s]
Adding requests:  26%|██▌       | 537/2048 [00:01<00:03, 427.75it/s]
Adding requests:  28%|██▊       | 580/2048 [00:01<00:03, 423.19it/s]
Adding requests:  30%|███       | 623/2048 [00:01<00:03, 416.06it/s]
Adding requests:  32%|███▏      | 665/2048 [00:01<00:03, 410.47it/s]
Adding requests:  35%|███▍      | 707/2048 [00:01<00:03, 411.61it/s]
Adding requests:  37%|███▋      | 749/2048 [00:01<00:03, 411.83it/s]
Adding requests:  39%|███▊      | 791/2048 [00:01<00:03, 385.16it/s]
Adding requests:  41%|████      | 834/2048 [00:02<00:03, 397.48it/s]
Adding requests:  43%|████▎     | 875/2048 [00:02<00:07, 152.62it/s]
Adding requests:  45%|████▍     | 914/2048 [00:02<00:06, 184.36it/s]
Adding requests:  47%|████▋     | 954/2048 [00:02<00:04, 218.88it/s]
Adding requests:  49%|████▊     | 995/2048 [00:03<00:04, 253.94it/s]
Adding requests:  51%|█████     | 1037/2048 [00:03<00:03, 286.63it/s]
Adding requests:  53%|█████▎    | 1077/2048 [00:03<00:03, 311.55it/s]
Adding requests:  55%|█████▍    | 1117/2048 [00:03<00:02, 332.21it/s]
Adding requests:  57%|█████▋    | 1158/2048 [00:03<00:02, 350.82it/s]
Adding requests:  59%|█████▊    | 1201/2048 [00:03<00:02, 369.56it/s]
Adding requests:  61%|██████    | 1242/2048 [00:03<00:02, 380.28it/s]
Adding requests:  63%|██████▎   | 1283/2048 [00:03<00:01, 384.25it/s]
Adding requests:  65%|██████▍   | 1326/2048 [00:03<00:01, 397.25it/s]
Adding requests:  67%|██████▋   | 1367/2048 [00:03<00:01, 397.50it/s]
Adding requests:  69%|██████▉   | 1408/2048 [00:04<00:01, 398.94it/s]
Adding requests:  71%|███████   | 1449/2048 [00:04<00:01, 402.03it/s]
Adding requests:  73%|███████▎  | 1492/2048 [00:04<00:01, 408.74it/s]
Adding requests:  75%|███████▍  | 1534/2048 [00:04<00:01, 406.95it/s]
Adding requests:  77%|███████▋  | 1576/2048 [00:04<00:01, 406.65it/s]
Adding requests:  79%|███████▉  | 1618/2048 [00:04<00:01, 407.07it/s]
Adding requests:  81%|████████  | 1659/2048 [00:04<00:01, 384.48it/s]
Adding requests:  83%|████████▎ | 1698/2048 [00:04<00:00, 375.58it/s]
Adding requests:  85%|████████▍ | 1736/2048 [00:04<00:00, 370.12it/s]
Adding requests:  87%|████████▋ | 1778/2048 [00:05<00:00, 382.76it/s]
Adding requests:  89%|████████▉ | 1818/2048 [00:05<00:00, 387.44it/s]
Adding requests:  91%|█████████ | 1860/2048 [00:05<00:00, 395.76it/s]
Adding requests:  93%|█████████▎| 1903/2048 [00:05<00:00, 404.34it/s]
Adding requests:  95%|█████████▌| 1946/2048 [00:05<00:00, 408.77it/s]
Adding requests:  97%|█████████▋| 1987/2048 [00:05<00:00, 406.93it/s]
Adding requests:  99%|█████████▉| 2028/2048 [00:05<00:00, 368.96it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 359.25it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:02<02:10, 15.41it/s, est. speed input: 15780.14 toks/s, output: 15.41 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:04<03:25,  9.70it/s, est. speed input: 10745.23 toks/s, output: 10.49 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:07<04:04,  8.10it/s, est. speed input: 9247.38 toks/s, output: 9.03 toks/s]  
Processed prompts:   4%|▍         | 82/2048 [00:09<04:26,  7.37it/s, est. speed input: 8519.16 toks/s, output: 8.32 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:12<04:39,  6.97it/s, est. speed input: 8088.44 toks/s, output: 7.90 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:14<04:47,  6.73it/s, est. speed input: 7807.07 toks/s, output: 7.62 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:17<04:51,  6.58it/s, est. speed input: 7605.67 toks/s, output: 7.43 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:20<04:53,  6.48it/s, est. speed input: 7454.86 toks/s, output: 7.28 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:22<04:53,  6.42it/s, est. speed input: 7340.82 toks/s, output: 7.17 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:25<05:00,  6.22it/s, est. speed input: 7189.71 toks/s, output: 7.02 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:27<04:53,  6.32it/s, est. speed input: 7146.59 toks/s, output: 6.98 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:30<04:51,  6.30it/s, est. speed input: 7084.61 toks/s, output: 6.92 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:32<04:49,  6.30it/s, est. speed input: 7035.04 toks/s, output: 6.87 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:35<04:47,  6.29it/s, est. speed input: 6990.67 toks/s, output: 6.83 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:38<04:45,  6.28it/s, est. speed input: 6951.25 toks/s, output: 6.79 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:40<04:42,  6.28it/s, est. speed input: 6918.06 toks/s, output: 6.76 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:43<04:40,  6.27it/s, est. speed input: 6887.21 toks/s, output: 6.73 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:45<04:33,  6.36it/s, est. speed input: 6879.50 toks/s, output: 6.72 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:48<04:32,  6.33it/s, est. speed input: 6855.30 toks/s, output: 6.69 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:50<04:31,  6.31it/s, est. speed input: 6832.46 toks/s, output: 6.67 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:53<04:29,  6.29it/s, est. speed input: 6812.02 toks/s, output: 6.65 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:55<04:26,  6.29it/s, est. speed input: 6793.99 toks/s, output: 6.63 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:58<04:24,  6.28it/s, est. speed input: 6777.67 toks/s, output: 6.62 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:00<04:22,  6.28it/s, est. speed input: 6763.01 toks/s, output: 6.60 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:03<04:20,  6.27it/s, est. speed input: 6747.98 toks/s, output: 6.59 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:05<04:13,  6.36it/s, est. speed input: 6747.83 toks/s, output: 6.59 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:08<04:12,  6.33it/s, est. speed input: 6735.53 toks/s, output: 6.58 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:10<04:10,  6.31it/s, est. speed input: 6723.16 toks/s, output: 6.57 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:13<04:08,  6.29it/s, est. speed input: 6712.17 toks/s, output: 6.55 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:16<04:06,  6.28it/s, est. speed input: 6701.47 toks/s, output: 6.54 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:18<04:04,  6.27it/s, est. speed input: 6692.09 toks/s, output: 6.54 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:21<04:01,  6.28it/s, est. speed input: 6683.99 toks/s, output: 6.53 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:23<03:59,  6.27it/s, est. speed input: 6675.85 toks/s, output: 6.52 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:26<03:56,  6.27it/s, est. speed input: 6668.40 toks/s, output: 6.51 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:28<03:54,  6.27it/s, est. speed input: 6660.86 toks/s, output: 6.50 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:31<03:52,  6.27it/s, est. speed input: 6653.93 toks/s, output: 6.50 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:33<03:49,  6.26it/s, est. speed input: 6646.76 toks/s, output: 6.49 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:36<03:47,  6.26it/s, est. speed input: 6640.78 toks/s, output: 6.49 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:39<03:44,  6.27it/s, est. speed input: 6635.37 toks/s, output: 6.48 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:41<03:41,  6.26it/s, est. speed input: 6629.51 toks/s, output: 6.47 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:44<03:39,  6.27it/s, est. speed input: 6624.66 toks/s, output: 6.47 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:46<03:36,  6.26it/s, est. speed input: 6619.40 toks/s, output: 6.46 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:49<03:34,  6.26it/s, est. speed input: 6614.29 toks/s, output: 6.46 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:51<03:31,  6.26it/s, est. speed input: 6609.56 toks/s, output: 6.45 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [01:54<03:29,  6.26it/s, est. speed input: 6605.08 toks/s, output: 6.45 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [01:56<03:26,  6.26it/s, est. speed input: 6601.00 toks/s, output: 6.45 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [01:59<03:24,  6.26it/s, est. speed input: 6596.67 toks/s, output: 6.44 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:01<03:18,  6.35it/s, est. speed input: 6599.30 toks/s, output: 6.44 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:04<03:16,  6.33it/s, est. speed input: 6595.80 toks/s, output: 6.44 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:07<03:15,  6.31it/s, est. speed input: 6592.06 toks/s, output: 6.44 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:09<03:13,  6.29it/s, est. speed input: 6588.10 toks/s, output: 6.43 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:12<03:11,  6.27it/s, est. speed input: 6584.15 toks/s, output: 6.43 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:14<03:08,  6.27it/s, est. speed input: 6580.71 toks/s, output: 6.43 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:17<03:06,  6.26it/s, est. speed input: 6577.59 toks/s, output: 6.42 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:19<03:03,  6.26it/s, est. speed input: 6574.43 toks/s, output: 6.42 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:22<03:01,  6.26it/s, est. speed input: 6571.63 toks/s, output: 6.42 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:24<02:58,  6.26it/s, est. speed input: 6568.79 toks/s, output: 6.41 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:27<02:55,  6.27it/s, est. speed input: 6566.27 toks/s, output: 6.41 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:30<02:53,  6.26it/s, est. speed input: 6563.54 toks/s, output: 6.41 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:32<02:50,  6.27it/s, est. speed input: 6561.24 toks/s, output: 6.41 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:35<02:48,  6.27it/s, est. speed input: 6558.94 toks/s, output: 6.41 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:37<02:45,  6.26it/s, est. speed input: 6556.23 toks/s, output: 6.40 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:40<02:43,  6.26it/s, est. speed input: 6553.94 toks/s, output: 6.40 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:42<02:40,  6.26it/s, est. speed input: 6551.86 toks/s, output: 6.40 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:45<02:37,  6.27it/s, est. speed input: 6550.10 toks/s, output: 6.40 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [02:47<02:35,  6.27it/s, est. speed input: 6548.29 toks/s, output: 6.39 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [02:50<02:32,  6.27it/s, est. speed input: 6546.03 toks/s, output: 6.39 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [02:53<02:30,  6.26it/s, est. speed input: 6544.07 toks/s, output: 6.39 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [02:55<02:27,  6.26it/s, est. speed input: 6542.15 toks/s, output: 6.39 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [02:58<02:25,  6.27it/s, est. speed input: 6540.49 toks/s, output: 6.39 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:00<02:22,  6.27it/s, est. speed input: 6538.96 toks/s, output: 6.39 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:03<02:19,  6.27it/s, est. speed input: 6537.48 toks/s, output: 6.38 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:05<02:17,  6.27it/s, est. speed input: 6535.74 toks/s, output: 6.38 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:08<02:13,  6.36it/s, est. speed input: 6538.37 toks/s, output: 6.39 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:10<02:11,  6.33it/s, est. speed input: 6536.87 toks/s, output: 6.38 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:13<02:07,  6.41it/s, est. speed input: 6539.49 toks/s, output: 6.39 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:15<02:05,  6.36it/s, est. speed input: 6537.60 toks/s, output: 6.38 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:18<02:03,  6.33it/s, est. speed input: 6536.11 toks/s, output: 6.38 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:20<02:01,  6.31it/s, est. speed input: 6534.64 toks/s, output: 6.38 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:23<01:59,  6.30it/s, est. speed input: 6533.03 toks/s, output: 6.38 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:25<01:56,  6.29it/s, est. speed input: 6531.76 toks/s, output: 6.38 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:28<01:52,  6.37it/s, est. speed input: 6534.08 toks/s, output: 6.38 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:30<01:50,  6.34it/s, est. speed input: 6532.69 toks/s, output: 6.38 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:33<01:48,  6.32it/s, est. speed input: 6531.34 toks/s, output: 6.38 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:36<01:46,  6.30it/s, est. speed input: 6529.72 toks/s, output: 6.38 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:38<01:43,  6.29it/s, est. speed input: 6528.54 toks/s, output: 6.38 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:41<01:41,  6.28it/s, est. speed input: 6526.91 toks/s, output: 6.37 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [03:43<01:39,  6.27it/s, est. speed input: 6525.74 toks/s, output: 6.37 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [03:46<01:35,  6.36it/s, est. speed input: 6528.03 toks/s, output: 6.38 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [03:48<01:31,  6.43it/s, est. speed input: 6530.21 toks/s, output: 6.38 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [03:51<01:29,  6.38it/s, est. speed input: 6529.02 toks/s, output: 6.38 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [03:53<01:27,  6.34it/s, est. speed input: 6527.69 toks/s, output: 6.37 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [03:56<01:25,  6.32it/s, est. speed input: 6526.42 toks/s, output: 6.37 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [03:58<01:22,  6.39it/s, est. speed input: 6528.56 toks/s, output: 6.38 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:01<01:20,  6.35it/s, est. speed input: 6527.22 toks/s, output: 6.37 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:03<01:16,  6.42it/s, est. speed input: 6529.36 toks/s, output: 6.38 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:06<01:14,  6.38it/s, est. speed input: 6528.43 toks/s, output: 6.38 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:08<01:12,  6.34it/s, est. speed input: 6527.14 toks/s, output: 6.37 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:11<01:10,  6.32it/s, est. speed input: 6525.92 toks/s, output: 6.37 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:13<01:07,  6.40it/s, est. speed input: 6528.18 toks/s, output: 6.38 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:16<01:05,  6.36it/s, est. speed input: 6527.03 toks/s, output: 6.37 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:18<01:02,  6.33it/s, est. speed input: 6526.06 toks/s, output: 6.37 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:21<01:00,  6.32it/s, est. speed input: 6525.17 toks/s, output: 6.37 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:24<00:58,  6.30it/s, est. speed input: 6524.00 toks/s, output: 6.37 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:26<00:55,  6.29it/s, est. speed input: 6522.90 toks/s, output: 6.37 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [04:29<00:53,  6.28it/s, est. speed input: 6521.86 toks/s, output: 6.37 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [04:31<00:49,  6.37it/s, est. speed input: 6523.80 toks/s, output: 6.37 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [04:33<00:46,  6.55it/s, est. speed input: 6529.41 toks/s, output: 6.38 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [04:36<00:44,  6.46it/s, est. speed input: 6528.36 toks/s, output: 6.38 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [04:38<00:42,  6.40it/s, est. speed input: 6527.27 toks/s, output: 6.37 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [04:41<00:39,  6.36it/s, est. speed input: 6526.23 toks/s, output: 6.37 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [04:44<00:37,  6.33it/s, est. speed input: 6525.11 toks/s, output: 6.37 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [04:46<00:35,  6.31it/s, est. speed input: 6524.13 toks/s, output: 6.37 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [04:49<00:32,  6.29it/s, est. speed input: 6523.16 toks/s, output: 6.37 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [04:51<00:30,  6.29it/s, est. speed input: 6522.34 toks/s, output: 6.37 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [04:54<00:27,  6.28it/s, est. speed input: 6521.41 toks/s, output: 6.37 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [04:56<00:24,  6.36it/s, est. speed input: 6523.05 toks/s, output: 6.37 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [04:59<00:22,  6.34it/s, est. speed input: 6522.24 toks/s, output: 6.37 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:01<00:19,  6.31it/s, est. speed input: 6521.03 toks/s, output: 6.37 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:04<00:17,  6.29it/s, est. speed input: 6520.06 toks/s, output: 6.37 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:06<00:14,  6.28it/s, est. speed input: 6519.07 toks/s, output: 6.37 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:09<00:12,  6.27it/s, est. speed input: 6518.18 toks/s, output: 6.37 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:11<00:09,  6.37it/s, est. speed input: 6519.99 toks/s, output: 6.37 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:14<00:07,  6.33it/s, est. speed input: 6518.99 toks/s, output: 6.37 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:17<00:04,  6.31it/s, est. speed input: 6518.13 toks/s, output: 6.37 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:19<00:02,  6.41it/s, est. speed input: 6520.40 toks/s, output: 6.37 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:19<00:00,  6.41it/s, est. speed input: 6565.28 toks/s, output: 6.41 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:19<00:00,  6.41it/s, est. speed input: 6565.28 toks/s, output: 6.41 toks/s]
[rank0]:[W126 15:38:31.065881454 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 420.2s

测试结果:
  Requests/s:   6.30
  Tokens/s:     6456.41
  Total Reqs:   2048
  Elapsed:      325.13s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     6450.11

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:38:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:38:52 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1453309) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1453309) WARNING 01-26 15:40:17 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.33 requests/s, 6483.84 total tokens/s, 6.33 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 15:38:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:38:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:38:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:38:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:38:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:38:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:38:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:38:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:38:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:38:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:38:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:38:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:38:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:38:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:38:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:38:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:38:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1453309) [2026-01-26 15:38:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1453309) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1453309) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.89s/it]
(EngineCore_DP0 pid=1453309) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.36s/it]
(EngineCore_DP0 pid=1453309) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.54s/it]
(EngineCore_DP0 pid=1453309) 
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1453309) [2026-01-26 15:39:57] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1453309) 2026-01-26 15:40:09,072 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1453309) 2026-01-26 15:40:10,440 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 45/4096 [00:00<00:09, 448.11it/s]
Adding requests:   2%|▏         | 90/4096 [00:00<00:09, 423.61it/s]
Adding requests:   3%|▎         | 133/4096 [00:00<00:09, 407.08it/s]
Adding requests:   4%|▍         | 174/4096 [00:00<00:09, 398.45it/s]
Adding requests:   5%|▌         | 217/4096 [00:00<00:09, 409.05it/s]
Adding requests:   6%|▋         | 258/4096 [00:00<00:09, 392.97it/s]
Adding requests:   7%|▋         | 301/4096 [00:00<00:09, 402.00it/s]
Adding requests:   8%|▊         | 342/4096 [00:00<00:09, 401.94it/s]
Adding requests:   9%|▉         | 386/4096 [00:00<00:08, 412.74it/s]
Adding requests:  11%|█         | 431/4096 [00:01<00:08, 423.97it/s]
Adding requests:  12%|█▏        | 474/4096 [00:01<00:08, 420.22it/s]
Adding requests:  13%|█▎        | 525/4096 [00:01<00:08, 443.28it/s]
Adding requests:  14%|█▍        | 570/4096 [00:01<00:08, 433.27it/s]
Adding requests:  15%|█▍        | 614/4096 [00:01<00:08, 423.61it/s]
Adding requests:  16%|█▌        | 657/4096 [00:01<00:08, 421.34it/s]
Adding requests:  17%|█▋        | 701/4096 [00:01<00:07, 425.74it/s]
Adding requests:  18%|█▊        | 744/4096 [00:01<00:07, 424.40it/s]
Adding requests:  19%|█▉        | 787/4096 [00:01<00:07, 420.73it/s]
Adding requests:  20%|██        | 831/4096 [00:01<00:07, 423.60it/s]
Adding requests:  21%|██▏       | 874/4096 [00:02<00:07, 416.46it/s]
Adding requests:  22%|██▏       | 916/4096 [00:02<00:07, 416.82it/s]
Adding requests:  23%|██▎       | 958/4096 [00:02<00:07, 416.22it/s]
Adding requests:  24%|██▍       | 1000/4096 [00:02<00:07, 409.54it/s]
Adding requests:  25%|██▌       | 1043/4096 [00:02<00:07, 414.24it/s]
Adding requests:  26%|██▋       | 1085/4096 [00:02<00:07, 402.94it/s]
Adding requests:  27%|██▋       | 1126/4096 [00:02<00:07, 404.05it/s]
Adding requests:  28%|██▊       | 1167/4096 [00:02<00:07, 397.31it/s]
Adding requests:  29%|██▉       | 1207/4096 [00:02<00:07, 366.59it/s]
Adding requests:  31%|███       | 1251/4096 [00:03<00:07, 386.72it/s]
Adding requests:  32%|███▏      | 1291/4096 [00:03<00:07, 377.74it/s]
Adding requests:  33%|███▎      | 1333/4096 [00:03<00:07, 385.66it/s]
Adding requests:  34%|███▎      | 1376/4096 [00:03<00:06, 397.01it/s]
Adding requests:  35%|███▍      | 1417/4096 [00:03<00:06, 398.42it/s]
Adding requests:  36%|███▌      | 1462/4096 [00:03<00:06, 412.72it/s]
Adding requests:  37%|███▋      | 1504/4096 [00:03<00:06, 410.92it/s]
Adding requests:  38%|███▊      | 1549/4096 [00:03<00:06, 421.56it/s]
Adding requests:  39%|███▉      | 1592/4096 [00:03<00:06, 410.43it/s]
Adding requests:  40%|███▉      | 1634/4096 [00:03<00:06, 406.46it/s]
Adding requests:  41%|████      | 1675/4096 [00:04<00:06, 400.41it/s]
Adding requests:  42%|████▏     | 1716/4096 [00:04<00:05, 401.64it/s]
Adding requests:  43%|████▎     | 1759/4096 [00:04<00:05, 408.99it/s]
Adding requests:  44%|████▍     | 1801/4096 [00:04<00:05, 409.35it/s]
Adding requests:  45%|████▌     | 1845/4096 [00:04<00:05, 416.72it/s]
Adding requests:  46%|████▌     | 1887/4096 [00:04<00:05, 413.34it/s]
Adding requests:  47%|████▋     | 1930/4096 [00:04<00:05, 414.78it/s]
Adding requests:  48%|████▊     | 1972/4096 [00:04<00:05, 406.91it/s]
Adding requests:  49%|████▉     | 2013/4096 [00:04<00:05, 396.85it/s]
Adding requests:  50%|█████     | 2056/4096 [00:05<00:05, 403.94it/s]
Adding requests:  51%|█████     | 2097/4096 [00:05<00:05, 396.62it/s]
Adding requests:  52%|█████▏    | 2140/4096 [00:05<00:04, 402.82it/s]
Adding requests:  53%|█████▎    | 2181/4096 [00:05<00:04, 396.45it/s]
Adding requests:  54%|█████▍    | 2221/4096 [00:05<00:04, 386.59it/s]
Adding requests:  55%|█████▌    | 2262/4096 [00:05<00:04, 391.30it/s]
Adding requests:  56%|█████▋    | 2307/4096 [00:05<00:04, 405.76it/s]
Adding requests:  57%|█████▋    | 2353/4096 [00:05<00:04, 420.02it/s]
Adding requests:  58%|█████▊    | 2396/4096 [00:05<00:04, 418.24it/s]
Adding requests:  60%|█████▉    | 2438/4096 [00:05<00:04, 412.25it/s]
Adding requests:  61%|██████    | 2480/4096 [00:06<00:04, 400.56it/s]
Adding requests:  62%|██████▏   | 2524/4096 [00:06<00:03, 411.46it/s]
Adding requests:  63%|██████▎   | 2570/4096 [00:06<00:03, 422.74it/s]
Adding requests:  64%|██████▍   | 2613/4096 [00:06<00:03, 420.61it/s]
Adding requests:  65%|██████▍   | 2656/4096 [00:06<00:03, 422.81it/s]
Adding requests:  66%|██████▌   | 2699/4096 [00:06<00:03, 406.47it/s]
Adding requests:  67%|██████▋   | 2743/4096 [00:06<00:03, 415.86it/s]
Adding requests:  68%|██████▊   | 2785/4096 [00:06<00:03, 416.09it/s]
Adding requests:  69%|██████▉   | 2827/4096 [00:06<00:03, 416.60it/s]
Adding requests:  70%|███████   | 2869/4096 [00:07<00:02, 416.77it/s]
Adding requests:  71%|███████   | 2911/4096 [00:07<00:02, 416.35it/s]
Adding requests:  72%|███████▏  | 2957/4096 [00:07<00:02, 428.77it/s]
Adding requests:  73%|███████▎  | 3000/4096 [00:07<00:02, 424.41it/s]
Adding requests:  74%|███████▍  | 3046/4096 [00:07<00:02, 434.59it/s]
Adding requests:  75%|███████▌  | 3090/4096 [00:07<00:02, 428.56it/s]
Adding requests:  76%|███████▋  | 3133/4096 [00:07<00:02, 428.55it/s]
Adding requests:  78%|███████▊  | 3176/4096 [00:07<00:02, 414.59it/s]
Adding requests:  79%|███████▊  | 3220/4096 [00:07<00:02, 419.97it/s]
Adding requests:  80%|███████▉  | 3263/4096 [00:07<00:01, 417.57it/s]
Adding requests:  81%|████████  | 3305/4096 [00:08<00:01, 404.54it/s]
Adding requests:  82%|████████▏ | 3350/4096 [00:08<00:01, 417.10it/s]
Adding requests:  83%|████████▎ | 3392/4096 [00:08<00:01, 408.26it/s]
Adding requests:  84%|████████▍ | 3435/4096 [00:08<00:01, 412.46it/s]
Adding requests:  85%|████████▍ | 3479/4096 [00:08<00:01, 419.27it/s]
Adding requests:  86%|████████▌ | 3522/4096 [00:08<00:01, 408.81it/s]
Adding requests:  87%|████████▋ | 3569/4096 [00:08<00:01, 425.56it/s]
Adding requests:  88%|████████▊ | 3612/4096 [00:08<00:01, 414.79it/s]
Adding requests:  89%|████████▉ | 3657/4096 [00:08<00:01, 423.11it/s]
Adding requests:  90%|█████████ | 3700/4096 [00:08<00:00, 406.34it/s]
Adding requests:  91%|█████████▏| 3741/4096 [00:09<00:00, 406.49it/s]
Adding requests:  92%|█████████▏| 3782/4096 [00:09<00:00, 406.29it/s]
Adding requests:  93%|█████████▎| 3823/4096 [00:09<00:00, 369.63it/s]
Adding requests:  94%|█████████▍| 3864/4096 [00:09<00:00, 376.92it/s]
Adding requests:  95%|█████████▌| 3904/4096 [00:09<00:00, 382.79it/s]
Adding requests:  96%|█████████▋| 3944/4096 [00:09<00:00, 387.24it/s]
Adding requests:  97%|█████████▋| 3988/4096 [00:09<00:00, 400.07it/s]
Adding requests:  98%|█████████▊| 4030/4096 [00:09<00:00, 403.07it/s]
Adding requests:  99%|█████████▉| 4074/4096 [00:09<00:00, 410.22it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 409.27it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 34/4096 [00:00<00:48, 82.95it/s, est. speed input: 84951.93 toks/s, output: 82.95 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:05<06:27, 10.39it/s, est. speed input: 12303.42 toks/s, output: 12.01 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:10<08:16,  8.05it/s, est. speed input: 9504.61 toks/s, output: 9.28 toks/s]  
Processed prompts:   3%|▎         | 130/4096 [00:15<09:05,  7.26it/s, est. speed input: 8514.56 toks/s, output: 8.31 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:21<10:18,  6.36it/s, est. speed input: 7612.58 toks/s, output: 7.43 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:26<10:10,  6.39it/s, est. speed input: 7425.55 toks/s, output: 7.25 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:31<10:08,  6.36it/s, est. speed input: 7271.67 toks/s, output: 7.10 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:36<10:05,  6.34it/s, est. speed input: 7158.97 toks/s, output: 6.99 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:41<09:56,  6.38it/s, est. speed input: 7094.29 toks/s, output: 6.93 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:46<09:53,  6.36it/s, est. speed input: 7026.05 toks/s, output: 6.86 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:52<09:51,  6.33it/s, est. speed input: 6966.84 toks/s, output: 6.80 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:57<09:47,  6.32it/s, est. speed input: 6919.62 toks/s, output: 6.76 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:02<09:39,  6.35it/s, est. speed input: 6893.02 toks/s, output: 6.73 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:07<09:35,  6.33it/s, est. speed input: 6858.99 toks/s, output: 6.70 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:12<09:31,  6.32it/s, est. speed input: 6830.01 toks/s, output: 6.67 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:17<09:27,  6.31it/s, est. speed input: 6804.93 toks/s, output: 6.65 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:22<09:22,  6.31it/s, est. speed input: 6782.46 toks/s, output: 6.62 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:27<09:18,  6.30it/s, est. speed input: 6761.34 toks/s, output: 6.60 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:32<09:14,  6.29it/s, est. speed input: 6743.37 toks/s, output: 6.59 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:37<09:09,  6.29it/s, est. speed input: 6727.56 toks/s, output: 6.57 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:42<09:04,  6.29it/s, est. speed input: 6713.15 toks/s, output: 6.56 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:47<08:58,  6.29it/s, est. speed input: 6700.27 toks/s, output: 6.54 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:52<08:53,  6.29it/s, est. speed input: 6688.84 toks/s, output: 6.53 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:57<08:45,  6.33it/s, est. speed input: 6683.74 toks/s, output: 6.53 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:03<08:41,  6.32it/s, est. speed input: 6673.85 toks/s, output: 6.52 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:08<08:37,  6.31it/s, est. speed input: 6664.43 toks/s, output: 6.51 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:13<08:32,  6.30it/s, est. speed input: 6656.09 toks/s, output: 6.50 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:18<08:27,  6.30it/s, est. speed input: 6648.62 toks/s, output: 6.49 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:23<08:22,  6.30it/s, est. speed input: 6641.51 toks/s, output: 6.49 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:28<08:18,  6.29it/s, est. speed input: 6633.42 toks/s, output: 6.48 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:33<08:13,  6.29it/s, est. speed input: 6627.38 toks/s, output: 6.47 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:38<08:08,  6.29it/s, est. speed input: 6621.30 toks/s, output: 6.47 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:43<08:02,  6.29it/s, est. speed input: 6615.72 toks/s, output: 6.46 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:48<07:57,  6.29it/s, est. speed input: 6610.55 toks/s, output: 6.46 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:53<07:53,  6.29it/s, est. speed input: 6605.20 toks/s, output: 6.45 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:59<07:47,  6.29it/s, est. speed input: 6600.38 toks/s, output: 6.45 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:04<07:39,  6.33it/s, est. speed input: 6600.27 toks/s, output: 6.45 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:08<07:32,  6.36it/s, est. speed input: 6599.97 toks/s, output: 6.45 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:14<07:28,  6.34it/s, est. speed input: 6595.94 toks/s, output: 6.44 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:19<07:24,  6.33it/s, est. speed input: 6592.06 toks/s, output: 6.44 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:24<07:17,  6.36it/s, est. speed input: 6592.08 toks/s, output: 6.44 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:29<07:13,  6.34it/s, est. speed input: 6588.59 toks/s, output: 6.43 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:34<07:10,  6.31it/s, est. speed input: 6583.49 toks/s, output: 6.43 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:39<07:06,  6.30it/s, est. speed input: 6579.74 toks/s, output: 6.43 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:44<06:54,  6.40it/s, est. speed input: 6585.01 toks/s, output: 6.43 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:49<06:51,  6.37it/s, est. speed input: 6581.92 toks/s, output: 6.43 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:54<06:45,  6.39it/s, est. speed input: 6582.37 toks/s, output: 6.43 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:59<06:39,  6.41it/s, est. speed input: 6582.72 toks/s, output: 6.43 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:04<06:36,  6.38it/s, est. speed input: 6580.05 toks/s, output: 6.43 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:09<06:29,  6.40it/s, est. speed input: 6580.35 toks/s, output: 6.43 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:14<06:26,  6.37it/s, est. speed input: 6577.72 toks/s, output: 6.42 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:19<06:23,  6.34it/s, est. speed input: 6575.09 toks/s, output: 6.42 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:24<06:19,  6.33it/s, est. speed input: 6572.36 toks/s, output: 6.42 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:29<06:05,  6.48it/s, est. speed input: 6580.46 toks/s, output: 6.43 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:34<06:03,  6.42it/s, est. speed input: 6577.85 toks/s, output: 6.42 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:39<06:01,  6.37it/s, est. speed input: 6574.79 toks/s, output: 6.42 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:44<05:57,  6.35it/s, est. speed input: 6572.30 toks/s, output: 6.42 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:49<05:53,  6.33it/s, est. speed input: 6570.03 toks/s, output: 6.42 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:54<05:46,  6.37it/s, est. speed input: 6570.62 toks/s, output: 6.42 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:59<05:42,  6.34it/s, est. speed input: 6568.38 toks/s, output: 6.41 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [05:04<05:38,  6.33it/s, est. speed input: 6566.26 toks/s, output: 6.41 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:09<05:31,  6.36it/s, est. speed input: 6566.64 toks/s, output: 6.41 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:14<05:27,  6.34it/s, est. speed input: 6564.68 toks/s, output: 6.41 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:19<05:21,  6.37it/s, est. speed input: 6564.99 toks/s, output: 6.41 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:24<05:17,  6.34it/s, est. speed input: 6563.13 toks/s, output: 6.41 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:29<05:13,  6.33it/s, est. speed input: 6561.29 toks/s, output: 6.41 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:35<05:08,  6.31it/s, est. speed input: 6559.18 toks/s, output: 6.41 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:39<05:01,  6.35it/s, est. speed input: 6559.78 toks/s, output: 6.41 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:45<04:58,  6.33it/s, est. speed input: 6557.63 toks/s, output: 6.40 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:50<04:53,  6.32it/s, est. speed input: 6556.08 toks/s, output: 6.40 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:55<04:48,  6.31it/s, est. speed input: 6554.57 toks/s, output: 6.40 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [06:00<04:43,  6.30it/s, est. speed input: 6552.87 toks/s, output: 6.40 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [06:05<04:37,  6.34it/s, est. speed input: 6553.35 toks/s, output: 6.40 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:10<04:32,  6.33it/s, est. speed input: 6551.89 toks/s, output: 6.40 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [06:15<04:28,  6.31it/s, est. speed input: 6549.86 toks/s, output: 6.40 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [06:20<04:23,  6.30it/s, est. speed input: 6548.47 toks/s, output: 6.39 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [06:25<04:18,  6.30it/s, est. speed input: 6546.99 toks/s, output: 6.39 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:30<04:13,  6.30it/s, est. speed input: 6545.66 toks/s, output: 6.39 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:35<04:06,  6.34it/s, est. speed input: 6546.39 toks/s, output: 6.39 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:40<04:02,  6.33it/s, est. speed input: 6545.21 toks/s, output: 6.39 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:45<03:56,  6.36it/s, est. speed input: 6545.87 toks/s, output: 6.39 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:50<03:52,  6.33it/s, est. speed input: 6544.05 toks/s, output: 6.39 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [06:55<03:45,  6.36it/s, est. speed input: 6544.76 toks/s, output: 6.39 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [07:00<03:41,  6.34it/s, est. speed input: 6543.44 toks/s, output: 6.39 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [07:05<03:35,  6.37it/s, est. speed input: 6544.12 toks/s, output: 6.39 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [07:11<03:31,  6.35it/s, est. speed input: 6542.94 toks/s, output: 6.39 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [07:16<03:26,  6.33it/s, est. speed input: 6541.77 toks/s, output: 6.39 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [07:21<03:22,  6.31it/s, est. speed input: 6540.41 toks/s, output: 6.39 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [07:26<03:17,  6.30it/s, est. speed input: 6539.21 toks/s, output: 6.39 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:30<03:07,  6.46it/s, est. speed input: 6544.19 toks/s, output: 6.39 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:35<03:03,  6.45it/s, est. speed input: 6544.67 toks/s, output: 6.39 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:41<02:59,  6.40it/s, est. speed input: 6543.48 toks/s, output: 6.39 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:45<02:54,  6.42it/s, est. speed input: 6544.12 toks/s, output: 6.39 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [07:51<02:50,  6.37it/s, est. speed input: 6542.71 toks/s, output: 6.39 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [07:56<02:46,  6.35it/s, est. speed input: 6541.66 toks/s, output: 6.39 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [08:01<02:41,  6.33it/s, est. speed input: 6540.60 toks/s, output: 6.39 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [08:06<02:36,  6.32it/s, est. speed input: 6539.49 toks/s, output: 6.39 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [08:11<02:31,  6.31it/s, est. speed input: 6538.59 toks/s, output: 6.39 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [08:16<02:25,  6.35it/s, est. speed input: 6539.08 toks/s, output: 6.39 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [08:21<02:21,  6.33it/s, est. speed input: 6538.17 toks/s, output: 6.38 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [08:26<02:16,  6.31it/s, est. speed input: 6537.01 toks/s, output: 6.38 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [08:31<02:11,  6.30it/s, est. speed input: 6535.98 toks/s, output: 6.38 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:36<02:06,  6.30it/s, est. speed input: 6534.94 toks/s, output: 6.38 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:41<02:01,  6.30it/s, est. speed input: 6534.03 toks/s, output: 6.38 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:46<01:56,  6.30it/s, est. speed input: 6533.30 toks/s, output: 6.38 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [08:51<01:50,  6.34it/s, est. speed input: 6533.97 toks/s, output: 6.38 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [08:57<01:46,  6.32it/s, est. speed input: 6532.75 toks/s, output: 6.38 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [09:02<01:41,  6.31it/s, est. speed input: 6531.82 toks/s, output: 6.38 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [09:07<01:36,  6.30it/s, est. speed input: 6531.04 toks/s, output: 6.38 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [09:12<01:31,  6.30it/s, est. speed input: 6530.17 toks/s, output: 6.38 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [09:17<01:25,  6.35it/s, est. speed input: 6530.91 toks/s, output: 6.38 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [09:22<01:20,  6.33it/s, est. speed input: 6530.17 toks/s, output: 6.38 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [09:27<01:15,  6.36it/s, est. speed input: 6530.57 toks/s, output: 6.38 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [09:32<01:10,  6.33it/s, est. speed input: 6529.65 toks/s, output: 6.38 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:37<01:04,  6.43it/s, est. speed input: 6532.01 toks/s, output: 6.38 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:42<00:59,  6.39it/s, est. speed input: 6531.32 toks/s, output: 6.38 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:47<00:55,  6.36it/s, est. speed input: 6530.47 toks/s, output: 6.38 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [09:52<00:50,  6.33it/s, est. speed input: 6529.67 toks/s, output: 6.38 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [09:57<00:45,  6.32it/s, est. speed input: 6528.91 toks/s, output: 6.38 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [10:02<00:40,  6.31it/s, est. speed input: 6528.07 toks/s, output: 6.38 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [10:07<00:35,  6.30it/s, est. speed input: 6527.37 toks/s, output: 6.37 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [10:12<00:29,  6.35it/s, est. speed input: 6528.01 toks/s, output: 6.38 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [10:17<00:24,  6.37it/s, est. speed input: 6528.54 toks/s, output: 6.38 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [10:22<00:19,  6.35it/s, est. speed input: 6527.84 toks/s, output: 6.37 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [10:27<00:14,  6.38it/s, est. speed input: 6528.45 toks/s, output: 6.38 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [10:32<00:09,  6.39it/s, est. speed input: 6528.79 toks/s, output: 6.38 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [10:37<00:04,  6.47it/s, est. speed input: 6531.05 toks/s, output: 6.38 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:37<00:00,  6.47it/s, est. speed input: 6579.23 toks/s, output: 6.43 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:37<00:00,  6.43it/s, est. speed input: 6579.23 toks/s, output: 6.43 toks/s]
[rank0]:[W126 15:51:05.662764521 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 753.7s

测试结果:
  Requests/s:   6.33
  Tokens/s:     6483.84
  Total Reqs:   4096
  Elapsed:      647.52s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     6477.52

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:51:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:51:39 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1464015) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1464015) ERROR 01-26 15:52:46 [core.py:866] 


─── STDERR ───
[2026-01-26 15:51:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:51:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:51:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:51:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:51:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:51:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:51:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:51:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:51:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:51:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:51:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:51:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:51:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:51:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:51:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:51:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:51:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1464015) [2026-01-26 15:51:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1464015) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1464015) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.65s/it]
(EngineCore_DP0 pid=1464015) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 30.28s/it]
(EngineCore_DP0 pid=1464015) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.44s/it]
(EngineCore_DP0 pid=1464015) 
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 16662528 bytes
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 12959744 bytes
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 137003008 bytes
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1464015) [2026-01-26 15:52:44] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 68009984 bytes
(EngineCore_DP0 pid=1464015) Process EngineCore_DP0:
(EngineCore_DP0 pid=1464015) Traceback (most recent call last):
(EngineCore_DP0 pid=1464015)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1464015)     self.run()
(EngineCore_DP0 pid=1464015)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1464015)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1464015)     raise e
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1464015)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1464015)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1464015)     super().__init__(
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1464015)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1464015)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1464015)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1464015)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1464015)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1464015)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1464015)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1464015)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1464015)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1464015)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1464015)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1464015)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1464015)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1464015)     outputs = self.model(
(EngineCore_DP0 pid=1464015)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1464015)     hidden_states = self.model(
(EngineCore_DP0 pid=1464015)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1464015)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1464015)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1464015)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1464015)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1464015)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1464015)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1464015)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1464015)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1464015)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1464015)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1464015)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1464015)     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1464015)     return self._linear_fn(
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1464015)     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1464015)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1464015)     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1464015)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1464015)     return fn(input, L)
(EngineCore_DP0 pid=1464015)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1464015)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1464015)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1464015) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1464015) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1464015) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1464015) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1464015) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1464015) 
[rank0]:[W126 15:52:47.527466682 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_6/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,10.3490,5309.0605,12.3683
1024,1024,1,128,128,6.3665,6525.7021,20.1051
2048,1024,2,256,128,6.4378,6598.7118,39.7653
4096,1024,4,512,128,6.2814,6438.4781,81.5099
8192,1024,8,1024,128,6.2699,6426.6610,163.3196
16384,1024,16,2048,128,6.2989,6456.4121,325.1341
32768,1024,32,4096,128,6.3257,6483.8433,647.5172
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-INT8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_8

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:52:53 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:52:53 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1465220) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1465220) WARNING 01-26 15:54:11 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 10.32 requests/s, 5292.38 total tokens/s, 10.32 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 15:52:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:52:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:52:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:52:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:52:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:52:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:52:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:52:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:52:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:52:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:52:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:52:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:52:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:52:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:52:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:52:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:52:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1465220) [2026-01-26 15:52:57] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1465220) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1465220) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:27<00:27, 27.81s/it]
(EngineCore_DP0 pid=1465220) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 31.03s/it]
(EngineCore_DP0 pid=1465220) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 30.54s/it]
(EngineCore_DP0 pid=1465220) 
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1465220) [2026-01-26 15:53:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1465220) 2026-01-26 15:54:08,405 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1465220) 2026-01-26 15:54:08,501 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<01:28,  1.43it/s]
Adding requests:   2%|▏         | 2/128 [00:00<00:49,  2.52it/s]
Adding requests:   2%|▏         | 3/128 [00:01<00:34,  3.64it/s]
Adding requests:   4%|▍         | 5/128 [00:01<00:20,  5.92it/s]
Adding requests:   5%|▌         | 7/128 [00:01<00:14,  8.17it/s]
Adding requests:   7%|▋         | 9/128 [00:01<00:11, 10.50it/s]
Adding requests:   9%|▉         | 12/128 [00:01<00:08, 13.99it/s]
Adding requests:  13%|█▎        | 17/128 [00:01<00:05, 20.86it/s]
Adding requests:  16%|█▋        | 21/128 [00:01<00:04, 24.51it/s]
Adding requests:  21%|██        | 27/128 [00:01<00:03, 32.79it/s]
Adding requests:  31%|███▏      | 40/128 [00:02<00:01, 57.66it/s]
Adding requests:  60%|██████    | 77/128 [00:02<00:00, 141.01it/s]
Adding requests:  98%|█████████▊| 126/128 [00:02<00:00, 236.40it/s]
Adding requests: 100%|██████████| 128/128 [00:02<00:00, 57.75it/s] 

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:01, 103.04it/s, est. speed input: 52765.10 toks/s, output: 103.04 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:04, 20.88it/s, est. speed input: 12504.92 toks/s, output: 24.42 toks/s]  
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 17.39it/s, est. speed input: 10642.20 toks/s, output: 20.79 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:05, 15.49it/s, est. speed input: 9713.95 toks/s, output: 18.97 toks/s] 
Processed prompts:  31%|███▏      | 40/128 [00:02<00:06, 14.47it/s, est. speed input: 9237.11 toks/s, output: 18.04 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:06, 13.89it/s, est. speed input: 8985.13 toks/s, output: 17.55 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:06, 13.34it/s, est. speed input: 8762.63 toks/s, output: 17.11 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:06, 12.89it/s, est. speed input: 8574.53 toks/s, output: 16.75 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:06, 12.47it/s, est. speed input: 8400.79 toks/s, output: 16.41 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:06, 12.07it/s, est. speed input: 8237.08 toks/s, output: 16.09 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:06, 11.89it/s, est. speed input: 8108.74 toks/s, output: 15.84 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:06, 11.70it/s, est. speed input: 7987.40 toks/s, output: 15.60 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:06, 11.65it/s, est. speed input: 7887.90 toks/s, output: 15.41 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:06, 11.57it/s, est. speed input: 7792.43 toks/s, output: 15.22 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:05, 11.47it/s, est. speed input: 7701.63 toks/s, output: 15.04 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:04<00:05, 11.27it/s, est. speed input: 7605.04 toks/s, output: 14.85 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:04<00:05, 11.32it/s, est. speed input: 7534.77 toks/s, output: 14.72 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:05, 11.32it/s, est. speed input: 7467.43 toks/s, output: 14.58 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:05, 11.34it/s, est. speed input: 7405.85 toks/s, output: 14.46 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:05, 11.33it/s, est. speed input: 7347.02 toks/s, output: 14.35 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:05<00:04, 11.21it/s, est. speed input: 7284.09 toks/s, output: 14.23 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:05<00:04, 11.18it/s, est. speed input: 7229.13 toks/s, output: 14.12 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:05<00:04, 11.20it/s, est. speed input: 7180.91 toks/s, output: 14.03 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:05<00:04, 11.21it/s, est. speed input: 7135.39 toks/s, output: 13.94 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:04, 11.20it/s, est. speed input: 7091.88 toks/s, output: 13.85 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:05<00:04, 11.20it/s, est. speed input: 7051.26 toks/s, output: 13.77 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:06<00:03, 11.16it/s, est. speed input: 7010.53 toks/s, output: 13.69 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:06<00:03, 11.14it/s, est. speed input: 6972.50 toks/s, output: 13.62 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:06<00:03, 11.11it/s, est. speed input: 6935.80 toks/s, output: 13.55 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:06<00:03, 11.20it/s, est. speed input: 6907.24 toks/s, output: 13.49 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:06<00:03, 11.16it/s, est. speed input: 6874.64 toks/s, output: 13.43 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:07<00:03, 11.16it/s, est. speed input: 6845.07 toks/s, output: 13.37 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:07<00:02, 11.08it/s, est. speed input: 6812.68 toks/s, output: 13.31 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:07<00:02, 11.14it/s, est. speed input: 6787.90 toks/s, output: 13.26 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:07<00:02, 11.19it/s, est. speed input: 6764.42 toks/s, output: 13.21 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:07<00:02, 11.23it/s, est. speed input: 6742.55 toks/s, output: 13.17 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:07<00:02, 11.23it/s, est. speed input: 6720.14 toks/s, output: 13.13 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:08<00:01, 11.21it/s, est. speed input: 6697.85 toks/s, output: 13.08 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:08<00:01, 11.09it/s, est. speed input: 6672.13 toks/s, output: 13.03 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:08<00:01, 11.11it/s, est. speed input: 6651.97 toks/s, output: 12.99 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:08<00:01, 11.15it/s, est. speed input: 6633.58 toks/s, output: 12.96 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:08<00:01, 11.16it/s, est. speed input: 6615.05 toks/s, output: 12.92 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:09<00:01, 11.18it/s, est. speed input: 6597.81 toks/s, output: 12.89 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:09<00:00, 11.19it/s, est. speed input: 6581.14 toks/s, output: 12.85 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:09<00:00, 11.07it/s, est. speed input: 6560.32 toks/s, output: 12.81 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:09<00:00, 11.12it/s, est. speed input: 6545.50 toks/s, output: 12.78 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:09<00:00, 11.12it/s, est. speed input: 6529.64 toks/s, output: 12.75 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:09<00:00, 11.10it/s, est. speed input: 6513.77 toks/s, output: 12.72 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.15it/s, est. speed input: 6500.52 toks/s, output: 12.70 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.15it/s, est. speed input: 6500.52 toks/s, output: 12.70 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.70it/s, est. speed input: 6500.52 toks/s, output: 12.70 toks/s]
[rank0]:[W126 15:54:24.782156294 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 110.2s

测试结果:
  Requests/s:   10.32
  Tokens/s:     5292.38
  Total Reqs:   128
  Elapsed:      12.41s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5282.07

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:54:43 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:54:43 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1466941) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1466941) WARNING 01-26 15:56:00 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.94 requests/s, 6084.76 total tokens/s, 5.94 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 15:54:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:54:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:54:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:54:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:54:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:54:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:54:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:54:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:54:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:54:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:54:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:54:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:54:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:54:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:54:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:54:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:54:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1466941) [2026-01-26 15:54:48] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1466941) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1466941) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.56s/it]
(EngineCore_DP0 pid=1466941) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.59s/it]
(EngineCore_DP0 pid=1466941) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.14s/it]
(EngineCore_DP0 pid=1466941) 
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1466941) [2026-01-26 15:55:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1466941) 2026-01-26 15:55:59,722 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1466941) 2026-01-26 15:55:59,755 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  32%|███▏      | 41/128 [00:00<00:00, 398.97it/s]
Adding requests:  63%|██████▎   | 81/128 [00:00<00:00, 370.26it/s]
Adding requests:  94%|█████████▍| 120/128 [00:00<00:00, 377.09it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 378.06it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:17,  7.28it/s, est. speed input: 7458.31 toks/s, output: 7.28 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:23,  5.33it/s, est. speed input: 5767.21 toks/s, output: 5.63 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:22,  5.53it/s, est. speed input: 5831.11 toks/s, output: 5.69 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:21,  5.73it/s, est. speed input: 5918.10 toks/s, output: 5.78 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:20,  5.84it/s, est. speed input: 5969.04 toks/s, output: 5.83 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:20,  5.93it/s, est. speed input: 6008.17 toks/s, output: 5.87 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:20,  5.98it/s, est. speed input: 6039.13 toks/s, output: 5.90 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:19,  6.02it/s, est. speed input: 6060.58 toks/s, output: 5.92 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:19,  5.99it/s, est. speed input: 6061.93 toks/s, output: 5.92 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:19,  5.98it/s, est. speed input: 6066.11 toks/s, output: 5.92 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:02<00:19,  6.00it/s, est. speed input: 6076.88 toks/s, output: 5.93 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:19,  6.03it/s, est. speed input: 6089.18 toks/s, output: 5.95 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:18,  6.04it/s, est. speed input: 6097.46 toks/s, output: 5.95 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:18,  6.04it/s, est. speed input: 6102.77 toks/s, output: 5.96 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:18,  6.03it/s, est. speed input: 6105.26 toks/s, output: 5.96 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:18,  6.00it/s, est. speed input: 6104.25 toks/s, output: 5.96 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:03<00:18,  6.01it/s, est. speed input: 6108.47 toks/s, output: 5.97 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:03<00:18,  6.04it/s, est. speed input: 6116.15 toks/s, output: 5.97 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:17,  6.11it/s, est. speed input: 6131.27 toks/s, output: 5.99 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:17,  6.13it/s, est. speed input: 6140.13 toks/s, output: 6.00 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:17,  6.11it/s, est. speed input: 6142.50 toks/s, output: 6.00 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:17,  6.06it/s, est. speed input: 6139.96 toks/s, output: 6.00 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:04<00:17,  6.06it/s, est. speed input: 6142.50 toks/s, output: 6.00 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:04<00:16,  6.07it/s, est. speed input: 6146.55 toks/s, output: 6.00 toks/s]
Processed prompts:  20%|██        | 26/128 [00:04<00:16,  6.07it/s, est. speed input: 6149.10 toks/s, output: 6.00 toks/s]
Processed prompts:  21%|██        | 27/128 [00:04<00:16,  6.07it/s, est. speed input: 6151.34 toks/s, output: 6.01 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:16,  6.05it/s, est. speed input: 6151.64 toks/s, output: 6.01 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:16,  6.05it/s, est. speed input: 6152.89 toks/s, output: 6.01 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:16,  6.01it/s, est. speed input: 6149.37 toks/s, output: 6.01 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:05<00:16,  6.04it/s, est. speed input: 6153.11 toks/s, output: 6.01 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:05<00:15,  6.06it/s, est. speed input: 6156.26 toks/s, output: 6.01 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:05<00:15,  6.07it/s, est. speed input: 6158.27 toks/s, output: 6.01 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:05<00:15,  6.05it/s, est. speed input: 6158.58 toks/s, output: 6.01 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:05<00:15,  6.05it/s, est. speed input: 6159.44 toks/s, output: 6.02 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:15,  6.03it/s, est. speed input: 6158.26 toks/s, output: 6.01 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:06<00:15,  6.06it/s, est. speed input: 6161.43 toks/s, output: 6.02 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:06<00:14,  6.06it/s, est. speed input: 6162.84 toks/s, output: 6.02 toks/s]
Processed prompts:  30%|███       | 39/128 [00:06<00:14,  6.04it/s, est. speed input: 6162.15 toks/s, output: 6.02 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:06<00:14,  6.08it/s, est. speed input: 6165.81 toks/s, output: 6.02 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:06<00:14,  6.10it/s, est. speed input: 6168.93 toks/s, output: 6.02 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:06<00:14,  6.04it/s, est. speed input: 6166.04 toks/s, output: 6.02 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:07<00:14,  6.04it/s, est. speed input: 6166.27 toks/s, output: 6.02 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:07<00:13,  6.05it/s, est. speed input: 6167.39 toks/s, output: 6.02 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:07<00:13,  6.04it/s, est. speed input: 6167.08 toks/s, output: 6.02 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:07<00:13,  6.02it/s, est. speed input: 6166.27 toks/s, output: 6.02 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:07<00:13,  6.06it/s, est. speed input: 6168.92 toks/s, output: 6.02 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:07<00:13,  6.08it/s, est. speed input: 6171.05 toks/s, output: 6.03 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:08<00:13,  6.03it/s, est. speed input: 6168.51 toks/s, output: 6.02 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:08<00:12,  6.07it/s, est. speed input: 6171.71 toks/s, output: 6.03 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:08<00:12,  6.06it/s, est. speed input: 6172.09 toks/s, output: 6.03 toks/s]
Processed prompts:  41%|████      | 52/128 [00:08<00:12,  6.07it/s, est. speed input: 6173.19 toks/s, output: 6.03 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:08<00:12,  6.10it/s, est. speed input: 6175.68 toks/s, output: 6.03 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:08<00:12,  6.10it/s, est. speed input: 6177.25 toks/s, output: 6.03 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:09<00:11,  6.08it/s, est. speed input: 6177.41 toks/s, output: 6.03 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:09<00:11,  6.12it/s, est. speed input: 6180.74 toks/s, output: 6.04 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:09<00:11,  6.13it/s, est. speed input: 6182.88 toks/s, output: 6.04 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:09<00:11,  6.10it/s, est. speed input: 6182.62 toks/s, output: 6.04 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:09<00:11,  6.09it/s, est. speed input: 6183.08 toks/s, output: 6.04 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:09<00:11,  6.06it/s, est. speed input: 6182.14 toks/s, output: 6.04 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:10<00:11,  5.99it/s, est. speed input: 6178.76 toks/s, output: 6.03 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:10<00:10,  6.01it/s, est. speed input: 6179.26 toks/s, output: 6.03 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:10<00:10,  6.04it/s, est. speed input: 6180.51 toks/s, output: 6.04 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:10<00:10,  6.07it/s, est. speed input: 6181.95 toks/s, output: 6.04 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:10<00:10,  6.06it/s, est. speed input: 6182.15 toks/s, output: 6.04 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:10<00:10,  6.06it/s, est. speed input: 6182.27 toks/s, output: 6.04 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:11<00:10,  6.05it/s, est. speed input: 6182.12 toks/s, output: 6.04 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:11<00:10,  5.99it/s, est. speed input: 6179.50 toks/s, output: 6.03 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:11<00:09,  6.01it/s, est. speed input: 6179.93 toks/s, output: 6.04 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:11<00:09,  6.01it/s, est. speed input: 6179.41 toks/s, output: 6.03 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:11<00:09,  6.03it/s, est. speed input: 6180.05 toks/s, output: 6.04 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:11<00:09,  6.06it/s, est. speed input: 6181.22 toks/s, output: 6.04 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:12<00:09,  6.06it/s, est. speed input: 6181.65 toks/s, output: 6.04 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:12<00:08,  6.06it/s, est. speed input: 6181.87 toks/s, output: 6.04 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:12<00:08,  6.09it/s, est. speed input: 6183.39 toks/s, output: 6.04 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:12<00:08,  6.08it/s, est. speed input: 6183.78 toks/s, output: 6.04 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:12<00:08,  6.08it/s, est. speed input: 6184.39 toks/s, output: 6.04 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:12<00:08,  6.07it/s, est. speed input: 6184.23 toks/s, output: 6.04 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:13<00:08,  6.07it/s, est. speed input: 6184.61 toks/s, output: 6.04 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:13<00:08,  5.99it/s, est. speed input: 6181.50 toks/s, output: 6.04 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:13<00:07,  6.01it/s, est. speed input: 6181.75 toks/s, output: 6.04 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:13<00:07,  6.03it/s, est. speed input: 6182.18 toks/s, output: 6.04 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:13<00:07,  6.05it/s, est. speed input: 6182.84 toks/s, output: 6.04 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:13<00:07,  6.04it/s, est. speed input: 6182.68 toks/s, output: 6.04 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:14<00:07,  6.02it/s, est. speed input: 6181.93 toks/s, output: 6.04 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:14<00:06,  6.08it/s, est. speed input: 6183.94 toks/s, output: 6.04 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:14<00:06,  5.99it/s, est. speed input: 6181.04 toks/s, output: 6.04 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:14<00:06,  6.04it/s, est. speed input: 6182.23 toks/s, output: 6.04 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:14<00:06,  6.08it/s, est. speed input: 6183.74 toks/s, output: 6.04 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:14<00:06,  6.05it/s, est. speed input: 6183.38 toks/s, output: 6.04 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:15<00:06,  6.03it/s, est. speed input: 6182.75 toks/s, output: 6.04 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:15<00:05,  6.07it/s, est. speed input: 6184.06 toks/s, output: 6.04 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:15<00:05,  6.02it/s, est. speed input: 6182.44 toks/s, output: 6.04 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:15<00:05,  6.03it/s, est. speed input: 6182.66 toks/s, output: 6.04 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:15<00:05,  6.04it/s, est. speed input: 6182.85 toks/s, output: 6.04 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:15<00:05,  6.02it/s, est. speed input: 6182.30 toks/s, output: 6.04 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:16<00:05,  5.99it/s, est. speed input: 6181.17 toks/s, output: 6.04 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:16<00:04,  6.03it/s, est. speed input: 6181.99 toks/s, output: 6.04 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:16<00:04,  5.99it/s, est. speed input: 6180.58 toks/s, output: 6.04 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:16<00:04,  5.98it/s, est. speed input: 6179.85 toks/s, output: 6.04 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:16<00:04,  6.00it/s, est. speed input: 6180.00 toks/s, output: 6.04 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:16<00:04,  6.05it/s, est. speed input: 6181.23 toks/s, output: 6.04 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:17<00:04,  6.05it/s, est. speed input: 6181.36 toks/s, output: 6.04 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:17<00:03,  6.07it/s, est. speed input: 6182.18 toks/s, output: 6.04 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:17<00:03,  6.08it/s, est. speed input: 6182.84 toks/s, output: 6.04 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:17<00:03,  6.02it/s, est. speed input: 6181.45 toks/s, output: 6.04 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:17<00:03,  6.02it/s, est. speed input: 6181.33 toks/s, output: 6.04 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:17<00:03,  6.05it/s, est. speed input: 6182.01 toks/s, output: 6.04 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:18<00:03,  6.02it/s, est. speed input: 6181.17 toks/s, output: 6.04 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:18<00:02,  6.02it/s, est. speed input: 6180.89 toks/s, output: 6.04 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:18<00:02,  6.05it/s, est. speed input: 6181.79 toks/s, output: 6.04 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:18<00:02,  5.99it/s, est. speed input: 6180.00 toks/s, output: 6.04 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:18<00:02,  6.01it/s, est. speed input: 6180.32 toks/s, output: 6.04 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:18<00:02,  6.03it/s, est. speed input: 6180.55 toks/s, output: 6.04 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:19<00:02,  6.02it/s, est. speed input: 6180.18 toks/s, output: 6.04 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:19<00:01,  6.03it/s, est. speed input: 6180.27 toks/s, output: 6.04 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:19<00:01,  6.03it/s, est. speed input: 6180.23 toks/s, output: 6.04 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:19<00:01,  5.99it/s, est. speed input: 6179.09 toks/s, output: 6.03 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:19<00:01,  5.98it/s, est. speed input: 6178.36 toks/s, output: 6.03 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:19<00:01,  6.01it/s, est. speed input: 6178.68 toks/s, output: 6.03 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:20<00:01,  6.01it/s, est. speed input: 6178.54 toks/s, output: 6.03 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:20<00:00,  6.02it/s, est. speed input: 6178.66 toks/s, output: 6.03 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:20<00:00,  6.02it/s, est. speed input: 6178.40 toks/s, output: 6.03 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:20<00:00,  6.02it/s, est. speed input: 6178.29 toks/s, output: 6.03 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:20<00:00,  5.96it/s, est. speed input: 6176.51 toks/s, output: 6.03 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:20<00:00,  5.98it/s, est. speed input: 6176.42 toks/s, output: 6.03 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:21<00:00,  5.99it/s, est. speed input: 6176.33 toks/s, output: 6.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  5.99it/s, est. speed input: 6176.09 toks/s, output: 6.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  5.99it/s, est. speed input: 6176.09 toks/s, output: 6.03 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  6.03it/s, est. speed input: 6176.09 toks/s, output: 6.03 toks/s]
[rank0]:[W126 15:56:22.586268038 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 105.2s

测试结果:
  Requests/s:   5.94
  Tokens/s:     6084.76
  Total Reqs:   128
  Elapsed:      21.56s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     6078.82

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:56:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:56:30 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1468625) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1468625) WARNING 01-26 15:57:46 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.09 requests/s, 6242.05 total tokens/s, 6.09 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 15:56:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:56:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:56:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:56:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:56:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:56:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:56:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:56:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:56:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:56:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:56:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:56:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:56:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:56:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:56:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:56:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:56:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1468625) [2026-01-26 15:56:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1468625) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1468625) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.38s/it]
(EngineCore_DP0 pid=1468625) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 31.17s/it]
(EngineCore_DP0 pid=1468625) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 30.75s/it]
(EngineCore_DP0 pid=1468625) 
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:37] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1468625) [2026-01-26 15:57:38] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1468625) 2026-01-26 15:57:45,689 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1468625) 2026-01-26 15:57:45,726 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  19%|█▉        | 49/256 [00:00<00:00, 484.93it/s]
Adding requests:  38%|███▊      | 98/256 [00:00<00:00, 434.26it/s]
Adding requests:  55%|█████▌    | 142/256 [00:00<00:00, 420.73it/s]
Adding requests:  73%|███████▎  | 187/256 [00:00<00:00, 431.54it/s]
Adding requests:  90%|█████████ | 231/256 [00:00<00:00, 429.82it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 430.36it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:21, 11.67it/s, est. speed input: 11954.93 toks/s, output: 11.67 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:29,  8.51it/s, est. speed input: 9209.83 toks/s, output: 8.99 toks/s]  
Processed prompts:   3%|▎         | 8/256 [00:00<00:33,  7.48it/s, est. speed input: 8282.95 toks/s, output: 8.09 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:35,  6.96it/s, est. speed input: 7792.71 toks/s, output: 7.61 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:36,  6.63it/s, est. speed input: 7472.11 toks/s, output: 7.30 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:01<00:37,  6.48it/s, est. speed input: 7286.77 toks/s, output: 7.12 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:37,  6.38it/s, est. speed input: 7151.13 toks/s, output: 6.98 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:37,  6.30it/s, est. speed input: 7041.00 toks/s, output: 6.88 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:02<00:37,  6.26it/s, est. speed input: 6963.41 toks/s, output: 6.80 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:37,  6.23it/s, est. speed input: 6895.65 toks/s, output: 6.73 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:37,  6.17it/s, est. speed input: 6829.36 toks/s, output: 6.67 toks/s]
Processed prompts:  10%|█         | 26/256 [00:03<00:37,  6.15it/s, est. speed input: 6782.84 toks/s, output: 6.62 toks/s]
Processed prompts:  11%|█         | 28/256 [00:04<00:37,  6.16it/s, est. speed input: 6746.81 toks/s, output: 6.59 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:04<00:36,  6.12it/s, est. speed input: 6706.97 toks/s, output: 6.55 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:04<00:36,  6.14it/s, est. speed input: 6680.72 toks/s, output: 6.52 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:05<00:36,  6.16it/s, est. speed input: 6661.11 toks/s, output: 6.50 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:05<00:35,  6.16it/s, est. speed input: 6640.49 toks/s, output: 6.48 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:05<00:35,  6.12it/s, est. speed input: 6614.87 toks/s, output: 6.46 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:06<00:35,  6.11it/s, est. speed input: 6594.93 toks/s, output: 6.44 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:06<00:34,  6.12it/s, est. speed input: 6579.23 toks/s, output: 6.43 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:06<00:34,  6.09it/s, est. speed input: 6558.56 toks/s, output: 6.40 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:07<00:34,  6.10it/s, est. speed input: 6546.25 toks/s, output: 6.39 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:07<00:33,  6.12it/s, est. speed input: 6536.33 toks/s, output: 6.38 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:07<00:33,  6.10it/s, est. speed input: 6521.67 toks/s, output: 6.37 toks/s]
Processed prompts:  20%|██        | 52/256 [00:08<00:33,  6.12it/s, est. speed input: 6513.24 toks/s, output: 6.36 toks/s]
Processed prompts:  21%|██        | 54/256 [00:08<00:32,  6.12it/s, est. speed input: 6504.52 toks/s, output: 6.35 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:08<00:32,  6.11it/s, est. speed input: 6493.97 toks/s, output: 6.34 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:09<00:32,  6.12it/s, est. speed input: 6486.88 toks/s, output: 6.33 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:09<00:32,  6.12it/s, est. speed input: 6479.14 toks/s, output: 6.33 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:09<00:31,  6.11it/s, est. speed input: 6471.34 toks/s, output: 6.32 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:10<00:31,  6.11it/s, est. speed input: 6464.36 toks/s, output: 6.31 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:10<00:31,  6.11it/s, est. speed input: 6457.40 toks/s, output: 6.31 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:10<00:30,  6.11it/s, est. speed input: 6451.95 toks/s, output: 6.30 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:11<00:30,  6.08it/s, est. speed input: 6443.27 toks/s, output: 6.29 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:11<00:30,  6.10it/s, est. speed input: 6438.97 toks/s, output: 6.29 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:11<00:29,  6.11it/s, est. speed input: 6434.39 toks/s, output: 6.28 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:12<00:29,  6.08it/s, est. speed input: 6426.35 toks/s, output: 6.28 toks/s]
Processed prompts:  30%|███       | 78/256 [00:12<00:29,  6.08it/s, est. speed input: 6421.60 toks/s, output: 6.27 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:12<00:28,  6.09it/s, est. speed input: 6417.53 toks/s, output: 6.27 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:13<00:28,  6.06it/s, est. speed input: 6410.58 toks/s, output: 6.26 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:13<00:28,  6.08it/s, est. speed input: 6406.63 toks/s, output: 6.26 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:13<00:27,  6.08it/s, est. speed input: 6402.92 toks/s, output: 6.25 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:14<00:27,  6.07it/s, est. speed input: 6397.90 toks/s, output: 6.25 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:14<00:27,  6.08it/s, est. speed input: 6394.75 toks/s, output: 6.24 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:14<00:26,  6.11it/s, est. speed input: 6392.72 toks/s, output: 6.24 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:15<00:26,  6.08it/s, est. speed input: 6388.06 toks/s, output: 6.24 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:15<00:26,  6.10it/s, est. speed input: 6385.57 toks/s, output: 6.24 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:15<00:25,  6.10it/s, est. speed input: 6383.13 toks/s, output: 6.23 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:16<00:25,  6.10it/s, est. speed input: 6380.02 toks/s, output: 6.23 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:16<00:25,  6.07it/s, est. speed input: 6375.56 toks/s, output: 6.23 toks/s]
Processed prompts:  41%|████      | 104/256 [00:16<00:25,  6.07it/s, est. speed input: 6372.60 toks/s, output: 6.22 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:17<00:24,  6.09it/s, est. speed input: 6370.68 toks/s, output: 6.22 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:17<00:24,  6.05it/s, est. speed input: 6365.68 toks/s, output: 6.22 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:17<00:24,  6.07it/s, est. speed input: 6363.92 toks/s, output: 6.21 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:18<00:23,  6.09it/s, est. speed input: 6362.33 toks/s, output: 6.21 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:18<00:23,  6.06it/s, est. speed input: 6358.44 toks/s, output: 6.21 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:18<00:23,  6.07it/s, est. speed input: 6356.13 toks/s, output: 6.21 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:19<00:22,  6.07it/s, est. speed input: 6353.77 toks/s, output: 6.20 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:19<00:22,  6.04it/s, est. speed input: 6349.61 toks/s, output: 6.20 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:19<00:22,  6.07it/s, est. speed input: 6348.80 toks/s, output: 6.20 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:20<00:21,  6.08it/s, est. speed input: 6347.17 toks/s, output: 6.20 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:20<00:21,  6.11it/s, est. speed input: 6346.57 toks/s, output: 6.20 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:20<00:21,  6.09it/s, est. speed input: 6344.15 toks/s, output: 6.20 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:20<00:20,  6.08it/s, est. speed input: 6342.12 toks/s, output: 6.19 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:21<00:20,  6.08it/s, est. speed input: 6340.39 toks/s, output: 6.19 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:21<00:20,  6.06it/s, est. speed input: 6337.49 toks/s, output: 6.19 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:21<00:19,  6.07it/s, est. speed input: 6336.18 toks/s, output: 6.19 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:22<00:19,  6.08it/s, est. speed input: 6334.57 toks/s, output: 6.19 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:22<00:19,  6.09it/s, est. speed input: 6333.77 toks/s, output: 6.19 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:22<00:18,  6.09it/s, est. speed input: 6332.45 toks/s, output: 6.18 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:23<00:18,  6.08it/s, est. speed input: 6330.53 toks/s, output: 6.18 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:23<00:18,  6.05it/s, est. speed input: 6327.35 toks/s, output: 6.18 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:23<00:17,  6.06it/s, est. speed input: 6326.11 toks/s, output: 6.18 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:24<00:17,  6.07it/s, est. speed input: 6325.18 toks/s, output: 6.18 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:24<00:17,  6.05it/s, est. speed input: 6322.71 toks/s, output: 6.17 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:24<00:16,  6.07it/s, est. speed input: 6322.00 toks/s, output: 6.17 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:25<00:16,  6.08it/s, est. speed input: 6321.08 toks/s, output: 6.17 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:25<00:16,  6.08it/s, est. speed input: 6319.74 toks/s, output: 6.17 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:25<00:15,  6.07it/s, est. speed input: 6317.95 toks/s, output: 6.17 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:26<00:15,  6.11it/s, est. speed input: 6318.54 toks/s, output: 6.17 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:26<00:15,  6.11it/s, est. speed input: 6317.64 toks/s, output: 6.17 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:26<00:14,  6.07it/s, est. speed input: 6315.32 toks/s, output: 6.17 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:27<00:14,  6.07it/s, est. speed input: 6314.24 toks/s, output: 6.17 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:27<00:14,  6.08it/s, est. speed input: 6313.28 toks/s, output: 6.17 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:27<00:13,  6.06it/s, est. speed input: 6311.67 toks/s, output: 6.16 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:28<00:13,  6.10it/s, est. speed input: 6311.92 toks/s, output: 6.16 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:28<00:13,  6.09it/s, est. speed input: 6310.71 toks/s, output: 6.16 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:28<00:12,  6.06it/s, est. speed input: 6308.55 toks/s, output: 6.16 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:29<00:12,  6.07it/s, est. speed input: 6307.90 toks/s, output: 6.16 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:29<00:12,  6.07it/s, est. speed input: 6306.77 toks/s, output: 6.16 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:29<00:11,  6.05it/s, est. speed input: 6305.16 toks/s, output: 6.16 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:30<00:11,  6.07it/s, est. speed input: 6304.66 toks/s, output: 6.16 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:30<00:11,  6.09it/s, est. speed input: 6304.28 toks/s, output: 6.16 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:30<00:10,  6.09it/s, est. speed input: 6303.76 toks/s, output: 6.16 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:31<00:10,  6.06it/s, est. speed input: 6301.77 toks/s, output: 6.15 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:31<00:10,  6.07it/s, est. speed input: 6301.32 toks/s, output: 6.15 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:31<00:09,  6.09it/s, est. speed input: 6300.98 toks/s, output: 6.15 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:32<00:09,  6.07it/s, est. speed input: 6299.71 toks/s, output: 6.15 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:32<00:09,  6.08it/s, est. speed input: 6299.10 toks/s, output: 6.15 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:32<00:07,  6.86it/s, est. speed input: 6322.31 toks/s, output: 6.17 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:33<00:07,  6.57it/s, est. speed input: 6320.32 toks/s, output: 6.17 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:33<00:07,  6.42it/s, est. speed input: 6319.52 toks/s, output: 6.17 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:33<00:07,  6.34it/s, est. speed input: 6319.49 toks/s, output: 6.17 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:34<00:07,  6.27it/s, est. speed input: 6318.87 toks/s, output: 6.17 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:34<00:07,  6.18it/s, est. speed input: 6317.10 toks/s, output: 6.17 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:34<00:06,  6.16it/s, est. speed input: 6316.43 toks/s, output: 6.17 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:35<00:06,  6.15it/s, est. speed input: 6315.97 toks/s, output: 6.17 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:35<00:06,  6.10it/s, est. speed input: 6314.39 toks/s, output: 6.17 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:35<00:05,  6.11it/s, est. speed input: 6313.92 toks/s, output: 6.17 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:36<00:05,  6.10it/s, est. speed input: 6312.99 toks/s, output: 6.17 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:36<00:05,  6.07it/s, est. speed input: 6311.45 toks/s, output: 6.16 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:36<00:04,  6.08it/s, est. speed input: 6311.06 toks/s, output: 6.16 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:36<00:04,  6.10it/s, est. speed input: 6310.84 toks/s, output: 6.16 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:37<00:04,  6.06it/s, est. speed input: 6309.13 toks/s, output: 6.16 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:37<00:03,  6.08it/s, est. speed input: 6308.83 toks/s, output: 6.16 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:37<00:03,  6.11it/s, est. speed input: 6308.96 toks/s, output: 6.16 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:38<00:03,  6.07it/s, est. speed input: 6307.36 toks/s, output: 6.16 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:38<00:02,  6.08it/s, est. speed input: 6306.90 toks/s, output: 6.16 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:38<00:02,  6.10it/s, est. speed input: 6306.68 toks/s, output: 6.16 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:39<00:02,  6.10it/s, est. speed input: 6306.23 toks/s, output: 6.16 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:39<00:01,  6.07it/s, est. speed input: 6304.86 toks/s, output: 6.16 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:39<00:01,  6.08it/s, est. speed input: 6304.40 toks/s, output: 6.16 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:40<00:01,  6.08it/s, est. speed input: 6303.87 toks/s, output: 6.16 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:40<00:00,  6.06it/s, est. speed input: 6302.72 toks/s, output: 6.15 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:40<00:00,  6.07it/s, est. speed input: 6302.07 toks/s, output: 6.15 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:41<00:00,  6.09it/s, est. speed input: 6301.85 toks/s, output: 6.15 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  7.13it/s, est. speed input: 6325.66 toks/s, output: 6.18 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  7.13it/s, est. speed input: 6325.66 toks/s, output: 6.18 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  6.18it/s, est. speed input: 6325.66 toks/s, output: 6.18 toks/s]
[rank0]:[W126 15:58:28.103537693 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 127.3s

测试结果:
  Requests/s:   6.09
  Tokens/s:     6242.05
  Total Reqs:   256
  Elapsed:      42.04s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     6235.96

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 15:58:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 15:58:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1470596) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1470596) WARNING 01-26 15:59:56 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.96 requests/s, 6110.87 total tokens/s, 5.96 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 15:58:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:58:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:58:39] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:58:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:58:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:58:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:58:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:58:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 15:58:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 15:58:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:58:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 15:58:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 15:58:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 15:58:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 15:58:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 15:58:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 15:58:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1470596) [2026-01-26 15:58:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1470596) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1470596) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.29s/it]
(EngineCore_DP0 pid=1470596) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 31.27s/it]
(EngineCore_DP0 pid=1470596) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 30.82s/it]
(EngineCore_DP0 pid=1470596) 
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1470596) [2026-01-26 15:59:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1470596) 2026-01-26 15:59:55,325 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1470596) 2026-01-26 15:59:55,410 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 31/512 [00:00<00:01, 307.39it/s]
Adding requests:  13%|█▎        | 69/512 [00:00<00:01, 348.33it/s]
Adding requests:  21%|██▏       | 110/512 [00:00<00:01, 372.77it/s]
Adding requests:  29%|██▉       | 150/512 [00:00<00:00, 382.71it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:00, 403.70it/s]
Adding requests:  47%|████▋     | 239/512 [00:00<00:00, 414.86it/s]
Adding requests:  55%|█████▌    | 283/512 [00:00<00:00, 422.43it/s]
Adding requests:  64%|██████▍   | 328/512 [00:00<00:00, 430.06it/s]
Adding requests:  73%|███████▎  | 374/512 [00:00<00:00, 436.49it/s]
Adding requests:  82%|████████▏ | 419/512 [00:01<00:00, 437.39it/s]
Adding requests:  90%|█████████ | 463/512 [00:01<00:00, 435.48it/s]
Adding requests: 100%|█████████▉| 510/512 [00:01<00:00, 444.87it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 419.47it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:33, 15.32it/s, est. speed input: 15685.96 toks/s, output: 15.32 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:01<00:57,  8.71it/s, est. speed input: 9673.22 toks/s, output: 9.45 toks/s] 
Processed prompts:   3%|▎         | 14/512 [00:01<01:08,  7.30it/s, est. speed input: 8269.86 toks/s, output: 8.08 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:02<01:13,  6.75it/s, est. speed input: 7673.92 toks/s, output: 7.49 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:03<01:16,  6.43it/s, est. speed input: 7316.20 toks/s, output: 7.14 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:17,  6.27it/s, est. speed input: 7100.20 toks/s, output: 6.93 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:18,  6.17it/s, est. speed input: 6948.28 toks/s, output: 6.79 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:05<01:18,  6.11it/s, est. speed input: 6840.58 toks/s, output: 6.68 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:05<01:18,  6.06it/s, est. speed input: 6755.91 toks/s, output: 6.60 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:17,  6.04it/s, est. speed input: 6690.84 toks/s, output: 6.53 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:07<01:17,  6.01it/s, est. speed input: 6632.98 toks/s, output: 6.48 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:07<01:16,  6.01it/s, est. speed input: 6593.61 toks/s, output: 6.44 toks/s]
Processed prompts:  11%|█         | 54/512 [00:08<01:16,  6.01it/s, est. speed input: 6558.88 toks/s, output: 6.41 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:09<01:15,  5.99it/s, est. speed input: 6523.04 toks/s, output: 6.37 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:09<01:15,  5.99it/s, est. speed input: 6495.55 toks/s, output: 6.34 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:10<01:14,  5.98it/s, est. speed input: 6471.00 toks/s, output: 6.32 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:11<01:14,  5.97it/s, est. speed input: 6447.62 toks/s, output: 6.30 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:11<01:13,  5.97it/s, est. speed input: 6429.76 toks/s, output: 6.28 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:12<01:12,  5.96it/s, est. speed input: 6410.27 toks/s, output: 6.26 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:13<01:12,  5.96it/s, est. speed input: 6393.68 toks/s, output: 6.24 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:13<01:11,  5.96it/s, est. speed input: 6380.22 toks/s, output: 6.23 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:14<01:10,  5.96it/s, est. speed input: 6366.83 toks/s, output: 6.22 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:15<01:10,  5.96it/s, est. speed input: 6355.53 toks/s, output: 6.21 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:15<01:09,  5.95it/s, est. speed input: 6343.73 toks/s, output: 6.20 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:16<01:08,  5.95it/s, est. speed input: 6333.15 toks/s, output: 6.18 toks/s]
Processed prompts:  21%|██        | 106/512 [00:17<01:08,  5.97it/s, est. speed input: 6326.17 toks/s, output: 6.18 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:17<01:07,  5.96it/s, est. speed input: 6317.60 toks/s, output: 6.17 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:18<01:06,  5.96it/s, est. speed input: 6309.77 toks/s, output: 6.16 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:19<01:05,  5.98it/s, est. speed input: 6304.77 toks/s, output: 6.16 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:19<01:05,  5.98it/s, est. speed input: 6298.43 toks/s, output: 6.15 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:20<01:04,  5.98it/s, est. speed input: 6292.76 toks/s, output: 6.15 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:21<01:03,  5.99it/s, est. speed input: 6288.23 toks/s, output: 6.14 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:21<01:03,  5.96it/s, est. speed input: 6280.84 toks/s, output: 6.13 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:22<01:02,  5.97it/s, est. speed input: 6276.57 toks/s, output: 6.13 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:23<01:02,  5.96it/s, est. speed input: 6270.68 toks/s, output: 6.12 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:23<01:01,  5.95it/s, est. speed input: 6265.32 toks/s, output: 6.12 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:24<01:00,  5.97it/s, est. speed input: 6262.33 toks/s, output: 6.12 toks/s]
Processed prompts:  30%|███       | 154/512 [00:25<01:00,  5.96it/s, est. speed input: 6257.76 toks/s, output: 6.11 toks/s]
Processed prompts:  31%|███       | 158/512 [00:25<00:59,  5.95it/s, est. speed input: 6253.04 toks/s, output: 6.11 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:26<00:58,  5.95it/s, est. speed input: 6248.89 toks/s, output: 6.10 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:27<00:58,  5.95it/s, est. speed input: 6245.29 toks/s, output: 6.10 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:27<00:57,  5.95it/s, est. speed input: 6241.33 toks/s, output: 6.10 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:28<00:56,  5.95it/s, est. speed input: 6238.01 toks/s, output: 6.09 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:29<00:56,  5.94it/s, est. speed input: 6233.53 toks/s, output: 6.09 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:29<00:55,  5.95it/s, est. speed input: 6230.76 toks/s, output: 6.08 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:30<00:54,  5.94it/s, est. speed input: 6227.47 toks/s, output: 6.08 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:31<00:54,  5.94it/s, est. speed input: 6224.18 toks/s, output: 6.08 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:31<00:53,  5.95it/s, est. speed input: 6222.26 toks/s, output: 6.08 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:32<00:52,  5.94it/s, est. speed input: 6218.84 toks/s, output: 6.07 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:33<00:49,  6.25it/s, est. speed input: 6237.05 toks/s, output: 6.09 toks/s]
Processed prompts:  40%|████      | 206/512 [00:33<00:49,  6.18it/s, est. speed input: 6235.24 toks/s, output: 6.09 toks/s]
Processed prompts:  41%|████      | 210/512 [00:34<00:49,  6.08it/s, est. speed input: 6231.02 toks/s, output: 6.08 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:35<00:49,  6.06it/s, est. speed input: 6229.14 toks/s, output: 6.08 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:35<00:48,  6.00it/s, est. speed input: 6225.30 toks/s, output: 6.08 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:36<00:48,  5.98it/s, est. speed input: 6222.66 toks/s, output: 6.08 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:37<00:47,  5.98it/s, est. speed input: 6220.97 toks/s, output: 6.08 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:37<00:47,  5.96it/s, est. speed input: 6217.92 toks/s, output: 6.07 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:38<00:46,  5.96it/s, est. speed input: 6215.93 toks/s, output: 6.07 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:39<00:45,  5.96it/s, est. speed input: 6214.22 toks/s, output: 6.07 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:39<00:45,  5.95it/s, est. speed input: 6211.86 toks/s, output: 6.07 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:40<00:44,  5.97it/s, est. speed input: 6210.58 toks/s, output: 6.07 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:41<00:44,  5.95it/s, est. speed input: 6208.26 toks/s, output: 6.06 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:41<00:43,  5.93it/s, est. speed input: 6205.29 toks/s, output: 6.06 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:42<00:42,  5.93it/s, est. speed input: 6203.34 toks/s, output: 6.06 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:43<00:42,  5.93it/s, est. speed input: 6201.27 toks/s, output: 6.06 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:43<00:41,  5.94it/s, est. speed input: 6199.52 toks/s, output: 6.05 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:44<00:40,  5.95it/s, est. speed input: 6198.67 toks/s, output: 6.05 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:45<00:40,  5.94it/s, est. speed input: 6196.60 toks/s, output: 6.05 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:45<00:39,  5.94it/s, est. speed input: 6194.72 toks/s, output: 6.05 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:46<00:38,  5.95it/s, est. speed input: 6193.57 toks/s, output: 6.05 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:47<00:37,  5.95it/s, est. speed input: 6192.13 toks/s, output: 6.05 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:47<00:37,  5.95it/s, est. speed input: 6190.96 toks/s, output: 6.05 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:48<00:36,  5.94it/s, est. speed input: 6189.12 toks/s, output: 6.04 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:49<00:36,  5.92it/s, est. speed input: 6186.87 toks/s, output: 6.04 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:49<00:35,  5.94it/s, est. speed input: 6185.87 toks/s, output: 6.04 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:50<00:32,  6.32it/s, est. speed input: 6201.18 toks/s, output: 6.06 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:51<00:32,  6.22it/s, est. speed input: 6200.19 toks/s, output: 6.05 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:51<00:32,  6.13it/s, est. speed input: 6198.75 toks/s, output: 6.05 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:52<00:32,  6.05it/s, est. speed input: 6196.38 toks/s, output: 6.05 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:53<00:31,  6.04it/s, est. speed input: 6195.64 toks/s, output: 6.05 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:53<00:31,  6.00it/s, est. speed input: 6193.92 toks/s, output: 6.05 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:54<00:30,  5.98it/s, est. speed input: 6192.30 toks/s, output: 6.05 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:55<00:29,  5.97it/s, est. speed input: 6191.02 toks/s, output: 6.05 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:55<00:29,  5.96it/s, est. speed input: 6189.74 toks/s, output: 6.04 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:56<00:28,  5.94it/s, est. speed input: 6187.80 toks/s, output: 6.04 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:57<00:27,  5.94it/s, est. speed input: 6186.72 toks/s, output: 6.04 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:57<00:27,  5.93it/s, est. speed input: 6184.91 toks/s, output: 6.04 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:58<00:26,  5.92it/s, est. speed input: 6183.28 toks/s, output: 6.04 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:59<00:26,  5.92it/s, est. speed input: 6182.00 toks/s, output: 6.04 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:59<00:25,  5.94it/s, est. speed input: 6181.24 toks/s, output: 6.04 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [01:00<00:24,  5.92it/s, est. speed input: 6179.63 toks/s, output: 6.03 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [01:01<00:23,  5.92it/s, est. speed input: 6178.11 toks/s, output: 6.03 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [01:02<00:23,  5.91it/s, est. speed input: 6176.51 toks/s, output: 6.03 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [01:02<00:22,  5.92it/s, est. speed input: 6175.69 toks/s, output: 6.03 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:03<00:21,  5.91it/s, est. speed input: 6174.10 toks/s, output: 6.03 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:04<00:21,  5.91it/s, est. speed input: 6172.78 toks/s, output: 6.03 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:04<00:20,  5.95it/s, est. speed input: 6172.84 toks/s, output: 6.03 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:05<00:19,  5.93it/s, est. speed input: 6171.51 toks/s, output: 6.03 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:06<00:19,  5.93it/s, est. speed input: 6170.31 toks/s, output: 6.03 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:06<00:18,  5.95it/s, est. speed input: 6169.97 toks/s, output: 6.03 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:07<00:17,  5.93it/s, est. speed input: 6168.64 toks/s, output: 6.02 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:08<00:17,  5.95it/s, est. speed input: 6168.39 toks/s, output: 6.02 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:08<00:16,  5.93it/s, est. speed input: 6167.05 toks/s, output: 6.02 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:09<00:15,  5.92it/s, est. speed input: 6165.78 toks/s, output: 6.02 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:10<00:15,  5.93it/s, est. speed input: 6165.01 toks/s, output: 6.02 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:10<00:14,  5.90it/s, est. speed input: 6163.24 toks/s, output: 6.02 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:11<00:13,  5.90it/s, est. speed input: 6162.07 toks/s, output: 6.02 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:11<00:12,  6.31it/s, est. speed input: 6173.53 toks/s, output: 6.03 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:12<00:11,  6.18it/s, est. speed input: 6172.37 toks/s, output: 6.03 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:13<00:11,  6.13it/s, est. speed input: 6172.03 toks/s, output: 6.03 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:14<00:10,  6.05it/s, est. speed input: 6170.63 toks/s, output: 6.03 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:14<00:10,  6.01it/s, est. speed input: 6169.80 toks/s, output: 6.03 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:15<00:09,  6.01it/s, est. speed input: 6169.52 toks/s, output: 6.02 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:16<00:09,  5.97it/s, est. speed input: 6168.27 toks/s, output: 6.02 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:16<00:08,  5.96it/s, est. speed input: 6167.36 toks/s, output: 6.02 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:17<00:07,  5.96it/s, est. speed input: 6166.75 toks/s, output: 6.02 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:18<00:07,  5.94it/s, est. speed input: 6165.74 toks/s, output: 6.02 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:18<00:06,  5.92it/s, est. speed input: 6164.36 toks/s, output: 6.02 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:19<00:05,  5.94it/s, est. speed input: 6163.99 toks/s, output: 6.02 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:20<00:05,  5.93it/s, est. speed input: 6163.12 toks/s, output: 6.02 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:20<00:04,  5.92it/s, est. speed input: 6162.19 toks/s, output: 6.02 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:21<00:03,  5.92it/s, est. speed input: 6161.25 toks/s, output: 6.02 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:22<00:03,  5.91it/s, est. speed input: 6160.11 toks/s, output: 6.02 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:22<00:02,  5.93it/s, est. speed input: 6159.71 toks/s, output: 6.02 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:23<00:01,  5.91it/s, est. speed input: 6158.66 toks/s, output: 6.01 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:24<00:01,  5.91it/s, est. speed input: 6157.80 toks/s, output: 6.01 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:24<00:00,  6.38it/s, est. speed input: 6168.90 toks/s, output: 6.02 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:24<00:00,  6.38it/s, est. speed input: 6193.08 toks/s, output: 6.05 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:24<00:00,  6.05it/s, est. speed input: 6193.08 toks/s, output: 6.05 toks/s]
[rank0]:[W126 16:01:22.051937777 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 173.3s

测试结果:
  Requests/s:   5.96
  Tokens/s:     6110.87
  Total Reqs:   512
  Elapsed:      85.88s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     6104.90

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:01:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:01:34 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1473191) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1473191) WARNING 01-26 16:02:52 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.65 requests/s, 5790.86 total tokens/s, 5.65 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 16:01:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:01:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:01:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:01:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:01:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:01:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:01:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:01:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:01:37] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:01:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:01:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:01:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:01:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:01:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:01:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:01:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:01:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1473191) [2026-01-26 16:01:38] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1473191) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1473191) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.37s/it]
(EngineCore_DP0 pid=1473191) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 31.45s/it]
(EngineCore_DP0 pid=1473191) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 30.99s/it]
(EngineCore_DP0 pid=1473191) 
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1473191) [2026-01-26 16:02:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1473191) 2026-01-26 16:02:50,002 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1473191) 2026-01-26 16:02:50,309 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 26/1024 [00:00<00:03, 257.91it/s]
Adding requests:   6%|▋         | 66/1024 [00:00<00:02, 339.82it/s]
Adding requests:  10%|█         | 106/1024 [00:00<00:02, 364.45it/s]
Adding requests:  14%|█▍        | 145/1024 [00:00<00:02, 374.23it/s]
Adding requests:  18%|█▊        | 188/1024 [00:00<00:02, 393.63it/s]
Adding requests:  23%|██▎       | 232/1024 [00:00<00:01, 406.86it/s]
Adding requests:  27%|██▋       | 273/1024 [00:00<00:01, 405.67it/s]
Adding requests:  31%|███       | 318/1024 [00:00<00:01, 418.49it/s]
Adding requests:  35%|███▌      | 362/1024 [00:00<00:01, 423.29it/s]
Adding requests:  40%|███▉      | 405/1024 [00:01<00:01, 422.88it/s]
Adding requests:  44%|████▍     | 448/1024 [00:01<00:01, 421.60it/s]
Adding requests:  48%|████▊     | 495/1024 [00:01<00:01, 435.92it/s]
Adding requests:  53%|█████▎    | 539/1024 [00:01<00:01, 432.90it/s]
Adding requests:  57%|█████▋    | 583/1024 [00:01<00:01, 427.17it/s]
Adding requests:  61%|██████    | 626/1024 [00:01<00:00, 422.69it/s]
Adding requests:  65%|██████▌   | 669/1024 [00:01<00:00, 422.12it/s]
Adding requests:  70%|██████▉   | 714/1024 [00:01<00:00, 430.10it/s]
Adding requests:  74%|███████▍  | 758/1024 [00:01<00:00, 423.48it/s]
Adding requests:  78%|███████▊  | 801/1024 [00:01<00:00, 422.77it/s]
Adding requests:  82%|████████▏ | 844/1024 [00:02<00:00, 422.27it/s]
Adding requests:  87%|████████▋ | 889/1024 [00:02<00:00, 429.40it/s]
Adding requests:  91%|█████████ | 932/1024 [00:02<00:00, 425.06it/s]
Adding requests:  95%|█████████▌| 977/1024 [00:02<00:00, 431.50it/s]
Adding requests: 100%|█████████▉| 1021/1024 [00:02<00:00, 430.08it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 416.53it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<01:01, 16.40it/s, est. speed input: 16796.97 toks/s, output: 16.40 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:02<02:02,  8.19it/s, est. speed input: 9152.06 toks/s, output: 8.94 toks/s]  
Processed prompts:   3%|▎         | 26/1024 [00:03<02:25,  6.87it/s, est. speed input: 7776.34 toks/s, output: 7.59 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:04<02:35,  6.35it/s, est. speed input: 7192.91 toks/s, output: 7.02 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:06<02:41,  6.09it/s, est. speed input: 6879.21 toks/s, output: 6.72 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:07<02:43,  5.95it/s, est. speed input: 6686.12 toks/s, output: 6.53 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:09<02:45,  5.85it/s, est. speed input: 6545.08 toks/s, output: 6.39 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:10<02:45,  5.79it/s, est. speed input: 6447.35 toks/s, output: 6.30 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:11<02:45,  5.75it/s, est. speed input: 6368.64 toks/s, output: 6.22 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:13<02:44,  5.71it/s, est. speed input: 6305.07 toks/s, output: 6.16 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:14<02:44,  5.69it/s, est. speed input: 6254.69 toks/s, output: 6.11 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:16<02:42,  5.69it/s, est. speed input: 6215.56 toks/s, output: 6.07 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:17<02:42,  5.66it/s, est. speed input: 6175.84 toks/s, output: 6.03 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:18<02:40,  5.66it/s, est. speed input: 6148.68 toks/s, output: 6.00 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:20<02:39,  5.65it/s, est. speed input: 6121.77 toks/s, output: 5.98 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:21<02:38,  5.65it/s, est. speed input: 6098.72 toks/s, output: 5.96 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:23<02:36,  5.66it/s, est. speed input: 6081.87 toks/s, output: 5.94 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:24<02:35,  5.66it/s, est. speed input: 6064.83 toks/s, output: 5.92 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:26<02:33,  5.66it/s, est. speed input: 6051.34 toks/s, output: 5.91 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:27<02:32,  5.66it/s, est. speed input: 6038.17 toks/s, output: 5.90 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:28<02:30,  5.66it/s, est. speed input: 6026.25 toks/s, output: 5.89 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:30<02:29,  5.66it/s, est. speed input: 6014.87 toks/s, output: 5.87 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:31<02:28,  5.66it/s, est. speed input: 6005.07 toks/s, output: 5.86 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:33<02:26,  5.65it/s, est. speed input: 5994.99 toks/s, output: 5.85 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:34<02:21,  5.82it/s, est. speed input: 6010.88 toks/s, output: 5.87 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:35<02:21,  5.77it/s, est. speed input: 6001.81 toks/s, output: 5.86 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:37<02:20,  5.73it/s, est. speed input: 5992.96 toks/s, output: 5.85 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:38<02:19,  5.70it/s, est. speed input: 5985.23 toks/s, output: 5.84 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:40<02:19,  5.68it/s, est. speed input: 5977.03 toks/s, output: 5.84 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:41<02:18,  5.65it/s, est. speed input: 5968.31 toks/s, output: 5.83 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:42<02:17,  5.64it/s, est. speed input: 5960.85 toks/s, output: 5.82 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:44<02:15,  5.64it/s, est. speed input: 5955.31 toks/s, output: 5.82 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:45<02:14,  5.63it/s, est. speed input: 5948.45 toks/s, output: 5.81 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:47<02:13,  5.63it/s, est. speed input: 5942.85 toks/s, output: 5.80 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:48<02:11,  5.64it/s, est. speed input: 5938.55 toks/s, output: 5.80 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:50<02:10,  5.64it/s, est. speed input: 5933.77 toks/s, output: 5.79 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:51<02:09,  5.63it/s, est. speed input: 5928.35 toks/s, output: 5.79 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:52<02:03,  5.82it/s, est. speed input: 5941.81 toks/s, output: 5.80 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:54<02:02,  5.77it/s, est. speed input: 5938.09 toks/s, output: 5.80 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:55<02:02,  5.73it/s, est. speed input: 5933.69 toks/s, output: 5.79 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:56<02:01,  5.71it/s, est. speed input: 5929.92 toks/s, output: 5.79 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:58<02:00,  5.69it/s, est. speed input: 5926.34 toks/s, output: 5.79 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:59<01:59,  5.66it/s, est. speed input: 5921.88 toks/s, output: 5.78 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [01:01<01:58,  5.65it/s, est. speed input: 5917.95 toks/s, output: 5.78 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [01:02<01:57,  5.65it/s, est. speed input: 5914.65 toks/s, output: 5.78 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [01:04<01:56,  5.63it/s, est. speed input: 5910.67 toks/s, output: 5.77 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [01:05<01:54,  5.63it/s, est. speed input: 5907.15 toks/s, output: 5.77 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:06<01:53,  5.63it/s, est. speed input: 5904.22 toks/s, output: 5.77 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:08<01:52,  5.62it/s, est. speed input: 5900.90 toks/s, output: 5.76 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:09<01:50,  5.63it/s, est. speed input: 5898.35 toks/s, output: 5.76 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:11<01:49,  5.62it/s, est. speed input: 5894.90 toks/s, output: 5.76 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:12<01:47,  5.62it/s, est. speed input: 5892.06 toks/s, output: 5.75 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:14<01:46,  5.62it/s, est. speed input: 5889.59 toks/s, output: 5.75 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:15<01:41,  5.80it/s, est. speed input: 5898.77 toks/s, output: 5.76 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:16<01:41,  5.74it/s, est. speed input: 5895.81 toks/s, output: 5.76 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:18<01:40,  5.70it/s, est. speed input: 5893.10 toks/s, output: 5.75 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:19<01:39,  5.69it/s, est. speed input: 5891.50 toks/s, output: 5.75 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:21<01:38,  5.67it/s, est. speed input: 5889.34 toks/s, output: 5.75 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:22<01:37,  5.67it/s, est. speed input: 5887.71 toks/s, output: 5.75 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:23<01:35,  5.66it/s, est. speed input: 5885.78 toks/s, output: 5.75 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:25<01:34,  5.64it/s, est. speed input: 5883.41 toks/s, output: 5.75 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:26<01:33,  5.64it/s, est. speed input: 5881.31 toks/s, output: 5.74 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:28<01:31,  5.65it/s, est. speed input: 5880.00 toks/s, output: 5.74 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:29<01:30,  5.64it/s, est. speed input: 5878.38 toks/s, output: 5.74 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:30<01:29,  5.63it/s, est. speed input: 5876.13 toks/s, output: 5.74 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:32<01:27,  5.62it/s, est. speed input: 5873.93 toks/s, output: 5.74 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:33<01:26,  5.62it/s, est. speed input: 5871.98 toks/s, output: 5.73 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:35<01:25,  5.62it/s, est. speed input: 5870.28 toks/s, output: 5.73 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:36<01:23,  5.64it/s, est. speed input: 5869.42 toks/s, output: 5.73 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:38<01:22,  5.63it/s, est. speed input: 5867.46 toks/s, output: 5.73 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:39<01:20,  5.63it/s, est. speed input: 5866.16 toks/s, output: 5.73 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:40<01:19,  5.63it/s, est. speed input: 5864.78 toks/s, output: 5.73 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:42<01:17,  5.63it/s, est. speed input: 5863.24 toks/s, output: 5.73 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:43<01:16,  5.62it/s, est. speed input: 5861.60 toks/s, output: 5.72 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:45<01:14,  5.63it/s, est. speed input: 5860.50 toks/s, output: 5.72 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:46<01:13,  5.62it/s, est. speed input: 5858.77 toks/s, output: 5.72 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:48<01:12,  5.61it/s, est. speed input: 5856.94 toks/s, output: 5.72 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:49<01:10,  5.62it/s, est. speed input: 5855.90 toks/s, output: 5.72 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:50<01:09,  5.61it/s, est. speed input: 5854.24 toks/s, output: 5.72 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:52<01:08,  5.61it/s, est. speed input: 5852.92 toks/s, output: 5.72 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:53<01:06,  5.62it/s, est. speed input: 5852.06 toks/s, output: 5.71 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:55<01:04,  5.63it/s, est. speed input: 5851.29 toks/s, output: 5.71 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:56<01:03,  5.63it/s, est. speed input: 5850.36 toks/s, output: 5.71 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:57<01:02,  5.63it/s, est. speed input: 5849.35 toks/s, output: 5.71 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:59<01:00,  5.64it/s, est. speed input: 5848.56 toks/s, output: 5.71 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [02:00<00:59,  5.64it/s, est. speed input: 5847.80 toks/s, output: 5.71 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [02:02<00:57,  5.65it/s, est. speed input: 5847.14 toks/s, output: 5.71 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [02:03<00:56,  5.64it/s, est. speed input: 5846.18 toks/s, output: 5.71 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [02:05<00:55,  5.64it/s, est. speed input: 5845.23 toks/s, output: 5.71 toks/s]
Processed prompts:  71%|███████   | 722/1024 [02:06<00:53,  5.62it/s, est. speed input: 5843.92 toks/s, output: 5.71 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [02:07<00:52,  5.62it/s, est. speed input: 5842.76 toks/s, output: 5.71 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [02:09<00:50,  5.63it/s, est. speed input: 5842.34 toks/s, output: 5.71 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [02:10<00:49,  5.63it/s, est. speed input: 5841.31 toks/s, output: 5.70 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [02:12<00:47,  5.63it/s, est. speed input: 5840.55 toks/s, output: 5.70 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:13<00:46,  5.63it/s, est. speed input: 5839.79 toks/s, output: 5.70 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:15<00:45,  5.62it/s, est. speed input: 5838.71 toks/s, output: 5.70 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:16<00:43,  5.64it/s, est. speed input: 5838.36 toks/s, output: 5.70 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:17<00:40,  5.82it/s, est. speed input: 5844.06 toks/s, output: 5.71 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:19<00:39,  5.77it/s, est. speed input: 5843.40 toks/s, output: 5.71 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:20<00:38,  5.71it/s, est. speed input: 5842.22 toks/s, output: 5.71 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:21<00:37,  5.69it/s, est. speed input: 5841.60 toks/s, output: 5.70 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:23<00:36,  5.67it/s, est. speed input: 5840.68 toks/s, output: 5.70 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:24<00:35,  5.65it/s, est. speed input: 5839.66 toks/s, output: 5.70 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:26<00:33,  5.64it/s, est. speed input: 5838.76 toks/s, output: 5.70 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:27<00:32,  5.63it/s, est. speed input: 5838.01 toks/s, output: 5.70 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:29<00:30,  5.63it/s, est. speed input: 5837.14 toks/s, output: 5.70 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:30<00:29,  5.62it/s, est. speed input: 5836.14 toks/s, output: 5.70 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:31<00:28,  5.62it/s, est. speed input: 5835.57 toks/s, output: 5.70 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:33<00:26,  5.63it/s, est. speed input: 5834.96 toks/s, output: 5.70 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:34<00:25,  5.62it/s, est. speed input: 5834.19 toks/s, output: 5.70 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:36<00:23,  5.63it/s, est. speed input: 5833.77 toks/s, output: 5.70 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:37<00:22,  5.62it/s, est. speed input: 5832.80 toks/s, output: 5.70 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:39<00:20,  5.63it/s, est. speed input: 5832.29 toks/s, output: 5.70 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:40<00:19,  5.63it/s, est. speed input: 5831.77 toks/s, output: 5.70 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:41<00:18,  5.63it/s, est. speed input: 5831.14 toks/s, output: 5.69 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:43<00:16,  5.62it/s, est. speed input: 5830.33 toks/s, output: 5.69 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:44<00:15,  5.62it/s, est. speed input: 5829.61 toks/s, output: 5.69 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:46<00:13,  5.61it/s, est. speed input: 5828.85 toks/s, output: 5.69 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:47<00:12,  5.64it/s, est. speed input: 5828.96 toks/s, output: 5.69 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:49<00:11,  5.62it/s, est. speed input: 5828.04 toks/s, output: 5.69 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:50<00:09,  5.63it/s, est. speed input: 5827.49 toks/s, output: 5.69 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:51<00:08,  5.63it/s, est. speed input: 5827.19 toks/s, output: 5.69 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:53<00:06,  5.63it/s, est. speed input: 5826.65 toks/s, output: 5.69 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:54<00:05,  5.63it/s, est. speed input: 5825.98 toks/s, output: 5.69 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:56<00:03,  5.62it/s, est. speed input: 5825.24 toks/s, output: 5.69 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:57<00:02,  5.62it/s, est. speed input: 5824.85 toks/s, output: 5.69 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:58<00:01,  5.86it/s, est. speed input: 5830.45 toks/s, output: 5.69 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:58<00:00,  5.86it/s, est. speed input: 5864.81 toks/s, output: 5.73 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:58<00:00,  5.73it/s, est. speed input: 5864.81 toks/s, output: 5.73 toks/s]
[rank0]:[W126 16:05:53.872791678 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 270.7s

测试结果:
  Requests/s:   5.65
  Tokens/s:     5790.86
  Total Reqs:   1024
  Elapsed:      181.25s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     5785.21

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:06:06 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:06:06 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1477149) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1477149) WARNING 01-26 16:07:29 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.00 requests/s, 6145.03 total tokens/s, 6.00 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 16:06:06] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:06:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:06:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:06:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:06:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:06:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:06:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:06:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:06:10] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:06:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:06:10] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:06:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:06:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:06:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:06:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:06:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:06:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1477149) [2026-01-26 16:06:11] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1477149) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1477149) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.50s/it]
(EngineCore_DP0 pid=1477149) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.69s/it]
(EngineCore_DP0 pid=1477149) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.21s/it]
(EngineCore_DP0 pid=1477149) 
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1477149) [2026-01-26 16:07:14] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1477149) 2026-01-26 16:07:24,100 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1477149) 2026-01-26 16:07:24,657 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 33/2048 [00:00<00:06, 323.73it/s]
Adding requests:   3%|▎         | 69/2048 [00:00<00:05, 343.77it/s]
Adding requests:   5%|▌         | 111/2048 [00:00<00:05, 375.92it/s]
Adding requests:   7%|▋         | 152/2048 [00:00<00:04, 388.75it/s]
Adding requests:  10%|▉         | 198/2048 [00:00<00:04, 411.33it/s]
Adding requests:  12%|█▏        | 242/2048 [00:00<00:04, 420.80it/s]
Adding requests:  14%|█▍        | 285/2048 [00:00<00:04, 416.44it/s]
Adding requests:  16%|█▌        | 328/2048 [00:00<00:04, 419.92it/s]
Adding requests:  18%|█▊        | 374/2048 [00:00<00:03, 430.25it/s]
Adding requests:  20%|██        | 419/2048 [00:01<00:03, 433.76it/s]
Adding requests:  23%|██▎       | 464/2048 [00:01<00:03, 436.74it/s]
Adding requests:  25%|██▌       | 513/2048 [00:01<00:03, 451.08it/s]
Adding requests:  28%|██▊       | 564/2048 [00:01<00:03, 466.44it/s]
Adding requests:  30%|██▉       | 611/2048 [00:01<00:03, 446.97it/s]
Adding requests:  32%|███▏      | 656/2048 [00:01<00:03, 445.35it/s]
Adding requests:  34%|███▍      | 701/2048 [00:01<00:03, 446.22it/s]
Adding requests:  36%|███▋      | 746/2048 [00:01<00:02, 434.47it/s]
Adding requests:  39%|███▊      | 790/2048 [00:01<00:03, 407.98it/s]
Adding requests:  41%|████      | 836/2048 [00:01<00:02, 420.50it/s]
Adding requests:  43%|████▎     | 879/2048 [00:02<00:05, 195.28it/s]
Adding requests:  45%|████▌     | 922/2048 [00:02<00:04, 231.82it/s]
Adding requests:  47%|████▋     | 966/2048 [00:02<00:04, 269.95it/s]
Adding requests:  49%|████▉     | 1009/2048 [00:02<00:03, 301.96it/s]
Adding requests:  51%|█████▏    | 1052/2048 [00:02<00:03, 330.36it/s]
Adding requests:  53%|█████▎    | 1094/2048 [00:02<00:02, 351.48it/s]
Adding requests:  56%|█████▌    | 1140/2048 [00:03<00:02, 378.49it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:03<00:02, 392.35it/s]
Adding requests:  60%|█████▉    | 1228/2048 [00:03<00:02, 401.93it/s]
Adding requests:  62%|██████▏   | 1271/2048 [00:03<00:01, 405.51it/s]
Adding requests:  64%|██████▍   | 1314/2048 [00:03<00:01, 412.14it/s]
Adding requests:  66%|██████▋   | 1358/2048 [00:03<00:01, 418.10it/s]
Adding requests:  69%|██████▊   | 1403/2048 [00:03<00:01, 426.80it/s]
Adding requests:  71%|███████   | 1448/2048 [00:03<00:01, 431.81it/s]
Adding requests:  73%|███████▎  | 1496/2048 [00:03<00:01, 443.95it/s]
Adding requests:  75%|███████▌  | 1541/2048 [00:04<00:01, 442.13it/s]
Adding requests:  77%|███████▋  | 1586/2048 [00:04<00:01, 436.57it/s]
Adding requests:  80%|███████▉  | 1630/2048 [00:04<00:00, 432.32it/s]
Adding requests:  82%|████████▏ | 1674/2048 [00:04<00:00, 421.52it/s]
Adding requests:  84%|████████▍ | 1720/2048 [00:04<00:00, 430.13it/s]
Adding requests:  86%|████████▌ | 1764/2048 [00:04<00:00, 422.77it/s]
Adding requests:  88%|████████▊ | 1807/2048 [00:04<00:00, 421.39it/s]
Adding requests:  90%|█████████ | 1850/2048 [00:04<00:00, 414.76it/s]
Adding requests:  92%|█████████▏| 1894/2048 [00:04<00:00, 420.79it/s]
Adding requests:  95%|█████████▍| 1939/2048 [00:04<00:00, 426.69it/s]
Adding requests:  97%|█████████▋| 1983/2048 [00:05<00:00, 428.36it/s]
Adding requests:  99%|█████████▉| 2026/2048 [00:05<00:00, 400.41it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 391.17it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 18/2048 [00:00<00:45, 44.92it/s, est. speed input: 45996.15 toks/s, output: 44.92 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:03<03:28,  9.68it/s, est. speed input: 11324.15 toks/s, output: 11.06 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:05<04:22,  7.60it/s, est. speed input: 8911.31 toks/s, output: 8.70 toks/s]  
Processed prompts:   3%|▎         | 66/2048 [00:08<04:48,  6.87it/s, est. speed input: 8023.19 toks/s, output: 7.84 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:11<05:01,  6.53it/s, est. speed input: 7567.61 toks/s, output: 7.39 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:13<05:08,  6.33it/s, est. speed input: 7285.56 toks/s, output: 7.11 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:16<05:11,  6.21it/s, est. speed input: 7095.72 toks/s, output: 6.93 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:19<05:12,  6.13it/s, est. speed input: 6957.98 toks/s, output: 6.79 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:21<05:12,  6.08it/s, est. speed input: 6854.19 toks/s, output: 6.69 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:24<05:11,  6.05it/s, est. speed input: 6774.61 toks/s, output: 6.62 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:27<05:22,  5.80it/s, est. speed input: 6626.88 toks/s, output: 6.47 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:30<05:12,  5.94it/s, est. speed input: 6609.63 toks/s, output: 6.45 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:32<05:09,  5.94it/s, est. speed input: 6567.96 toks/s, output: 6.41 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:35<05:06,  5.95it/s, est. speed input: 6533.95 toks/s, output: 6.38 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:38<05:03,  5.96it/s, est. speed input: 6504.27 toks/s, output: 6.35 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:40<05:00,  5.96it/s, est. speed input: 6478.52 toks/s, output: 6.33 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:43<04:57,  5.97it/s, est. speed input: 6456.38 toks/s, output: 6.31 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:46<04:54,  5.96it/s, est. speed input: 6435.81 toks/s, output: 6.28 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:48<04:47,  6.06it/s, est. speed input: 6437.15 toks/s, output: 6.29 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:51<04:46,  6.03it/s, est. speed input: 6419.52 toks/s, output: 6.27 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:54<04:44,  6.01it/s, est. speed input: 6403.94 toks/s, output: 6.25 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:56<04:42,  5.99it/s, est. speed input: 6389.65 toks/s, output: 6.24 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:59<04:40,  5.98it/s, est. speed input: 6375.62 toks/s, output: 6.23 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [01:02<04:38,  5.97it/s, est. speed input: 6363.24 toks/s, output: 6.21 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:04<04:35,  5.97it/s, est. speed input: 6353.10 toks/s, output: 6.20 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:07<04:33,  5.96it/s, est. speed input: 6342.80 toks/s, output: 6.19 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:10<04:26,  6.06it/s, est. speed input: 6347.10 toks/s, output: 6.20 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:12<04:24,  6.03it/s, est. speed input: 6338.06 toks/s, output: 6.19 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:15<04:23,  6.01it/s, est. speed input: 6329.64 toks/s, output: 6.18 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:18<04:21,  6.00it/s, est. speed input: 6322.04 toks/s, output: 6.17 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:20<04:18,  5.99it/s, est. speed input: 6314.94 toks/s, output: 6.17 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:23<04:16,  5.98it/s, est. speed input: 6308.01 toks/s, output: 6.16 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:26<04:14,  5.97it/s, est. speed input: 6301.77 toks/s, output: 6.15 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:28<04:11,  5.97it/s, est. speed input: 6295.77 toks/s, output: 6.15 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:31<04:10,  5.94it/s, est. speed input: 6287.32 toks/s, output: 6.14 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:34<04:07,  5.95it/s, est. speed input: 6282.06 toks/s, output: 6.13 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:36<04:04,  5.95it/s, est. speed input: 6276.61 toks/s, output: 6.13 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:39<04:01,  5.95it/s, est. speed input: 6272.27 toks/s, output: 6.13 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:42<03:58,  5.96it/s, est. speed input: 6268.14 toks/s, output: 6.12 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:44<03:55,  5.96it/s, est. speed input: 6264.03 toks/s, output: 6.12 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:47<03:53,  5.96it/s, est. speed input: 6260.20 toks/s, output: 6.11 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:50<03:50,  5.97it/s, est. speed input: 6256.78 toks/s, output: 6.11 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:52<03:47,  5.96it/s, est. speed input: 6253.10 toks/s, output: 6.11 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:55<03:45,  5.96it/s, est. speed input: 6249.52 toks/s, output: 6.10 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:58<03:42,  5.96it/s, est. speed input: 6246.17 toks/s, output: 6.10 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [02:01<03:39,  5.96it/s, est. speed input: 6243.11 toks/s, output: 6.10 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [02:03<03:37,  5.95it/s, est. speed input: 6239.56 toks/s, output: 6.09 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [02:06<03:34,  5.96it/s, est. speed input: 6236.82 toks/s, output: 6.09 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:08<03:28,  6.06it/s, est. speed input: 6240.96 toks/s, output: 6.09 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:11<03:26,  6.03it/s, est. speed input: 6238.04 toks/s, output: 6.09 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:14<03:24,  6.01it/s, est. speed input: 6235.53 toks/s, output: 6.09 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:17<03:22,  5.99it/s, est. speed input: 6232.81 toks/s, output: 6.09 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:19<03:20,  5.98it/s, est. speed input: 6230.27 toks/s, output: 6.08 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:22<03:17,  5.98it/s, est. speed input: 6227.94 toks/s, output: 6.08 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:25<03:15,  5.97it/s, est. speed input: 6225.75 toks/s, output: 6.08 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:27<03:12,  5.97it/s, est. speed input: 6223.40 toks/s, output: 6.08 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:30<03:10,  5.97it/s, est. speed input: 6221.40 toks/s, output: 6.08 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:33<03:07,  5.96it/s, est. speed input: 6219.23 toks/s, output: 6.07 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:35<03:05,  5.95it/s, est. speed input: 6216.72 toks/s, output: 6.07 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:38<03:02,  5.96it/s, est. speed input: 6214.79 toks/s, output: 6.07 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:41<02:59,  5.96it/s, est. speed input: 6212.89 toks/s, output: 6.07 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:43<02:56,  5.96it/s, est. speed input: 6211.13 toks/s, output: 6.07 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:46<02:54,  5.96it/s, est. speed input: 6209.33 toks/s, output: 6.06 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:49<02:51,  5.96it/s, est. speed input: 6207.81 toks/s, output: 6.06 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:51<02:48,  5.96it/s, est. speed input: 6206.12 toks/s, output: 6.06 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:54<02:46,  5.96it/s, est. speed input: 6204.55 toks/s, output: 6.06 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [02:57<02:43,  5.96it/s, est. speed input: 6203.04 toks/s, output: 6.06 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [02:59<02:40,  5.96it/s, est. speed input: 6201.59 toks/s, output: 6.06 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [03:02<02:38,  5.96it/s, est. speed input: 6200.17 toks/s, output: 6.05 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [03:05<02:35,  5.97it/s, est. speed input: 6199.03 toks/s, output: 6.05 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [03:08<02:32,  5.95it/s, est. speed input: 6197.14 toks/s, output: 6.05 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:10<02:30,  5.95it/s, est. speed input: 6195.68 toks/s, output: 6.05 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:13<02:27,  5.96it/s, est. speed input: 6194.58 toks/s, output: 6.05 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:16<02:24,  5.95it/s, est. speed input: 6193.09 toks/s, output: 6.05 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:18<02:19,  6.05it/s, est. speed input: 6196.42 toks/s, output: 6.05 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:21<02:17,  6.02it/s, est. speed input: 6195.09 toks/s, output: 6.05 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:23<02:13,  6.11it/s, est. speed input: 6198.54 toks/s, output: 6.05 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:26<02:11,  6.07it/s, est. speed input: 6197.38 toks/s, output: 6.05 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:29<02:09,  6.04it/s, est. speed input: 6196.24 toks/s, output: 6.05 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:31<02:07,  6.01it/s, est. speed input: 6194.96 toks/s, output: 6.05 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:34<02:04,  6.00it/s, est. speed input: 6194.03 toks/s, output: 6.05 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:37<02:02,  5.99it/s, est. speed input: 6192.88 toks/s, output: 6.05 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:39<01:58,  6.07it/s, est. speed input: 6195.35 toks/s, output: 6.05 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:42<01:56,  6.03it/s, est. speed input: 6194.26 toks/s, output: 6.05 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:45<01:54,  6.01it/s, est. speed input: 6193.23 toks/s, output: 6.05 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:47<01:51,  5.99it/s, est. speed input: 6192.05 toks/s, output: 6.05 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:50<01:49,  5.99it/s, est. speed input: 6191.11 toks/s, output: 6.05 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:53<01:46,  5.97it/s, est. speed input: 6189.92 toks/s, output: 6.04 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [03:55<01:44,  5.97it/s, est. speed input: 6189.05 toks/s, output: 6.04 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [03:58<01:39,  6.06it/s, est. speed input: 6191.72 toks/s, output: 6.05 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [04:01<01:36,  6.13it/s, est. speed input: 6194.38 toks/s, output: 6.05 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [04:03<01:34,  6.07it/s, est. speed input: 6193.24 toks/s, output: 6.05 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [04:06<01:32,  6.05it/s, est. speed input: 6192.44 toks/s, output: 6.05 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [04:09<01:30,  6.01it/s, est. speed input: 6191.23 toks/s, output: 6.05 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [04:11<01:26,  6.09it/s, est. speed input: 6193.74 toks/s, output: 6.05 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:14<01:24,  6.05it/s, est. speed input: 6192.61 toks/s, output: 6.05 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:16<01:20,  6.12it/s, est. speed input: 6195.25 toks/s, output: 6.05 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:19<01:18,  6.07it/s, est. speed input: 6194.20 toks/s, output: 6.05 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:22<01:16,  6.04it/s, est. speed input: 6193.35 toks/s, output: 6.05 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:24<01:14,  6.02it/s, est. speed input: 6192.43 toks/s, output: 6.05 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:27<01:10,  6.09it/s, est. speed input: 6194.72 toks/s, output: 6.05 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:30<01:08,  6.05it/s, est. speed input: 6193.74 toks/s, output: 6.05 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:32<01:06,  6.02it/s, est. speed input: 6192.91 toks/s, output: 6.05 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:35<01:03,  6.01it/s, est. speed input: 6192.10 toks/s, output: 6.05 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:38<01:01,  6.00it/s, est. speed input: 6191.33 toks/s, output: 6.05 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:40<00:58,  5.98it/s, est. speed input: 6190.47 toks/s, output: 6.05 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [04:43<00:55,  5.98it/s, est. speed input: 6189.69 toks/s, output: 6.04 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [04:46<00:52,  6.07it/s, est. speed input: 6191.97 toks/s, output: 6.05 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [04:48<00:48,  6.25it/s, est. speed input: 6197.56 toks/s, output: 6.05 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [04:51<00:46,  6.16it/s, est. speed input: 6196.69 toks/s, output: 6.05 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [04:53<00:44,  6.10it/s, est. speed input: 6195.90 toks/s, output: 6.05 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [04:56<00:41,  6.06it/s, est. speed input: 6195.00 toks/s, output: 6.05 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [04:59<00:39,  6.03it/s, est. speed input: 6194.32 toks/s, output: 6.05 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [05:01<00:36,  6.01it/s, est. speed input: 6193.59 toks/s, output: 6.05 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [05:04<00:34,  6.00it/s, est. speed input: 6192.82 toks/s, output: 6.05 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [05:07<00:31,  5.98it/s, est. speed input: 6191.97 toks/s, output: 6.05 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [05:09<00:29,  5.98it/s, est. speed input: 6191.28 toks/s, output: 6.05 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [05:12<00:26,  6.07it/s, est. speed input: 6193.23 toks/s, output: 6.05 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [05:15<00:23,  6.04it/s, est. speed input: 6192.53 toks/s, output: 6.05 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:17<00:21,  6.00it/s, est. speed input: 6191.32 toks/s, output: 6.05 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:20<00:18,  5.99it/s, est. speed input: 6190.66 toks/s, output: 6.05 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:23<00:15,  5.98it/s, est. speed input: 6189.79 toks/s, output: 6.04 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:25<00:13,  5.97it/s, est. speed input: 6189.02 toks/s, output: 6.04 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:28<00:10,  6.07it/s, est. speed input: 6191.09 toks/s, output: 6.05 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:31<00:07,  6.03it/s, est. speed input: 6190.27 toks/s, output: 6.05 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:33<00:04,  6.01it/s, est. speed input: 6189.64 toks/s, output: 6.04 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:36<00:02,  6.11it/s, est. speed input: 6192.00 toks/s, output: 6.05 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:36<00:00,  6.11it/s, est. speed input: 6234.61 toks/s, output: 6.09 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:36<00:00,  6.09it/s, est. speed input: 6234.61 toks/s, output: 6.09 toks/s]
[rank0]:[W126 16:13:11.578098012 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 438.0s

测试结果:
  Requests/s:   6.00
  Tokens/s:     6145.03
  Total Reqs:   2048
  Elapsed:      341.61s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     6139.03

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:13:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:13:34 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1483478) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1483478) WARNING 01-26 16:15:03 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.96 requests/s, 6110.22 total tokens/s, 5.96 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 16:13:33] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:13:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:13:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:13:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:13:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:13:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:13:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:13:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:13:37] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:13:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:13:37] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:13:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:13:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:13:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:13:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:13:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:13:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1483478) [2026-01-26 16:13:38] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1483478) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1483478) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.52s/it]
(EngineCore_DP0 pid=1483478) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 32.24s/it]
(EngineCore_DP0 pid=1483478) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 31.68s/it]
(EngineCore_DP0 pid=1483478) 
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:42] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1483478) [2026-01-26 16:14:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1483478) 2026-01-26 16:14:54,823 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1483478) 2026-01-26 16:14:56,100 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:08, 484.49it/s]
Adding requests:   2%|▏         | 98/4096 [00:00<00:09, 441.41it/s]
Adding requests:   3%|▎         | 143/4096 [00:00<00:09, 410.96it/s]
Adding requests:   5%|▍         | 188/4096 [00:00<00:09, 422.95it/s]
Adding requests:   6%|▌         | 231/4096 [00:00<00:09, 416.00it/s]
Adding requests:   7%|▋         | 273/4096 [00:00<00:09, 414.45it/s]
Adding requests:   8%|▊         | 319/4096 [00:00<00:08, 428.53it/s]
Adding requests:   9%|▉         | 365/4096 [00:00<00:08, 436.09it/s]
Adding requests:  10%|█         | 411/4096 [00:00<00:08, 442.94it/s]
Adding requests:  11%|█         | 459/4096 [00:01<00:08, 452.47it/s]
Adding requests:  12%|█▏        | 505/4096 [00:01<00:08, 441.41it/s]
Adding requests:  14%|█▎        | 555/4096 [00:01<00:07, 456.85it/s]
Adding requests:  15%|█▍        | 601/4096 [00:01<00:07, 442.54it/s]
Adding requests:  16%|█▌        | 646/4096 [00:01<00:08, 426.20it/s]
Adding requests:  17%|█▋        | 691/4096 [00:01<00:07, 430.62it/s]
Adding requests:  18%|█▊        | 735/4096 [00:01<00:07, 424.77it/s]
Adding requests:  19%|█▉        | 783/4096 [00:01<00:07, 440.41it/s]
Adding requests:  20%|██        | 828/4096 [00:01<00:07, 423.15it/s]
Adding requests:  21%|██▏       | 876/4096 [00:02<00:07, 438.87it/s]
Adding requests:  22%|██▏       | 921/4096 [00:02<00:07, 430.26it/s]
Adding requests:  24%|██▎       | 968/4096 [00:02<00:07, 440.69it/s]
Adding requests:  25%|██▍       | 1013/4096 [00:02<00:07, 425.25it/s]
Adding requests:  26%|██▌       | 1058/4096 [00:02<00:07, 430.03it/s]
Adding requests:  27%|██▋       | 1102/4096 [00:02<00:06, 431.21it/s]
Adding requests:  28%|██▊       | 1147/4096 [00:02<00:06, 434.54it/s]
Adding requests:  29%|██▉       | 1192/4096 [00:02<00:06, 438.99it/s]
Adding requests:  30%|███       | 1236/4096 [00:02<00:06, 420.23it/s]
Adding requests:  31%|███       | 1279/4096 [00:02<00:06, 422.78it/s]
Adding requests:  32%|███▏      | 1322/4096 [00:03<00:06, 416.12it/s]
Adding requests:  33%|███▎      | 1368/4096 [00:03<00:06, 428.52it/s]
Adding requests:  34%|███▍      | 1411/4096 [00:03<00:06, 418.31it/s]
Adding requests:  36%|███▌      | 1458/4096 [00:03<00:06, 432.45it/s]
Adding requests:  37%|███▋      | 1503/4096 [00:03<00:05, 435.49it/s]
Adding requests:  38%|███▊      | 1548/4096 [00:03<00:05, 439.09it/s]
Adding requests:  39%|███▉      | 1592/4096 [00:03<00:05, 433.55it/s]
Adding requests:  40%|███▉      | 1636/4096 [00:03<00:05, 431.42it/s]
Adding requests:  41%|████      | 1680/4096 [00:03<00:05, 433.32it/s]
Adding requests:  42%|████▏     | 1724/4096 [00:03<00:05, 432.07it/s]
Adding requests:  43%|████▎     | 1770/4096 [00:04<00:05, 438.97it/s]
Adding requests:  44%|████▍     | 1814/4096 [00:04<00:05, 429.85it/s]
Adding requests:  45%|████▌     | 1861/4096 [00:04<00:05, 441.26it/s]
Adding requests:  47%|████▋     | 1906/4096 [00:04<00:04, 438.33it/s]
Adding requests:  48%|████▊     | 1957/4096 [00:04<00:04, 458.60it/s]
Adding requests:  49%|████▉     | 2003/4096 [00:04<00:04, 444.76it/s]
Adding requests:  50%|█████     | 2048/4096 [00:04<00:04, 444.08it/s]
Adding requests:  51%|█████     | 2093/4096 [00:04<00:04, 430.38it/s]
Adding requests:  52%|█████▏    | 2137/4096 [00:04<00:04, 428.09it/s]
Adding requests:  53%|█████▎    | 2180/4096 [00:05<00:04, 416.63it/s]
Adding requests:  54%|█████▍    | 2223/4096 [00:05<00:04, 418.52it/s]
Adding requests:  55%|█████▌    | 2266/4096 [00:05<00:04, 420.39it/s]
Adding requests:  56%|█████▋    | 2311/4096 [00:05<00:04, 428.72it/s]
Adding requests:  58%|█████▊    | 2359/4096 [00:05<00:03, 441.83it/s]
Adding requests:  59%|█████▊    | 2404/4096 [00:05<00:03, 443.35it/s]
Adding requests:  60%|█████▉    | 2449/4096 [00:05<00:03, 437.09it/s]
Adding requests:  61%|██████    | 2493/4096 [00:05<00:03, 433.40it/s]
Adding requests:  62%|██████▏   | 2545/4096 [00:05<00:03, 455.41it/s]
Adding requests:  63%|██████▎   | 2591/4096 [00:05<00:03, 446.84it/s]
Adding requests:  64%|██████▍   | 2636/4096 [00:06<00:03, 441.14it/s]
Adding requests:  65%|██████▌   | 2681/4096 [00:06<00:03, 436.87it/s]
Adding requests:  67%|██████▋   | 2725/4096 [00:06<00:03, 431.83it/s]
Adding requests:  68%|██████▊   | 2769/4096 [00:06<00:03, 433.06it/s]
Adding requests:  69%|██████▊   | 2813/4096 [00:06<00:02, 434.34it/s]
Adding requests:  70%|██████▉   | 2857/4096 [00:06<00:02, 431.73it/s]
Adding requests:  71%|███████   | 2901/4096 [00:06<00:02, 428.80it/s]
Adding requests:  72%|███████▏  | 2945/4096 [00:06<00:02, 431.25it/s]
Adding requests:  73%|███████▎  | 2989/4096 [00:06<00:02, 431.05it/s]
Adding requests:  74%|███████▍  | 3036/4096 [00:06<00:02, 441.84it/s]
Adding requests:  75%|███████▌  | 3081/4096 [00:07<00:02, 440.91it/s]
Adding requests:  76%|███████▋  | 3129/4096 [00:07<00:02, 451.42it/s]
Adding requests:  78%|███████▊  | 3175/4096 [00:07<00:02, 434.58it/s]
Adding requests:  79%|███████▊  | 3223/4096 [00:07<00:01, 446.19it/s]
Adding requests:  80%|███████▉  | 3268/4096 [00:07<00:01, 421.54it/s]
Adding requests:  81%|████████  | 3311/4096 [00:07<00:01, 406.66it/s]
Adding requests:  82%|████████▏ | 3353/4096 [00:07<00:01, 410.19it/s]
Adding requests:  83%|████████▎ | 3399/4096 [00:07<00:01, 422.20it/s]
Adding requests:  84%|████████▍ | 3445/4096 [00:07<00:01, 432.35it/s]
Adding requests:  85%|████████▌ | 3489/4096 [00:08<00:01, 424.24it/s]
Adding requests:  86%|████████▋ | 3540/4096 [00:08<00:01, 447.72it/s]
Adding requests:  88%|████████▊ | 3585/4096 [00:08<00:01, 440.14it/s]
Adding requests:  89%|████████▊ | 3632/4096 [00:08<00:01, 448.19it/s]
Adding requests:  90%|████████▉ | 3677/4096 [00:08<00:00, 434.49it/s]
Adding requests:  91%|█████████ | 3723/4096 [00:08<00:00, 437.55it/s]
Adding requests:  92%|█████████▏| 3767/4096 [00:08<00:00, 416.49it/s]
Adding requests:  93%|█████████▎| 3809/4096 [00:08<00:00, 412.85it/s]
Adding requests:  94%|█████████▍| 3851/4096 [00:08<00:00, 395.65it/s]
Adding requests:  95%|█████████▌| 3892/4096 [00:09<00:00, 397.90it/s]
Adding requests:  96%|█████████▌| 3936/4096 [00:09<00:00, 408.95it/s]
Adding requests:  97%|█████████▋| 3978/4096 [00:09<00:00, 406.70it/s]
Adding requests:  98%|█████████▊| 4024/4096 [00:09<00:00, 421.27it/s]
Adding requests:  99%|█████████▉| 4067/4096 [00:09<00:00, 411.81it/s]
Adding requests: 100%|██████████| 4096/4096 [00:09<00:00, 430.66it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 38/4096 [00:02<03:59, 16.95it/s, est. speed input: 17358.97 toks/s, output: 16.95 toks/s]
Processed prompts:   2%|▏         | 70/4096 [00:07<07:57,  8.43it/s, est. speed input: 9405.28 toks/s, output: 9.18 toks/s]  
Processed prompts:   2%|▏         | 102/4096 [00:13<09:20,  7.13it/s, est. speed input: 8032.51 toks/s, output: 7.84 toks/s]
Processed prompts:   3%|▎         | 134/4096 [00:18<10:15,  6.44it/s, est. speed input: 7322.16 toks/s, output: 7.15 toks/s]
Processed prompts:   4%|▍         | 166/4096 [00:24<10:28,  6.25it/s, est. speed input: 7043.20 toks/s, output: 6.88 toks/s]
Processed prompts:   5%|▍         | 198/4096 [00:29<10:29,  6.19it/s, est. speed input: 6898.02 toks/s, output: 6.74 toks/s]
Processed prompts:   6%|▌         | 230/4096 [00:34<10:33,  6.11it/s, est. speed input: 6770.89 toks/s, output: 6.61 toks/s]
Processed prompts:   6%|▋         | 262/4096 [00:40<10:33,  6.05it/s, est. speed input: 6677.46 toks/s, output: 6.52 toks/s]
Processed prompts:   7%|▋         | 294/4096 [00:45<10:26,  6.06it/s, est. speed input: 6627.04 toks/s, output: 6.47 toks/s]
Processed prompts:   8%|▊         | 326/4096 [00:50<10:29,  5.98it/s, est. speed input: 6554.21 toks/s, output: 6.40 toks/s]
Processed prompts:   9%|▊         | 358/4096 [00:56<10:26,  5.97it/s, est. speed input: 6507.53 toks/s, output: 6.36 toks/s]
Processed prompts:  10%|▉         | 390/4096 [01:01<10:22,  5.95it/s, est. speed input: 6468.73 toks/s, output: 6.32 toks/s]
Processed prompts:  10%|█         | 422/4096 [01:07<10:13,  5.99it/s, est. speed input: 6449.25 toks/s, output: 6.30 toks/s]
Processed prompts:  11%|█         | 454/4096 [01:12<10:10,  5.97it/s, est. speed input: 6420.76 toks/s, output: 6.27 toks/s]
Processed prompts:  12%|█▏        | 486/4096 [01:17<10:06,  5.95it/s, est. speed input: 6395.61 toks/s, output: 6.25 toks/s]
Processed prompts:  13%|█▎        | 518/4096 [01:23<10:02,  5.94it/s, est. speed input: 6372.36 toks/s, output: 6.22 toks/s]
Processed prompts:  13%|█▎        | 550/4096 [01:28<09:57,  5.93it/s, est. speed input: 6353.22 toks/s, output: 6.20 toks/s]
Processed prompts:  14%|█▍        | 582/4096 [01:34<09:53,  5.92it/s, est. speed input: 6335.72 toks/s, output: 6.19 toks/s]
Processed prompts:  15%|█▍        | 614/4096 [01:39<09:47,  5.92it/s, est. speed input: 6320.83 toks/s, output: 6.17 toks/s]
Processed prompts:  16%|█▌        | 646/4096 [01:44<09:42,  5.92it/s, est. speed input: 6307.40 toks/s, output: 6.16 toks/s]
Processed prompts:  17%|█▋        | 678/4096 [01:50<09:37,  5.92it/s, est. speed input: 6295.61 toks/s, output: 6.15 toks/s]
Processed prompts:  17%|█▋        | 710/4096 [01:55<09:32,  5.92it/s, est. speed input: 6284.02 toks/s, output: 6.14 toks/s]
Processed prompts:  18%|█▊        | 742/4096 [02:01<09:26,  5.92it/s, est. speed input: 6273.89 toks/s, output: 6.13 toks/s]
Processed prompts:  19%|█▉        | 774/4096 [02:06<09:16,  5.97it/s, est. speed input: 6272.79 toks/s, output: 6.13 toks/s]
Processed prompts:  20%|█▉        | 806/4096 [02:11<09:12,  5.95it/s, est. speed input: 6264.05 toks/s, output: 6.12 toks/s]
Processed prompts:  20%|██        | 838/4096 [02:17<09:07,  5.95it/s, est. speed input: 6256.32 toks/s, output: 6.11 toks/s]
Processed prompts:  21%|██        | 870/4096 [02:22<09:02,  5.94it/s, est. speed input: 6249.35 toks/s, output: 6.10 toks/s]
Processed prompts:  22%|██▏       | 902/4096 [02:27<08:59,  5.93it/s, est. speed input: 6241.31 toks/s, output: 6.10 toks/s]
Processed prompts:  23%|██▎       | 934/4096 [02:33<08:53,  5.92it/s, est. speed input: 6235.00 toks/s, output: 6.09 toks/s]
Processed prompts:  24%|██▎       | 966/4096 [02:38<08:48,  5.92it/s, est. speed input: 6228.60 toks/s, output: 6.08 toks/s]
Processed prompts:  24%|██▍       | 998/4096 [02:44<08:43,  5.92it/s, est. speed input: 6223.28 toks/s, output: 6.08 toks/s]
Processed prompts:  25%|██▌       | 1030/4096 [02:49<08:37,  5.92it/s, est. speed input: 6218.17 toks/s, output: 6.07 toks/s]
Processed prompts:  26%|██▌       | 1062/4096 [02:55<08:32,  5.92it/s, est. speed input: 6213.54 toks/s, output: 6.07 toks/s]
Processed prompts:  27%|██▋       | 1094/4096 [03:00<08:27,  5.92it/s, est. speed input: 6208.92 toks/s, output: 6.06 toks/s]
Processed prompts:  27%|██▋       | 1126/4096 [03:05<08:21,  5.92it/s, est. speed input: 6204.64 toks/s, output: 6.06 toks/s]
Processed prompts:  28%|██▊       | 1158/4096 [03:11<08:16,  5.92it/s, est. speed input: 6200.79 toks/s, output: 6.06 toks/s]
Processed prompts:  29%|██▉       | 1190/4096 [03:16<08:07,  5.97it/s, est. speed input: 6201.17 toks/s, output: 6.06 toks/s]
Processed prompts:  30%|██▉       | 1222/4096 [03:21<07:59,  6.00it/s, est. speed input: 6201.69 toks/s, output: 6.06 toks/s]
Processed prompts:  31%|███       | 1254/4096 [03:27<07:55,  5.98it/s, est. speed input: 6198.24 toks/s, output: 6.05 toks/s]
Processed prompts:  31%|███▏      | 1286/4096 [03:32<07:52,  5.95it/s, est. speed input: 6194.08 toks/s, output: 6.05 toks/s]
Processed prompts:  32%|███▏      | 1318/4096 [03:37<07:43,  5.99it/s, est. speed input: 6194.84 toks/s, output: 6.05 toks/s]
Processed prompts:  33%|███▎      | 1350/4096 [03:43<07:40,  5.97it/s, est. speed input: 6191.60 toks/s, output: 6.05 toks/s]
Processed prompts:  34%|███▎      | 1382/4096 [03:48<07:36,  5.95it/s, est. speed input: 6188.29 toks/s, output: 6.04 toks/s]
Processed prompts:  35%|███▍      | 1414/4096 [03:53<07:27,  5.99it/s, est. speed input: 6189.21 toks/s, output: 6.04 toks/s]
Processed prompts:  35%|███▌      | 1446/4096 [03:59<07:20,  6.01it/s, est. speed input: 6189.68 toks/s, output: 6.04 toks/s]
Processed prompts:  36%|███▌      | 1478/4096 [04:04<07:17,  5.98it/s, est. speed input: 6186.76 toks/s, output: 6.04 toks/s]
Processed prompts:  37%|███▋      | 1510/4096 [04:09<07:10,  6.01it/s, est. speed input: 6187.55 toks/s, output: 6.04 toks/s]
Processed prompts:  38%|███▊      | 1542/4096 [04:15<07:03,  6.03it/s, est. speed input: 6188.51 toks/s, output: 6.04 toks/s]
Processed prompts:  38%|███▊      | 1574/4096 [04:20<07:00,  6.00it/s, est. speed input: 6185.91 toks/s, output: 6.04 toks/s]
Processed prompts:  39%|███▉      | 1606/4096 [04:25<06:53,  6.02it/s, est. speed input: 6186.60 toks/s, output: 6.04 toks/s]
Processed prompts:  40%|███▉      | 1638/4096 [04:31<06:50,  5.99it/s, est. speed input: 6184.13 toks/s, output: 6.04 toks/s]
Processed prompts:  41%|████      | 1670/4096 [04:36<06:46,  5.97it/s, est. speed input: 6181.76 toks/s, output: 6.04 toks/s]
Processed prompts:  42%|████▏     | 1702/4096 [04:42<06:42,  5.95it/s, est. speed input: 6179.37 toks/s, output: 6.03 toks/s]
Processed prompts:  42%|████▏     | 1734/4096 [04:47<06:27,  6.10it/s, est. speed input: 6186.78 toks/s, output: 6.04 toks/s]
Processed prompts:  43%|████▎     | 1766/4096 [04:52<06:25,  6.04it/s, est. speed input: 6184.42 toks/s, output: 6.04 toks/s]
Processed prompts:  44%|████▍     | 1798/4096 [04:57<06:22,  6.00it/s, est. speed input: 6182.07 toks/s, output: 6.04 toks/s]
Processed prompts:  45%|████▍     | 1830/4096 [05:03<06:19,  5.97it/s, est. speed input: 6179.78 toks/s, output: 6.03 toks/s]
Processed prompts:  45%|████▌     | 1862/4096 [05:08<06:11,  6.01it/s, est. speed input: 6180.71 toks/s, output: 6.04 toks/s]
Processed prompts:  46%|████▌     | 1894/4096 [05:13<06:08,  5.98it/s, est. speed input: 6178.68 toks/s, output: 6.03 toks/s]
Processed prompts:  47%|████▋     | 1926/4096 [05:19<06:03,  5.96it/s, est. speed input: 6176.72 toks/s, output: 6.03 toks/s]
Processed prompts:  48%|████▊     | 1958/4096 [05:24<05:59,  5.95it/s, est. speed input: 6174.70 toks/s, output: 6.03 toks/s]
Processed prompts:  49%|████▊     | 1990/4096 [05:29<05:51,  5.98it/s, est. speed input: 6175.37 toks/s, output: 6.03 toks/s]
Processed prompts:  49%|████▉     | 2022/4096 [05:35<05:47,  5.97it/s, est. speed input: 6173.73 toks/s, output: 6.03 toks/s]
Processed prompts:  50%|█████     | 2054/4096 [05:40<05:40,  6.00it/s, est. speed input: 6174.56 toks/s, output: 6.03 toks/s]
Processed prompts:  51%|█████     | 2086/4096 [05:46<05:36,  5.98it/s, est. speed input: 6172.82 toks/s, output: 6.03 toks/s]
Processed prompts:  52%|█████▏    | 2118/4096 [05:51<05:32,  5.96it/s, est. speed input: 6170.96 toks/s, output: 6.03 toks/s]
Processed prompts:  52%|█████▏    | 2150/4096 [05:56<05:27,  5.95it/s, est. speed input: 6169.31 toks/s, output: 6.02 toks/s]
Processed prompts:  53%|█████▎    | 2182/4096 [06:02<05:19,  5.98it/s, est. speed input: 6170.00 toks/s, output: 6.03 toks/s]
Processed prompts:  54%|█████▍    | 2214/4096 [06:07<05:15,  5.96it/s, est. speed input: 6168.42 toks/s, output: 6.02 toks/s]
Processed prompts:  55%|█████▍    | 2246/4096 [06:12<05:10,  5.95it/s, est. speed input: 6166.93 toks/s, output: 6.02 toks/s]
Processed prompts:  56%|█████▌    | 2278/4096 [06:18<05:05,  5.95it/s, est. speed input: 6165.58 toks/s, output: 6.02 toks/s]
Processed prompts:  56%|█████▋    | 2310/4096 [06:23<05:00,  5.94it/s, est. speed input: 6164.12 toks/s, output: 6.02 toks/s]
Processed prompts:  57%|█████▋    | 2342/4096 [06:29<04:53,  5.98it/s, est. speed input: 6164.87 toks/s, output: 6.02 toks/s]
Processed prompts:  58%|█████▊    | 2374/4096 [06:34<04:48,  5.96it/s, est. speed input: 6163.46 toks/s, output: 6.02 toks/s]
Processed prompts:  59%|█████▊    | 2406/4096 [06:39<04:44,  5.95it/s, est. speed input: 6162.00 toks/s, output: 6.02 toks/s]
Processed prompts:  60%|█████▉    | 2438/4096 [06:45<04:39,  5.94it/s, est. speed input: 6160.69 toks/s, output: 6.02 toks/s]
Processed prompts:  60%|██████    | 2470/4096 [06:50<04:34,  5.93it/s, est. speed input: 6159.39 toks/s, output: 6.02 toks/s]
Processed prompts:  61%|██████    | 2502/4096 [06:56<04:28,  5.93it/s, est. speed input: 6158.11 toks/s, output: 6.01 toks/s]
Processed prompts:  62%|██████▏   | 2534/4096 [07:01<04:21,  5.97it/s, est. speed input: 6158.88 toks/s, output: 6.01 toks/s]
Processed prompts:  63%|██████▎   | 2566/4096 [07:06<04:17,  5.95it/s, est. speed input: 6157.53 toks/s, output: 6.01 toks/s]
Processed prompts:  63%|██████▎   | 2598/4096 [07:11<04:10,  5.99it/s, est. speed input: 6158.32 toks/s, output: 6.01 toks/s]
Processed prompts:  64%|██████▍   | 2630/4096 [07:17<04:05,  5.97it/s, est. speed input: 6157.07 toks/s, output: 6.01 toks/s]
Processed prompts:  65%|██████▍   | 2662/4096 [07:22<03:59,  6.00it/s, est. speed input: 6157.79 toks/s, output: 6.01 toks/s]
Processed prompts:  66%|██████▌   | 2694/4096 [07:28<03:54,  5.98it/s, est. speed input: 6156.78 toks/s, output: 6.01 toks/s]
Processed prompts:  67%|██████▋   | 2726/4096 [07:33<03:48,  6.01it/s, est. speed input: 6157.55 toks/s, output: 6.01 toks/s]
Processed prompts:  67%|██████▋   | 2758/4096 [07:38<03:43,  5.98it/s, est. speed input: 6156.39 toks/s, output: 6.01 toks/s]
Processed prompts:  68%|██████▊   | 2790/4096 [07:44<03:39,  5.96it/s, est. speed input: 6155.28 toks/s, output: 6.01 toks/s]
Processed prompts:  69%|██████▉   | 2822/4096 [07:49<03:34,  5.95it/s, est. speed input: 6154.25 toks/s, output: 6.01 toks/s]
Processed prompts:  70%|██████▉   | 2854/4096 [07:54<03:29,  5.94it/s, est. speed input: 6153.15 toks/s, output: 6.01 toks/s]
Processed prompts:  70%|███████   | 2886/4096 [08:00<03:20,  6.03it/s, est. speed input: 6155.92 toks/s, output: 6.01 toks/s]
Processed prompts:  71%|███████   | 2918/4096 [08:05<03:14,  6.05it/s, est. speed input: 6156.69 toks/s, output: 6.01 toks/s]
Processed prompts:  72%|███████▏  | 2950/4096 [08:10<03:10,  6.01it/s, est. speed input: 6155.57 toks/s, output: 6.01 toks/s]
Processed prompts:  73%|███████▎  | 2982/4096 [08:16<03:04,  6.03it/s, est. speed input: 6156.19 toks/s, output: 6.01 toks/s]
Processed prompts:  74%|███████▎  | 3014/4096 [08:21<03:00,  5.99it/s, est. speed input: 6155.18 toks/s, output: 6.01 toks/s]
Processed prompts:  74%|███████▍  | 3046/4096 [08:26<02:55,  5.97it/s, est. speed input: 6154.21 toks/s, output: 6.01 toks/s]
Processed prompts:  75%|███████▌  | 3078/4096 [08:32<02:50,  5.95it/s, est. speed input: 6153.20 toks/s, output: 6.01 toks/s]
Processed prompts:  76%|███████▌  | 3110/4096 [08:37<02:45,  5.94it/s, est. speed input: 6152.17 toks/s, output: 6.01 toks/s]
Processed prompts:  77%|███████▋  | 3142/4096 [08:43<02:40,  5.93it/s, est. speed input: 6151.19 toks/s, output: 6.01 toks/s]
Processed prompts:  77%|███████▋  | 3174/4096 [08:48<02:34,  5.98it/s, est. speed input: 6152.03 toks/s, output: 6.01 toks/s]
Processed prompts:  78%|███████▊  | 3206/4096 [08:53<02:29,  5.96it/s, est. speed input: 6151.06 toks/s, output: 6.01 toks/s]
Processed prompts:  79%|███████▉  | 3238/4096 [08:59<02:24,  5.95it/s, est. speed input: 6150.14 toks/s, output: 6.01 toks/s]
Processed prompts:  80%|███████▉  | 3270/4096 [09:04<02:19,  5.94it/s, est. speed input: 6149.32 toks/s, output: 6.01 toks/s]
Processed prompts:  81%|████████  | 3302/4096 [09:09<02:13,  5.94it/s, est. speed input: 6148.58 toks/s, output: 6.00 toks/s]
Processed prompts:  81%|████████▏ | 3334/4096 [09:15<02:08,  5.93it/s, est. speed input: 6147.77 toks/s, output: 6.00 toks/s]
Processed prompts:  82%|████████▏ | 3366/4096 [09:20<02:03,  5.93it/s, est. speed input: 6146.84 toks/s, output: 6.00 toks/s]
Processed prompts:  83%|████████▎ | 3398/4096 [09:26<01:56,  5.97it/s, est. speed input: 6147.42 toks/s, output: 6.00 toks/s]
Processed prompts:  84%|████████▎ | 3430/4096 [09:31<01:51,  5.95it/s, est. speed input: 6146.55 toks/s, output: 6.00 toks/s]
Processed prompts:  85%|████████▍ | 3462/4096 [09:36<01:46,  5.94it/s, est. speed input: 6145.69 toks/s, output: 6.00 toks/s]
Processed prompts:  85%|████████▌ | 3494/4096 [09:42<01:41,  5.94it/s, est. speed input: 6144.99 toks/s, output: 6.00 toks/s]
Processed prompts:  86%|████████▌ | 3526/4096 [09:47<01:36,  5.93it/s, est. speed input: 6144.24 toks/s, output: 6.00 toks/s]
Processed prompts:  87%|████████▋ | 3558/4096 [09:52<01:30,  5.97it/s, est. speed input: 6144.86 toks/s, output: 6.00 toks/s]
Processed prompts:  88%|████████▊ | 3590/4096 [09:58<01:24,  5.96it/s, est. speed input: 6144.15 toks/s, output: 6.00 toks/s]
Processed prompts:  88%|████████▊ | 3622/4096 [10:03<01:19,  5.95it/s, est. speed input: 6143.41 toks/s, output: 6.00 toks/s]
Processed prompts:  89%|████████▉ | 3654/4096 [10:09<01:14,  5.94it/s, est. speed input: 6142.68 toks/s, output: 6.00 toks/s]
Processed prompts:  90%|████████▉ | 3686/4096 [10:14<01:07,  6.04it/s, est. speed input: 6145.10 toks/s, output: 6.00 toks/s]
Processed prompts:  91%|█████████ | 3718/4096 [10:19<01:02,  6.00it/s, est. speed input: 6144.36 toks/s, output: 6.00 toks/s]
Processed prompts:  92%|█████████▏| 3750/4096 [10:25<00:57,  5.98it/s, est. speed input: 6143.68 toks/s, output: 6.00 toks/s]
Processed prompts:  92%|█████████▏| 3782/4096 [10:30<00:52,  5.96it/s, est. speed input: 6142.97 toks/s, output: 6.00 toks/s]
Processed prompts:  93%|█████████▎| 3814/4096 [10:35<00:47,  5.95it/s, est. speed input: 6142.27 toks/s, output: 6.00 toks/s]
Processed prompts:  94%|█████████▍| 3846/4096 [10:41<00:42,  5.94it/s, est. speed input: 6141.54 toks/s, output: 6.00 toks/s]
Processed prompts:  95%|█████████▍| 3878/4096 [10:46<00:36,  5.93it/s, est. speed input: 6140.83 toks/s, output: 6.00 toks/s]
Processed prompts:  95%|█████████▌| 3910/4096 [10:51<00:31,  5.97it/s, est. speed input: 6141.50 toks/s, output: 6.00 toks/s]
Processed prompts:  96%|█████████▌| 3942/4096 [10:57<00:25,  6.00it/s, est. speed input: 6142.10 toks/s, output: 6.00 toks/s]
Processed prompts:  97%|█████████▋| 3974/4096 [11:02<00:20,  5.97it/s, est. speed input: 6141.37 toks/s, output: 6.00 toks/s]
Processed prompts:  98%|█████████▊| 4006/4096 [11:07<00:14,  6.00it/s, est. speed input: 6141.90 toks/s, output: 6.00 toks/s]
Processed prompts:  99%|█████████▊| 4038/4096 [11:13<00:09,  6.02it/s, est. speed input: 6142.48 toks/s, output: 6.00 toks/s]
Processed prompts:  99%|█████████▉| 4070/4096 [11:17<00:04,  6.34it/s, est. speed input: 6150.68 toks/s, output: 6.01 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:17<00:00,  6.34it/s, est. speed input: 6189.97 toks/s, output: 6.04 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:17<00:00,  6.04it/s, est. speed input: 6189.97 toks/s, output: 6.04 toks/s]
[rank0]:[W126 16:26:30.127628235 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 800.4s

测试结果:
  Requests/s:   5.96
  Tokens/s:     6110.22
  Total Reqs:   4096
  Elapsed:      687.11s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     6104.26

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:27:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:27:12 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1494901) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1494901) ERROR 01-26 16:28:24 [core.py:866] 


─── STDERR ───
[2026-01-26 16:27:11] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:27:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:27:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:27:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:27:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:27:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:27:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:27:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:27:15] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:27:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:27:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:27:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:27:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:27:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:27:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:27:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:27:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1494901) [2026-01-26 16:27:16] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1494901) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1494901) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.75s/it]
(EngineCore_DP0 pid=1494901) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 32.28s/it]
(EngineCore_DP0 pid=1494901) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 31.75s/it]
(EngineCore_DP0 pid=1494901) 
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 18579456 bytes
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 14450688 bytes
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 152764416 bytes
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1494901) [2026-01-26 16:28:21] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 76382208 bytes
(EngineCore_DP0 pid=1494901) Process EngineCore_DP0:
(EngineCore_DP0 pid=1494901) Traceback (most recent call last):
(EngineCore_DP0 pid=1494901)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1494901)     self.run()
(EngineCore_DP0 pid=1494901)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1494901)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1494901)     raise e
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1494901)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1494901)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1494901)     super().__init__(
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1494901)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1494901)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1494901)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1494901)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1494901)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1494901)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1494901)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1494901)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1494901)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1494901)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1494901)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1494901)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1494901)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1494901)     outputs = self.model(
(EngineCore_DP0 pid=1494901)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1494901)     hidden_states = self.model(
(EngineCore_DP0 pid=1494901)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1494901)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1494901)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1494901)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1494901)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1494901)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1494901)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1494901)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1494901)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1494901)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1494901)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1494901)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1494901)     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1494901)     return self._linear_fn(
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1494901)     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1494901)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1494901)     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1494901)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1494901)     return fn(input, L)
(EngineCore_DP0 pid=1494901)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1494901)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1494901)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1494901) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1494901) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1494901) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1494901) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1494901) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1494901) 
[rank0]:[W126 16:28:24.806507815 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_8/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,10.3165,5292.3821,12.4073
1024,1024,1,128,128,5.9363,6084.7584,21.5621
2048,1024,2,256,128,6.0898,6242.0501,42.0375
4096,1024,4,512,128,5.9618,6110.8659,85.8798
8192,1024,8,1024,128,5.6496,5790.8587,181.2512
16384,1024,16,2048,128,5.9951,6145.0256,341.6096
32768,1024,32,4096,128,5.9612,6110.2225,687.1108
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-INT8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-INT8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_10

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:28:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:28:30 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1496168) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1496168) WARNING 01-26 16:30:02 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 9.43 requests/s, 4836.08 total tokens/s, 9.43 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 16:28:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:28:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:28:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:28:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:28:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:28:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:28:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:28:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:28:33] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:28:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:28:33] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:28:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:28:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:28:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:28:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:28:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:28:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1496168) [2026-01-26 16:28:34] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1496168) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1496168) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.24s/it]
(EngineCore_DP0 pid=1496168) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 33.44s/it]
(EngineCore_DP0 pid=1496168) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 32.66s/it]
(EngineCore_DP0 pid=1496168) 
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:40] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:40] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:41] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1496168) [2026-01-26 16:29:41] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1496168) 2026-01-26 16:29:51,856 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1496168) 2026-01-26 16:29:52,261 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<01:59,  1.06it/s]
Adding requests:   2%|▏         | 2/128 [00:01<01:15,  1.68it/s]
Adding requests:   2%|▏         | 3/128 [00:01<00:54,  2.30it/s]
Adding requests:   3%|▎         | 4/128 [00:01<00:41,  3.02it/s]
Adding requests:   4%|▍         | 5/128 [00:01<00:32,  3.82it/s]
Adding requests:   5%|▌         | 7/128 [00:01<00:20,  6.05it/s]
Adding requests:   7%|▋         | 9/128 [00:02<00:14,  8.14it/s]
Adding requests:   9%|▉         | 12/128 [00:02<00:09, 11.92it/s]
Adding requests:  12%|█▎        | 16/128 [00:02<00:06, 17.63it/s]
Adding requests:  16%|█▌        | 20/128 [00:02<00:05, 20.92it/s]
Adding requests:  21%|██        | 27/128 [00:02<00:03, 30.67it/s]
Adding requests:  29%|██▉       | 37/128 [00:02<00:01, 47.06it/s]
Adding requests:  50%|█████     | 64/128 [00:02<00:00, 103.43it/s]
Adding requests:  73%|███████▎  | 93/128 [00:02<00:00, 152.66it/s]
Adding requests: 100%|██████████| 128/128 [00:03<00:00, 42.54it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:01, 109.42it/s, est. speed input: 56032.28 toks/s, output: 109.43 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 20.58it/s, est. speed input: 12414.60 toks/s, output: 24.25 toks/s]  
Processed prompts:  27%|██▋       | 35/128 [00:01<00:05, 16.51it/s, est. speed input: 10197.67 toks/s, output: 19.92 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 14.88it/s, est. speed input: 9371.16 toks/s, output: 18.30 toks/s] 
Processed prompts:  33%|███▎      | 42/128 [00:02<00:06, 13.86it/s, est. speed input: 8900.55 toks/s, output: 17.38 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:06, 13.33it/s, est. speed input: 8666.65 toks/s, output: 16.93 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:06, 12.82it/s, est. speed input: 8457.82 toks/s, output: 16.52 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:06, 12.33it/s, est. speed input: 8269.77 toks/s, output: 16.15 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:06, 11.92it/s, est. speed input: 8103.02 toks/s, output: 15.83 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:06, 11.53it/s, est. speed input: 7944.43 toks/s, output: 15.52 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:06, 11.26it/s, est. speed input: 7808.31 toks/s, output: 15.25 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:06, 11.12it/s, est. speed input: 7692.91 toks/s, output: 15.03 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:06, 11.05it/s, est. speed input: 7592.65 toks/s, output: 14.83 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:04<00:06, 11.01it/s, est. speed input: 7503.41 toks/s, output: 14.66 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:04<00:06, 10.93it/s, est. speed input: 7415.50 toks/s, output: 14.48 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:04<00:05, 10.78it/s, est. speed input: 7327.17 toks/s, output: 14.31 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:05, 10.75it/s, est. speed input: 7251.88 toks/s, output: 14.16 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:05, 10.73it/s, est. speed input: 7183.50 toks/s, output: 14.03 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:05<00:05, 10.72it/s, est. speed input: 7120.18 toks/s, output: 13.91 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:05<00:05, 10.69it/s, est. speed input: 7059.29 toks/s, output: 13.79 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:05<00:05, 10.62it/s, est. speed input: 6999.13 toks/s, output: 13.67 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:05<00:04, 10.66it/s, est. speed input: 6949.20 toks/s, output: 13.57 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:05<00:04, 10.70it/s, est. speed input: 6903.67 toks/s, output: 13.48 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:04, 10.71it/s, est. speed input: 6859.54 toks/s, output: 13.40 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:04, 10.73it/s, est. speed input: 6819.27 toks/s, output: 13.32 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:06<00:04, 10.76it/s, est. speed input: 6782.16 toks/s, output: 13.25 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:06<00:03, 10.66it/s, est. speed input: 6739.76 toks/s, output: 13.16 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:06<00:03, 10.67it/s, est. speed input: 6704.82 toks/s, output: 13.10 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:06<00:03, 10.66it/s, est. speed input: 6670.48 toks/s, output: 13.03 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:07<00:03, 10.72it/s, est. speed input: 6641.41 toks/s, output: 12.97 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:07<00:03, 10.72it/s, est. speed input: 6611.87 toks/s, output: 12.91 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:07<00:03, 10.66it/s, est. speed input: 6580.92 toks/s, output: 12.85 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:07<00:02, 10.65it/s, est. speed input: 6552.66 toks/s, output: 12.80 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:07<00:02, 10.64it/s, est. speed input: 6525.88 toks/s, output: 12.75 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02, 10.73it/s, est. speed input: 6504.81 toks/s, output: 12.70 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:08<00:02, 10.71it/s, est. speed input: 6481.23 toks/s, output: 12.66 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:08<00:02, 10.70it/s, est. speed input: 6458.68 toks/s, output: 12.61 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:08<00:01, 10.61it/s, est. speed input: 6433.46 toks/s, output: 12.57 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:08<00:01, 10.67it/s, est. speed input: 6414.42 toks/s, output: 12.53 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:08<00:01, 10.73it/s, est. speed input: 6397.11 toks/s, output: 12.49 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:09<00:01, 10.75it/s, est. speed input: 6379.35 toks/s, output: 12.46 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:09<00:01, 10.71it/s, est. speed input: 6360.45 toks/s, output: 12.42 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:09<00:00, 10.70it/s, est. speed input: 6342.69 toks/s, output: 12.39 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:09<00:00, 10.59it/s, est. speed input: 6322.07 toks/s, output: 12.35 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:09<00:00, 10.66it/s, est. speed input: 6307.58 toks/s, output: 12.32 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:10<00:00, 10.69it/s, est. speed input: 6292.66 toks/s, output: 12.29 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:10<00:00, 10.74it/s, est. speed input: 6279.73 toks/s, output: 12.27 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 10.74it/s, est. speed input: 6265.77 toks/s, output: 12.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 10.74it/s, est. speed input: 6265.77 toks/s, output: 12.24 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.24it/s, est. speed input: 6265.77 toks/s, output: 12.24 toks/s]
[rank0]:[W126 16:30:17.281023416 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 128.0s

测试结果:
  Requests/s:   9.43
  Tokens/s:     4836.08
  Total Reqs:   128
  Elapsed:      13.58s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     4826.66

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:30:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:30:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1498155) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1498155) WARNING 01-26 16:31:59 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.59 requests/s, 5729.43 total tokens/s, 5.59 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 16:30:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:30:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:30:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:30:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:30:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:30:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:30:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:30:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:30:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:30:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:30:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:30:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:30:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:30:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:30:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:30:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:30:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1498155) [2026-01-26 16:30:44] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1498155) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1498155) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.81s/it]
(EngineCore_DP0 pid=1498155) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 33.20s/it]
(EngineCore_DP0 pid=1498155) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 32.54s/it]
(EngineCore_DP0 pid=1498155) 
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1498155) [2026-01-26 16:31:51] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1498155) 2026-01-26 16:31:58,961 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1498155) 2026-01-26 16:31:58,998 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  24%|██▍       | 31/128 [00:00<00:00, 309.04it/s]
Adding requests:  58%|█████▊    | 74/128 [00:00<00:00, 377.53it/s]
Adding requests:  92%|█████████▏| 118/128 [00:00<00:00, 405.90it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 391.76it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:20,  6.07it/s, est. speed input: 6212.16 toks/s, output: 6.07 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:26,  4.65it/s, est. speed input: 4991.92 toks/s, output: 4.87 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:30,  4.11it/s, est. speed input: 4520.64 toks/s, output: 4.41 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:01<00:31,  3.85it/s, est. speed input: 4276.71 toks/s, output: 4.18 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:01<00:32,  3.70it/s, est. speed input: 4130.80 toks/s, output: 4.03 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:01<00:33,  3.58it/s, est. speed input: 4012.40 toks/s, output: 3.92 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:02<00:32,  3.68it/s, est. speed input: 4013.90 toks/s, output: 3.92 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:02<00:28,  4.16it/s, est. speed input: 4167.59 toks/s, output: 4.07 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:02<00:25,  4.59it/s, est. speed input: 4305.09 toks/s, output: 4.20 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:02<00:23,  4.93it/s, est. speed input: 4421.09 toks/s, output: 4.32 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:02<00:22,  5.18it/s, est. speed input: 4520.36 toks/s, output: 4.41 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:21,  5.33it/s, est. speed input: 4601.23 toks/s, output: 4.49 toks/s]
Processed prompts:  11%|█         | 14/128 [00:03<00:20,  5.50it/s, est. speed input: 4683.22 toks/s, output: 4.57 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:03<00:20,  5.63it/s, est. speed input: 4755.61 toks/s, output: 4.64 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:03<00:19,  5.71it/s, est. speed input: 4820.04 toks/s, output: 4.71 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:03<00:19,  5.79it/s, est. speed input: 4881.38 toks/s, output: 4.77 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:03<00:18,  5.80it/s, est. speed input: 4930.82 toks/s, output: 4.82 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:03<00:18,  5.75it/s, est. speed input: 4969.78 toks/s, output: 4.85 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:04<00:18,  5.79it/s, est. speed input: 5013.00 toks/s, output: 4.90 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:04<00:18,  5.83it/s, est. speed input: 5055.06 toks/s, output: 4.94 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:04<00:18,  5.84it/s, est. speed input: 5091.95 toks/s, output: 4.97 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:04<00:17,  5.86it/s, est. speed input: 5127.30 toks/s, output: 5.01 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:04<00:17,  5.90it/s, est. speed input: 5162.79 toks/s, output: 5.04 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:04<00:17,  5.85it/s, est. speed input: 5188.08 toks/s, output: 5.07 toks/s]
Processed prompts:  20%|██        | 26/128 [00:05<00:17,  5.87it/s, est. speed input: 5216.93 toks/s, output: 5.09 toks/s]
Processed prompts:  21%|██        | 27/128 [00:05<00:17,  5.89it/s, est. speed input: 5244.39 toks/s, output: 5.12 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:05<00:17,  5.88it/s, est. speed input: 5268.05 toks/s, output: 5.14 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:05<00:16,  5.89it/s, est. speed input: 5292.07 toks/s, output: 5.17 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:05<00:16,  5.92it/s, est. speed input: 5315.90 toks/s, output: 5.19 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:05<00:16,  5.88it/s, est. speed input: 5334.18 toks/s, output: 5.21 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:06<00:16,  5.88it/s, est. speed input: 5353.22 toks/s, output: 5.23 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:06<00:16,  5.88it/s, est. speed input: 5371.09 toks/s, output: 5.25 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:06<00:15,  5.90it/s, est. speed input: 5389.94 toks/s, output: 5.26 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:06<00:15,  5.86it/s, est. speed input: 5403.72 toks/s, output: 5.28 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:06<00:15,  5.89it/s, est. speed input: 5420.49 toks/s, output: 5.29 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:06<00:15,  5.85it/s, est. speed input: 5432.56 toks/s, output: 5.31 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:07<00:15,  5.87it/s, est. speed input: 5447.44 toks/s, output: 5.32 toks/s]
Processed prompts:  30%|███       | 39/128 [00:07<00:15,  5.90it/s, est. speed input: 5462.88 toks/s, output: 5.33 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:07<00:14,  5.91it/s, est. speed input: 5476.30 toks/s, output: 5.35 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:07<00:14,  5.92it/s, est. speed input: 5490.20 toks/s, output: 5.36 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:07<00:14,  5.92it/s, est. speed input: 5502.52 toks/s, output: 5.37 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:07<00:14,  5.90it/s, est. speed input: 5513.11 toks/s, output: 5.38 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:08<00:14,  5.83it/s, est. speed input: 5519.27 toks/s, output: 5.39 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:08<00:14,  5.86it/s, est. speed input: 5530.61 toks/s, output: 5.40 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:08<00:13,  5.87it/s, est. speed input: 5540.33 toks/s, output: 5.41 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:08<00:13,  5.84it/s, est. speed input: 5547.97 toks/s, output: 5.42 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:08<00:13,  5.84it/s, est. speed input: 5556.21 toks/s, output: 5.43 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:09<00:13,  5.83it/s, est. speed input: 5563.89 toks/s, output: 5.43 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:09<00:13,  5.80it/s, est. speed input: 5569.58 toks/s, output: 5.44 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:09<00:13,  5.83it/s, est. speed input: 5577.92 toks/s, output: 5.45 toks/s]
Processed prompts:  41%|████      | 52/128 [00:09<00:13,  5.82it/s, est. speed input: 5584.65 toks/s, output: 5.45 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:09<00:12,  5.83it/s, est. speed input: 5591.90 toks/s, output: 5.46 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:09<00:12,  5.88it/s, est. speed input: 5601.12 toks/s, output: 5.47 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:10<00:12,  5.87it/s, est. speed input: 5607.45 toks/s, output: 5.48 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:10<00:12,  5.81it/s, est. speed input: 5610.94 toks/s, output: 5.48 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:10<00:12,  5.83it/s, est. speed input: 5617.67 toks/s, output: 5.49 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:10<00:11,  5.86it/s, est. speed input: 5624.82 toks/s, output: 5.49 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:10<00:11,  5.85it/s, est. speed input: 5630.50 toks/s, output: 5.50 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:10<00:11,  5.90it/s, est. speed input: 5638.45 toks/s, output: 5.51 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:11<00:11,  5.87it/s, est. speed input: 5643.02 toks/s, output: 5.51 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:11<00:11,  5.80it/s, est. speed input: 5645.46 toks/s, output: 5.51 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:11<00:11,  5.81it/s, est. speed input: 5650.07 toks/s, output: 5.52 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:11<00:11,  5.81it/s, est. speed input: 5654.47 toks/s, output: 5.52 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:11<00:10,  5.83it/s, est. speed input: 5659.69 toks/s, output: 5.53 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:11<00:10,  5.84it/s, est. speed input: 5664.78 toks/s, output: 5.53 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:12<00:10,  5.84it/s, est. speed input: 5669.15 toks/s, output: 5.54 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:12<00:10,  5.82it/s, est. speed input: 5672.51 toks/s, output: 5.54 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:12<00:10,  5.85it/s, est. speed input: 5677.82 toks/s, output: 5.54 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:12<00:09,  5.89it/s, est. speed input: 5683.73 toks/s, output: 5.55 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:12<00:09,  5.91it/s, est. speed input: 5689.20 toks/s, output: 5.56 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:12<00:09,  5.89it/s, est. speed input: 5693.02 toks/s, output: 5.56 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:13<00:09,  5.88it/s, est. speed input: 5697.01 toks/s, output: 5.56 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:13<00:09,  5.82it/s, est. speed input: 5698.57 toks/s, output: 5.57 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:13<00:09,  5.81it/s, est. speed input: 5701.58 toks/s, output: 5.57 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:13<00:08,  5.82it/s, est. speed input: 5705.08 toks/s, output: 5.57 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:13<00:08,  5.81it/s, est. speed input: 5707.70 toks/s, output: 5.57 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:13<00:08,  5.80it/s, est. speed input: 5710.39 toks/s, output: 5.58 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:14<00:08,  5.85it/s, est. speed input: 5715.12 toks/s, output: 5.58 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:14<00:08,  5.79it/s, est. speed input: 5715.97 toks/s, output: 5.58 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:14<00:08,  5.81it/s, est. speed input: 5719.49 toks/s, output: 5.59 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:14<00:07,  5.84it/s, est. speed input: 5723.33 toks/s, output: 5.59 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:14<00:07,  5.86it/s, est. speed input: 5726.96 toks/s, output: 5.59 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:15<00:07,  5.87it/s, est. speed input: 5730.57 toks/s, output: 5.60 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:15<00:07,  5.84it/s, est. speed input: 5732.59 toks/s, output: 5.60 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:15<00:07,  5.81it/s, est. speed input: 5734.18 toks/s, output: 5.60 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:15<00:07,  5.78it/s, est. speed input: 5735.44 toks/s, output: 5.60 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:15<00:06,  5.80it/s, est. speed input: 5738.07 toks/s, output: 5.60 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:15<00:06,  5.81it/s, est. speed input: 5740.59 toks/s, output: 5.61 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:16<00:06,  5.82it/s, est. speed input: 5743.24 toks/s, output: 5.61 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:16<00:06,  5.83it/s, est. speed input: 5745.92 toks/s, output: 5.61 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:16<00:06,  5.88it/s, est. speed input: 5749.81 toks/s, output: 5.62 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:16<00:06,  5.78it/s, est. speed input: 5749.41 toks/s, output: 5.61 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:16<00:05,  5.81it/s, est. speed input: 5752.06 toks/s, output: 5.62 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:16<00:05,  5.82it/s, est. speed input: 5754.34 toks/s, output: 5.62 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:17<00:05,  5.81it/s, est. speed input: 5756.28 toks/s, output: 5.62 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:17<00:05,  5.82it/s, est. speed input: 5758.29 toks/s, output: 5.62 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:17<00:05,  5.83it/s, est. speed input: 5760.86 toks/s, output: 5.63 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:17<00:05,  5.77it/s, est. speed input: 5760.89 toks/s, output: 5.63 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:17<00:04,  5.78it/s, est. speed input: 5762.72 toks/s, output: 5.63 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:17<00:04,  5.80it/s, est. speed input: 5764.95 toks/s, output: 5.63 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:18<00:04,  5.82it/s, est. speed input: 5767.09 toks/s, output: 5.63 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:18<00:04,  5.85it/s, est. speed input: 5769.91 toks/s, output: 5.63 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:18<00:04,  5.85it/s, est. speed input: 5771.99 toks/s, output: 5.64 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:18<00:03,  5.84it/s, est. speed input: 5773.63 toks/s, output: 5.64 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:18<00:03,  5.85it/s, est. speed input: 5775.84 toks/s, output: 5.64 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:18<00:03,  5.85it/s, est. speed input: 5777.81 toks/s, output: 5.64 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:19<00:03,  5.82it/s, est. speed input: 5778.80 toks/s, output: 5.64 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:19<00:03,  5.85it/s, est. speed input: 5781.29 toks/s, output: 5.65 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:19<00:03,  5.83it/s, est. speed input: 5782.60 toks/s, output: 5.65 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:19<00:02,  5.76it/s, est. speed input: 5782.27 toks/s, output: 5.65 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:19<00:02,  5.77it/s, est. speed input: 5783.50 toks/s, output: 5.65 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:20<00:02,  5.78it/s, est. speed input: 5784.74 toks/s, output: 5.65 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:20<00:02,  5.81it/s, est. speed input: 5786.83 toks/s, output: 5.65 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:20<00:02,  5.86it/s, est. speed input: 5789.53 toks/s, output: 5.65 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:20<00:02,  5.86it/s, est. speed input: 5791.45 toks/s, output: 5.66 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:20<00:01,  5.82it/s, est. speed input: 5792.00 toks/s, output: 5.66 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:20<00:01,  5.81it/s, est. speed input: 5792.99 toks/s, output: 5.66 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:21<00:01,  5.81it/s, est. speed input: 5794.31 toks/s, output: 5.66 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:21<00:01,  5.83it/s, est. speed input: 5796.17 toks/s, output: 5.66 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:21<00:01,  5.84it/s, est. speed input: 5797.80 toks/s, output: 5.66 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:21<00:01,  5.82it/s, est. speed input: 5798.68 toks/s, output: 5.66 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:21<00:00,  5.77it/s, est. speed input: 5798.73 toks/s, output: 5.66 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:21<00:00,  5.83it/s, est. speed input: 5801.19 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:22<00:00,  5.84it/s, est. speed input: 5802.71 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:22<00:00,  5.83it/s, est. speed input: 5803.70 toks/s, output: 5.67 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:22<00:00,  5.86it/s, est. speed input: 5805.70 toks/s, output: 5.67 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.85it/s, est. speed input: 5807.01 toks/s, output: 5.67 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.85it/s, est. speed input: 5807.01 toks/s, output: 5.67 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.67it/s, est. speed input: 5807.01 toks/s, output: 5.67 toks/s]
[rank0]:[W126 16:32:22.126137982 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 110.7s

测试结果:
  Requests/s:   5.59
  Tokens/s:     5729.43
  Total Reqs:   128
  Elapsed:      22.90s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     5723.85

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:32:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:32:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1499882) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1499882) WARNING 01-26 16:33:52 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.89 requests/s, 6032.60 total tokens/s, 5.89 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 16:32:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:32:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:32:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:32:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:32:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:32:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:32:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:32:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:32:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:32:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:32:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:32:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:32:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:32:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:32:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:32:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:32:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1499882) [2026-01-26 16:32:36] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1499882) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1499882) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.91s/it]
(EngineCore_DP0 pid=1499882) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 33.62s/it]
(EngineCore_DP0 pid=1499882) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 32.92s/it]
(EngineCore_DP0 pid=1499882) 
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1499882) [2026-01-26 16:33:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1499882) 2026-01-26 16:33:51,125 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1499882) 2026-01-26 16:33:51,163 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  12%|█▎        | 32/256 [00:00<00:00, 318.94it/s]
Adding requests:  27%|██▋       | 70/256 [00:00<00:00, 353.00it/s]
Adding requests:  44%|████▍     | 112/256 [00:00<00:00, 378.44it/s]
Adding requests:  60%|█████▉    | 153/256 [00:00<00:00, 389.94it/s]
Adding requests:  78%|███████▊  | 199/256 [00:00<00:00, 413.93it/s]
Adding requests:  95%|█████████▍| 242/256 [00:00<00:00, 414.62it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 398.12it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:19, 12.67it/s, est. speed input: 12971.55 toks/s, output: 12.67 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:29,  8.62it/s, est. speed input: 9425.88 toks/s, output: 9.20 toks/s]  
Processed prompts:   3%|▎         | 8/256 [00:00<00:33,  7.36it/s, est. speed input: 8271.96 toks/s, output: 8.08 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:36,  6.79it/s, est. speed input: 7712.49 toks/s, output: 7.53 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:37,  6.46it/s, est. speed input: 7369.43 toks/s, output: 7.20 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:02<00:38,  6.29it/s, est. speed input: 7158.76 toks/s, output: 6.99 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:38,  6.19it/s, est. speed input: 7011.61 toks/s, output: 6.85 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:39,  6.08it/s, est. speed input: 6882.25 toks/s, output: 6.72 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:03<00:39,  6.04it/s, est. speed input: 6791.94 toks/s, output: 6.63 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:38,  6.01it/s, est. speed input: 6721.20 toks/s, output: 6.56 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:38,  5.96it/s, est. speed input: 6655.30 toks/s, output: 6.50 toks/s]
Processed prompts:  10%|█         | 26/256 [00:04<00:38,  5.96it/s, est. speed input: 6608.10 toks/s, output: 6.45 toks/s]
Processed prompts:  11%|█         | 28/256 [00:04<00:38,  5.95it/s, est. speed input: 6566.19 toks/s, output: 6.41 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:04<00:38,  5.90it/s, est. speed input: 6519.82 toks/s, output: 6.37 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:05<00:37,  5.90it/s, est. speed input: 6488.25 toks/s, output: 6.34 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:05<00:37,  5.91it/s, est. speed input: 6461.17 toks/s, output: 6.31 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:05<00:37,  5.88it/s, est. speed input: 6431.35 toks/s, output: 6.28 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:06<00:37,  5.89it/s, est. speed input: 6410.18 toks/s, output: 6.26 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:06<00:36,  5.91it/s, est. speed input: 6393.26 toks/s, output: 6.24 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:06<00:36,  5.88it/s, est. speed input: 6371.76 toks/s, output: 6.22 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:07<00:35,  5.90it/s, est. speed input: 6358.14 toks/s, output: 6.21 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:07<00:35,  5.90it/s, est. speed input: 6343.82 toks/s, output: 6.20 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:07<00:35,  5.87it/s, est. speed input: 6325.63 toks/s, output: 6.18 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:08<00:34,  5.89it/s, est. speed input: 6315.32 toks/s, output: 6.17 toks/s]
Processed prompts:  20%|██        | 52/256 [00:08<00:34,  5.91it/s, est. speed input: 6306.55 toks/s, output: 6.16 toks/s]
Processed prompts:  21%|██        | 54/256 [00:08<00:34,  5.89it/s, est. speed input: 6293.97 toks/s, output: 6.15 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:09<00:33,  5.91it/s, est. speed input: 6287.01 toks/s, output: 6.14 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:09<00:33,  5.90it/s, est. speed input: 6277.50 toks/s, output: 6.13 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:09<00:33,  5.89it/s, est. speed input: 6268.55 toks/s, output: 6.12 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:10<00:32,  5.90it/s, est. speed input: 6261.88 toks/s, output: 6.12 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:10<00:32,  5.90it/s, est. speed input: 6254.53 toks/s, output: 6.11 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:10<00:32,  5.88it/s, est. speed input: 6245.63 toks/s, output: 6.10 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:11<00:31,  5.89it/s, est. speed input: 6240.22 toks/s, output: 6.09 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:11<00:31,  5.91it/s, est. speed input: 6236.13 toks/s, output: 6.09 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:11<00:31,  5.90it/s, est. speed input: 6230.07 toks/s, output: 6.08 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:12<00:30,  5.88it/s, est. speed input: 6222.84 toks/s, output: 6.08 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:12<00:30,  5.89it/s, est. speed input: 6217.93 toks/s, output: 6.07 toks/s]
Processed prompts:  30%|███       | 78/256 [00:12<00:30,  5.89it/s, est. speed input: 6213.14 toks/s, output: 6.07 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:13<00:29,  5.87it/s, est. speed input: 6206.90 toks/s, output: 6.06 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:13<00:29,  5.88it/s, est. speed input: 6202.50 toks/s, output: 6.06 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:13<00:29,  5.89it/s, est. speed input: 6199.00 toks/s, output: 6.05 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:14<00:28,  5.87it/s, est. speed input: 6193.17 toks/s, output: 6.05 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:14<00:28,  5.88it/s, est. speed input: 6190.14 toks/s, output: 6.05 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:14<00:28,  5.90it/s, est. speed input: 6187.93 toks/s, output: 6.04 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:15<00:27,  5.87it/s, est. speed input: 6182.05 toks/s, output: 6.04 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:15<00:27,  5.88it/s, est. speed input: 6179.03 toks/s, output: 6.03 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:15<00:27,  5.89it/s, est. speed input: 6176.32 toks/s, output: 6.03 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:16<00:26,  5.86it/s, est. speed input: 6170.94 toks/s, output: 6.03 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:16<00:26,  5.86it/s, est. speed input: 6167.34 toks/s, output: 6.02 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:16<00:26,  5.87it/s, est. speed input: 6165.10 toks/s, output: 6.02 toks/s]
Processed prompts:  41%|████      | 104/256 [00:17<00:25,  5.86it/s, est. speed input: 6161.23 toks/s, output: 6.02 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:17<00:25,  5.88it/s, est. speed input: 6159.33 toks/s, output: 6.01 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:17<00:25,  5.89it/s, est. speed input: 6157.37 toks/s, output: 6.01 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:18<00:24,  5.86it/s, est. speed input: 6153.28 toks/s, output: 6.01 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:18<00:24,  5.88it/s, est. speed input: 6151.54 toks/s, output: 6.01 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:18<00:24,  5.89it/s, est. speed input: 6149.70 toks/s, output: 6.01 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:19<00:23,  5.86it/s, est. speed input: 6146.08 toks/s, output: 6.00 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:19<00:23,  5.88it/s, est. speed input: 6144.50 toks/s, output: 6.00 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:20<00:23,  5.88it/s, est. speed input: 6142.27 toks/s, output: 6.00 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:20<00:22,  5.87it/s, est. speed input: 6139.62 toks/s, output: 6.00 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:20<00:22,  5.87it/s, est. speed input: 6137.58 toks/s, output: 5.99 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:21<00:22,  5.88it/s, est. speed input: 6136.13 toks/s, output: 5.99 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:21<00:21,  5.88it/s, est. speed input: 6134.49 toks/s, output: 5.99 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:21<00:21,  5.89it/s, est. speed input: 6132.96 toks/s, output: 5.99 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:22<00:21,  5.89it/s, est. speed input: 6131.49 toks/s, output: 5.99 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:22<00:20,  5.90it/s, est. speed input: 6130.70 toks/s, output: 5.99 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:22<00:20,  5.88it/s, est. speed input: 6128.03 toks/s, output: 5.98 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:23<00:20,  5.88it/s, est. speed input: 6126.38 toks/s, output: 5.98 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:23<00:19,  5.90it/s, est. speed input: 6126.08 toks/s, output: 5.98 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:23<00:19,  5.88it/s, est. speed input: 6123.91 toks/s, output: 5.98 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:24<00:19,  5.89it/s, est. speed input: 6122.90 toks/s, output: 5.98 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:24<00:18,  5.89it/s, est. speed input: 6121.43 toks/s, output: 5.98 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:24<00:18,  5.88it/s, est. speed input: 6119.74 toks/s, output: 5.98 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:25<00:18,  5.87it/s, est. speed input: 6118.12 toks/s, output: 5.97 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:25<00:17,  5.88it/s, est. speed input: 6117.19 toks/s, output: 5.97 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:25<00:17,  5.86it/s, est. speed input: 6114.95 toks/s, output: 5.97 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:26<00:17,  5.86it/s, est. speed input: 6113.57 toks/s, output: 5.97 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:26<00:16,  5.87it/s, est. speed input: 6112.38 toks/s, output: 5.97 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:26<00:16,  5.86it/s, est. speed input: 6110.80 toks/s, output: 5.97 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:27<00:16,  5.87it/s, est. speed input: 6109.75 toks/s, output: 5.97 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:27<00:15,  5.87it/s, est. speed input: 6108.74 toks/s, output: 5.97 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:27<00:15,  5.86it/s, est. speed input: 6106.91 toks/s, output: 5.96 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:28<00:15,  5.85it/s, est. speed input: 6105.39 toks/s, output: 5.96 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:28<00:14,  5.87it/s, est. speed input: 6104.64 toks/s, output: 5.96 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:28<00:14,  5.85it/s, est. speed input: 6102.73 toks/s, output: 5.96 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:29<00:13,  5.86it/s, est. speed input: 6101.84 toks/s, output: 5.96 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:29<00:13,  5.89it/s, est. speed input: 6101.83 toks/s, output: 5.96 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:29<00:13,  5.87it/s, est. speed input: 6100.21 toks/s, output: 5.96 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:30<00:12,  5.88it/s, est. speed input: 6099.69 toks/s, output: 5.96 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:30<00:12,  5.90it/s, est. speed input: 6099.67 toks/s, output: 5.96 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:30<00:12,  5.88it/s, est. speed input: 6098.31 toks/s, output: 5.96 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:31<00:11,  5.88it/s, est. speed input: 6097.39 toks/s, output: 5.95 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:31<00:11,  5.89it/s, est. speed input: 6097.04 toks/s, output: 5.95 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:31<00:11,  5.87it/s, est. speed input: 6095.62 toks/s, output: 5.95 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:32<00:10,  5.88it/s, est. speed input: 6095.10 toks/s, output: 5.95 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:32<00:10,  5.88it/s, est. speed input: 6094.19 toks/s, output: 5.95 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:32<00:10,  5.87it/s, est. speed input: 6092.99 toks/s, output: 5.95 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:33<00:09,  5.85it/s, est. speed input: 6091.38 toks/s, output: 5.95 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:33<00:09,  5.87it/s, est. speed input: 6091.16 toks/s, output: 5.95 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:33<00:08,  6.66it/s, est. speed input: 6114.68 toks/s, output: 5.97 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:34<00:08,  6.39it/s, est. speed input: 6113.14 toks/s, output: 5.97 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:34<00:08,  6.22it/s, est. speed input: 6112.18 toks/s, output: 5.97 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:34<00:07,  6.13it/s, est. speed input: 6111.64 toks/s, output: 5.97 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:35<00:07,  6.01it/s, est. speed input: 6109.55 toks/s, output: 5.97 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:35<00:07,  5.98it/s, est. speed input: 6108.90 toks/s, output: 5.97 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:35<00:07,  5.96it/s, est. speed input: 6108.58 toks/s, output: 5.97 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:36<00:06,  5.91it/s, est. speed input: 6106.83 toks/s, output: 5.96 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:36<00:06,  5.91it/s, est. speed input: 6106.28 toks/s, output: 5.96 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:36<00:06,  5.91it/s, est. speed input: 6105.96 toks/s, output: 5.96 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:37<00:05,  5.88it/s, est. speed input: 6104.53 toks/s, output: 5.96 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:37<00:05,  5.91it/s, est. speed input: 6104.58 toks/s, output: 5.96 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:37<00:05,  5.91it/s, est. speed input: 6104.09 toks/s, output: 5.96 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:38<00:04,  5.89it/s, est. speed input: 6102.91 toks/s, output: 5.96 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:38<00:04,  5.89it/s, est. speed input: 6102.35 toks/s, output: 5.96 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:38<00:04,  5.90it/s, est. speed input: 6101.95 toks/s, output: 5.96 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:39<00:03,  5.88it/s, est. speed input: 6100.90 toks/s, output: 5.96 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:39<00:03,  5.87it/s, est. speed input: 6099.90 toks/s, output: 5.96 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:39<00:03,  5.89it/s, est. speed input: 6099.71 toks/s, output: 5.96 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:40<00:02,  5.91it/s, est. speed input: 6099.68 toks/s, output: 5.96 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:40<00:02,  5.88it/s, est. speed input: 6098.49 toks/s, output: 5.96 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:40<00:02,  5.89it/s, est. speed input: 6098.16 toks/s, output: 5.96 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:41<00:01,  5.89it/s, est. speed input: 6097.45 toks/s, output: 5.95 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:41<00:01,  5.85it/s, est. speed input: 6095.88 toks/s, output: 5.95 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:41<00:01,  5.86it/s, est. speed input: 6095.40 toks/s, output: 5.95 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:42<00:00,  5.88it/s, est. speed input: 6095.13 toks/s, output: 5.95 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:42<00:00,  5.85it/s, est. speed input: 6093.69 toks/s, output: 5.95 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:42<00:00,  6.89it/s, est. speed input: 6117.37 toks/s, output: 5.97 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:42<00:00,  6.89it/s, est. speed input: 6117.37 toks/s, output: 5.97 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:42<00:00,  5.97it/s, est. speed input: 6117.37 toks/s, output: 5.97 toks/s]
[rank0]:[W126 16:34:35.966481665 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 133.5s

测试结果:
  Requests/s:   5.89
  Tokens/s:     6032.60
  Total Reqs:   256
  Elapsed:      43.50s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     6026.71

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:34:45 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:34:46 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1501943) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1501943) WARNING 01-26 16:36:07 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.78 requests/s, 5926.08 total tokens/s, 5.78 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 16:34:45] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:34:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:34:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:34:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:34:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:34:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:34:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:34:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:34:49] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:34:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:34:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:34:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:34:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:34:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:34:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:34:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:34:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1501943) [2026-01-26 16:34:50] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1501943) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1501943) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.68s/it]
(EngineCore_DP0 pid=1501943) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 34.21s/it]
(EngineCore_DP0 pid=1501943) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 33.38s/it]
(EngineCore_DP0 pid=1501943) 
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1501943) [2026-01-26 16:35:58] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1501943) 2026-01-26 16:36:06,431 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1501943) 2026-01-26 16:36:06,516 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   9%|▊         | 44/512 [00:00<00:01, 432.08it/s]
Adding requests:  17%|█▋        | 88/512 [00:00<00:01, 408.47it/s]
Adding requests:  26%|██▌       | 131/512 [00:00<00:00, 417.00it/s]
Adding requests:  34%|███▍      | 176/512 [00:00<00:00, 426.70it/s]
Adding requests:  44%|████▎     | 223/512 [00:00<00:00, 439.46it/s]
Adding requests:  52%|█████▏    | 268/512 [00:00<00:00, 435.49it/s]
Adding requests:  61%|██████    | 313/512 [00:00<00:00, 437.29it/s]
Adding requests:  70%|██████▉   | 357/512 [00:00<00:00, 436.44it/s]
Adding requests:  79%|███████▊  | 402/512 [00:00<00:00, 439.01it/s]
Adding requests:  87%|████████▋ | 446/512 [00:01<00:00, 438.36it/s]
Adding requests:  96%|█████████▌| 491/512 [00:01<00:00, 440.25it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 435.30it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:40, 12.49it/s, est. speed input: 12790.31 toks/s, output: 12.49 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:01<01:02,  8.06it/s, est. speed input: 8821.10 toks/s, output: 8.61 toks/s] 
Processed prompts:   3%|▎         | 14/512 [00:01<01:11,  6.92it/s, est. speed input: 7722.99 toks/s, output: 7.54 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:02<01:16,  6.46it/s, est. speed input: 7240.43 toks/s, output: 7.07 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:03<01:18,  6.21it/s, est. speed input: 6956.68 toks/s, output: 6.79 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:20,  6.06it/s, est. speed input: 6772.51 toks/s, output: 6.61 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:20,  5.97it/s, est. speed input: 6646.57 toks/s, output: 6.49 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:05<01:20,  5.93it/s, est. speed input: 6559.87 toks/s, output: 6.41 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:05<01:20,  5.89it/s, est. speed input: 6488.52 toks/s, output: 6.34 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:20,  5.85it/s, est. speed input: 6427.41 toks/s, output: 6.28 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:07<01:19,  5.86it/s, est. speed input: 6389.82 toks/s, output: 6.24 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:08<01:19,  5.83it/s, est. speed input: 6348.34 toks/s, output: 6.20 toks/s]
Processed prompts:  11%|█         | 54/512 [00:08<01:18,  5.83it/s, est. speed input: 6318.80 toks/s, output: 6.17 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:09<01:17,  5.83it/s, est. speed input: 6294.23 toks/s, output: 6.15 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:10<01:17,  5.81it/s, est. speed input: 6265.72 toks/s, output: 6.12 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:10<01:17,  5.79it/s, est. speed input: 6241.78 toks/s, output: 6.10 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:11<01:16,  5.81it/s, est. speed input: 6227.58 toks/s, output: 6.08 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:12<01:15,  5.82it/s, est. speed input: 6212.97 toks/s, output: 6.07 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:12<01:14,  5.83it/s, est. speed input: 6201.46 toks/s, output: 6.06 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:13<01:14,  5.80it/s, est. speed input: 6185.03 toks/s, output: 6.04 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:14<01:13,  5.78it/s, est. speed input: 6170.20 toks/s, output: 6.03 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:14<01:12,  5.79it/s, est. speed input: 6160.05 toks/s, output: 6.02 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:15<01:12,  5.77it/s, est. speed input: 6146.98 toks/s, output: 6.00 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:16<01:11,  5.77it/s, est. speed input: 6136.19 toks/s, output: 5.99 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:17<01:10,  5.78it/s, est. speed input: 6128.28 toks/s, output: 5.98 toks/s]
Processed prompts:  21%|██        | 106/512 [00:17<01:10,  5.77it/s, est. speed input: 6119.26 toks/s, output: 5.98 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:18<01:09,  5.78it/s, est. speed input: 6111.87 toks/s, output: 5.97 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:19<01:08,  5.79it/s, est. speed input: 6106.53 toks/s, output: 5.96 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:19<01:08,  5.78it/s, est. speed input: 6098.96 toks/s, output: 5.96 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:20<01:07,  5.77it/s, est. speed input: 6092.10 toks/s, output: 5.95 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:21<01:06,  5.79it/s, est. speed input: 6087.80 toks/s, output: 5.95 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:21<01:06,  5.78it/s, est. speed input: 6081.64 toks/s, output: 5.94 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:22<01:05,  5.78it/s, est. speed input: 6076.41 toks/s, output: 5.93 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:23<01:04,  5.79it/s, est. speed input: 6072.80 toks/s, output: 5.93 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:23<01:03,  5.79it/s, est. speed input: 6068.51 toks/s, output: 5.93 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:24<01:03,  5.77it/s, est. speed input: 6062.94 toks/s, output: 5.92 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:25<01:02,  5.78it/s, est. speed input: 6059.85 toks/s, output: 5.92 toks/s]
Processed prompts:  30%|███       | 154/512 [00:26<01:02,  5.77it/s, est. speed input: 6055.06 toks/s, output: 5.91 toks/s]
Processed prompts:  31%|███       | 158/512 [00:26<01:01,  5.76it/s, est. speed input: 6050.49 toks/s, output: 5.91 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:27<01:00,  5.78it/s, est. speed input: 6048.40 toks/s, output: 5.91 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:28<01:00,  5.76it/s, est. speed input: 6043.56 toks/s, output: 5.90 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:28<00:59,  5.76it/s, est. speed input: 6040.31 toks/s, output: 5.90 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:29<00:58,  5.77it/s, est. speed input: 6037.72 toks/s, output: 5.90 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:30<00:57,  5.77it/s, est. speed input: 6034.40 toks/s, output: 5.89 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:30<00:57,  5.77it/s, est. speed input: 6031.68 toks/s, output: 5.89 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:31<00:57,  5.67it/s, est. speed input: 6020.92 toks/s, output: 5.88 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:32<00:56,  5.68it/s, est. speed input: 6017.58 toks/s, output: 5.88 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:33<00:55,  5.70it/s, est. speed input: 6014.86 toks/s, output: 5.87 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:33<00:54,  5.73it/s, est. speed input: 6013.39 toks/s, output: 5.87 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:34<00:51,  6.03it/s, est. speed input: 6030.58 toks/s, output: 5.89 toks/s]
Processed prompts:  40%|████      | 206/512 [00:34<00:51,  5.97it/s, est. speed input: 6029.31 toks/s, output: 5.89 toks/s]
Processed prompts:  41%|████      | 210/512 [00:35<00:51,  5.91it/s, est. speed input: 6027.01 toks/s, output: 5.89 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:36<00:50,  5.87it/s, est. speed input: 6024.82 toks/s, output: 5.88 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:37<00:50,  5.85it/s, est. speed input: 6023.30 toks/s, output: 5.88 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:37<00:49,  5.81it/s, est. speed input: 6020.33 toks/s, output: 5.88 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:38<00:49,  5.79it/s, est. speed input: 6017.99 toks/s, output: 5.88 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:39<00:48,  5.81it/s, est. speed input: 6017.25 toks/s, output: 5.88 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:39<00:48,  5.78it/s, est. speed input: 6014.38 toks/s, output: 5.87 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:40<00:47,  5.78it/s, est. speed input: 6012.59 toks/s, output: 5.87 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:41<00:46,  5.78it/s, est. speed input: 6011.00 toks/s, output: 5.87 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:41<00:46,  5.76it/s, est. speed input: 6008.27 toks/s, output: 5.87 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:42<00:45,  5.75it/s, est. speed input: 6005.74 toks/s, output: 5.86 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:43<00:44,  5.77it/s, est. speed input: 6004.97 toks/s, output: 5.86 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:44<00:44,  5.77it/s, est. speed input: 6003.69 toks/s, output: 5.86 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:44<00:43,  5.77it/s, est. speed input: 6001.90 toks/s, output: 5.86 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:45<00:42,  5.78it/s, est. speed input: 6000.95 toks/s, output: 5.86 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:46<00:41,  5.77it/s, est. speed input: 5999.21 toks/s, output: 5.86 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:46<00:41,  5.77it/s, est. speed input: 5997.88 toks/s, output: 5.86 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:47<00:40,  5.77it/s, est. speed input: 5996.88 toks/s, output: 5.86 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:48<00:39,  5.77it/s, est. speed input: 5995.44 toks/s, output: 5.85 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:48<00:39,  5.76it/s, est. speed input: 5993.81 toks/s, output: 5.85 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:49<00:38,  5.76it/s, est. speed input: 5992.22 toks/s, output: 5.85 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:50<00:37,  5.76it/s, est. speed input: 5991.00 toks/s, output: 5.85 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:50<00:37,  5.77it/s, est. speed input: 5990.25 toks/s, output: 5.85 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:51<00:36,  5.76it/s, est. speed input: 5988.86 toks/s, output: 5.85 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:52<00:33,  6.11it/s, est. speed input: 6002.60 toks/s, output: 5.86 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:52<00:33,  6.01it/s, est. speed input: 6001.70 toks/s, output: 5.86 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:53<00:33,  5.93it/s, est. speed input: 6000.11 toks/s, output: 5.86 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:54<00:33,  5.87it/s, est. speed input: 5998.63 toks/s, output: 5.86 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:54<00:32,  5.84it/s, est. speed input: 5997.51 toks/s, output: 5.86 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:55<00:32,  5.80it/s, est. speed input: 5995.73 toks/s, output: 5.86 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:56<00:31,  5.79it/s, est. speed input: 5994.42 toks/s, output: 5.85 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:57<00:30,  5.79it/s, est. speed input: 5993.79 toks/s, output: 5.85 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:57<00:30,  5.78it/s, est. speed input: 5992.65 toks/s, output: 5.85 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:58<00:29,  5.78it/s, est. speed input: 5991.62 toks/s, output: 5.85 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:59<00:28,  5.78it/s, est. speed input: 5990.94 toks/s, output: 5.85 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:59<00:28,  5.78it/s, est. speed input: 5989.88 toks/s, output: 5.85 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [01:00<00:27,  5.78it/s, est. speed input: 5989.04 toks/s, output: 5.85 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [01:01<00:26,  5.80it/s, est. speed input: 5989.14 toks/s, output: 5.85 toks/s]
Processed prompts:  71%|███████   | 362/512 [01:01<00:25,  5.78it/s, est. speed input: 5987.83 toks/s, output: 5.85 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [01:02<00:25,  5.76it/s, est. speed input: 5986.31 toks/s, output: 5.85 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [01:03<00:24,  5.76it/s, est. speed input: 5985.48 toks/s, output: 5.85 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [01:03<00:23,  5.76it/s, est. speed input: 5984.49 toks/s, output: 5.84 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [01:04<00:23,  5.78it/s, est. speed input: 5984.20 toks/s, output: 5.84 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:05<00:22,  5.77it/s, est. speed input: 5983.17 toks/s, output: 5.84 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:06<00:21,  5.77it/s, est. speed input: 5982.37 toks/s, output: 5.84 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:06<00:21,  5.76it/s, est. speed input: 5981.35 toks/s, output: 5.84 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:07<00:20,  5.76it/s, est. speed input: 5980.44 toks/s, output: 5.84 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:08<00:19,  5.75it/s, est. speed input: 5979.27 toks/s, output: 5.84 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:08<00:19,  5.75it/s, est. speed input: 5978.39 toks/s, output: 5.84 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:09<00:18,  5.74it/s, est. speed input: 5977.10 toks/s, output: 5.84 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:10<00:17,  5.74it/s, est. speed input: 5976.00 toks/s, output: 5.84 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:10<00:17,  5.74it/s, est. speed input: 5975.11 toks/s, output: 5.84 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:11<00:16,  5.73it/s, est. speed input: 5973.89 toks/s, output: 5.83 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:12<00:15,  5.72it/s, est. speed input: 5972.66 toks/s, output: 5.83 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:13<00:14,  5.75it/s, est. speed input: 5972.32 toks/s, output: 5.83 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:13<00:14,  5.74it/s, est. speed input: 5971.31 toks/s, output: 5.83 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:14<00:12,  6.09it/s, est. speed input: 5981.01 toks/s, output: 5.84 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:14<00:12,  5.98it/s, est. speed input: 5980.21 toks/s, output: 5.84 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:15<00:11,  5.89it/s, est. speed input: 5978.85 toks/s, output: 5.84 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:16<00:11,  5.84it/s, est. speed input: 5977.80 toks/s, output: 5.84 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:17<00:10,  5.83it/s, est. speed input: 5977.39 toks/s, output: 5.84 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:17<00:10,  5.80it/s, est. speed input: 5976.43 toks/s, output: 5.84 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:18<00:09,  5.77it/s, est. speed input: 5975.23 toks/s, output: 5.84 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:19<00:08,  5.78it/s, est. speed input: 5975.04 toks/s, output: 5.83 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:19<00:07,  5.76it/s, est. speed input: 5973.75 toks/s, output: 5.83 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:20<00:07,  5.75it/s, est. speed input: 5972.97 toks/s, output: 5.83 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:21<00:06,  5.77it/s, est. speed input: 5972.65 toks/s, output: 5.83 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:21<00:05,  5.76it/s, est. speed input: 5972.01 toks/s, output: 5.83 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:22<00:05,  5.77it/s, est. speed input: 5971.47 toks/s, output: 5.83 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:23<00:04,  5.76it/s, est. speed input: 5970.64 toks/s, output: 5.83 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:24<00:03,  5.74it/s, est. speed input: 5969.55 toks/s, output: 5.83 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:24<00:03,  5.75it/s, est. speed input: 5969.09 toks/s, output: 5.83 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:25<00:02,  5.74it/s, est. speed input: 5968.19 toks/s, output: 5.83 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:26<00:01,  5.74it/s, est. speed input: 5967.45 toks/s, output: 5.83 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:26<00:01,  5.75it/s, est. speed input: 5967.04 toks/s, output: 5.83 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:27<00:00,  6.15it/s, est. speed input: 5976.63 toks/s, output: 5.84 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:27<00:00,  6.15it/s, est. speed input: 6000.06 toks/s, output: 5.86 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:27<00:00,  5.86it/s, est. speed input: 6000.06 toks/s, output: 5.86 toks/s]
[rank0]:[W126 16:37:36.958319200 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 180.4s

测试结果:
  Requests/s:   5.78
  Tokens/s:     5926.08
  Total Reqs:   512
  Elapsed:      88.56s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     5920.30

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:37:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:37:48 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1504638) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1504638) WARNING 01-26 16:39:10 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.61 requests/s, 5748.82 total tokens/s, 5.61 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 16:37:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:37:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:37:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:37:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:37:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:37:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:37:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:37:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:37:51] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:37:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:37:51] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:37:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:37:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:37:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:37:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:37:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:37:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1504638) [2026-01-26 16:37:52] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1504638) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1504638) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.31s/it]
(EngineCore_DP0 pid=1504638) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 33.64s/it]
(EngineCore_DP0 pid=1504638) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 32.84s/it]
(EngineCore_DP0 pid=1504638) 
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1504638) [2026-01-26 16:38:59] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1504638) 2026-01-26 16:39:08,121 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1504638) 2026-01-26 16:39:08,687 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 34/1024 [00:00<00:02, 333.50it/s]
Adding requests:   7%|▋         | 72/1024 [00:00<00:02, 355.60it/s]
Adding requests:  12%|█▏        | 119/1024 [00:00<00:02, 404.69it/s]
Adding requests:  16%|█▌        | 162/1024 [00:00<00:02, 412.06it/s]
Adding requests:  20%|██        | 208/1024 [00:00<00:01, 428.99it/s]
Adding requests:  25%|██▍       | 252/1024 [00:00<00:01, 432.63it/s]
Adding requests:  29%|██▉       | 299/1024 [00:00<00:01, 442.02it/s]
Adding requests:  34%|███▎      | 344/1024 [00:00<00:01, 435.03it/s]
Adding requests:  38%|███▊      | 389/1024 [00:00<00:01, 437.33it/s]
Adding requests:  42%|████▏     | 435/1024 [00:01<00:01, 441.04it/s]
Adding requests:  47%|████▋     | 482/1024 [00:01<00:01, 447.42it/s]
Adding requests:  52%|█████▏    | 534/1024 [00:01<00:01, 462.32it/s]
Adding requests:  57%|█████▋    | 581/1024 [00:01<00:00, 450.69it/s]
Adding requests:  61%|██████▏   | 628/1024 [00:01<00:00, 453.34it/s]
Adding requests:  66%|██████▌   | 674/1024 [00:01<00:00, 444.84it/s]
Adding requests:  70%|███████   | 720/1024 [00:01<00:00, 447.91it/s]
Adding requests:  75%|███████▍  | 765/1024 [00:01<00:00, 439.31it/s]
Adding requests:  79%|███████▉  | 811/1024 [00:01<00:00, 442.69it/s]
Adding requests:  84%|████████▍ | 858/1024 [00:01<00:00, 449.81it/s]
Adding requests:  89%|████████▊ | 907/1024 [00:02<00:00, 457.18it/s]
Adding requests:  93%|█████████▎| 953/1024 [00:02<00:00, 446.55it/s]
Adding requests:  97%|█████████▋| 998/1024 [00:02<00:00, 447.06it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 439.36it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<01:22, 12.23it/s, est. speed input: 12525.52 toks/s, output: 12.23 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:02<02:14,  7.47it/s, est. speed input: 8183.15 toks/s, output: 7.99 toks/s]  
Processed prompts:   3%|▎         | 26/1024 [00:03<02:32,  6.54it/s, est. speed input: 7241.41 toks/s, output: 7.07 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:05<02:40,  6.17it/s, est. speed input: 6835.36 toks/s, output: 6.68 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:06<02:45,  5.95it/s, est. speed input: 6591.93 toks/s, output: 6.44 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:07<02:46,  5.84it/s, est. speed input: 6446.17 toks/s, output: 6.30 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:09<02:47,  5.77it/s, est. speed input: 6340.21 toks/s, output: 6.19 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:10<02:47,  5.70it/s, est. speed input: 6255.64 toks/s, output: 6.11 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:12<02:47,  5.68it/s, est. speed input: 6200.33 toks/s, output: 6.05 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:13<02:46,  5.67it/s, est. speed input: 6154.53 toks/s, output: 6.01 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:15<02:45,  5.65it/s, est. speed input: 6117.64 toks/s, output: 5.97 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:16<02:43,  5.65it/s, est. speed input: 6089.27 toks/s, output: 5.95 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:17<02:42,  5.64it/s, est. speed input: 6060.37 toks/s, output: 5.92 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:19<02:41,  5.62it/s, est. speed input: 6036.35 toks/s, output: 5.89 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:20<02:40,  5.62it/s, est. speed input: 6016.27 toks/s, output: 5.88 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:22<02:39,  5.62it/s, est. speed input: 5998.94 toks/s, output: 5.86 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:23<02:38,  5.60it/s, est. speed input: 5981.31 toks/s, output: 5.84 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:25<02:36,  5.61it/s, est. speed input: 5967.99 toks/s, output: 5.83 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:26<02:35,  5.60it/s, est. speed input: 5954.62 toks/s, output: 5.82 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:27<02:33,  5.61it/s, est. speed input: 5944.25 toks/s, output: 5.80 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:29<02:32,  5.61it/s, est. speed input: 5935.81 toks/s, output: 5.80 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:30<02:31,  5.60it/s, est. speed input: 5924.82 toks/s, output: 5.79 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:32<02:30,  5.59it/s, est. speed input: 5914.14 toks/s, output: 5.78 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:33<02:28,  5.60it/s, est. speed input: 5908.17 toks/s, output: 5.77 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:34<02:22,  5.79it/s, est. speed input: 5926.77 toks/s, output: 5.79 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:36<02:21,  5.74it/s, est. speed input: 5920.48 toks/s, output: 5.78 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:37<02:21,  5.70it/s, est. speed input: 5914.04 toks/s, output: 5.78 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:39<02:20,  5.67it/s, est. speed input: 5907.19 toks/s, output: 5.77 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:40<02:19,  5.65it/s, est. speed input: 5901.53 toks/s, output: 5.76 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:42<02:18,  5.64it/s, est. speed input: 5896.21 toks/s, output: 5.76 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:43<02:17,  5.62it/s, est. speed input: 5890.58 toks/s, output: 5.75 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:44<02:16,  5.62it/s, est. speed input: 5885.66 toks/s, output: 5.75 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:46<02:15,  5.61it/s, est. speed input: 5881.17 toks/s, output: 5.74 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:47<02:13,  5.61it/s, est. speed input: 5876.71 toks/s, output: 5.74 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:49<02:12,  5.61it/s, est. speed input: 5873.34 toks/s, output: 5.74 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:50<02:10,  5.61it/s, est. speed input: 5869.93 toks/s, output: 5.73 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:52<02:09,  5.61it/s, est. speed input: 5865.97 toks/s, output: 5.73 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:53<02:03,  5.79it/s, est. speed input: 5879.16 toks/s, output: 5.74 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:54<02:03,  5.74it/s, est. speed input: 5876.29 toks/s, output: 5.74 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:56<02:02,  5.71it/s, est. speed input: 5873.74 toks/s, output: 5.74 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:57<02:02,  5.68it/s, est. speed input: 5870.21 toks/s, output: 5.73 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:58<02:01,  5.65it/s, est. speed input: 5866.43 toks/s, output: 5.73 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [01:00<02:00,  5.64it/s, est. speed input: 5864.09 toks/s, output: 5.73 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [01:01<01:58,  5.63it/s, est. speed input: 5861.28 toks/s, output: 5.72 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [01:03<01:57,  5.62it/s, est. speed input: 5858.20 toks/s, output: 5.72 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [01:04<01:56,  5.61it/s, est. speed input: 5855.02 toks/s, output: 5.72 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [01:06<01:55,  5.61it/s, est. speed input: 5852.71 toks/s, output: 5.72 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:07<01:53,  5.61it/s, est. speed input: 5850.13 toks/s, output: 5.71 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:09<01:52,  5.60it/s, est. speed input: 5847.10 toks/s, output: 5.71 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:10<01:51,  5.60it/s, est. speed input: 5844.75 toks/s, output: 5.71 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:11<01:49,  5.59it/s, est. speed input: 5842.02 toks/s, output: 5.71 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:13<01:48,  5.59it/s, est. speed input: 5839.86 toks/s, output: 5.70 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:14<01:46,  5.60it/s, est. speed input: 5837.98 toks/s, output: 5.70 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:15<01:41,  5.80it/s, est. speed input: 5848.57 toks/s, output: 5.71 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:17<01:41,  5.73it/s, est. speed input: 5845.91 toks/s, output: 5.71 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:18<01:40,  5.70it/s, est. speed input: 5844.38 toks/s, output: 5.71 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:20<01:39,  5.66it/s, est. speed input: 5842.06 toks/s, output: 5.71 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:21<01:39,  5.62it/s, est. speed input: 5839.06 toks/s, output: 5.70 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:23<01:37,  5.62it/s, est. speed input: 5837.25 toks/s, output: 5.70 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:24<01:36,  5.60it/s, est. speed input: 5835.12 toks/s, output: 5.70 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:26<01:35,  5.61it/s, est. speed input: 5833.90 toks/s, output: 5.70 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:27<01:33,  5.60it/s, est. speed input: 5831.73 toks/s, output: 5.70 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:28<01:32,  5.59it/s, est. speed input: 5829.83 toks/s, output: 5.69 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:30<01:31,  5.59it/s, est. speed input: 5827.96 toks/s, output: 5.69 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:31<01:29,  5.59it/s, est. speed input: 5826.55 toks/s, output: 5.69 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:33<01:28,  5.60it/s, est. speed input: 5825.31 toks/s, output: 5.69 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:34<01:26,  5.59it/s, est. speed input: 5823.35 toks/s, output: 5.69 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:36<01:25,  5.60it/s, est. speed input: 5822.55 toks/s, output: 5.69 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:37<01:23,  5.60it/s, est. speed input: 5821.22 toks/s, output: 5.68 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:38<01:22,  5.59it/s, est. speed input: 5819.64 toks/s, output: 5.68 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:40<01:21,  5.59it/s, est. speed input: 5818.27 toks/s, output: 5.68 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:41<01:19,  5.59it/s, est. speed input: 5816.96 toks/s, output: 5.68 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:43<01:18,  5.59it/s, est. speed input: 5815.81 toks/s, output: 5.68 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:44<01:16,  5.60it/s, est. speed input: 5814.77 toks/s, output: 5.68 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:46<01:15,  5.59it/s, est. speed input: 5813.09 toks/s, output: 5.68 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:47<01:14,  5.58it/s, est. speed input: 5811.42 toks/s, output: 5.68 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:48<01:12,  5.57it/s, est. speed input: 5809.91 toks/s, output: 5.67 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:50<01:11,  5.57it/s, est. speed input: 5808.40 toks/s, output: 5.67 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:51<01:10,  5.57it/s, est. speed input: 5806.91 toks/s, output: 5.67 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:53<01:08,  5.57it/s, est. speed input: 5805.91 toks/s, output: 5.67 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:54<01:07,  5.57it/s, est. speed input: 5804.49 toks/s, output: 5.67 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:56<01:05,  5.56it/s, est. speed input: 5802.97 toks/s, output: 5.67 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:57<01:04,  5.57it/s, est. speed input: 5801.85 toks/s, output: 5.67 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:58<01:02,  5.57it/s, est. speed input: 5800.92 toks/s, output: 5.66 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [02:00<01:01,  5.59it/s, est. speed input: 5800.33 toks/s, output: 5.66 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [02:01<00:59,  5.58it/s, est. speed input: 5799.28 toks/s, output: 5.66 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [02:03<00:58,  5.58it/s, est. speed input: 5798.23 toks/s, output: 5.66 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [02:04<00:56,  5.59it/s, est. speed input: 5797.49 toks/s, output: 5.66 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [02:06<00:55,  5.58it/s, est. speed input: 5796.28 toks/s, output: 5.66 toks/s]
Processed prompts:  71%|███████   | 722/1024 [02:07<00:54,  5.58it/s, est. speed input: 5795.37 toks/s, output: 5.66 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [02:08<00:52,  5.59it/s, est. speed input: 5794.88 toks/s, output: 5.66 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [02:10<00:51,  5.58it/s, est. speed input: 5793.60 toks/s, output: 5.66 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [02:11<00:49,  5.57it/s, est. speed input: 5792.54 toks/s, output: 5.66 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [02:13<00:48,  5.59it/s, est. speed input: 5792.13 toks/s, output: 5.66 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:14<00:47,  5.57it/s, est. speed input: 5790.89 toks/s, output: 5.66 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:16<00:45,  5.57it/s, est. speed input: 5789.94 toks/s, output: 5.65 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:17<00:44,  5.57it/s, est. speed input: 5789.10 toks/s, output: 5.65 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:18<00:41,  5.76it/s, est. speed input: 5794.88 toks/s, output: 5.66 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:20<00:40,  5.72it/s, est. speed input: 5794.53 toks/s, output: 5.66 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:21<00:39,  5.69it/s, est. speed input: 5794.12 toks/s, output: 5.66 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:23<00:37,  5.65it/s, est. speed input: 5792.96 toks/s, output: 5.66 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:24<00:36,  5.63it/s, est. speed input: 5792.41 toks/s, output: 5.66 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:26<00:35,  5.64it/s, est. speed input: 5792.27 toks/s, output: 5.66 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:27<00:33,  5.62it/s, est. speed input: 5791.52 toks/s, output: 5.66 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:28<00:32,  5.60it/s, est. speed input: 5790.41 toks/s, output: 5.65 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:30<00:31,  5.59it/s, est. speed input: 5789.51 toks/s, output: 5.65 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:31<00:29,  5.58it/s, est. speed input: 5788.66 toks/s, output: 5.65 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:33<00:28,  5.59it/s, est. speed input: 5788.26 toks/s, output: 5.65 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:34<00:26,  5.58it/s, est. speed input: 5787.34 toks/s, output: 5.65 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:36<00:25,  5.58it/s, est. speed input: 5786.70 toks/s, output: 5.65 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:37<00:23,  5.59it/s, est. speed input: 5786.43 toks/s, output: 5.65 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:38<00:22,  5.59it/s, est. speed input: 5785.85 toks/s, output: 5.65 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:40<00:21,  5.59it/s, est. speed input: 5785.25 toks/s, output: 5.65 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:41<00:19,  5.58it/s, est. speed input: 5784.51 toks/s, output: 5.65 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:43<00:18,  5.58it/s, est. speed input: 5783.70 toks/s, output: 5.65 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:44<00:16,  5.58it/s, est. speed input: 5783.21 toks/s, output: 5.65 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:46<00:15,  5.58it/s, est. speed input: 5782.68 toks/s, output: 5.65 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:47<00:13,  5.59it/s, est. speed input: 5782.25 toks/s, output: 5.65 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:48<00:12,  5.59it/s, est. speed input: 5781.82 toks/s, output: 5.65 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:50<00:11,  5.59it/s, est. speed input: 5781.44 toks/s, output: 5.65 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:51<00:09,  5.59it/s, est. speed input: 5780.87 toks/s, output: 5.65 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:53<00:08,  5.59it/s, est. speed input: 5780.40 toks/s, output: 5.64 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:54<00:06,  5.59it/s, est. speed input: 5779.90 toks/s, output: 5.64 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:56<00:05,  5.58it/s, est. speed input: 5779.12 toks/s, output: 5.64 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:57<00:03,  5.57it/s, est. speed input: 5778.37 toks/s, output: 5.64 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:58<00:02,  5.58it/s, est. speed input: 5778.00 toks/s, output: 5.64 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [03:00<00:01,  5.81it/s, est. speed input: 5783.48 toks/s, output: 5.65 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [03:00<00:00,  5.81it/s, est. speed input: 5817.56 toks/s, output: 5.68 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [03:00<00:00,  5.68it/s, est. speed input: 5817.56 toks/s, output: 5.68 toks/s]
[rank0]:[W126 16:42:13.917423871 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 277.8s

测试结果:
  Requests/s:   5.61
  Tokens/s:     5748.82
  Total Reqs:   1024
  Elapsed:      182.58s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     5743.21

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 16:42:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 16:42:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1508722) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1508722) WARNING 01-26 16:44:08 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 0.76 requests/s, 779.92 total tokens/s, 0.76 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 16:42:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:42:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:42:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:42:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:42:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:42:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:42:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:42:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 16:42:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 16:42:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:42:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 16:42:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 16:42:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 16:42:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 16:42:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 16:42:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 16:42:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1508722) [2026-01-26 16:42:35] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1508722) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1508722) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.78s/it]
(EngineCore_DP0 pid=1508722) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 34.14s/it]
(EngineCore_DP0 pid=1508722) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 33.33s/it]
(EngineCore_DP0 pid=1508722) 
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1508722) [2026-01-26 16:43:43] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1508722) 2026-01-26 16:43:53,318 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1508722) 2026-01-26 16:43:54,112 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 43/2048 [00:00<00:04, 422.39it/s]
Adding requests:   4%|▍         | 86/2048 [00:00<00:05, 390.99it/s]
Adding requests:   6%|▋         | 131/2048 [00:00<00:04, 413.73it/s]
Adding requests:   9%|▉         | 184/2048 [00:00<00:04, 457.94it/s]
Adding requests:  11%|█▏        | 231/2048 [00:00<00:03, 460.27it/s]
Adding requests:  14%|█▍        | 284/2048 [00:00<00:03, 481.34it/s]
Adding requests:  17%|█▋        | 343/2048 [00:00<00:03, 514.02it/s]
Adding requests:  20%|█▉        | 403/2048 [00:00<00:03, 539.93it/s]
Adding requests:  22%|██▏       | 458/2048 [00:00<00:02, 531.17it/s]
Adding requests:  25%|██▌       | 516/2048 [00:01<00:02, 543.94it/s]
Adding requests:  28%|██▊       | 576/2048 [00:01<00:02, 558.29it/s]
Adding requests:  31%|███       | 632/2048 [00:01<00:02, 552.44it/s]
Adding requests:  34%|███▎      | 688/2048 [00:01<00:02, 551.06it/s]
Adding requests:  36%|███▋      | 744/2048 [00:01<00:02, 546.57it/s]
Adding requests:  39%|███▉      | 799/2048 [00:01<00:02, 545.80it/s]
Adding requests:  42%|████▏     | 854/2048 [00:01<00:02, 522.09it/s]
Adding requests:  44%|████▍     | 910/2048 [00:01<00:02, 530.80it/s]
Adding requests:  47%|████▋     | 964/2048 [00:02<00:02, 381.19it/s]
Adding requests:  49%|████▉     | 1009/2048 [00:02<00:02, 391.53it/s]
Adding requests:  52%|█████▏    | 1064/2048 [00:02<00:02, 429.46it/s]
Adding requests:  55%|█████▍    | 1120/2048 [00:02<00:02, 462.25it/s]
Adding requests:  58%|█████▊    | 1178/2048 [00:02<00:01, 491.99it/s]
Adding requests:  60%|██████    | 1236/2048 [00:02<00:01, 515.95it/s]
Adding requests:  63%|██████▎   | 1291/2048 [00:02<00:01, 523.95it/s]
Adding requests:  66%|██████▌   | 1348/2048 [00:02<00:01, 536.75it/s]
Adding requests:  69%|██████▊   | 1405/2048 [00:02<00:01, 543.41it/s]
Adding requests:  71%|███████▏  | 1463/2048 [00:02<00:01, 550.97it/s]
Adding requests:  74%|███████▍  | 1519/2048 [00:03<00:00, 536.33it/s]
Adding requests:  77%|███████▋  | 1574/2048 [00:03<00:00, 536.80it/s]
Adding requests:  79%|███████▉  | 1628/2048 [00:03<00:00, 537.35it/s]
Adding requests:  82%|████████▏ | 1682/2048 [00:03<00:00, 534.25it/s]
Adding requests:  85%|████████▍ | 1736/2048 [00:03<00:00, 533.48it/s]
Adding requests:  87%|████████▋ | 1790/2048 [00:03<00:00, 528.89it/s]
Adding requests:  90%|█████████ | 1847/2048 [00:03<00:00, 539.11it/s]
Adding requests:  93%|█████████▎| 1904/2048 [00:03<00:00, 546.76it/s]
Adding requests:  96%|█████████▌| 1963/2048 [00:03<00:00, 558.44it/s]
Adding requests:  99%|█████████▊| 2019/2048 [00:03<00:00, 550.27it/s]
Adding requests: 100%|██████████| 2048/2048 [00:03<00:00, 512.49it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   0%|          | 2/2048 [00:15<4:27:46,  7.85s/it, est. speed input: 130.40 toks/s, output: 0.13 toks/s]
Processed prompts:   1%|          | 18/2048 [00:35<1:00:15,  1.78s/it, est. speed input: 516.31 toks/s, output: 0.50 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:55<49:41,  1.48s/it, est. speed input: 624.84 toks/s, output: 0.61 toks/s]  
Processed prompts:   2%|▏         | 50/2048 [01:15<45:50,  1.38s/it, est. speed input: 676.31 toks/s, output: 0.66 toks/s]
Processed prompts:   3%|▎         | 66/2048 [01:35<43:57,  1.33s/it, est. speed input: 705.07 toks/s, output: 0.69 toks/s]
Processed prompts:   4%|▍         | 82/2048 [01:55<42:39,  1.30s/it, est. speed input: 724.74 toks/s, output: 0.71 toks/s]
Processed prompts:   5%|▍         | 98/2048 [02:15<41:47,  1.29s/it, est. speed input: 738.25 toks/s, output: 0.72 toks/s]
Processed prompts:   6%|▌         | 114/2048 [02:35<41:04,  1.27s/it, est. speed input: 748.61 toks/s, output: 0.73 toks/s]
Processed prompts:   6%|▋         | 130/2048 [02:55<40:31,  1.27s/it, est. speed input: 756.43 toks/s, output: 0.74 toks/s]
Processed prompts:   7%|▋         | 146/2048 [03:15<40:01,  1.26s/it, est. speed input: 762.78 toks/s, output: 0.74 toks/s]
Processed prompts:   8%|▊         | 162/2048 [03:36<39:34,  1.26s/it, est. speed input: 767.94 toks/s, output: 0.75 toks/s]
Processed prompts:   9%|▊         | 178/2048 [03:56<39:09,  1.26s/it, est. speed input: 772.22 toks/s, output: 0.75 toks/s]
Processed prompts:   9%|▉         | 194/2048 [04:23<43:19,  1.40s/it, est. speed input: 753.07 toks/s, output: 0.74 toks/s]
Processed prompts:  10%|█         | 210/2048 [04:43<41:32,  1.36s/it, est. speed input: 757.68 toks/s, output: 0.74 toks/s]
Processed prompts:  11%|█         | 226/2048 [05:03<40:13,  1.32s/it, est. speed input: 761.70 toks/s, output: 0.74 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [05:23<39:11,  1.30s/it, est. speed input: 765.21 toks/s, output: 0.75 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [05:43<38:23,  1.29s/it, est. speed input: 768.31 toks/s, output: 0.75 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [06:03<37:43,  1.28s/it, est. speed input: 771.07 toks/s, output: 0.75 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [06:23<37:10,  1.27s/it, est. speed input: 773.53 toks/s, output: 0.76 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [06:51<40:54,  1.41s/it, est. speed input: 761.13 toks/s, output: 0.74 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [07:11<39:10,  1.36s/it, est. speed input: 763.80 toks/s, output: 0.75 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [07:31<37:52,  1.33s/it, est. speed input: 766.17 toks/s, output: 0.75 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [07:51<36:52,  1.31s/it, est. speed input: 768.37 toks/s, output: 0.75 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [08:11<36:03,  1.29s/it, est. speed input: 770.42 toks/s, output: 0.75 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [08:31<35:23,  1.28s/it, est. speed input: 772.29 toks/s, output: 0.75 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [08:51<34:50,  1.27s/it, est. speed input: 774.04 toks/s, output: 0.76 toks/s]
Processed prompts:  20%|██        | 418/2048 [09:11<34:20,  1.26s/it, est. speed input: 775.65 toks/s, output: 0.76 toks/s]
Processed prompts:  21%|██        | 434/2048 [09:39<37:47,  1.40s/it, est. speed input: 766.81 toks/s, output: 0.75 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [09:59<36:11,  1.36s/it, est. speed input: 768.52 toks/s, output: 0.75 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [10:19<34:58,  1.33s/it, est. speed input: 770.13 toks/s, output: 0.75 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [10:39<34:02,  1.30s/it, est. speed input: 771.62 toks/s, output: 0.75 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [10:59<33:17,  1.29s/it, est. speed input: 773.01 toks/s, output: 0.75 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [11:19<32:39,  1.28s/it, est. speed input: 774.34 toks/s, output: 0.76 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [11:39<32:07,  1.27s/it, est. speed input: 775.61 toks/s, output: 0.76 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [11:59<31:38,  1.26s/it, est. speed input: 776.81 toks/s, output: 0.76 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [12:19<31:13,  1.26s/it, est. speed input: 777.88 toks/s, output: 0.76 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [12:39<30:49,  1.26s/it, est. speed input: 778.96 toks/s, output: 0.76 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [12:59<30:26,  1.26s/it, est. speed input: 779.96 toks/s, output: 0.76 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [13:19<30:04,  1.25s/it, est. speed input: 780.93 toks/s, output: 0.76 toks/s]
Processed prompts:  31%|███       | 626/2048 [13:39<29:42,  1.25s/it, est. speed input: 781.84 toks/s, output: 0.76 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [13:59<29:21,  1.25s/it, est. speed input: 782.71 toks/s, output: 0.76 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [14:19<29:01,  1.25s/it, est. speed input: 783.53 toks/s, output: 0.77 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [14:39<28:40,  1.25s/it, est. speed input: 784.32 toks/s, output: 0.77 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [15:00<28:20,  1.25s/it, est. speed input: 785.05 toks/s, output: 0.77 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [15:20<28:00,  1.25s/it, est. speed input: 785.78 toks/s, output: 0.77 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [15:40<27:40,  1.25s/it, est. speed input: 786.46 toks/s, output: 0.77 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [16:00<27:19,  1.25s/it, est. speed input: 787.13 toks/s, output: 0.77 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [16:20<27:00,  1.25s/it, est. speed input: 787.75 toks/s, output: 0.77 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [16:40<26:39,  1.25s/it, est. speed input: 788.38 toks/s, output: 0.77 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [17:07<29:22,  1.40s/it, est. speed input: 783.03 toks/s, output: 0.76 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [17:27<28:05,  1.35s/it, est. speed input: 783.72 toks/s, output: 0.77 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [17:47<27:06,  1.32s/it, est. speed input: 784.35 toks/s, output: 0.77 toks/s]
Processed prompts:  41%|████      | 834/2048 [18:07<26:19,  1.30s/it, est. speed input: 784.98 toks/s, output: 0.77 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [18:27<25:41,  1.29s/it, est. speed input: 785.57 toks/s, output: 0.77 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [18:47<25:07,  1.28s/it, est. speed input: 786.17 toks/s, output: 0.77 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [19:08<24:39,  1.27s/it, est. speed input: 786.72 toks/s, output: 0.77 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [19:28<24:12,  1.26s/it, est. speed input: 787.28 toks/s, output: 0.77 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [19:48<23:47,  1.26s/it, est. speed input: 787.81 toks/s, output: 0.77 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [20:08<23:25,  1.26s/it, est. speed input: 788.31 toks/s, output: 0.77 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [20:28<23:03,  1.26s/it, est. speed input: 788.78 toks/s, output: 0.77 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [20:48<22:42,  1.25s/it, est. speed input: 789.25 toks/s, output: 0.77 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [21:08<22:21,  1.25s/it, est. speed input: 789.71 toks/s, output: 0.77 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [21:28<22:00,  1.25s/it, est. speed input: 790.16 toks/s, output: 0.77 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [21:48<21:39,  1.25s/it, est. speed input: 790.59 toks/s, output: 0.77 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [22:08<21:19,  1.25s/it, est. speed input: 791.02 toks/s, output: 0.77 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [22:28<20:59,  1.25s/it, est. speed input: 791.42 toks/s, output: 0.77 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [22:48<20:38,  1.25s/it, est. speed input: 791.83 toks/s, output: 0.77 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [23:08<20:18,  1.25s/it, est. speed input: 792.22 toks/s, output: 0.77 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [23:28<19:58,  1.25s/it, est. speed input: 792.60 toks/s, output: 0.77 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [23:48<19:38,  1.25s/it, est. speed input: 792.96 toks/s, output: 0.77 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [24:08<19:18,  1.25s/it, est. speed input: 793.31 toks/s, output: 0.77 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [24:28<18:58,  1.25s/it, est. speed input: 793.67 toks/s, output: 0.78 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [24:48<18:38,  1.25s/it, est. speed input: 794.00 toks/s, output: 0.78 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [25:08<18:18,  1.25s/it, est. speed input: 794.31 toks/s, output: 0.78 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [25:28<17:58,  1.25s/it, est. speed input: 794.64 toks/s, output: 0.78 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [25:56<19:40,  1.40s/it, est. speed input: 791.00 toks/s, output: 0.77 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [26:16<18:42,  1.35s/it, est. speed input: 791.35 toks/s, output: 0.77 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [26:43<19:53,  1.47s/it, est. speed input: 787.88 toks/s, output: 0.77 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [27:03<18:38,  1.40s/it, est. speed input: 788.27 toks/s, output: 0.77 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [27:23<17:40,  1.36s/it, est. speed input: 788.64 toks/s, output: 0.77 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [27:43<16:55,  1.33s/it, est. speed input: 788.98 toks/s, output: 0.77 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [28:03<16:17,  1.30s/it, est. speed input: 789.33 toks/s, output: 0.77 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [28:23<15:45,  1.29s/it, est. speed input: 789.67 toks/s, output: 0.77 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [28:51<17:01,  1.42s/it, est. speed input: 786.46 toks/s, output: 0.77 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [29:11<16:02,  1.37s/it, est. speed input: 786.83 toks/s, output: 0.77 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [29:31<15:15,  1.34s/it, est. speed input: 787.18 toks/s, output: 0.77 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [29:51<14:37,  1.31s/it, est. speed input: 787.53 toks/s, output: 0.77 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [30:11<14:05,  1.29s/it, est. speed input: 787.87 toks/s, output: 0.77 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [30:31<13:36,  1.28s/it, est. speed input: 788.21 toks/s, output: 0.77 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [30:51<13:10,  1.27s/it, est. speed input: 788.54 toks/s, output: 0.77 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [31:19<14:14,  1.41s/it, est. speed input: 785.62 toks/s, output: 0.77 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [31:47<14:49,  1.51s/it, est. speed input: 782.79 toks/s, output: 0.76 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [32:07<13:40,  1.43s/it, est. speed input: 783.17 toks/s, output: 0.76 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [32:27<12:47,  1.38s/it, est. speed input: 783.53 toks/s, output: 0.77 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [32:47<12:05,  1.34s/it, est. speed input: 783.88 toks/s, output: 0.77 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [33:15<12:46,  1.46s/it, est. speed input: 781.19 toks/s, output: 0.76 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [33:35<11:51,  1.40s/it, est. speed input: 781.56 toks/s, output: 0.76 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [34:02<12:19,  1.50s/it, est. speed input: 778.97 toks/s, output: 0.76 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [34:22<11:20,  1.42s/it, est. speed input: 779.35 toks/s, output: 0.76 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [34:42<10:33,  1.37s/it, est. speed input: 779.75 toks/s, output: 0.76 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [35:02<09:55,  1.33s/it, est. speed input: 780.12 toks/s, output: 0.76 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [35:30<10:25,  1.45s/it, est. speed input: 777.66 toks/s, output: 0.76 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [35:50<09:36,  1.39s/it, est. speed input: 778.05 toks/s, output: 0.76 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [36:10<08:57,  1.35s/it, est. speed input: 778.42 toks/s, output: 0.76 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [36:30<08:24,  1.32s/it, est. speed input: 778.79 toks/s, output: 0.76 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [36:50<07:55,  1.30s/it, est. speed input: 779.14 toks/s, output: 0.76 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [37:10<07:29,  1.29s/it, est. speed input: 779.49 toks/s, output: 0.76 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [37:30<07:05,  1.27s/it, est. speed input: 779.84 toks/s, output: 0.76 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [37:58<07:29,  1.41s/it, est. speed input: 777.54 toks/s, output: 0.76 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [38:24<07:25,  1.47s/it, est. speed input: 775.91 toks/s, output: 0.76 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [38:44<06:42,  1.41s/it, est. speed input: 776.28 toks/s, output: 0.76 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [39:04<06:07,  1.36s/it, est. speed input: 776.64 toks/s, output: 0.76 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [39:24<05:37,  1.33s/it, est. speed input: 776.99 toks/s, output: 0.76 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [39:44<05:10,  1.31s/it, est. speed input: 777.33 toks/s, output: 0.76 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [40:04<04:46,  1.29s/it, est. speed input: 777.68 toks/s, output: 0.76 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [40:24<04:23,  1.28s/it, est. speed input: 778.02 toks/s, output: 0.76 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [40:44<04:01,  1.27s/it, est. speed input: 778.36 toks/s, output: 0.76 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [41:04<03:39,  1.26s/it, est. speed input: 778.69 toks/s, output: 0.76 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [41:32<03:41,  1.40s/it, est. speed input: 776.59 toks/s, output: 0.76 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [41:52<03:12,  1.36s/it, est. speed input: 776.93 toks/s, output: 0.76 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [42:12<02:47,  1.33s/it, est. speed input: 777.27 toks/s, output: 0.76 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [42:32<02:23,  1.30s/it, est. speed input: 777.59 toks/s, output: 0.76 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [42:52<02:01,  1.29s/it, est. speed input: 777.90 toks/s, output: 0.76 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [43:12<01:39,  1.28s/it, est. speed input: 778.22 toks/s, output: 0.76 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [43:39<01:27,  1.41s/it, est. speed input: 776.22 toks/s, output: 0.76 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [43:59<01:02,  1.37s/it, est. speed input: 776.54 toks/s, output: 0.76 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [44:19<00:39,  1.33s/it, est. speed input: 776.86 toks/s, output: 0.76 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [44:47<00:20,  1.45s/it, est. speed input: 774.98 toks/s, output: 0.76 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [44:47<00:00,  1.45s/it, est. speed input: 780.32 toks/s, output: 0.76 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [44:47<00:00,  1.31s/it, est. speed input: 780.32 toks/s, output: 0.76 toks/s]
[rank0]:[W126 17:29:00.263386354 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 2805.6s

测试结果:
  Requests/s:   0.76
  Tokens/s:     779.92
  Total Reqs:   2048
  Elapsed:      2691.56s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     779.16

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:29:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:29:22 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1547769) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1547769) WARNING 01-26 17:30:54 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.76 requests/s, 5901.61 total tokens/s, 5.76 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 17:29:21] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:29:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:29:21] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:29:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:29:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:29:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:29:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:29:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:29:25] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:29:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:29:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:29:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:29:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:29:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:29:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:29:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:29:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1547769) [2026-01-26 17:29:26] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1547769) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1547769) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.07s/it]
(EngineCore_DP0 pid=1547769) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 33.88s/it]
(EngineCore_DP0 pid=1547769) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 33.00s/it]
(EngineCore_DP0 pid=1547769) 
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1547769) [2026-01-26 17:30:33] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1547769) 2026-01-26 17:30:45,733 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1547769) 2026-01-26 17:30:47,739 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/4096 [00:01<1:17:21,  1.13s/it]
Adding requests:   0%|          | 2/4096 [00:01<44:24,  1.54it/s]  
Adding requests:   0%|          | 3/4096 [00:01<29:37,  2.30it/s]
Adding requests:   0%|          | 4/4096 [00:01<20:57,  3.26it/s]
Adding requests:   0%|          | 6/4096 [00:01<12:28,  5.46it/s]
Adding requests:   0%|          | 9/4096 [00:02<07:40,  8.88it/s]
Adding requests:   0%|          | 12/4096 [00:02<05:31, 12.32it/s]
Adding requests:   0%|          | 17/4096 [00:02<03:30, 19.38it/s]
Adding requests:   1%|          | 30/4096 [00:02<01:34, 43.16it/s]
Adding requests:   1%|          | 45/4096 [00:02<00:59, 68.11it/s]
Adding requests:   2%|▏         | 64/4096 [00:02<00:41, 97.51it/s]
Adding requests:   2%|▏         | 81/4096 [00:02<00:34, 116.20it/s]
Adding requests:   3%|▎         | 111/4096 [00:02<00:24, 164.53it/s]
Adding requests:   3%|▎         | 140/4096 [00:02<00:19, 197.97it/s]
Adding requests:   4%|▍         | 177/4096 [00:02<00:15, 245.08it/s]
Adding requests:   5%|▌         | 216/4096 [00:03<00:13, 285.53it/s]
Adding requests:   6%|▋         | 259/4096 [00:03<00:11, 326.91it/s]
Adding requests:   7%|▋         | 299/4096 [00:03<00:10, 348.05it/s]
Adding requests:   8%|▊         | 344/4096 [00:03<00:09, 376.90it/s]
Adding requests:  10%|▉         | 391/4096 [00:03<00:09, 403.52it/s]
Adding requests:  11%|█         | 440/4096 [00:03<00:08, 427.17it/s]
Adding requests:  12%|█▏        | 486/4096 [00:03<00:08, 436.20it/s]
Adding requests:  13%|█▎        | 535/4096 [00:03<00:07, 450.01it/s]
Adding requests:  14%|█▍        | 581/4096 [00:03<00:08, 438.38it/s]
Adding requests:  15%|█▌        | 625/4096 [00:04<00:07, 437.01it/s]
Adding requests:  16%|█▋        | 669/4096 [00:04<00:08, 427.50it/s]
Adding requests:  17%|█▋        | 712/4096 [00:04<00:08, 410.15it/s]
Adding requests:  18%|█▊        | 754/4096 [00:04<00:08, 404.96it/s]
Adding requests:  20%|█▉        | 799/4096 [00:04<00:07, 416.30it/s]
Adding requests:  21%|██        | 846/4096 [00:04<00:07, 431.12it/s]
Adding requests:  22%|██▏       | 890/4096 [00:04<00:07, 431.67it/s]
Adding requests:  23%|██▎       | 934/4096 [00:04<00:07, 428.22it/s]
Adding requests:  24%|██▍       | 979/4096 [00:04<00:07, 432.90it/s]
Adding requests:  25%|██▍       | 1023/4096 [00:04<00:07, 433.99it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:05<00:07, 427.49it/s]
Adding requests:  27%|██▋       | 1111/4096 [00:05<00:06, 429.85it/s]
Adding requests:  28%|██▊       | 1155/4096 [00:05<00:06, 430.05it/s]
Adding requests:  29%|██▉       | 1199/4096 [00:05<00:06, 427.00it/s]
Adding requests:  30%|███       | 1242/4096 [00:05<00:06, 422.69it/s]
Adding requests:  31%|███▏      | 1285/4096 [00:05<00:06, 418.45it/s]
Adding requests:  32%|███▏      | 1327/4096 [00:05<00:07, 384.21it/s]
Adding requests:  33%|███▎      | 1368/4096 [00:05<00:07, 387.78it/s]
Adding requests:  34%|███▍      | 1410/4096 [00:05<00:06, 393.85it/s]
Adding requests:  35%|███▌      | 1452/4096 [00:06<00:06, 399.02it/s]
Adding requests:  37%|███▋      | 1497/4096 [00:06<00:06, 411.47it/s]
Adding requests:  38%|███▊      | 1540/4096 [00:06<00:06, 415.90it/s]
Adding requests:  39%|███▊      | 1583/4096 [00:06<00:06, 418.14it/s]
Adding requests:  40%|███▉      | 1625/4096 [00:06<00:06, 408.80it/s]
Adding requests:  41%|████      | 1667/4096 [00:06<00:05, 411.37it/s]
Adding requests:  42%|████▏     | 1711/4096 [00:06<00:05, 418.33it/s]
Adding requests:  43%|████▎     | 1756/4096 [00:06<00:05, 427.54it/s]
Adding requests:  44%|████▍     | 1799/4096 [00:06<00:05, 419.88it/s]
Adding requests:  45%|████▍     | 1842/4096 [00:06<00:05, 419.83it/s]
Adding requests:  46%|████▌     | 1885/4096 [00:07<00:05, 421.37it/s]
Adding requests:  47%|████▋     | 1930/4096 [00:07<00:05, 429.77it/s]
Adding requests:  48%|████▊     | 1974/4096 [00:07<00:04, 428.49it/s]
Adding requests:  49%|████▉     | 2017/4096 [00:07<00:04, 424.81it/s]
Adding requests:  50%|█████     | 2060/4096 [00:07<00:04, 420.01it/s]
Adding requests:  51%|█████▏    | 2104/4096 [00:07<00:04, 425.02it/s]
Adding requests:  52%|█████▏    | 2147/4096 [00:07<00:04, 422.40it/s]
Adding requests:  53%|█████▎    | 2190/4096 [00:07<00:04, 409.91it/s]
Adding requests:  54%|█████▍    | 2232/4096 [00:07<00:04, 402.01it/s]
Adding requests:  56%|█████▌    | 2276/4096 [00:07<00:04, 411.07it/s]
Adding requests:  57%|█████▋    | 2321/4096 [00:08<00:04, 421.36it/s]
Adding requests:  58%|█████▊    | 2369/4096 [00:08<00:03, 437.04it/s]
Adding requests:  59%|█████▉    | 2413/4096 [00:08<00:03, 430.82it/s]
Adding requests:  60%|█████▉    | 2457/4096 [00:08<00:03, 432.52it/s]
Adding requests:  61%|██████    | 2502/4096 [00:08<00:03, 435.01it/s]
Adding requests:  62%|██████▏   | 2546/4096 [00:08<00:03, 405.42it/s]
Adding requests:  63%|██████▎   | 2588/4096 [00:08<00:03, 409.35it/s]
Adding requests:  64%|██████▍   | 2632/4096 [00:08<00:03, 416.38it/s]
Adding requests:  65%|██████▌   | 2675/4096 [00:08<00:03, 418.85it/s]
Adding requests:  66%|██████▋   | 2718/4096 [00:09<00:03, 420.38it/s]
Adding requests:  67%|██████▋   | 2764/4096 [00:09<00:03, 431.81it/s]
Adding requests:  69%|██████▊   | 2808/4096 [00:09<00:02, 429.85it/s]
Adding requests:  70%|██████▉   | 2853/4096 [00:09<00:02, 433.12it/s]
Adding requests:  71%|███████   | 2897/4096 [00:09<00:02, 434.99it/s]
Adding requests:  72%|███████▏  | 2942/4096 [00:09<00:02, 437.70it/s]
Adding requests:  73%|███████▎  | 2987/4096 [00:09<00:02, 437.63it/s]
Adding requests:  74%|███████▍  | 3032/4096 [00:09<00:02, 439.68it/s]
Adding requests:  75%|███████▌  | 3077/4096 [00:09<00:02, 441.55it/s]
Adding requests:  76%|███████▌  | 3123/4096 [00:09<00:02, 445.64it/s]
Adding requests:  77%|███████▋  | 3168/4096 [00:10<00:02, 441.90it/s]
Adding requests:  78%|███████▊  | 3213/4096 [00:10<00:02, 435.85it/s]
Adding requests:  80%|███████▉  | 3258/4096 [00:10<00:01, 437.20it/s]
Adding requests:  81%|████████  | 3302/4096 [00:10<00:01, 430.48it/s]
Adding requests:  82%|████████▏ | 3346/4096 [00:10<00:01, 430.76it/s]
Adding requests:  83%|████████▎ | 3391/4096 [00:10<00:01, 434.81it/s]
Adding requests:  84%|████████▍ | 3435/4096 [00:10<00:01, 427.47it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:10<00:01, 439.64it/s]
Adding requests:  86%|████████▌ | 3527/4096 [00:10<00:01, 434.63it/s]
Adding requests:  87%|████████▋ | 3573/4096 [00:10<00:01, 438.85it/s]
Adding requests:  88%|████████▊ | 3617/4096 [00:11<00:01, 427.67it/s]
Adding requests:  89%|████████▉ | 3661/4096 [00:11<00:01, 428.61it/s]
Adding requests:  90%|█████████ | 3704/4096 [00:11<00:00, 426.41it/s]
Adding requests:  91%|█████████▏| 3747/4096 [00:11<00:00, 426.79it/s]
Adding requests:  93%|█████████▎| 3790/4096 [00:11<00:00, 414.05it/s]
Adding requests:  94%|█████████▎| 3832/4096 [00:11<00:00, 401.56it/s]
Adding requests:  95%|█████████▍| 3875/4096 [00:11<00:00, 407.47it/s]
Adding requests:  96%|█████████▌| 3916/4096 [00:11<00:00, 406.03it/s]
Adding requests:  97%|█████████▋| 3957/4096 [00:11<00:00, 394.30it/s]
Adding requests:  98%|█████████▊| 3999/4096 [00:12<00:00, 399.97it/s]
Adding requests:  99%|█████████▊| 4042/4096 [00:12<00:00, 408.36it/s]
Adding requests: 100%|█████████▉| 4083/4096 [00:12<00:00, 404.58it/s]
Adding requests: 100%|██████████| 4096/4096 [00:12<00:00, 334.26it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 40/4096 [00:01<02:20, 28.84it/s, est. speed input: 29533.93 toks/s, output: 28.84 toks/s]
Processed prompts:   2%|▏         | 72/4096 [00:06<07:17,  9.21it/s, est. speed input: 10633.27 toks/s, output: 10.38 toks/s]
Processed prompts:   3%|▎         | 104/4096 [00:12<09:05,  7.31it/s, est. speed input: 8525.77 toks/s, output: 8.33 toks/s] 
Processed prompts:   3%|▎         | 136/4096 [00:18<09:57,  6.63it/s, est. speed input: 7716.56 toks/s, output: 7.54 toks/s]
Processed prompts:   4%|▍         | 168/4096 [00:23<10:24,  6.29it/s, est. speed input: 7284.52 toks/s, output: 7.11 toks/s]
Processed prompts:   5%|▍         | 200/4096 [00:29<10:33,  6.15it/s, est. speed input: 7048.87 toks/s, output: 6.88 toks/s]
Processed prompts:   6%|▌         | 232/4096 [00:34<10:43,  6.01it/s, est. speed input: 6860.01 toks/s, output: 6.70 toks/s]
Processed prompts:   6%|▋         | 264/4096 [00:40<10:47,  5.92it/s, est. speed input: 6723.33 toks/s, output: 6.57 toks/s]
Processed prompts:   7%|▋         | 296/4096 [00:45<10:42,  5.91it/s, est. speed input: 6640.99 toks/s, output: 6.49 toks/s]
Processed prompts:   8%|▊         | 328/4096 [00:51<10:43,  5.85it/s, est. speed input: 6556.74 toks/s, output: 6.40 toks/s]
Processed prompts:   9%|▉         | 360/4096 [00:56<10:42,  5.81it/s, est. speed input: 6488.52 toks/s, output: 6.34 toks/s]
Processed prompts:  10%|▉         | 392/4096 [01:02<10:39,  5.79it/s, est. speed input: 6434.33 toks/s, output: 6.28 toks/s]
Processed prompts:  10%|█         | 424/4096 [01:07<10:30,  5.82it/s, est. speed input: 6401.40 toks/s, output: 6.25 toks/s]
Processed prompts:  11%|█         | 456/4096 [01:13<10:28,  5.79it/s, est. speed input: 6360.54 toks/s, output: 6.21 toks/s]
Processed prompts:  12%|█▏        | 488/4096 [01:19<10:25,  5.77it/s, est. speed input: 6325.26 toks/s, output: 6.18 toks/s]
Processed prompts:  13%|█▎        | 520/4096 [01:24<10:20,  5.76it/s, est. speed input: 6295.53 toks/s, output: 6.15 toks/s]
Processed prompts:  13%|█▎        | 552/4096 [01:30<10:16,  5.75it/s, est. speed input: 6267.74 toks/s, output: 6.12 toks/s]
Processed prompts:  14%|█▍        | 584/4096 [01:35<10:11,  5.74it/s, est. speed input: 6244.15 toks/s, output: 6.10 toks/s]
Processed prompts:  15%|█▌        | 616/4096 [01:41<10:06,  5.74it/s, est. speed input: 6223.13 toks/s, output: 6.08 toks/s]
Processed prompts:  16%|█▌        | 648/4096 [01:46<10:01,  5.73it/s, est. speed input: 6203.87 toks/s, output: 6.06 toks/s]
Processed prompts:  17%|█▋        | 680/4096 [01:52<09:56,  5.73it/s, est. speed input: 6186.47 toks/s, output: 6.04 toks/s]
Processed prompts:  17%|█▋        | 712/4096 [01:58<09:51,  5.72it/s, est. speed input: 6170.92 toks/s, output: 6.03 toks/s]
Processed prompts:  18%|█▊        | 744/4096 [02:03<09:45,  5.72it/s, est. speed input: 6156.51 toks/s, output: 6.01 toks/s]
Processed prompts:  19%|█▉        | 776/4096 [02:09<09:35,  5.77it/s, est. speed input: 6150.85 toks/s, output: 6.01 toks/s]
Processed prompts:  20%|█▉        | 808/4096 [02:14<09:31,  5.75it/s, est. speed input: 6138.36 toks/s, output: 5.99 toks/s]
Processed prompts:  21%|██        | 840/4096 [02:20<09:26,  5.74it/s, est. speed input: 6127.44 toks/s, output: 5.98 toks/s]
Processed prompts:  21%|██▏       | 872/4096 [02:25<09:21,  5.74it/s, est. speed input: 6117.55 toks/s, output: 5.97 toks/s]
Processed prompts:  22%|██▏       | 904/4096 [02:31<09:16,  5.73it/s, est. speed input: 6108.04 toks/s, output: 5.96 toks/s]
Processed prompts:  23%|██▎       | 936/4096 [02:37<09:11,  5.73it/s, est. speed input: 6099.21 toks/s, output: 5.96 toks/s]
Processed prompts:  24%|██▎       | 968/4096 [02:42<09:05,  5.73it/s, est. speed input: 6091.21 toks/s, output: 5.95 toks/s]
Processed prompts:  24%|██▍       | 1000/4096 [02:48<09:00,  5.73it/s, est. speed input: 6083.40 toks/s, output: 5.94 toks/s]
Processed prompts:  25%|██▌       | 1032/4096 [02:53<08:55,  5.72it/s, est. speed input: 6075.89 toks/s, output: 5.93 toks/s]
Processed prompts:  26%|██▌       | 1064/4096 [02:59<08:49,  5.72it/s, est. speed input: 6069.37 toks/s, output: 5.93 toks/s]
Processed prompts:  27%|██▋       | 1096/4096 [03:05<08:43,  5.73it/s, est. speed input: 6063.43 toks/s, output: 5.92 toks/s]
Processed prompts:  28%|██▊       | 1128/4096 [03:10<08:38,  5.73it/s, est. speed input: 6057.50 toks/s, output: 5.92 toks/s]
Processed prompts:  28%|██▊       | 1160/4096 [03:16<08:32,  5.72it/s, est. speed input: 6051.79 toks/s, output: 5.91 toks/s]
Processed prompts:  29%|██▉       | 1192/4096 [03:21<08:23,  5.77it/s, est. speed input: 6050.98 toks/s, output: 5.91 toks/s]
Processed prompts:  30%|██▉       | 1224/4096 [03:27<08:14,  5.80it/s, est. speed input: 6050.21 toks/s, output: 5.91 toks/s]
Processed prompts:  31%|███       | 1256/4096 [03:32<08:11,  5.78it/s, est. speed input: 6045.48 toks/s, output: 5.90 toks/s]
Processed prompts:  31%|███▏      | 1288/4096 [03:38<08:07,  5.77it/s, est. speed input: 6040.84 toks/s, output: 5.90 toks/s]
Processed prompts:  32%|███▏      | 1320/4096 [03:43<07:58,  5.80it/s, est. speed input: 6040.21 toks/s, output: 5.90 toks/s]
Processed prompts:  33%|███▎      | 1352/4096 [03:49<07:55,  5.78it/s, est. speed input: 6035.97 toks/s, output: 5.89 toks/s]
Processed prompts:  34%|███▍      | 1384/4096 [03:54<07:50,  5.76it/s, est. speed input: 6031.83 toks/s, output: 5.89 toks/s]
Processed prompts:  35%|███▍      | 1416/4096 [04:00<07:42,  5.80it/s, est. speed input: 6031.55 toks/s, output: 5.89 toks/s]
Processed prompts:  35%|███▌      | 1448/4096 [04:05<07:34,  5.82it/s, est. speed input: 6031.37 toks/s, output: 5.89 toks/s]
Processed prompts:  36%|███▌      | 1480/4096 [04:11<07:31,  5.79it/s, est. speed input: 6027.45 toks/s, output: 5.89 toks/s]
Processed prompts:  37%|███▋      | 1512/4096 [04:16<07:24,  5.82it/s, est. speed input: 6027.42 toks/s, output: 5.89 toks/s]
Processed prompts:  38%|███▊      | 1544/4096 [04:22<07:17,  5.83it/s, est. speed input: 6027.11 toks/s, output: 5.89 toks/s]
Processed prompts:  38%|███▊      | 1576/4096 [04:27<07:14,  5.80it/s, est. speed input: 6023.56 toks/s, output: 5.88 toks/s]
Processed prompts:  39%|███▉      | 1608/4096 [04:33<07:07,  5.82it/s, est. speed input: 6023.56 toks/s, output: 5.88 toks/s]
Processed prompts:  40%|████      | 1640/4096 [04:38<07:03,  5.79it/s, est. speed input: 6020.24 toks/s, output: 5.88 toks/s]
Processed prompts:  41%|████      | 1672/4096 [04:44<07:00,  5.77it/s, est. speed input: 6017.00 toks/s, output: 5.88 toks/s]
Processed prompts:  42%|████▏     | 1704/4096 [04:50<06:55,  5.76it/s, est. speed input: 6014.17 toks/s, output: 5.87 toks/s]
Processed prompts:  42%|████▏     | 1736/4096 [04:55<06:39,  5.90it/s, est. speed input: 6021.17 toks/s, output: 5.88 toks/s]
Processed prompts:  43%|████▎     | 1768/4096 [05:00<06:38,  5.85it/s, est. speed input: 6018.19 toks/s, output: 5.88 toks/s]
Processed prompts:  44%|████▍     | 1800/4096 [05:06<06:35,  5.81it/s, est. speed input: 6015.15 toks/s, output: 5.87 toks/s]
Processed prompts:  45%|████▍     | 1832/4096 [05:12<06:31,  5.78it/s, est. speed input: 6012.51 toks/s, output: 5.87 toks/s]
Processed prompts:  46%|████▌     | 1864/4096 [05:17<06:24,  5.81it/s, est. speed input: 6012.56 toks/s, output: 5.87 toks/s]
Processed prompts:  46%|████▋     | 1896/4096 [05:23<06:20,  5.78it/s, est. speed input: 6009.86 toks/s, output: 5.87 toks/s]
Processed prompts:  47%|████▋     | 1928/4096 [05:28<06:16,  5.76it/s, est. speed input: 6007.11 toks/s, output: 5.87 toks/s]
Processed prompts:  48%|████▊     | 1960/4096 [05:34<06:08,  5.80it/s, est. speed input: 6007.30 toks/s, output: 5.87 toks/s]
Processed prompts:  49%|████▊     | 1992/4096 [05:39<06:04,  5.78it/s, est. speed input: 6005.00 toks/s, output: 5.86 toks/s]
Processed prompts:  49%|████▉     | 2024/4096 [05:45<05:59,  5.76it/s, est. speed input: 6002.53 toks/s, output: 5.86 toks/s]
Processed prompts:  50%|█████     | 2056/4096 [05:50<05:52,  5.79it/s, est. speed input: 6002.71 toks/s, output: 5.86 toks/s]
Processed prompts:  51%|█████     | 2088/4096 [05:56<05:47,  5.77it/s, est. speed input: 6000.54 toks/s, output: 5.86 toks/s]
Processed prompts:  52%|█████▏    | 2120/4096 [06:01<05:43,  5.76it/s, est. speed input: 5998.39 toks/s, output: 5.86 toks/s]
Processed prompts:  53%|█████▎    | 2152/4096 [06:07<05:38,  5.75it/s, est. speed input: 5996.34 toks/s, output: 5.86 toks/s]
Processed prompts:  53%|█████▎    | 2184/4096 [06:12<05:30,  5.79it/s, est. speed input: 5996.61 toks/s, output: 5.86 toks/s]
Processed prompts:  54%|█████▍    | 2216/4096 [06:18<05:26,  5.76it/s, est. speed input: 5994.52 toks/s, output: 5.85 toks/s]
Processed prompts:  55%|█████▍    | 2248/4096 [06:24<05:21,  5.75it/s, est. speed input: 5992.42 toks/s, output: 5.85 toks/s]
Processed prompts:  56%|█████▌    | 2280/4096 [06:29<05:16,  5.74it/s, est. speed input: 5990.61 toks/s, output: 5.85 toks/s]
Processed prompts:  56%|█████▋    | 2312/4096 [06:35<05:11,  5.73it/s, est. speed input: 5988.61 toks/s, output: 5.85 toks/s]
Processed prompts:  57%|█████▋    | 2344/4096 [06:40<05:03,  5.77it/s, est. speed input: 5988.86 toks/s, output: 5.85 toks/s]
Processed prompts:  58%|█████▊    | 2376/4096 [06:46<04:58,  5.75it/s, est. speed input: 5986.94 toks/s, output: 5.85 toks/s]
Processed prompts:  59%|█████▉    | 2408/4096 [06:51<04:53,  5.75it/s, est. speed input: 5985.29 toks/s, output: 5.85 toks/s]
Processed prompts:  60%|█████▉    | 2440/4096 [06:57<04:48,  5.73it/s, est. speed input: 5983.38 toks/s, output: 5.84 toks/s]
Processed prompts:  60%|██████    | 2472/4096 [07:03<04:43,  5.73it/s, est. speed input: 5981.80 toks/s, output: 5.84 toks/s]
Processed prompts:  61%|██████    | 2504/4096 [07:08<04:37,  5.73it/s, est. speed input: 5980.12 toks/s, output: 5.84 toks/s]
Processed prompts:  62%|██████▏   | 2536/4096 [07:14<04:30,  5.77it/s, est. speed input: 5980.53 toks/s, output: 5.84 toks/s]
Processed prompts:  63%|██████▎   | 2568/4096 [07:19<04:25,  5.75it/s, est. speed input: 5978.96 toks/s, output: 5.84 toks/s]
Processed prompts:  63%|██████▎   | 2600/4096 [07:25<04:18,  5.79it/s, est. speed input: 5979.46 toks/s, output: 5.84 toks/s]
Processed prompts:  64%|██████▍   | 2632/4096 [07:30<04:11,  5.82it/s, est. speed input: 5979.92 toks/s, output: 5.84 toks/s]
Processed prompts:  65%|██████▌   | 2664/4096 [07:36<04:07,  5.79it/s, est. speed input: 5978.41 toks/s, output: 5.84 toks/s]
Processed prompts:  66%|██████▌   | 2696/4096 [07:41<04:02,  5.77it/s, est. speed input: 5976.93 toks/s, output: 5.84 toks/s]
Processed prompts:  67%|██████▋   | 2728/4096 [07:47<03:55,  5.80it/s, est. speed input: 5977.33 toks/s, output: 5.84 toks/s]
Processed prompts:  67%|██████▋   | 2760/4096 [07:52<03:51,  5.77it/s, est. speed input: 5975.80 toks/s, output: 5.84 toks/s]
Processed prompts:  68%|██████▊   | 2792/4096 [07:58<03:46,  5.76it/s, est. speed input: 5974.50 toks/s, output: 5.83 toks/s]
Processed prompts:  69%|██████▉   | 2824/4096 [08:04<03:41,  5.75it/s, est. speed input: 5973.14 toks/s, output: 5.83 toks/s]
Processed prompts:  70%|██████▉   | 2856/4096 [08:09<03:36,  5.74it/s, est. speed input: 5971.74 toks/s, output: 5.83 toks/s]
Processed prompts:  71%|███████   | 2888/4096 [08:15<03:27,  5.83it/s, est. speed input: 5974.30 toks/s, output: 5.83 toks/s]
Processed prompts:  71%|███████▏  | 2920/4096 [08:20<03:21,  5.84it/s, est. speed input: 5974.67 toks/s, output: 5.83 toks/s]
Processed prompts:  72%|███████▏  | 2952/4096 [08:26<03:17,  5.80it/s, est. speed input: 5973.29 toks/s, output: 5.83 toks/s]
Processed prompts:  73%|███████▎  | 2984/4096 [08:31<03:11,  5.81it/s, est. speed input: 5973.23 toks/s, output: 5.83 toks/s]
Processed prompts:  74%|███████▎  | 3016/4096 [08:37<03:06,  5.78it/s, est. speed input: 5971.90 toks/s, output: 5.83 toks/s]
Processed prompts:  74%|███████▍  | 3048/4096 [08:42<03:01,  5.76it/s, est. speed input: 5970.69 toks/s, output: 5.83 toks/s]
Processed prompts:  75%|███████▌  | 3080/4096 [08:48<02:56,  5.75it/s, est. speed input: 5969.47 toks/s, output: 5.83 toks/s]
Processed prompts:  76%|███████▌  | 3112/4096 [08:53<02:51,  5.74it/s, est. speed input: 5968.24 toks/s, output: 5.83 toks/s]
Processed prompts:  77%|███████▋  | 3144/4096 [08:59<02:46,  5.73it/s, est. speed input: 5967.10 toks/s, output: 5.83 toks/s]
Processed prompts:  78%|███████▊  | 3176/4096 [09:04<02:39,  5.78it/s, est. speed input: 5967.59 toks/s, output: 5.83 toks/s]
Processed prompts:  78%|███████▊  | 3208/4096 [09:10<02:34,  5.76it/s, est. speed input: 5966.53 toks/s, output: 5.83 toks/s]
Processed prompts:  79%|███████▉  | 3240/4096 [09:16<02:28,  5.75it/s, est. speed input: 5965.43 toks/s, output: 5.83 toks/s]
Processed prompts:  80%|███████▉  | 3272/4096 [09:21<02:23,  5.74it/s, est. speed input: 5964.20 toks/s, output: 5.82 toks/s]
Processed prompts:  81%|████████  | 3304/4096 [09:27<02:18,  5.73it/s, est. speed input: 5963.22 toks/s, output: 5.82 toks/s]
Processed prompts:  81%|████████▏ | 3336/4096 [09:32<02:12,  5.73it/s, est. speed input: 5962.11 toks/s, output: 5.82 toks/s]
Processed prompts:  82%|████████▏ | 3368/4096 [09:38<02:07,  5.72it/s, est. speed input: 5961.09 toks/s, output: 5.82 toks/s]
Processed prompts:  83%|████████▎ | 3400/4096 [09:44<02:00,  5.77it/s, est. speed input: 5961.49 toks/s, output: 5.82 toks/s]
Processed prompts:  84%|████████▍ | 3432/4096 [09:49<01:55,  5.75it/s, est. speed input: 5960.47 toks/s, output: 5.82 toks/s]
Processed prompts:  85%|████████▍ | 3464/4096 [09:55<01:50,  5.74it/s, est. speed input: 5959.45 toks/s, output: 5.82 toks/s]
Processed prompts:  85%|████████▌ | 3496/4096 [10:00<01:44,  5.73it/s, est. speed input: 5958.47 toks/s, output: 5.82 toks/s]
Processed prompts:  86%|████████▌ | 3528/4096 [10:06<01:39,  5.73it/s, est. speed input: 5957.59 toks/s, output: 5.82 toks/s]
Processed prompts:  87%|████████▋ | 3560/4096 [10:11<01:32,  5.77it/s, est. speed input: 5958.14 toks/s, output: 5.82 toks/s]
Processed prompts:  88%|████████▊ | 3592/4096 [10:17<01:27,  5.76it/s, est. speed input: 5957.20 toks/s, output: 5.82 toks/s]
Processed prompts:  88%|████████▊ | 3624/4096 [10:23<01:22,  5.74it/s, est. speed input: 5956.23 toks/s, output: 5.82 toks/s]
Processed prompts:  89%|████████▉ | 3656/4096 [10:28<01:16,  5.74it/s, est. speed input: 5955.34 toks/s, output: 5.82 toks/s]
Processed prompts:  90%|█████████ | 3688/4096 [10:33<01:09,  5.83it/s, est. speed input: 5957.50 toks/s, output: 5.82 toks/s]
Processed prompts:  91%|█████████ | 3720/4096 [10:39<01:04,  5.80it/s, est. speed input: 5956.59 toks/s, output: 5.82 toks/s]
Processed prompts:  92%|█████████▏| 3752/4096 [10:45<00:59,  5.77it/s, est. speed input: 5955.70 toks/s, output: 5.82 toks/s]
Processed prompts:  92%|█████████▏| 3784/4096 [10:50<00:54,  5.76it/s, est. speed input: 5954.83 toks/s, output: 5.82 toks/s]
Processed prompts:  93%|█████████▎| 3816/4096 [10:56<00:48,  5.74it/s, est. speed input: 5953.97 toks/s, output: 5.81 toks/s]
Processed prompts:  94%|█████████▍| 3848/4096 [11:01<00:43,  5.74it/s, est. speed input: 5953.21 toks/s, output: 5.81 toks/s]
Processed prompts:  95%|█████████▍| 3880/4096 [11:07<00:37,  5.73it/s, est. speed input: 5952.29 toks/s, output: 5.81 toks/s]
Processed prompts:  96%|█████████▌| 3912/4096 [11:12<00:31,  5.77it/s, est. speed input: 5952.73 toks/s, output: 5.81 toks/s]
Processed prompts:  96%|█████████▋| 3944/4096 [11:18<00:26,  5.80it/s, est. speed input: 5953.23 toks/s, output: 5.81 toks/s]
Processed prompts:  97%|█████████▋| 3976/4096 [11:23<00:20,  5.77it/s, est. speed input: 5952.39 toks/s, output: 5.81 toks/s]
Processed prompts:  98%|█████████▊| 4008/4096 [11:29<00:15,  5.80it/s, est. speed input: 5952.82 toks/s, output: 5.81 toks/s]
Processed prompts:  99%|█████████▊| 4040/4096 [11:34<00:09,  5.82it/s, est. speed input: 5953.32 toks/s, output: 5.81 toks/s]
Processed prompts:  99%|█████████▉| 4072/4096 [11:39<00:03,  6.25it/s, est. speed input: 5964.07 toks/s, output: 5.82 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:39<00:00,  6.25it/s, est. speed input: 5999.22 toks/s, output: 5.86 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:39<00:00,  5.86it/s, est. speed input: 5999.22 toks/s, output: 5.86 toks/s]
[rank0]:[W126 17:42:56.364303827 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 840.3s

测试结果:
  Requests/s:   5.76
  Tokens/s:     5901.61
  Total Reqs:   4096
  Elapsed:      711.40s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5895.85

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-INT8                                 │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:43:35 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:43:35 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1559654) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1559654) ERROR 01-26 17:44:50 [core.py:866] 


─── STDERR ───
[2026-01-26 17:43:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:43:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:43:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:43:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:43:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:43:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:43:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:43:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:43:38] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:43:38] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:43:38] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-INT8
[2026-01-26 17:43:38] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-INT8'
[2026-01-26 17:43:38] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:43:38] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:43:38] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:43:38] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:43:38] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO SlideSparseLinearMethod_INT8.py:805: Wrapping CompressedTensorsW8A8Int8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO SlideSparseLinearMethod_INT8.py:452: SlideSparseInt8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO SlideSparseLinearMethod_INT8.py:604: SlideSparseInt8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO SlideSparseLinearMethod_INT8.py:621: Preloaded INT8 Triton kernels for model: Qwen2.5-7B-INT8
(EngineCore_DP0 pid=1559654) [2026-01-26 17:43:39] INFO SlideSparseLinearMethod_INT8.py:625: SlideSparseInt8LinearMethod initialized, kernel=cuSPARSELt, symmetric=True
(EngineCore_DP0 pid=1559654) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1559654) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.97s/it]
(EngineCore_DP0 pid=1559654) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.42s/it]
(EngineCore_DP0 pid=1559654) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.61s/it]
(EngineCore_DP0 pid=1559654) 
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 19906560 bytes
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 15482880 bytes
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 163676160 bytes
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:719: cuSPARSELt INT8 compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1559654) [2026-01-26 17:44:47] INFO SlideSparseLinearMethod_INT8.py:729: cuSPARSELt INT8 compression done: 81543168 bytes
(EngineCore_DP0 pid=1559654) Process EngineCore_DP0:
(EngineCore_DP0 pid=1559654) Traceback (most recent call last):
(EngineCore_DP0 pid=1559654)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1559654)     self.run()
(EngineCore_DP0 pid=1559654)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1559654)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1559654)     raise e
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1559654)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1559654)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1559654)     super().__init__(
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1559654)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1559654)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1559654)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1559654)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1559654)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1559654)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1559654)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1559654)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1559654)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1559654)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1559654)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1559654)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1559654)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1559654)     outputs = self.model(
(EngineCore_DP0 pid=1559654)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1559654)     hidden_states = self.model(
(EngineCore_DP0 pid=1559654)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1559654)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1559654)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1559654)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1559654)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1559654)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1559654)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1559654)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1559654)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1559654)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1559654)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1559654)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 745, in apply_weights
(EngineCore_DP0 pid=1559654)     return self.slidesparse_int8_linear.apply(
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 534, in apply
(EngineCore_DP0 pid=1559654)     return self._linear_fn(
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_INT8.py", line 289, in cuSPARSELt_INT8_linear
(EngineCore_DP0 pid=1559654)     qinput, scale_a_pad = quant_slide_int8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1559654)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/core/kernels.py", line 432, in quant_slide_int8_kernel
(EngineCore_DP0 pid=1559654)     return torch.ops.slidesparse.quant_slide_int8(input, model_name, L)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1559654)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/core/kernels.py", line 564, in _quant_slide_int8_impl
(EngineCore_DP0 pid=1559654)     return fn(input, L)
(EngineCore_DP0 pid=1559654)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 349, in quant_slide_int8_triton
(EngineCore_DP0 pid=1559654)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.int8, device=x.device)
(EngineCore_DP0 pid=1559654)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1559654) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1559654) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1559654) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1559654) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1559654) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1559654) 
[rank0]:[W126 17:44:51.286741001 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-INT8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_INT8_py312_cu129_aarch64/cusparselt/2_10/Qwen2.5-7B-INT8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,9.4271,4836.0839,13.5779
1024,1024,1,128,128,5.5897,5729.4347,22.8993
2048,1024,2,256,128,5.8855,6032.5959,43.4970
4096,1024,4,512,128,5.7815,5926.0794,88.5577
8192,1024,8,1024,128,5.6086,5748.8219,182.5765
16384,1024,16,2048,128,0.7609,779.9187,2691.5628
32768,1024,32,4096,128,5.7577,5901.6100,711.3991
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败


============================================================
  Benchmark 完成!
============================================================


总计: 35 成功, 5 失败
============================================================
