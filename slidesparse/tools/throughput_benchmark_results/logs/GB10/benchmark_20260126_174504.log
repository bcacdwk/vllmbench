======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-26 17:45:04
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model qwen2.5-7b-fp8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768,65536

命令行参数:
  --model: qwen2.5-7b-fp8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768,65536
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: GB10
  Compute Capability: cc121
  VRAM: 119.7 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  Qwen2.5-7B-FP8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/Qwen2.5-7B-FP8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cublaslt

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:45:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:45:08 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1561187) WARNING 01-26 17:46:02 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 11.36 requests/s, 5829.67 total tokens/s, 11.36 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 17:45:08] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:45:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:45:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:45:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:45:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:45:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:45:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:45:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:45:12] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:45:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:45:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:45:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:45:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:45:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:45:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:45:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:45:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1561187) [2026-01-26 17:45:13] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1561187) [2026-01-26 17:45:13] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1561187) [2026-01-26 17:45:13] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1561187) [2026-01-26 17:45:13] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1561187) [2026-01-26 17:45:13] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1561187) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1561187) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.65s/it]
(EngineCore_DP0 pid=1561187) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.70s/it]
(EngineCore_DP0 pid=1561187) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.69s/it]
(EngineCore_DP0 pid=1561187) 
(EngineCore_DP0 pid=1561187) 2026-01-26 17:46:02,112 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1561187) 2026-01-26 17:46:02,146 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  50%|█████     | 64/128 [00:00<00:00, 636.20it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 740.04it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:10, 11.81it/s, est. speed input: 6046.75 toks/s, output: 11.81 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:10, 11.76it/s, est. speed input: 6025.49 toks/s, output: 11.77 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:10, 11.54it/s, est. speed input: 5940.92 toks/s, output: 11.60 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:10, 11.52it/s, est. speed input: 5927.80 toks/s, output: 11.58 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:10, 11.59it/s, est. speed input: 5942.23 toks/s, output: 11.61 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:10, 11.58it/s, est. speed input: 5937.75 toks/s, output: 11.60 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:09, 11.58it/s, est. speed input: 5937.32 toks/s, output: 11.60 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:09, 11.56it/s, est. speed input: 5932.64 toks/s, output: 11.59 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:09, 11.44it/s, est. speed input: 5907.78 toks/s, output: 11.54 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:09, 11.51it/s, est. speed input: 5914.72 toks/s, output: 11.55 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:09, 11.58it/s, est. speed input: 5923.45 toks/s, output: 11.57 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:08, 11.61it/s, est. speed input: 5928.59 toks/s, output: 11.58 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:08, 11.60it/s, est. speed input: 5928.14 toks/s, output: 11.58 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:08, 11.65it/s, est. speed input: 5934.81 toks/s, output: 11.59 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:08, 11.56it/s, est. speed input: 5927.27 toks/s, output: 11.58 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:08, 11.53it/s, est. speed input: 5923.07 toks/s, output: 11.57 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:08, 11.57it/s, est. speed input: 5925.95 toks/s, output: 11.57 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:03<00:07, 11.59it/s, est. speed input: 5927.99 toks/s, output: 11.58 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:03<00:07, 11.56it/s, est. speed input: 5925.52 toks/s, output: 11.57 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:03<00:07, 11.65it/s, est. speed input: 5932.83 toks/s, output: 11.59 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:03<00:07, 11.66it/s, est. speed input: 5935.41 toks/s, output: 11.59 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:03<00:07, 11.52it/s, est. speed input: 5925.99 toks/s, output: 11.57 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:03<00:07, 11.53it/s, est. speed input: 5925.76 toks/s, output: 11.57 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:04<00:06, 11.54it/s, est. speed input: 5925.20 toks/s, output: 11.57 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:04<00:06, 11.51it/s, est. speed input: 5922.77 toks/s, output: 11.57 toks/s]
Processed prompts:  41%|████      | 52/128 [00:04<00:06, 11.57it/s, est. speed input: 5925.56 toks/s, output: 11.57 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:04<00:06, 11.57it/s, est. speed input: 5925.19 toks/s, output: 11.57 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:04<00:06, 11.47it/s, est. speed input: 5918.94 toks/s, output: 11.56 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:05<00:06, 11.62it/s, est. speed input: 5926.21 toks/s, output: 11.57 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:05<00:05, 11.64it/s, est. speed input: 5928.45 toks/s, output: 11.58 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:05<00:05, 11.59it/s, est. speed input: 5926.81 toks/s, output: 11.58 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:05<00:05, 11.62it/s, est. speed input: 5928.22 toks/s, output: 11.58 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:05<00:05, 11.63it/s, est. speed input: 5929.78 toks/s, output: 11.58 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:05<00:05, 11.49it/s, est. speed input: 5923.10 toks/s, output: 11.57 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:06<00:05, 11.54it/s, est. speed input: 5924.31 toks/s, output: 11.57 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:06<00:04, 11.55it/s, est. speed input: 5924.39 toks/s, output: 11.57 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:06<00:04, 11.57it/s, est. speed input: 5925.29 toks/s, output: 11.57 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:06<00:04, 11.60it/s, est. speed input: 5926.66 toks/s, output: 11.58 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:06<00:04, 11.58it/s, est. speed input: 5925.89 toks/s, output: 11.57 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:06<00:04, 11.44it/s, est. speed input: 5920.04 toks/s, output: 11.56 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:07<00:04, 11.50it/s, est. speed input: 5920.82 toks/s, output: 11.56 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:07<00:03, 11.51it/s, est. speed input: 5920.57 toks/s, output: 11.56 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:03, 11.50it/s, est. speed input: 5919.54 toks/s, output: 11.56 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:07<00:03, 11.58it/s, est. speed input: 5921.92 toks/s, output: 11.57 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:07<00:03, 11.57it/s, est. speed input: 5921.53 toks/s, output: 11.57 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:07<00:03, 11.45it/s, est. speed input: 5917.02 toks/s, output: 11.56 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:08<00:02, 11.45it/s, est. speed input: 5915.87 toks/s, output: 11.55 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:02, 11.47it/s, est. speed input: 5915.64 toks/s, output: 11.55 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:02, 11.53it/s, est. speed input: 5916.83 toks/s, output: 11.56 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:08<00:02, 11.55it/s, est. speed input: 5917.31 toks/s, output: 11.56 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02, 11.55it/s, est. speed input: 5917.08 toks/s, output: 11.56 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:09<00:02, 11.46it/s, est. speed input: 5914.03 toks/s, output: 11.55 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:09<00:01, 11.45it/s, est. speed input: 5912.98 toks/s, output: 11.55 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:01, 11.48it/s, est. speed input: 5912.95 toks/s, output: 11.55 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:09<00:01, 11.52it/s, est. speed input: 5913.55 toks/s, output: 11.55 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:09<00:01, 11.52it/s, est. speed input: 5913.27 toks/s, output: 11.55 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:09<00:01, 11.53it/s, est. speed input: 5913.29 toks/s, output: 11.55 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:10<00:01, 11.41it/s, est. speed input: 5909.50 toks/s, output: 11.54 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:10<00:00, 11.44it/s, est. speed input: 5909.23 toks/s, output: 11.54 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:10<00:00, 11.54it/s, est. speed input: 5911.18 toks/s, output: 11.55 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:10<00:00, 11.55it/s, est. speed input: 5911.38 toks/s, output: 11.55 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:10<00:00, 11.52it/s, est. speed input: 5910.65 toks/s, output: 11.54 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:10<00:00, 11.55it/s, est. speed input: 5911.30 toks/s, output: 11.55 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.49it/s, est. speed input: 5909.77 toks/s, output: 11.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.49it/s, est. speed input: 5909.77 toks/s, output: 11.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.54it/s, est. speed input: 5909.77 toks/s, output: 11.54 toks/s]
[rank0]:[W126 17:46:14.581152506 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 72.6s

测试结果:
  Requests/s:   11.36
  Tokens/s:     5829.67
  Total Reqs:   128
  Elapsed:      11.26s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5818.31

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:46:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:46:24 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1562421) WARNING 01-26 17:47:18 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.62 requests/s, 6782.14 total tokens/s, 6.62 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 17:46:24] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:46:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:46:24] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:46:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:46:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:46:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:46:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:46:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:46:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:46:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:46:27] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:46:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:46:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:46:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:46:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:46:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:46:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1562421) [2026-01-26 17:46:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1562421) [2026-01-26 17:46:29] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1562421) [2026-01-26 17:46:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1562421) [2026-01-26 17:46:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1562421) [2026-01-26 17:46:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1562421) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1562421) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.90s/it]
(EngineCore_DP0 pid=1562421) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.21s/it]
(EngineCore_DP0 pid=1562421) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.16s/it]
(EngineCore_DP0 pid=1562421) 
(EngineCore_DP0 pid=1562421) 2026-01-26 17:47:17,767 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1562421) 2026-01-26 17:47:17,804 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  23%|██▎       | 29/128 [00:00<00:00, 289.46it/s]
Adding requests:  54%|█████▍    | 69/128 [00:00<00:00, 354.36it/s]
Adding requests:  83%|████████▎ | 106/128 [00:00<00:00, 357.19it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 349.66it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:06, 19.25it/s, est. speed input: 19717.18 toks/s, output: 19.25 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:12,  9.55it/s, est. speed input: 10752.58 toks/s, output: 10.50 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:14,  8.12it/s, est. speed input: 9245.66 toks/s, output: 9.03 toks/s]  
Processed prompts:   6%|▋         | 8/128 [00:00<00:15,  7.76it/s, est. speed input: 8870.63 toks/s, output: 8.66 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:15,  7.47it/s, est. speed input: 8589.09 toks/s, output: 8.39 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:16,  7.27it/s, est. speed input: 8385.25 toks/s, output: 8.19 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:16,  7.02it/s, est. speed input: 8182.24 toks/s, output: 7.99 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:16,  6.94it/s, est. speed input: 8057.40 toks/s, output: 7.87 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:16,  6.86it/s, est. speed input: 7948.23 toks/s, output: 7.76 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:16,  6.85it/s, est. speed input: 7869.36 toks/s, output: 7.68 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:16,  6.78it/s, est. speed input: 7786.32 toks/s, output: 7.60 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:16,  6.76it/s, est. speed input: 7721.28 toks/s, output: 7.54 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:16,  6.73it/s, est. speed input: 7661.78 toks/s, output: 7.48 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:16,  6.67it/s, est. speed input: 7600.07 toks/s, output: 7.42 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:16,  6.64it/s, est. speed input: 7548.09 toks/s, output: 7.37 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:16,  6.68it/s, est. speed input: 7514.85 toks/s, output: 7.34 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:16,  6.67it/s, est. speed input: 7478.60 toks/s, output: 7.30 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:15,  6.69it/s, est. speed input: 7450.86 toks/s, output: 7.28 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:15,  6.68it/s, est. speed input: 7420.64 toks/s, output: 7.25 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:15,  6.69it/s, est. speed input: 7396.23 toks/s, output: 7.22 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:15,  6.60it/s, est. speed input: 7357.56 toks/s, output: 7.19 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:15,  6.63it/s, est. speed input: 7337.03 toks/s, output: 7.17 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:15,  6.65it/s, est. speed input: 7318.40 toks/s, output: 7.15 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:14,  6.68it/s, est. speed input: 7302.50 toks/s, output: 7.13 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:14,  6.69it/s, est. speed input: 7286.92 toks/s, output: 7.12 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:14,  6.70it/s, est. speed input: 7272.92 toks/s, output: 7.10 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:04<00:14,  6.69it/s, est. speed input: 7257.23 toks/s, output: 7.09 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:04<00:14,  6.61it/s, est. speed input: 7234.37 toks/s, output: 7.06 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:04<00:14,  6.64it/s, est. speed input: 7223.42 toks/s, output: 7.05 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:04<00:14,  6.66it/s, est. speed input: 7212.51 toks/s, output: 7.04 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:04<00:13,  6.67it/s, est. speed input: 7201.70 toks/s, output: 7.03 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:13,  6.68it/s, est. speed input: 7191.97 toks/s, output: 7.02 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:05<00:13,  6.69it/s, est. speed input: 7182.69 toks/s, output: 7.01 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:05<00:13,  6.69it/s, est. speed input: 7174.05 toks/s, output: 7.01 toks/s]
Processed prompts:  30%|███       | 39/128 [00:05<00:13,  6.63it/s, est. speed input: 7159.11 toks/s, output: 6.99 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:05<00:13,  6.65it/s, est. speed input: 7151.31 toks/s, output: 6.98 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:05<00:13,  6.67it/s, est. speed input: 7144.86 toks/s, output: 6.98 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:06<00:12,  6.69it/s, est. speed input: 7138.65 toks/s, output: 6.97 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:06<00:12,  6.71it/s, est. speed input: 7133.24 toks/s, output: 6.97 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:06<00:12,  6.71it/s, est. speed input: 7127.39 toks/s, output: 6.96 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:06<00:12,  6.69it/s, est. speed input: 7119.86 toks/s, output: 6.95 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:06<00:12,  6.61it/s, est. speed input: 7107.41 toks/s, output: 6.94 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:06<00:12,  6.64it/s, est. speed input: 7102.40 toks/s, output: 6.94 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:06<00:12,  6.50it/s, est. speed input: 7084.45 toks/s, output: 6.92 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:07<00:12,  6.56it/s, est. speed input: 7079.74 toks/s, output: 6.91 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:07<00:11,  6.60it/s, est. speed input: 7075.02 toks/s, output: 6.91 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:07<00:11,  6.63it/s, est. speed input: 7071.05 toks/s, output: 6.91 toks/s]
Processed prompts:  41%|████      | 52/128 [00:07<00:11,  6.65it/s, est. speed input: 7066.62 toks/s, output: 6.90 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:07<00:11,  6.61it/s, est. speed input: 7058.85 toks/s, output: 6.89 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:07<00:11,  6.63it/s, est. speed input: 7054.89 toks/s, output: 6.89 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:07<00:10,  6.65it/s, est. speed input: 7051.33 toks/s, output: 6.89 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:08<00:10,  6.65it/s, est. speed input: 7046.34 toks/s, output: 6.88 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:08<00:10,  6.67it/s, est. speed input: 7043.22 toks/s, output: 6.88 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:08<00:10,  6.65it/s, est. speed input: 7038.64 toks/s, output: 6.87 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:08<00:10,  6.66it/s, est. speed input: 7034.91 toks/s, output: 6.87 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:08<00:10,  6.61it/s, est. speed input: 7028.24 toks/s, output: 6.86 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:08<00:10,  6.67it/s, est. speed input: 7027.39 toks/s, output: 6.86 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:09<00:09,  6.66it/s, est. speed input: 7023.72 toks/s, output: 6.86 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:09<00:09,  6.66it/s, est. speed input: 7020.40 toks/s, output: 6.86 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:09<00:09,  6.71it/s, est. speed input: 7019.78 toks/s, output: 6.86 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:09<00:09,  6.72it/s, est. speed input: 7017.81 toks/s, output: 6.85 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:09<00:09,  6.69it/s, est. speed input: 7014.18 toks/s, output: 6.85 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:09<00:09,  6.60it/s, est. speed input: 7007.11 toks/s, output: 6.84 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:09<00:09,  6.61it/s, est. speed input: 7003.73 toks/s, output: 6.84 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:10<00:08,  6.63it/s, est. speed input: 7001.34 toks/s, output: 6.84 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:10<00:08,  6.64it/s, est. speed input: 6998.75 toks/s, output: 6.83 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:10<00:08,  6.65it/s, est. speed input: 6996.43 toks/s, output: 6.83 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:10<00:08,  6.66it/s, est. speed input: 6993.99 toks/s, output: 6.83 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:10<00:08,  6.68it/s, est. speed input: 6992.85 toks/s, output: 6.83 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:10<00:08,  6.61it/s, est. speed input: 6987.12 toks/s, output: 6.82 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:10<00:07,  6.63it/s, est. speed input: 6985.26 toks/s, output: 6.82 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:11<00:07,  6.63it/s, est. speed input: 6982.75 toks/s, output: 6.82 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:11<00:07,  6.65it/s, est. speed input: 6980.80 toks/s, output: 6.82 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:11<00:07,  6.64it/s, est. speed input: 6978.29 toks/s, output: 6.81 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:11<00:07,  6.65it/s, est. speed input: 6976.40 toks/s, output: 6.81 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:11<00:07,  6.69it/s, est. speed input: 6976.01 toks/s, output: 6.81 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:11<00:07,  6.63it/s, est. speed input: 6971.67 toks/s, output: 6.81 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:12<00:06,  6.65it/s, est. speed input: 6970.17 toks/s, output: 6.81 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:12<00:06,  6.64it/s, est. speed input: 6968.09 toks/s, output: 6.80 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:12<00:06,  6.67it/s, est. speed input: 6966.97 toks/s, output: 6.80 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:12<00:06,  6.68it/s, est. speed input: 6965.81 toks/s, output: 6.80 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:12<00:06,  6.67it/s, est. speed input: 6964.07 toks/s, output: 6.80 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:12<00:06,  6.67it/s, est. speed input: 6962.24 toks/s, output: 6.80 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:12<00:06,  6.58it/s, est. speed input: 6957.31 toks/s, output: 6.79 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:13<00:05,  6.59it/s, est. speed input: 6955.06 toks/s, output: 6.79 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:13<00:05,  6.60it/s, est. speed input: 6953.29 toks/s, output: 6.79 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:13<00:05,  6.64it/s, est. speed input: 6952.54 toks/s, output: 6.79 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:13<00:05,  6.67it/s, est. speed input: 6951.84 toks/s, output: 6.79 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:13<00:05,  6.66it/s, est. speed input: 6950.35 toks/s, output: 6.79 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:13<00:05,  6.69it/s, est. speed input: 6949.83 toks/s, output: 6.79 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:14<00:04,  6.61it/s, est. speed input: 6945.86 toks/s, output: 6.78 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:14<00:04,  6.62it/s, est. speed input: 6944.53 toks/s, output: 6.78 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:14<00:04,  6.65it/s, est. speed input: 6943.75 toks/s, output: 6.78 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:14<00:04,  6.63it/s, est. speed input: 6941.70 toks/s, output: 6.78 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:14<00:04,  6.64it/s, est. speed input: 6940.54 toks/s, output: 6.78 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:14<00:04,  6.65it/s, est. speed input: 6939.27 toks/s, output: 6.78 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:14<00:04,  6.67it/s, est. speed input: 6938.81 toks/s, output: 6.78 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:15<00:03,  6.58it/s, est. speed input: 6934.37 toks/s, output: 6.77 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:15<00:03,  6.60it/s, est. speed input: 6933.37 toks/s, output: 6.77 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:15<00:03,  6.62it/s, est. speed input: 6932.09 toks/s, output: 6.77 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:15<00:03,  6.63it/s, est. speed input: 6931.18 toks/s, output: 6.77 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:15<00:03,  6.66it/s, est. speed input: 6930.62 toks/s, output: 6.77 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:15<00:03,  6.67it/s, est. speed input: 6929.83 toks/s, output: 6.77 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:15<00:02,  6.68it/s, est. speed input: 6929.36 toks/s, output: 6.77 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:16<00:02,  6.58it/s, est. speed input: 6925.20 toks/s, output: 6.76 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:16<00:02,  6.61it/s, est. speed input: 6924.58 toks/s, output: 6.76 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:16<00:02,  6.62it/s, est. speed input: 6923.31 toks/s, output: 6.76 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:16<00:02,  6.63it/s, est. speed input: 6922.25 toks/s, output: 6.76 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:16<00:02,  6.65it/s, est. speed input: 6921.65 toks/s, output: 6.76 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:16<00:02,  6.66it/s, est. speed input: 6920.97 toks/s, output: 6.76 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:17<00:01,  6.66it/s, est. speed input: 6920.03 toks/s, output: 6.76 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:17<00:01,  6.56it/s, est. speed input: 6916.13 toks/s, output: 6.75 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:17<00:01,  6.61it/s, est. speed input: 6916.00 toks/s, output: 6.75 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:17<00:01,  6.64it/s, est. speed input: 6915.44 toks/s, output: 6.75 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:17<00:01,  6.64it/s, est. speed input: 6914.54 toks/s, output: 6.75 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:17<00:01,  6.66it/s, est. speed input: 6914.12 toks/s, output: 6.75 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:17<00:01,  6.65it/s, est. speed input: 6913.13 toks/s, output: 6.75 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:18<00:00,  6.66it/s, est. speed input: 6912.56 toks/s, output: 6.75 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:18<00:00,  6.58it/s, est. speed input: 6909.46 toks/s, output: 6.75 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:18<00:00,  6.62it/s, est. speed input: 6909.05 toks/s, output: 6.75 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:18<00:00,  6.62it/s, est. speed input: 6908.16 toks/s, output: 6.75 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:18<00:00,  6.62it/s, est. speed input: 6907.08 toks/s, output: 6.75 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:18<00:00,  6.65it/s, est. speed input: 6906.83 toks/s, output: 6.74 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:18<00:00,  6.67it/s, est. speed input: 6906.73 toks/s, output: 6.74 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:18<00:00,  6.67it/s, est. speed input: 6906.73 toks/s, output: 6.74 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:18<00:00,  6.74it/s, est. speed input: 6906.73 toks/s, output: 6.74 toks/s]
[rank0]:[W126 17:47:38.212449537 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 82.7s

测试结果:
  Requests/s:   6.62
  Tokens/s:     6782.14
  Total Reqs:   128
  Elapsed:      19.34s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     6775.52

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:47:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:47:47 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1563767) WARNING 01-26 17:48:39 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.74 requests/s, 6910.51 total tokens/s, 6.74 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 17:47:46] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:47:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:47:46] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:47:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:47:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:47:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:47:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:47:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:47:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:47:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:47:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:47:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:47:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:47:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:47:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:47:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:47:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1563767) [2026-01-26 17:47:51] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1563767) [2026-01-26 17:47:51] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1563767) [2026-01-26 17:47:51] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1563767) [2026-01-26 17:47:51] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1563767) [2026-01-26 17:47:51] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1563767) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1563767) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.27s/it]
(EngineCore_DP0 pid=1563767) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.23s/it]
(EngineCore_DP0 pid=1563767) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.39s/it]
(EngineCore_DP0 pid=1563767) 
(EngineCore_DP0 pid=1563767) 2026-01-26 17:48:38,583 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1563767) 2026-01-26 17:48:38,632 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  15%|█▌        | 39/256 [00:00<00:00, 385.34it/s]
Adding requests:  31%|███▏      | 80/256 [00:00<00:00, 396.77it/s]
Adding requests:  47%|████▋     | 121/256 [00:00<00:00, 402.50it/s]
Adding requests:  65%|██████▍   | 166/256 [00:00<00:00, 420.91it/s]
Adding requests:  83%|████████▎ | 213/256 [00:00<00:00, 437.08it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 424.07it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:12, 19.58it/s, est. speed input: 20047.88 toks/s, output: 19.58 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:23, 10.82it/s, est. speed input: 12164.40 toks/s, output: 11.88 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:00<00:27,  8.91it/s, est. speed input: 10290.71 toks/s, output: 10.05 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:30,  8.03it/s, est. speed input: 9380.44 toks/s, output: 9.16 toks/s] 
Processed prompts:   5%|▍         | 12/256 [00:01<00:32,  7.58it/s, est. speed input: 8874.36 toks/s, output: 8.67 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:01<00:33,  7.28it/s, est. speed input: 8518.81 toks/s, output: 8.32 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:01<00:33,  7.13it/s, est. speed input: 8292.34 toks/s, output: 8.10 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:33,  7.03it/s, est. speed input: 8124.84 toks/s, output: 7.93 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:02<00:33,  6.94it/s, est. speed input: 7983.89 toks/s, output: 7.80 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:02<00:33,  6.89it/s, est. speed input: 7876.65 toks/s, output: 7.69 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:33,  6.87it/s, est. speed input: 7794.62 toks/s, output: 7.61 toks/s]
Processed prompts:  10%|█         | 26/256 [00:03<00:33,  6.85it/s, est. speed input: 7724.17 toks/s, output: 7.54 toks/s]
Processed prompts:  11%|█         | 28/256 [00:03<00:33,  6.79it/s, est. speed input: 7650.06 toks/s, output: 7.47 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:04<00:33,  6.81it/s, est. speed input: 7604.02 toks/s, output: 7.43 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:04<00:32,  6.80it/s, est. speed input: 7559.36 toks/s, output: 7.38 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:04<00:32,  6.80it/s, est. speed input: 7521.55 toks/s, output: 7.35 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:04<00:32,  6.76it/s, est. speed input: 7479.15 toks/s, output: 7.30 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:05<00:32,  6.76it/s, est. speed input: 7446.83 toks/s, output: 7.27 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:05<00:31,  6.78it/s, est. speed input: 7422.77 toks/s, output: 7.25 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:05<00:31,  6.72it/s, est. speed input: 7388.32 toks/s, output: 7.22 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:06<00:31,  6.74it/s, est. speed input: 7366.84 toks/s, output: 7.19 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:06<00:31,  6.73it/s, est. speed input: 7343.68 toks/s, output: 7.17 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:06<00:30,  6.76it/s, est. speed input: 7328.13 toks/s, output: 7.16 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:07<00:30,  6.74it/s, est. speed input: 7307.87 toks/s, output: 7.14 toks/s]
Processed prompts:  20%|██        | 52/256 [00:07<00:30,  6.75it/s, est. speed input: 7292.33 toks/s, output: 7.12 toks/s]
Processed prompts:  21%|██        | 54/256 [00:07<00:29,  6.76it/s, est. speed input: 7279.48 toks/s, output: 7.11 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:07<00:29,  6.72it/s, est. speed input: 7261.03 toks/s, output: 7.09 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:08<00:29,  6.73it/s, est. speed input: 7248.87 toks/s, output: 7.08 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:08<00:28,  6.76it/s, est. speed input: 7240.12 toks/s, output: 7.07 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:08<00:28,  6.78it/s, est. speed input: 7231.60 toks/s, output: 7.06 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:09<00:28,  6.72it/s, est. speed input: 7215.44 toks/s, output: 7.05 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:09<00:28,  6.75it/s, est. speed input: 7208.35 toks/s, output: 7.04 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:09<00:27,  6.77it/s, est. speed input: 7200.86 toks/s, output: 7.03 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:09<00:27,  6.72it/s, est. speed input: 7188.34 toks/s, output: 7.02 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:10<00:27,  6.74it/s, est. speed input: 7180.72 toks/s, output: 7.01 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:10<00:27,  6.74it/s, est. speed input: 7173.16 toks/s, output: 7.01 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:10<00:26,  6.74it/s, est. speed input: 7166.10 toks/s, output: 7.00 toks/s]
Processed prompts:  30%|███       | 78/256 [00:11<00:26,  6.73it/s, est. speed input: 7157.65 toks/s, output: 6.99 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:11<00:26,  6.75it/s, est. speed input: 7152.76 toks/s, output: 6.99 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:11<00:25,  6.76it/s, est. speed input: 7147.97 toks/s, output: 6.98 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:12<00:25,  6.73it/s, est. speed input: 7139.61 toks/s, output: 6.97 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:12<00:25,  6.73it/s, est. speed input: 7133.83 toks/s, output: 6.97 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:12<00:24,  6.75it/s, est. speed input: 7129.40 toks/s, output: 6.96 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:12<00:24,  6.75it/s, est. speed input: 7124.30 toks/s, output: 6.96 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:13<00:24,  6.72it/s, est. speed input: 7117.04 toks/s, output: 6.95 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:13<00:23,  6.76it/s, est. speed input: 7114.78 toks/s, output: 6.95 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:13<00:23,  6.76it/s, est. speed input: 7111.09 toks/s, output: 6.94 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:14<00:23,  6.76it/s, est. speed input: 7107.08 toks/s, output: 6.94 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:14<00:23,  6.73it/s, est. speed input: 7101.00 toks/s, output: 6.93 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:14<00:22,  6.72it/s, est. speed input: 7096.36 toks/s, output: 6.93 toks/s]
Processed prompts:  41%|████      | 104/256 [00:15<00:22,  6.74it/s, est. speed input: 7093.08 toks/s, output: 6.93 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:15<00:22,  6.71it/s, est. speed input: 7087.73 toks/s, output: 6.92 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:15<00:22,  6.71it/s, est. speed input: 7083.73 toks/s, output: 6.92 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:15<00:21,  6.73it/s, est. speed input: 7080.98 toks/s, output: 6.92 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:16<00:21,  6.75it/s, est. speed input: 7078.46 toks/s, output: 6.91 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:16<00:21,  6.71it/s, est. speed input: 7073.28 toks/s, output: 6.91 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:16<00:20,  6.73it/s, est. speed input: 7070.64 toks/s, output: 6.90 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:17<00:20,  6.74it/s, est. speed input: 7067.99 toks/s, output: 6.90 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:17<00:20,  6.70it/s, est. speed input: 7062.95 toks/s, output: 6.90 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:17<00:19,  6.73it/s, est. speed input: 7061.58 toks/s, output: 6.90 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:17<00:19,  6.75it/s, est. speed input: 7059.47 toks/s, output: 6.89 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:18<00:19,  6.74it/s, est. speed input: 7056.96 toks/s, output: 6.89 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:18<00:19,  6.72it/s, est. speed input: 7053.06 toks/s, output: 6.89 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:18<00:18,  6.72it/s, est. speed input: 7050.22 toks/s, output: 6.88 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:19<00:18,  6.72it/s, est. speed input: 7047.95 toks/s, output: 6.88 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:19<00:18,  6.70it/s, est. speed input: 7044.08 toks/s, output: 6.88 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:19<00:17,  6.67it/s, est. speed input: 7039.63 toks/s, output: 6.87 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:20<00:17,  6.68it/s, est. speed input: 7037.40 toks/s, output: 6.87 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:20<00:17,  6.71it/s, est. speed input: 7035.89 toks/s, output: 6.87 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:20<00:17,  6.69it/s, est. speed input: 7032.28 toks/s, output: 6.87 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:20<00:16,  6.70it/s, est. speed input: 7030.53 toks/s, output: 6.87 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:21<00:16,  6.74it/s, est. speed input: 7030.11 toks/s, output: 6.87 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:21<00:16,  6.72it/s, est. speed input: 7027.11 toks/s, output: 6.86 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:21<00:15,  6.73it/s, est. speed input: 7025.72 toks/s, output: 6.86 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:22<00:15,  6.73it/s, est. speed input: 7024.00 toks/s, output: 6.86 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:22<00:15,  6.72it/s, est. speed input: 7021.57 toks/s, output: 6.86 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:22<00:14,  6.69it/s, est. speed input: 7018.34 toks/s, output: 6.85 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:23<00:14,  6.71it/s, est. speed input: 7016.94 toks/s, output: 6.85 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:23<00:14,  6.74it/s, est. speed input: 7016.37 toks/s, output: 6.85 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:23<00:14,  6.70it/s, est. speed input: 7013.42 toks/s, output: 6.85 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:23<00:13,  6.71it/s, est. speed input: 7012.09 toks/s, output: 6.85 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:24<00:13,  6.74it/s, est. speed input: 7011.28 toks/s, output: 6.85 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:24<00:13,  6.73it/s, est. speed input: 7009.59 toks/s, output: 6.85 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:24<00:12,  6.69it/s, est. speed input: 7006.39 toks/s, output: 6.84 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:25<00:12,  6.72it/s, est. speed input: 7005.81 toks/s, output: 6.84 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:25<00:12,  6.72it/s, est. speed input: 7004.41 toks/s, output: 6.84 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:25<00:11,  6.68it/s, est. speed input: 7001.42 toks/s, output: 6.84 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:26<00:11,  6.70it/s, est. speed input: 7000.49 toks/s, output: 6.84 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:26<00:11,  6.71it/s, est. speed input: 6999.12 toks/s, output: 6.84 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:26<00:11,  6.71it/s, est. speed input: 6997.62 toks/s, output: 6.83 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:26<00:10,  6.67it/s, est. speed input: 6994.74 toks/s, output: 6.83 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:27<00:10,  6.69it/s, est. speed input: 6993.55 toks/s, output: 6.83 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:27<00:10,  6.70it/s, est. speed input: 6992.59 toks/s, output: 6.83 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:27<00:09,  6.69it/s, est. speed input: 6990.74 toks/s, output: 6.83 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:28<00:09,  6.70it/s, est. speed input: 6989.70 toks/s, output: 6.83 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:28<00:09,  6.74it/s, est. speed input: 6989.67 toks/s, output: 6.83 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:28<00:08,  6.75it/s, est. speed input: 6989.28 toks/s, output: 6.83 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:29<00:08,  6.70it/s, est. speed input: 6986.81 toks/s, output: 6.82 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:29<00:08,  6.72it/s, est. speed input: 6986.20 toks/s, output: 6.82 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:29<00:06,  7.88it/s, est. speed input: 7019.58 toks/s, output: 6.86 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:29<00:06,  7.51it/s, est. speed input: 7018.77 toks/s, output: 6.85 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:30<00:06,  7.22it/s, est. speed input: 7016.46 toks/s, output: 6.85 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:30<00:06,  7.06it/s, est. speed input: 7014.92 toks/s, output: 6.85 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:30<00:06,  6.98it/s, est. speed input: 7014.65 toks/s, output: 6.85 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:30<00:06,  6.90it/s, est. speed input: 7013.35 toks/s, output: 6.85 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:31<00:06,  6.82it/s, est. speed input: 7011.18 toks/s, output: 6.85 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:31<00:05,  6.81it/s, est. speed input: 7010.56 toks/s, output: 6.85 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:31<00:05,  6.79it/s, est. speed input: 7009.54 toks/s, output: 6.85 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:32<00:05,  6.74it/s, est. speed input: 7007.52 toks/s, output: 6.84 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:32<00:05,  6.72it/s, est. speed input: 7005.75 toks/s, output: 6.84 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:32<00:04,  6.72it/s, est. speed input: 7004.68 toks/s, output: 6.84 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:33<00:04,  6.72it/s, est. speed input: 7003.73 toks/s, output: 6.84 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:33<00:04,  6.69it/s, est. speed input: 7001.76 toks/s, output: 6.84 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:33<00:03,  6.71it/s, est. speed input: 7000.88 toks/s, output: 6.84 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:33<00:03,  6.73it/s, est. speed input: 7000.32 toks/s, output: 6.84 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:34<00:03,  6.68it/s, est. speed input: 6997.77 toks/s, output: 6.83 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:34<00:02,  6.69it/s, est. speed input: 6996.94 toks/s, output: 6.83 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:34<00:02,  6.70it/s, est. speed input: 6995.85 toks/s, output: 6.83 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:35<00:02,  6.74it/s, est. speed input: 6995.76 toks/s, output: 6.83 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:35<00:02,  6.70it/s, est. speed input: 6993.99 toks/s, output: 6.83 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:35<00:01,  6.70it/s, est. speed input: 6992.75 toks/s, output: 6.83 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:36<00:01,  6.72it/s, est. speed input: 6992.21 toks/s, output: 6.83 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:36<00:01,  6.68it/s, est. speed input: 6990.33 toks/s, output: 6.83 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:36<00:00,  6.73it/s, est. speed input: 6990.45 toks/s, output: 6.83 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:36<00:00,  6.74it/s, est. speed input: 6990.04 toks/s, output: 6.83 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:37<00:00,  6.75it/s, est. speed input: 6989.56 toks/s, output: 6.83 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:37<00:00,  7.89it/s, est. speed input: 7015.56 toks/s, output: 6.85 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:37<00:00,  7.89it/s, est. speed input: 7015.56 toks/s, output: 6.85 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:37<00:00,  6.85it/s, est. speed input: 7015.56 toks/s, output: 6.85 toks/s]
[rank0]:[W126 17:49:17.935756554 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 99.6s

测试结果:
  Requests/s:   6.74
  Tokens/s:     6910.51
  Total Reqs:   256
  Elapsed:      37.97s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     6903.77

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:49:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:49:27 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1565355) WARNING 01-26 17:50:20 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.89 requests/s, 7058.18 total tokens/s, 6.89 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 17:49:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:49:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:49:27] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:49:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:49:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:49:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:49:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:49:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:49:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:49:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:49:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:49:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:49:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:49:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:49:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:49:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:49:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1565355) [2026-01-26 17:49:32] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1565355) [2026-01-26 17:49:32] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1565355) [2026-01-26 17:49:32] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1565355) [2026-01-26 17:49:32] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1565355) [2026-01-26 17:49:32] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1565355) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1565355) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.15s/it]
(EngineCore_DP0 pid=1565355) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.34s/it]
(EngineCore_DP0 pid=1565355) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.31s/it]
(EngineCore_DP0 pid=1565355) 
(EngineCore_DP0 pid=1565355) 2026-01-26 17:50:19,278 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1565355) 2026-01-26 17:50:19,516 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 29/512 [00:00<00:01, 281.24it/s]
Adding requests:  13%|█▎        | 66/512 [00:00<00:01, 330.87it/s]
Adding requests:  20%|█▉        | 102/512 [00:00<00:01, 343.99it/s]
Adding requests:  27%|██▋       | 137/512 [00:00<00:01, 344.22it/s]
Adding requests:  34%|███▍      | 176/512 [00:00<00:00, 359.92it/s]
Adding requests:  43%|████▎     | 222/512 [00:00<00:00, 391.34it/s]
Adding requests:  52%|█████▏    | 266/512 [00:00<00:00, 406.80it/s]
Adding requests:  61%|██████    | 310/512 [00:00<00:00, 416.95it/s]
Adding requests:  69%|██████▉   | 355/512 [00:00<00:00, 426.17it/s]
Adding requests:  78%|███████▊  | 400/512 [00:01<00:00, 431.25it/s]
Adding requests:  87%|████████▋ | 444/512 [00:01<00:00, 433.19it/s]
Adding requests:  96%|█████████▌| 492/512 [00:01<00:00, 446.10it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 407.57it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:12, 40.88it/s, est. speed input: 41864.14 toks/s, output: 40.88 toks/s]
Processed prompts:   2%|▏         | 11/512 [00:00<00:36, 13.63it/s, est. speed input: 15668.50 toks/s, output: 15.30 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:01<00:55,  8.99it/s, est. speed input: 11052.37 toks/s, output: 10.79 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:01<01:01,  8.10it/s, est. speed input: 9847.87 toks/s, output: 9.62 toks/s]  
Processed prompts:   4%|▍         | 22/512 [00:02<01:04,  7.62it/s, est. speed input: 9179.55 toks/s, output: 8.96 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:05,  7.38it/s, est. speed input: 8787.19 toks/s, output: 8.58 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:03<01:06,  7.21it/s, est. speed input: 8504.22 toks/s, output: 8.30 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:04<01:07,  7.13it/s, est. speed input: 8315.45 toks/s, output: 8.12 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:04<01:07,  7.04it/s, est. speed input: 8158.08 toks/s, output: 7.97 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:05<01:07,  6.99it/s, est. speed input: 8037.86 toks/s, output: 7.85 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:05<01:06,  6.97it/s, est. speed input: 7945.69 toks/s, output: 7.76 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:06<01:06,  6.94it/s, est. speed input: 7864.28 toks/s, output: 7.68 toks/s]
Processed prompts:  11%|█         | 54/512 [00:07<01:05,  6.94it/s, est. speed input: 7802.75 toks/s, output: 7.62 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:07<01:05,  6.92it/s, est. speed input: 7745.33 toks/s, output: 7.56 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:08<01:04,  6.92it/s, est. speed input: 7699.81 toks/s, output: 7.52 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:08<01:04,  6.92it/s, est. speed input: 7658.72 toks/s, output: 7.48 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:09<01:03,  6.92it/s, est. speed input: 7623.31 toks/s, output: 7.44 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:09<01:03,  6.90it/s, est. speed input: 7587.28 toks/s, output: 7.41 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:10<01:02,  6.89it/s, est. speed input: 7557.24 toks/s, output: 7.38 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:11<01:02,  6.90it/s, est. speed input: 7533.15 toks/s, output: 7.36 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:11<01:01,  6.88it/s, est. speed input: 7506.13 toks/s, output: 7.33 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:12<01:01,  6.89it/s, est. speed input: 7486.62 toks/s, output: 7.31 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:12<01:00,  6.88it/s, est. speed input: 7465.01 toks/s, output: 7.29 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:13<01:00,  6.88it/s, est. speed input: 7447.01 toks/s, output: 7.27 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:14<00:59,  6.87it/s, est. speed input: 7428.32 toks/s, output: 7.25 toks/s]
Processed prompts:  21%|██        | 106/512 [00:14<00:58,  6.89it/s, est. speed input: 7415.53 toks/s, output: 7.24 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:15<00:58,  6.88it/s, est. speed input: 7401.02 toks/s, output: 7.23 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:15<00:57,  6.87it/s, est. speed input: 7387.02 toks/s, output: 7.21 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:16<00:57,  6.88it/s, est. speed input: 7375.92 toks/s, output: 7.20 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:16<00:56,  6.88it/s, est. speed input: 7364.25 toks/s, output: 7.19 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:17<00:56,  6.89it/s, est. speed input: 7355.06 toks/s, output: 7.18 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:18<00:55,  6.88it/s, est. speed input: 7344.35 toks/s, output: 7.17 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:18<00:54,  6.88it/s, est. speed input: 7335.16 toks/s, output: 7.16 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:19<00:54,  6.86it/s, est. speed input: 7324.58 toks/s, output: 7.15 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:19<00:53,  6.87it/s, est. speed input: 7316.59 toks/s, output: 7.15 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:20<00:53,  6.87it/s, est. speed input: 7308.03 toks/s, output: 7.14 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:21<00:52,  6.88it/s, est. speed input: 7302.24 toks/s, output: 7.13 toks/s]
Processed prompts:  30%|███       | 154/512 [00:21<00:52,  6.88it/s, est. speed input: 7294.84 toks/s, output: 7.12 toks/s]
Processed prompts:  31%|███       | 158/512 [00:22<00:51,  6.86it/s, est. speed input: 7286.85 toks/s, output: 7.12 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:22<00:50,  6.89it/s, est. speed input: 7282.34 toks/s, output: 7.11 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:23<00:50,  6.87it/s, est. speed input: 7275.04 toks/s, output: 7.10 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:23<00:49,  6.88it/s, est. speed input: 7269.90 toks/s, output: 7.10 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:24<00:49,  6.86it/s, est. speed input: 7263.04 toks/s, output: 7.09 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:25<00:48,  6.88it/s, est. speed input: 7259.48 toks/s, output: 7.09 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:25<00:48,  6.87it/s, est. speed input: 7253.62 toks/s, output: 7.08 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:26<00:47,  6.88it/s, est. speed input: 7249.36 toks/s, output: 7.08 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:26<00:46,  6.86it/s, est. speed input: 7243.92 toks/s, output: 7.07 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:27<00:46,  6.86it/s, est. speed input: 7238.83 toks/s, output: 7.07 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:28<00:45,  6.88it/s, est. speed input: 7235.73 toks/s, output: 7.07 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:28<00:42,  7.34it/s, est. speed input: 7262.67 toks/s, output: 7.09 toks/s]
Processed prompts:  40%|████      | 206/512 [00:29<00:42,  7.20it/s, est. speed input: 7258.94 toks/s, output: 7.09 toks/s]
Processed prompts:  41%|████      | 210/512 [00:29<00:42,  7.09it/s, est. speed input: 7254.08 toks/s, output: 7.08 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:30<00:42,  7.03it/s, est. speed input: 7250.49 toks/s, output: 7.08 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:30<00:42,  6.88it/s, est. speed input: 7239.69 toks/s, output: 7.07 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:31<00:42,  6.88it/s, est. speed input: 7236.21 toks/s, output: 7.07 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:32<00:41,  6.86it/s, est. speed input: 7231.47 toks/s, output: 7.06 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:32<00:41,  6.87it/s, est. speed input: 7228.36 toks/s, output: 7.06 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:33<00:40,  6.85it/s, est. speed input: 7223.83 toks/s, output: 7.05 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:33<00:40,  6.85it/s, est. speed input: 7219.84 toks/s, output: 7.05 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:34<00:39,  6.86it/s, est. speed input: 7217.18 toks/s, output: 7.05 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:34<00:38,  6.87it/s, est. speed input: 7214.29 toks/s, output: 7.05 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:35<00:38,  6.88it/s, est. speed input: 7211.94 toks/s, output: 7.04 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:36<00:37,  6.87it/s, est. speed input: 7208.92 toks/s, output: 7.04 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:36<00:36,  6.89it/s, est. speed input: 7207.26 toks/s, output: 7.04 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:37<00:36,  6.88it/s, est. speed input: 7204.16 toks/s, output: 7.04 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:37<00:35,  6.88it/s, est. speed input: 7201.94 toks/s, output: 7.03 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:38<00:35,  6.87it/s, est. speed input: 7198.74 toks/s, output: 7.03 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:38<00:34,  6.86it/s, est. speed input: 7195.76 toks/s, output: 7.03 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:39<00:34,  6.86it/s, est. speed input: 7193.43 toks/s, output: 7.02 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:40<00:33,  6.85it/s, est. speed input: 7190.24 toks/s, output: 7.02 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:40<00:32,  6.85it/s, est. speed input: 7187.94 toks/s, output: 7.02 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:41<00:32,  6.85it/s, est. speed input: 7185.55 toks/s, output: 7.02 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:41<00:31,  6.86it/s, est. speed input: 7183.56 toks/s, output: 7.02 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:42<00:31,  6.85it/s, est. speed input: 7180.97 toks/s, output: 7.01 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:43<00:30,  6.87it/s, est. speed input: 7179.54 toks/s, output: 7.01 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:43<00:28,  7.33it/s, est. speed input: 7197.54 toks/s, output: 7.03 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:44<00:28,  7.20it/s, est. speed input: 7195.93 toks/s, output: 7.03 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:44<00:27,  7.09it/s, est. speed input: 7193.58 toks/s, output: 7.02 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:45<00:27,  7.02it/s, est. speed input: 7191.56 toks/s, output: 7.02 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:45<00:27,  6.97it/s, est. speed input: 7189.40 toks/s, output: 7.02 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:46<00:26,  6.93it/s, est. speed input: 7187.14 toks/s, output: 7.02 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:47<00:26,  6.92it/s, est. speed input: 7185.36 toks/s, output: 7.02 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:47<00:25,  6.88it/s, est. speed input: 7182.59 toks/s, output: 7.01 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:48<00:25,  6.87it/s, est. speed input: 7180.53 toks/s, output: 7.01 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:48<00:24,  6.85it/s, est. speed input: 7177.93 toks/s, output: 7.01 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:49<00:24,  6.87it/s, est. speed input: 7176.64 toks/s, output: 7.01 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:49<00:23,  6.86it/s, est. speed input: 7174.69 toks/s, output: 7.01 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:50<00:23,  6.86it/s, est. speed input: 7173.10 toks/s, output: 7.00 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:51<00:22,  6.85it/s, est. speed input: 7170.75 toks/s, output: 7.00 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:51<00:21,  6.84it/s, est. speed input: 7168.68 toks/s, output: 7.00 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:52<00:21,  6.86it/s, est. speed input: 7167.45 toks/s, output: 7.00 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:52<00:20,  6.84it/s, est. speed input: 7165.39 toks/s, output: 7.00 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:53<00:20,  6.85it/s, est. speed input: 7163.99 toks/s, output: 7.00 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:54<00:19,  6.84it/s, est. speed input: 7162.12 toks/s, output: 6.99 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:54<00:18,  6.86it/s, est. speed input: 7161.06 toks/s, output: 6.99 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:55<00:18,  6.85it/s, est. speed input: 7159.20 toks/s, output: 6.99 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:55<00:17,  6.86it/s, est. speed input: 7157.98 toks/s, output: 6.99 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:56<00:17,  6.84it/s, est. speed input: 7155.99 toks/s, output: 6.99 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:56<00:16,  6.84it/s, est. speed input: 7154.37 toks/s, output: 6.99 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:57<00:16,  6.84it/s, est. speed input: 7152.80 toks/s, output: 6.99 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:58<00:15,  6.83it/s, est. speed input: 7150.88 toks/s, output: 6.98 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:58<00:14,  6.84it/s, est. speed input: 7149.74 toks/s, output: 6.98 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:59<00:14,  6.83it/s, est. speed input: 7148.02 toks/s, output: 6.98 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:59<00:13,  6.85it/s, est. speed input: 7147.04 toks/s, output: 6.98 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:00<00:13,  6.83it/s, est. speed input: 7145.32 toks/s, output: 6.98 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:01<00:12,  6.83it/s, est. speed input: 7143.79 toks/s, output: 6.98 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:01<00:12,  6.82it/s, est. speed input: 7142.12 toks/s, output: 6.97 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:02<00:10,  7.31it/s, est. speed input: 7155.68 toks/s, output: 6.99 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:02<00:10,  7.16it/s, est. speed input: 7154.22 toks/s, output: 6.99 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:03<00:09,  7.01it/s, est. speed input: 7151.31 toks/s, output: 6.98 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:03<00:09,  6.97it/s, est. speed input: 7150.41 toks/s, output: 6.98 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:04<00:08,  6.92it/s, est. speed input: 7148.79 toks/s, output: 6.98 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:05<00:08,  6.92it/s, est. speed input: 7148.08 toks/s, output: 6.98 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:05<00:07,  6.89it/s, est. speed input: 7146.52 toks/s, output: 6.98 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:06<00:07,  6.88it/s, est. speed input: 7145.46 toks/s, output: 6.98 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:06<00:06,  6.85it/s, est. speed input: 7143.74 toks/s, output: 6.98 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:07<00:06,  6.86it/s, est. speed input: 7142.91 toks/s, output: 6.98 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:07<00:05,  6.86it/s, est. speed input: 7141.78 toks/s, output: 6.97 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:08<00:04,  6.84it/s, est. speed input: 7140.29 toks/s, output: 6.97 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:09<00:04,  6.86it/s, est. speed input: 7139.66 toks/s, output: 6.97 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:09<00:03,  6.84it/s, est. speed input: 7138.26 toks/s, output: 6.97 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:10<00:03,  6.86it/s, est. speed input: 7137.52 toks/s, output: 6.97 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:10<00:02,  6.84it/s, est. speed input: 7136.06 toks/s, output: 6.97 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:11<00:02,  6.85it/s, est. speed input: 7135.36 toks/s, output: 6.97 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:12<00:01,  6.83it/s, est. speed input: 7133.78 toks/s, output: 6.97 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:12<00:00,  6.85it/s, est. speed input: 7133.20 toks/s, output: 6.97 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:13<00:00,  7.33it/s, est. speed input: 7144.63 toks/s, output: 6.98 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:13<00:00,  7.33it/s, est. speed input: 7172.63 toks/s, output: 7.00 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:13<00:00,  7.00it/s, est. speed input: 7172.63 toks/s, output: 7.00 toks/s]
[rank0]:[W126 17:51:35.727443799 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 138.0s

测试结果:
  Requests/s:   6.89
  Tokens/s:     7058.18
  Total Reqs:   512
  Elapsed:      74.35s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     7051.29

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:51:47 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:51:47 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1567476) WARNING 01-26 17:52:44 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.63 requests/s, 6791.09 total tokens/s, 6.63 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 17:51:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:51:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:51:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:51:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:51:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:51:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:51:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:51:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:51:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:51:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:51:50] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:51:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:51:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:51:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:51:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:51:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:51:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1567476) [2026-01-26 17:51:52] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1567476) [2026-01-26 17:51:52] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1567476) [2026-01-26 17:51:52] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1567476) [2026-01-26 17:51:52] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1567476) [2026-01-26 17:51:52] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1567476) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1567476) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.09s/it]
(EngineCore_DP0 pid=1567476) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 20.99s/it]
(EngineCore_DP0 pid=1567476) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.00s/it]
(EngineCore_DP0 pid=1567476) 
(EngineCore_DP0 pid=1567476) 2026-01-26 17:52:41,252 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1567476) 2026-01-26 17:52:41,601 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 29/1024 [00:00<00:03, 285.15it/s]
Adding requests:   7%|▋         | 68/1024 [00:00<00:02, 346.21it/s]
Adding requests:  10%|█         | 104/1024 [00:00<00:02, 346.97it/s]
Adding requests:  14%|█▎        | 140/1024 [00:00<00:02, 347.00it/s]
Adding requests:  17%|█▋        | 177/1024 [00:00<00:02, 350.14it/s]
Adding requests:  21%|██        | 216/1024 [00:00<00:02, 361.07it/s]
Adding requests:  25%|██▍       | 253/1024 [00:00<00:02, 358.88it/s]
Adding requests:  28%|██▊       | 290/1024 [00:00<00:02, 361.19it/s]
Adding requests:  32%|███▏      | 328/1024 [00:00<00:01, 366.00it/s]
Adding requests:  36%|███▌      | 367/1024 [00:01<00:01, 370.28it/s]
Adding requests:  40%|███▉      | 407/1024 [00:01<00:01, 376.04it/s]
Adding requests:  43%|████▎     | 445/1024 [00:01<00:01, 364.23it/s]
Adding requests:  47%|████▋     | 482/1024 [00:01<00:01, 364.32it/s]
Adding requests:  51%|█████     | 522/1024 [00:01<00:01, 374.30it/s]
Adding requests:  55%|█████▍    | 560/1024 [00:01<00:01, 360.19it/s]
Adding requests:  58%|█████▊    | 597/1024 [00:01<00:01, 354.42it/s]
Adding requests:  62%|██████▏   | 633/1024 [00:01<00:01, 353.56it/s]
Adding requests:  66%|██████▌   | 673/1024 [00:01<00:00, 366.35it/s]
Adding requests:  70%|███████   | 720/1024 [00:01<00:00, 392.72it/s]
Adding requests:  74%|███████▍  | 762/1024 [00:02<00:00, 399.67it/s]
Adding requests:  79%|███████▉  | 807/1024 [00:02<00:00, 411.78it/s]
Adding requests:  83%|████████▎ | 850/1024 [00:02<00:00, 415.42it/s]
Adding requests:  88%|████████▊ | 896/1024 [00:02<00:00, 426.15it/s]
Adding requests:  92%|█████████▏| 940/1024 [00:02<00:00, 429.47it/s]
Adding requests:  96%|█████████▌| 983/1024 [00:02<00:00, 429.18it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 382.50it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:01<01:04, 15.65it/s, est. speed input: 16023.19 toks/s, output: 15.65 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:02<01:37, 10.22it/s, est. speed input: 11279.37 toks/s, output: 11.01 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:03<01:55,  8.59it/s, est. speed input: 9777.78 toks/s, output: 9.55 toks/s]  
Processed prompts:   4%|▍         | 42/1024 [00:04<02:05,  7.82it/s, est. speed input: 9030.98 toks/s, output: 8.82 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:05<02:11,  7.39it/s, est. speed input: 8578.22 toks/s, output: 8.38 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:07<02:15,  7.14it/s, est. speed input: 8280.03 toks/s, output: 8.09 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:08<02:17,  6.97it/s, est. speed input: 8064.52 toks/s, output: 7.88 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:09<02:18,  6.86it/s, est. speed input: 7905.18 toks/s, output: 7.72 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:10<02:18,  6.79it/s, est. speed input: 7778.98 toks/s, output: 7.60 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:12<02:18,  6.73it/s, est. speed input: 7677.16 toks/s, output: 7.50 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:13<02:18,  6.70it/s, est. speed input: 7596.28 toks/s, output: 7.42 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:14<02:17,  6.68it/s, est. speed input: 7529.14 toks/s, output: 7.35 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:15<02:16,  6.67it/s, est. speed input: 7472.72 toks/s, output: 7.30 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:16<02:15,  6.66it/s, est. speed input: 7423.87 toks/s, output: 7.25 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:18<02:14,  6.65it/s, est. speed input: 7381.13 toks/s, output: 7.21 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:19<02:13,  6.64it/s, est. speed input: 7344.23 toks/s, output: 7.17 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:20<02:12,  6.63it/s, est. speed input: 7309.48 toks/s, output: 7.14 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:21<02:11,  6.62it/s, est. speed input: 7278.93 toks/s, output: 7.11 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:22<02:10,  6.62it/s, est. speed input: 7252.33 toks/s, output: 7.08 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:24<02:09,  6.62it/s, est. speed input: 7228.36 toks/s, output: 7.06 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:25<02:07,  6.62it/s, est. speed input: 7206.42 toks/s, output: 7.04 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:26<02:06,  6.62it/s, est. speed input: 7186.63 toks/s, output: 7.02 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:27<02:05,  6.62it/s, est. speed input: 7169.41 toks/s, output: 7.00 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:28<01:59,  6.86it/s, est. speed input: 7188.37 toks/s, output: 7.02 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:29<02:00,  6.78it/s, est. speed input: 7170.43 toks/s, output: 7.00 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:31<01:59,  6.73it/s, est. speed input: 7155.01 toks/s, output: 6.99 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:32<01:59,  6.69it/s, est. speed input: 7140.32 toks/s, output: 6.97 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:33<01:58,  6.67it/s, est. speed input: 7127.03 toks/s, output: 6.96 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:34<01:57,  6.65it/s, est. speed input: 7114.99 toks/s, output: 6.95 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:36<01:56,  6.64it/s, est. speed input: 7103.58 toks/s, output: 6.94 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:37<01:55,  6.63it/s, est. speed input: 7092.94 toks/s, output: 6.93 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:38<01:54,  6.62it/s, est. speed input: 7082.21 toks/s, output: 6.92 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:39<01:53,  6.62it/s, est. speed input: 7073.10 toks/s, output: 6.91 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:40<01:52,  6.62it/s, est. speed input: 7064.21 toks/s, output: 6.90 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:42<01:50,  6.62it/s, est. speed input: 7056.25 toks/s, output: 6.89 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:43<01:49,  6.62it/s, est. speed input: 7048.27 toks/s, output: 6.88 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:44<01:44,  6.86it/s, est. speed input: 7063.09 toks/s, output: 6.90 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:45<01:44,  6.78it/s, est. speed input: 7055.52 toks/s, output: 6.89 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:46<01:44,  6.72it/s, est. speed input: 7047.50 toks/s, output: 6.88 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:47<01:43,  6.69it/s, est. speed input: 7040.35 toks/s, output: 6.88 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:49<01:42,  6.66it/s, est. speed input: 7033.64 toks/s, output: 6.87 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:50<01:42,  6.65it/s, est. speed input: 7027.06 toks/s, output: 6.86 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:51<01:41,  6.63it/s, est. speed input: 7020.77 toks/s, output: 6.86 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:52<01:39,  6.62it/s, est. speed input: 7014.80 toks/s, output: 6.85 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:54<01:38,  6.61it/s, est. speed input: 7008.78 toks/s, output: 6.84 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:55<01:37,  6.61it/s, est. speed input: 7003.33 toks/s, output: 6.84 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:56<01:36,  6.61it/s, est. speed input: 6998.00 toks/s, output: 6.83 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:57<01:35,  6.60it/s, est. speed input: 6993.03 toks/s, output: 6.83 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:58<01:34,  6.60it/s, est. speed input: 6987.95 toks/s, output: 6.82 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:00<01:33,  6.60it/s, est. speed input: 6983.46 toks/s, output: 6.82 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:01<01:31,  6.60it/s, est. speed input: 6978.80 toks/s, output: 6.82 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:02<01:30,  6.60it/s, est. speed input: 6974.84 toks/s, output: 6.81 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:03<01:26,  6.85it/s, est. speed input: 6986.46 toks/s, output: 6.82 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:04<01:26,  6.76it/s, est. speed input: 6981.56 toks/s, output: 6.82 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:06<01:25,  6.71it/s, est. speed input: 6977.46 toks/s, output: 6.81 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:07<01:24,  6.68it/s, est. speed input: 6973.48 toks/s, output: 6.81 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:08<01:23,  6.65it/s, est. speed input: 6969.33 toks/s, output: 6.81 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:09<01:22,  6.63it/s, est. speed input: 6965.65 toks/s, output: 6.80 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:10<01:21,  6.63it/s, est. speed input: 6962.22 toks/s, output: 6.80 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:12<01:20,  6.62it/s, est. speed input: 6958.82 toks/s, output: 6.80 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:13<01:19,  6.60it/s, est. speed input: 6955.05 toks/s, output: 6.79 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:14<01:18,  6.60it/s, est. speed input: 6951.68 toks/s, output: 6.79 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:15<01:17,  6.60it/s, est. speed input: 6948.54 toks/s, output: 6.79 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:16<01:16,  6.60it/s, est. speed input: 6945.63 toks/s, output: 6.78 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:18<01:14,  6.60it/s, est. speed input: 6942.82 toks/s, output: 6.78 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:19<01:13,  6.60it/s, est. speed input: 6940.07 toks/s, output: 6.78 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:20<01:12,  6.60it/s, est. speed input: 6937.34 toks/s, output: 6.77 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:21<01:11,  6.59it/s, est. speed input: 6934.23 toks/s, output: 6.77 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:23<01:10,  6.60it/s, est. speed input: 6931.71 toks/s, output: 6.77 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:24<01:08,  6.60it/s, est. speed input: 6929.39 toks/s, output: 6.77 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:25<01:07,  6.60it/s, est. speed input: 6926.89 toks/s, output: 6.76 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:26<01:06,  6.60it/s, est. speed input: 6924.41 toks/s, output: 6.76 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:27<01:05,  6.60it/s, est. speed input: 6922.25 toks/s, output: 6.76 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:29<01:03,  6.60it/s, est. speed input: 6920.00 toks/s, output: 6.76 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:30<01:02,  6.59it/s, est. speed input: 6917.54 toks/s, output: 6.76 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:31<01:01,  6.60it/s, est. speed input: 6915.45 toks/s, output: 6.75 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:32<01:00,  6.59it/s, est. speed input: 6913.23 toks/s, output: 6.75 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:33<00:59,  6.59it/s, est. speed input: 6911.13 toks/s, output: 6.75 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:35<00:57,  6.60it/s, est. speed input: 6909.28 toks/s, output: 6.75 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:36<00:56,  6.60it/s, est. speed input: 6907.48 toks/s, output: 6.75 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:37<00:55,  6.61it/s, est. speed input: 6905.91 toks/s, output: 6.74 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:38<00:54,  6.59it/s, est. speed input: 6903.58 toks/s, output: 6.74 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:39<00:53,  6.60it/s, est. speed input: 6901.87 toks/s, output: 6.74 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:41<00:51,  6.60it/s, est. speed input: 6900.16 toks/s, output: 6.74 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:42<00:50,  6.60it/s, est. speed input: 6898.36 toks/s, output: 6.74 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:43<00:49,  6.60it/s, est. speed input: 6896.69 toks/s, output: 6.74 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:44<00:48,  6.60it/s, est. speed input: 6895.15 toks/s, output: 6.73 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [01:46<00:46,  6.60it/s, est. speed input: 6893.47 toks/s, output: 6.73 toks/s]
Processed prompts:  71%|███████   | 722/1024 [01:47<00:45,  6.59it/s, est. speed input: 6891.62 toks/s, output: 6.73 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [01:48<00:44,  6.59it/s, est. speed input: 6890.15 toks/s, output: 6.73 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [01:49<00:43,  6.59it/s, est. speed input: 6888.55 toks/s, output: 6.73 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [01:50<00:42,  6.59it/s, est. speed input: 6887.03 toks/s, output: 6.73 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [01:52<00:40,  6.60it/s, est. speed input: 6885.76 toks/s, output: 6.72 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [01:53<00:39,  6.60it/s, est. speed input: 6884.32 toks/s, output: 6.72 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [01:54<00:38,  6.60it/s, est. speed input: 6882.92 toks/s, output: 6.72 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [01:55<00:37,  6.59it/s, est. speed input: 6881.21 toks/s, output: 6.72 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [01:56<00:34,  6.83it/s, est. speed input: 6888.20 toks/s, output: 6.73 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [01:58<00:34,  6.76it/s, est. speed input: 6887.00 toks/s, output: 6.73 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [01:59<00:33,  6.70it/s, est. speed input: 6885.45 toks/s, output: 6.72 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:00<00:32,  6.67it/s, est. speed input: 6884.19 toks/s, output: 6.72 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:01<00:30,  6.66it/s, est. speed input: 6883.14 toks/s, output: 6.72 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:02<00:29,  6.64it/s, est. speed input: 6881.85 toks/s, output: 6.72 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:04<00:28,  6.63it/s, est. speed input: 6880.63 toks/s, output: 6.72 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:05<00:27,  6.62it/s, est. speed input: 6879.39 toks/s, output: 6.72 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:06<00:26,  6.61it/s, est. speed input: 6878.09 toks/s, output: 6.72 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:07<00:25,  6.60it/s, est. speed input: 6876.90 toks/s, output: 6.72 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:08<00:23,  6.60it/s, est. speed input: 6875.74 toks/s, output: 6.71 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:10<00:22,  6.60it/s, est. speed input: 6874.56 toks/s, output: 6.71 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:11<00:21,  6.60it/s, est. speed input: 6873.46 toks/s, output: 6.71 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:12<00:20,  6.59it/s, est. speed input: 6872.24 toks/s, output: 6.71 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:13<00:19,  6.60it/s, est. speed input: 6871.34 toks/s, output: 6.71 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:15<00:17,  6.60it/s, est. speed input: 6870.26 toks/s, output: 6.71 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:16<00:16,  6.60it/s, est. speed input: 6869.20 toks/s, output: 6.71 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:17<00:15,  6.60it/s, est. speed input: 6868.25 toks/s, output: 6.71 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:18<00:14,  6.60it/s, est. speed input: 6867.36 toks/s, output: 6.71 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:19<00:13,  6.60it/s, est. speed input: 6866.27 toks/s, output: 6.71 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:21<00:11,  6.59it/s, est. speed input: 6865.11 toks/s, output: 6.70 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:22<00:10,  6.59it/s, est. speed input: 6864.26 toks/s, output: 6.70 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:23<00:09,  6.59it/s, est. speed input: 6863.15 toks/s, output: 6.70 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:24<00:08,  6.59it/s, est. speed input: 6862.07 toks/s, output: 6.70 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:25<00:06,  6.59it/s, est. speed input: 6861.15 toks/s, output: 6.70 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:27<00:05,  6.59it/s, est. speed input: 6860.22 toks/s, output: 6.70 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:28<00:04,  6.59it/s, est. speed input: 6859.24 toks/s, output: 6.70 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:29<00:03,  6.58it/s, est. speed input: 6858.25 toks/s, output: 6.70 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:30<00:02,  6.59it/s, est. speed input: 6857.47 toks/s, output: 6.70 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:31<00:00,  6.86it/s, est. speed input: 6863.68 toks/s, output: 6.70 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:31<00:00,  6.86it/s, est. speed input: 6904.12 toks/s, output: 6.74 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:31<00:00,  6.74it/s, est. speed input: 6904.12 toks/s, output: 6.74 toks/s]
[rank0]:[W126 17:55:18.082351443 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 223.3s

测试结果:
  Requests/s:   6.63
  Tokens/s:     6791.09
  Total Reqs:   1024
  Elapsed:      154.56s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     6784.47

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 17:55:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 17:55:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1570764) WARNING 01-26 17:56:31 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.64 requests/s, 6802.10 total tokens/s, 6.64 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 17:55:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:55:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:55:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:55:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:55:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:55:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:55:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:55:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 17:55:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 17:55:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:55:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 17:55:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 17:55:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 17:55:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 17:55:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 17:55:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 17:55:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1570764) [2026-01-26 17:55:36] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1570764) [2026-01-26 17:55:36] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1570764) [2026-01-26 17:55:36] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1570764) [2026-01-26 17:55:36] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1570764) [2026-01-26 17:55:36] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1570764) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1570764) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.47s/it]
(EngineCore_DP0 pid=1570764) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.29s/it]
(EngineCore_DP0 pid=1570764) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.32s/it]
(EngineCore_DP0 pid=1570764) 
(EngineCore_DP0 pid=1570764) 2026-01-26 17:56:26,709 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1570764) 2026-01-26 17:56:27,118 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 28/2048 [00:00<00:07, 277.01it/s]
Adding requests:   3%|▎         | 70/2048 [00:00<00:05, 354.30it/s]
Adding requests:   5%|▌         | 107/2048 [00:00<00:05, 359.23it/s]
Adding requests:   7%|▋         | 149/2048 [00:00<00:05, 378.34it/s]
Adding requests:   9%|▉         | 194/2048 [00:00<00:04, 401.17it/s]
Adding requests:  12%|█▏        | 238/2048 [00:00<00:04, 413.33it/s]
Adding requests:  14%|█▎        | 280/2048 [00:00<00:04, 410.68it/s]
Adding requests:  16%|█▌        | 325/2048 [00:00<00:04, 422.11it/s]
Adding requests:  18%|█▊        | 372/2048 [00:00<00:03, 435.23it/s]
Adding requests:  21%|██        | 420/2048 [00:01<00:03, 447.06it/s]
Adding requests:  23%|██▎       | 465/2048 [00:01<00:03, 445.37it/s]
Adding requests:  25%|██▍       | 510/2048 [00:01<00:03, 439.23it/s]
Adding requests:  27%|██▋       | 557/2048 [00:01<00:03, 445.98it/s]
Adding requests:  29%|██▉       | 602/2048 [00:01<00:03, 437.05it/s]
Adding requests:  32%|███▏      | 646/2048 [00:01<00:03, 433.90it/s]
Adding requests:  34%|███▎      | 690/2048 [00:01<00:03, 434.24it/s]
Adding requests:  36%|███▌      | 734/2048 [00:01<00:03, 423.65it/s]
Adding requests:  38%|███▊      | 777/2048 [00:01<00:03, 414.92it/s]
Adding requests:  40%|████      | 820/2048 [00:01<00:02, 417.46it/s]
Adding requests:  42%|████▏     | 862/2048 [00:02<00:06, 190.81it/s]
Adding requests:  44%|████▍     | 904/2048 [00:02<00:05, 226.82it/s]
Adding requests:  46%|████▌     | 944/2048 [00:02<00:04, 258.17it/s]
Adding requests:  48%|████▊     | 986/2048 [00:02<00:03, 290.30it/s]
Adding requests:  50%|█████     | 1029/2048 [00:02<00:03, 321.21it/s]
Adding requests:  52%|█████▏    | 1072/2048 [00:02<00:02, 345.23it/s]
Adding requests:  54%|█████▍    | 1116/2048 [00:03<00:02, 367.63it/s]
Adding requests:  57%|█████▋    | 1160/2048 [00:03<00:02, 385.99it/s]
Adding requests:  59%|█████▉    | 1205/2048 [00:03<00:02, 403.56it/s]
Adding requests:  61%|██████    | 1249/2048 [00:03<00:01, 413.09it/s]
Adding requests:  63%|██████▎   | 1292/2048 [00:03<00:01, 417.03it/s]
Adding requests:  65%|██████▌   | 1335/2048 [00:03<00:01, 417.83it/s]
Adding requests:  67%|██████▋   | 1378/2048 [00:03<00:01, 421.38it/s]
Adding requests:  69%|██████▉   | 1422/2048 [00:03<00:01, 426.69it/s]
Adding requests:  72%|███████▏  | 1466/2048 [00:03<00:01, 429.83it/s]
Adding requests:  74%|███████▍  | 1511/2048 [00:03<00:01, 433.70it/s]
Adding requests:  76%|███████▌  | 1555/2048 [00:04<00:01, 431.73it/s]
Adding requests:  78%|███████▊  | 1599/2048 [00:04<00:01, 428.20it/s]
Adding requests:  80%|████████  | 1642/2048 [00:04<00:00, 427.37it/s]
Adding requests:  82%|████████▏ | 1685/2048 [00:04<00:00, 425.64it/s]
Adding requests:  84%|████████▍ | 1728/2048 [00:04<00:00, 415.66it/s]
Adding requests:  87%|████████▋ | 1772/2048 [00:04<00:00, 421.17it/s]
Adding requests:  89%|████████▊ | 1815/2048 [00:04<00:00, 419.00it/s]
Adding requests:  91%|█████████ | 1859/2048 [00:04<00:00, 422.57it/s]
Adding requests:  93%|█████████▎| 1904/2048 [00:04<00:00, 429.84it/s]
Adding requests:  95%|█████████▌| 1948/2048 [00:05<00:00, 430.22it/s]
Adding requests:  97%|█████████▋| 1992/2048 [00:05<00:00, 423.45it/s]
Adding requests:  99%|█████████▉| 2035/2048 [00:05<00:00, 394.08it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 387.38it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:02<02:08, 15.69it/s, est. speed input: 16068.78 toks/s, output: 15.69 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:04<03:16, 10.16it/s, est. speed input: 11212.81 toks/s, output: 10.95 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:06<03:52,  8.51it/s, est. speed input: 9687.96 toks/s, output: 9.46 toks/s]  
Processed prompts:   4%|▍         | 82/2048 [00:09<04:12,  7.77it/s, est. speed input: 8953.73 toks/s, output: 8.74 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:11<04:24,  7.37it/s, est. speed input: 8516.19 toks/s, output: 8.32 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:14<04:31,  7.12it/s, est. speed input: 8225.35 toks/s, output: 8.03 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:16<04:35,  6.96it/s, est. speed input: 8015.74 toks/s, output: 7.83 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:19<04:37,  6.85it/s, est. speed input: 7860.81 toks/s, output: 7.68 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:21<04:38,  6.78it/s, est. speed input: 7739.90 toks/s, output: 7.56 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:23<04:37,  6.73it/s, est. speed input: 7640.99 toks/s, output: 7.46 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:26<04:35,  6.72it/s, est. speed input: 7569.61 toks/s, output: 7.39 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:28<04:34,  6.69it/s, est. speed input: 7502.18 toks/s, output: 7.33 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:31<04:33,  6.66it/s, est. speed input: 7444.83 toks/s, output: 7.27 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:33<04:31,  6.65it/s, est. speed input: 7396.08 toks/s, output: 7.22 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:35<04:29,  6.63it/s, est. speed input: 7352.68 toks/s, output: 7.18 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:38<04:28,  6.62it/s, est. speed input: 7314.46 toks/s, output: 7.14 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:40<04:25,  6.62it/s, est. speed input: 7281.86 toks/s, output: 7.11 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:43<04:18,  6.73it/s, est. speed input: 7277.12 toks/s, output: 7.11 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:45<04:17,  6.69it/s, est. speed input: 7249.42 toks/s, output: 7.08 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:47<04:16,  6.66it/s, est. speed input: 7224.31 toks/s, output: 7.05 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:50<04:15,  6.64it/s, est. speed input: 7200.81 toks/s, output: 7.03 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:52<04:13,  6.63it/s, est. speed input: 7180.77 toks/s, output: 7.01 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:55<04:11,  6.62it/s, est. speed input: 7162.24 toks/s, output: 6.99 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:57<04:08,  6.61it/s, est. speed input: 7145.15 toks/s, output: 6.98 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:00<04:07,  6.59it/s, est. speed input: 7126.29 toks/s, output: 6.96 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:02<04:00,  6.71it/s, est. speed input: 7127.76 toks/s, output: 6.96 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:04<03:59,  6.67it/s, est. speed input: 7113.92 toks/s, output: 6.95 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:07<03:58,  6.64it/s, est. speed input: 7099.99 toks/s, output: 6.93 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:09<03:56,  6.63it/s, est. speed input: 7088.24 toks/s, output: 6.92 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:12<03:54,  6.62it/s, est. speed input: 7077.07 toks/s, output: 6.91 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:14<03:51,  6.61it/s, est. speed input: 7066.53 toks/s, output: 6.90 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:16<03:49,  6.60it/s, est. speed input: 7056.21 toks/s, output: 6.89 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:19<03:47,  6.60it/s, est. speed input: 7046.98 toks/s, output: 6.88 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:21<03:45,  6.60it/s, est. speed input: 7038.14 toks/s, output: 6.87 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:24<03:42,  6.59it/s, est. speed input: 7029.39 toks/s, output: 6.86 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:26<03:40,  6.59it/s, est. speed input: 7021.69 toks/s, output: 6.86 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:29<03:38,  6.59it/s, est. speed input: 7014.40 toks/s, output: 6.85 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:31<03:35,  6.59it/s, est. speed input: 7006.67 toks/s, output: 6.84 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:33<03:33,  6.59it/s, est. speed input: 7000.16 toks/s, output: 6.84 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:36<03:30,  6.59it/s, est. speed input: 6994.07 toks/s, output: 6.83 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:38<03:28,  6.59it/s, est. speed input: 6988.30 toks/s, output: 6.82 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:41<03:26,  6.59it/s, est. speed input: 6982.17 toks/s, output: 6.82 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:43<03:23,  6.59it/s, est. speed input: 6977.04 toks/s, output: 6.81 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:46<03:21,  6.59it/s, est. speed input: 6971.96 toks/s, output: 6.81 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [01:48<03:18,  6.59it/s, est. speed input: 6966.64 toks/s, output: 6.80 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [01:50<03:16,  6.59it/s, est. speed input: 6962.03 toks/s, output: 6.80 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [01:53<03:13,  6.59it/s, est. speed input: 6957.59 toks/s, output: 6.79 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [01:55<03:07,  6.72it/s, est. speed input: 6962.16 toks/s, output: 6.80 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [01:58<03:06,  6.67it/s, est. speed input: 6957.05 toks/s, output: 6.79 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:00<03:05,  6.64it/s, est. speed input: 6952.60 toks/s, output: 6.79 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:02<03:03,  6.62it/s, est. speed input: 6948.53 toks/s, output: 6.79 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:05<03:01,  6.61it/s, est. speed input: 6944.40 toks/s, output: 6.78 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:07<02:58,  6.60it/s, est. speed input: 6940.67 toks/s, output: 6.78 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:10<02:56,  6.60it/s, est. speed input: 6937.18 toks/s, output: 6.77 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:12<02:54,  6.60it/s, est. speed input: 6933.75 toks/s, output: 6.77 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:15<02:52,  6.59it/s, est. speed input: 6930.10 toks/s, output: 6.77 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:17<02:49,  6.59it/s, est. speed input: 6926.72 toks/s, output: 6.76 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:19<02:47,  6.59it/s, est. speed input: 6923.57 toks/s, output: 6.76 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:22<02:45,  6.58it/s, est. speed input: 6920.13 toks/s, output: 6.76 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:24<02:42,  6.58it/s, est. speed input: 6917.20 toks/s, output: 6.76 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:27<02:40,  6.58it/s, est. speed input: 6914.34 toks/s, output: 6.75 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:29<02:37,  6.58it/s, est. speed input: 6911.44 toks/s, output: 6.75 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:32<02:35,  6.58it/s, est. speed input: 6908.65 toks/s, output: 6.75 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:34<02:32,  6.58it/s, est. speed input: 6906.18 toks/s, output: 6.74 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:36<02:30,  6.58it/s, est. speed input: 6903.48 toks/s, output: 6.74 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [02:39<02:28,  6.58it/s, est. speed input: 6900.69 toks/s, output: 6.74 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [02:41<02:25,  6.58it/s, est. speed input: 6898.32 toks/s, output: 6.74 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [02:44<02:23,  6.58it/s, est. speed input: 6896.14 toks/s, output: 6.73 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [02:46<02:20,  6.58it/s, est. speed input: 6893.74 toks/s, output: 6.73 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [02:49<02:18,  6.58it/s, est. speed input: 6891.74 toks/s, output: 6.73 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [02:51<02:15,  6.59it/s, est. speed input: 6889.70 toks/s, output: 6.73 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [02:53<02:13,  6.58it/s, est. speed input: 6887.58 toks/s, output: 6.73 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [02:56<02:11,  6.58it/s, est. speed input: 6885.22 toks/s, output: 6.72 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [02:58<02:06,  6.70it/s, est. speed input: 6888.78 toks/s, output: 6.73 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:01<02:04,  6.66it/s, est. speed input: 6886.71 toks/s, output: 6.73 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:03<02:00,  6.76it/s, est. speed input: 6890.16 toks/s, output: 6.73 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:05<01:59,  6.70it/s, est. speed input: 6888.02 toks/s, output: 6.73 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:08<01:57,  6.66it/s, est. speed input: 6886.08 toks/s, output: 6.72 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:10<01:55,  6.64it/s, est. speed input: 6884.10 toks/s, output: 6.72 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:13<01:53,  6.61it/s, est. speed input: 6882.02 toks/s, output: 6.72 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:15<01:51,  6.60it/s, est. speed input: 6880.28 toks/s, output: 6.72 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:17<01:46,  6.72it/s, est. speed input: 6883.55 toks/s, output: 6.72 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:20<01:45,  6.68it/s, est. speed input: 6881.79 toks/s, output: 6.72 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:22<01:43,  6.65it/s, est. speed input: 6880.01 toks/s, output: 6.72 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:25<01:41,  6.63it/s, est. speed input: 6878.30 toks/s, output: 6.72 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:27<01:38,  6.61it/s, est. speed input: 6876.48 toks/s, output: 6.72 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:30<01:36,  6.60it/s, est. speed input: 6874.78 toks/s, output: 6.71 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [03:32<01:34,  6.59it/s, est. speed input: 6873.04 toks/s, output: 6.71 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [03:34<01:30,  6.71it/s, est. speed input: 6876.26 toks/s, output: 6.72 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [03:37<01:26,  6.79it/s, est. speed input: 6879.23 toks/s, output: 6.72 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [03:39<01:25,  6.73it/s, est. speed input: 6877.73 toks/s, output: 6.72 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [03:41<01:23,  6.68it/s, est. speed input: 6876.11 toks/s, output: 6.71 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [03:44<01:21,  6.65it/s, est. speed input: 6874.65 toks/s, output: 6.71 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [03:46<01:17,  6.75it/s, est. speed input: 6877.60 toks/s, output: 6.72 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [03:49<01:16,  6.70it/s, est. speed input: 6875.99 toks/s, output: 6.71 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [03:51<01:12,  6.78it/s, est. speed input: 6878.85 toks/s, output: 6.72 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [03:53<01:11,  6.72it/s, est. speed input: 6877.34 toks/s, output: 6.72 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [03:56<01:09,  6.68it/s, est. speed input: 6875.93 toks/s, output: 6.71 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [03:58<01:07,  6.64it/s, est. speed input: 6874.30 toks/s, output: 6.71 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:00<01:03,  6.74it/s, est. speed input: 6876.85 toks/s, output: 6.72 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:03<01:01,  6.69it/s, est. speed input: 6875.44 toks/s, output: 6.71 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:05<00:59,  6.66it/s, est. speed input: 6874.11 toks/s, output: 6.71 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:08<00:57,  6.63it/s, est. speed input: 6872.58 toks/s, output: 6.71 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:10<00:55,  6.61it/s, est. speed input: 6871.31 toks/s, output: 6.71 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:13<00:52,  6.60it/s, est. speed input: 6870.04 toks/s, output: 6.71 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [04:15<00:50,  6.59it/s, est. speed input: 6868.53 toks/s, output: 6.71 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [04:17<00:47,  6.71it/s, est. speed input: 6871.24 toks/s, output: 6.71 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [04:19<00:43,  6.92it/s, est. speed input: 6877.74 toks/s, output: 6.72 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [04:22<00:41,  6.82it/s, est. speed input: 6876.43 toks/s, output: 6.72 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [04:24<00:40,  6.75it/s, est. speed input: 6875.20 toks/s, output: 6.71 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [04:27<00:37,  6.69it/s, est. speed input: 6873.84 toks/s, output: 6.71 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [04:29<00:35,  6.66it/s, est. speed input: 6872.58 toks/s, output: 6.71 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [04:32<00:33,  6.63it/s, est. speed input: 6871.38 toks/s, output: 6.71 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [04:34<00:31,  6.61it/s, est. speed input: 6869.98 toks/s, output: 6.71 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [04:36<00:28,  6.60it/s, est. speed input: 6868.80 toks/s, output: 6.71 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [04:39<00:26,  6.59it/s, est. speed input: 6867.61 toks/s, output: 6.71 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [04:41<00:23,  6.71it/s, est. speed input: 6870.06 toks/s, output: 6.71 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [04:44<00:21,  6.66it/s, est. speed input: 6868.73 toks/s, output: 6.71 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [04:46<00:18,  6.64it/s, est. speed input: 6867.60 toks/s, output: 6.71 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [04:49<00:16,  6.62it/s, est. speed input: 6866.47 toks/s, output: 6.71 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [04:51<00:14,  6.60it/s, est. speed input: 6865.21 toks/s, output: 6.70 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [04:53<00:11,  6.59it/s, est. speed input: 6864.11 toks/s, output: 6.70 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [04:56<00:09,  6.71it/s, est. speed input: 6866.39 toks/s, output: 6.71 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [04:58<00:06,  6.67it/s, est. speed input: 6865.32 toks/s, output: 6.70 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:01<00:04,  6.64it/s, est. speed input: 6864.17 toks/s, output: 6.70 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:03<00:02,  6.75it/s, est. speed input: 6866.68 toks/s, output: 6.71 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:03<00:00,  6.75it/s, est. speed input: 6913.94 toks/s, output: 6.75 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:03<00:00,  6.75it/s, est. speed input: 6913.94 toks/s, output: 6.75 toks/s]
[rank0]:[W126 18:01:40.246059190 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 381.1s

测试结果:
  Requests/s:   6.64
  Tokens/s:     6802.10
  Total Reqs:   2048
  Elapsed:      308.61s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     6795.46

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:02:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:02:00 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1576277) WARNING 01-26 18:03:04 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.64 requests/s, 6807.21 total tokens/s, 6.64 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 18:02:00] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:02:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:02:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:02:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:02:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:02:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:02:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:02:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:02:03] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:02:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:02:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:02:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:02:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:02:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:02:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:02:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:02:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1576277) [2026-01-26 18:02:04] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1576277) [2026-01-26 18:02:04] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1576277) [2026-01-26 18:02:04] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1576277) [2026-01-26 18:02:04] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1576277) [2026-01-26 18:02:04] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1576277) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1576277) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.14s/it]
(EngineCore_DP0 pid=1576277) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.05s/it]
(EngineCore_DP0 pid=1576277) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.07s/it]
(EngineCore_DP0 pid=1576277) 
(EngineCore_DP0 pid=1576277) 2026-01-26 18:02:57,081 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1576277) 2026-01-26 18:02:58,072 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 42/4096 [00:00<00:09, 413.44it/s]
Adding requests:   2%|▏         | 86/4096 [00:00<00:09, 426.43it/s]
Adding requests:   3%|▎         | 129/4096 [00:00<00:09, 410.98it/s]
Adding requests:   4%|▍         | 171/4096 [00:00<00:09, 397.92it/s]
Adding requests:   5%|▌         | 215/4096 [00:00<00:09, 411.49it/s]
Adding requests:   6%|▋         | 257/4096 [00:00<00:09, 412.18it/s]
Adding requests:   7%|▋         | 300/4096 [00:00<00:09, 416.11it/s]
Adding requests:   8%|▊         | 346/4096 [00:00<00:08, 429.16it/s]
Adding requests:   9%|▉         | 389/4096 [00:00<00:08, 429.29it/s]
Adding requests:  11%|█         | 436/4096 [00:01<00:08, 440.52it/s]
Adding requests:  12%|█▏        | 481/4096 [00:01<00:08, 439.28it/s]
Adding requests:  13%|█▎        | 527/4096 [00:01<00:08, 445.02it/s]
Adding requests:  14%|█▍        | 574/4096 [00:01<00:07, 451.77it/s]
Adding requests:  15%|█▌        | 620/4096 [00:01<00:08, 427.33it/s]
Adding requests:  16%|█▌        | 664/4096 [00:01<00:08, 428.93it/s]
Adding requests:  17%|█▋        | 708/4096 [00:01<00:07, 431.13it/s]
Adding requests:  18%|█▊        | 752/4096 [00:01<00:07, 424.65it/s]
Adding requests:  20%|█▉        | 800/4096 [00:01<00:07, 435.38it/s]
Adding requests:  21%|██        | 844/4096 [00:01<00:07, 428.71it/s]
Adding requests:  22%|██▏       | 890/4096 [00:02<00:07, 434.89it/s]
Adding requests:  23%|██▎       | 934/4096 [00:02<00:07, 430.46it/s]
Adding requests:  24%|██▍       | 978/4096 [00:02<00:07, 431.88it/s]
Adding requests:  25%|██▍       | 1023/4096 [00:02<00:07, 435.55it/s]
Adding requests:  26%|██▌       | 1067/4096 [00:02<00:07, 423.31it/s]
Adding requests:  27%|██▋       | 1110/4096 [00:02<00:07, 423.86it/s]
Adding requests:  28%|██▊       | 1154/4096 [00:02<00:06, 426.26it/s]
Adding requests:  29%|██▉       | 1197/4096 [00:02<00:06, 417.43it/s]
Adding requests:  30%|███       | 1243/4096 [00:02<00:06, 425.84it/s]
Adding requests:  31%|███▏      | 1286/4096 [00:03<00:06, 417.90it/s]
Adding requests:  32%|███▏      | 1330/4096 [00:03<00:06, 421.37it/s]
Adding requests:  34%|███▎      | 1377/4096 [00:03<00:06, 434.79it/s]
Adding requests:  35%|███▍      | 1421/4096 [00:03<00:06, 427.60it/s]
Adding requests:  36%|███▌      | 1468/4096 [00:03<00:06, 436.34it/s]
Adding requests:  37%|███▋      | 1512/4096 [00:03<00:05, 433.08it/s]
Adding requests:  38%|███▊      | 1556/4096 [00:03<00:06, 421.74it/s]
Adding requests:  39%|███▉      | 1599/4096 [00:03<00:05, 423.92it/s]
Adding requests:  40%|████      | 1642/4096 [00:03<00:05, 417.68it/s]
Adding requests:  41%|████      | 1686/4096 [00:03<00:05, 422.36it/s]
Adding requests:  42%|████▏     | 1729/4096 [00:04<00:05, 417.67it/s]
Adding requests:  43%|████▎     | 1774/4096 [00:04<00:05, 425.62it/s]
Adding requests:  44%|████▍     | 1817/4096 [00:04<00:05, 423.66it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:04<00:05, 425.06it/s]
Adding requests:  47%|████▋     | 1905/4096 [00:04<00:05, 429.61it/s]
Adding requests:  48%|████▊     | 1948/4096 [00:04<00:05, 428.07it/s]
Adding requests:  49%|████▊     | 1991/4096 [00:04<00:04, 427.95it/s]
Adding requests:  50%|████▉     | 2034/4096 [00:04<00:04, 423.37it/s]
Adding requests:  51%|█████     | 2077/4096 [00:04<00:04, 418.62it/s]
Adding requests:  52%|█████▏    | 2124/4096 [00:04<00:04, 431.29it/s]
Adding requests:  53%|█████▎    | 2168/4096 [00:05<00:04, 419.06it/s]
Adding requests:  54%|█████▍    | 2210/4096 [00:05<00:04, 407.30it/s]
Adding requests:  55%|█████▌    | 2254/4096 [00:05<00:04, 416.30it/s]
Adding requests:  56%|█████▌    | 2297/4096 [00:05<00:04, 419.74it/s]
Adding requests:  57%|█████▋    | 2343/4096 [00:05<00:04, 429.55it/s]
Adding requests:  58%|█████▊    | 2387/4096 [00:05<00:03, 431.52it/s]
Adding requests:  59%|█████▉    | 2432/4096 [00:05<00:04, 398.10it/s]
Adding requests:  60%|██████    | 2476/4096 [00:05<00:03, 408.48it/s]
Adding requests:  62%|██████▏   | 2521/4096 [00:05<00:03, 418.51it/s]
Adding requests:  63%|██████▎   | 2570/4096 [00:06<00:03, 439.01it/s]
Adding requests:  64%|██████▍   | 2615/4096 [00:06<00:03, 427.51it/s]
Adding requests:  65%|██████▍   | 2659/4096 [00:06<00:03, 426.01it/s]
Adding requests:  66%|██████▌   | 2703/4096 [00:06<00:03, 429.82it/s]
Adding requests:  67%|██████▋   | 2747/4096 [00:06<00:03, 431.72it/s]
Adding requests:  68%|██████▊   | 2796/4096 [00:06<00:02, 446.52it/s]
Adding requests:  69%|██████▉   | 2841/4096 [00:06<00:02, 431.79it/s]
Adding requests:  70%|███████   | 2887/4096 [00:06<00:02, 437.61it/s]
Adding requests:  72%|███████▏  | 2932/4096 [00:06<00:02, 441.07it/s]
Adding requests:  73%|███████▎  | 2978/4096 [00:06<00:02, 446.59it/s]
Adding requests:  74%|███████▍  | 3023/4096 [00:07<00:02, 442.58it/s]
Adding requests:  75%|███████▍  | 3068/4096 [00:07<00:02, 429.19it/s]
Adding requests:  76%|███████▌  | 3112/4096 [00:07<00:02, 432.24it/s]
Adding requests:  77%|███████▋  | 3158/4096 [00:07<00:02, 439.89it/s]
Adding requests:  78%|███████▊  | 3203/4096 [00:07<00:02, 435.38it/s]
Adding requests:  79%|███████▉  | 3252/4096 [00:07<00:01, 450.14it/s]
Adding requests:  81%|████████  | 3298/4096 [00:07<00:01, 423.77it/s]
Adding requests:  82%|████████▏ | 3344/4096 [00:07<00:01, 431.57it/s]
Adding requests:  83%|████████▎ | 3390/4096 [00:07<00:01, 438.79it/s]
Adding requests:  84%|████████▍ | 3435/4096 [00:08<00:01, 436.76it/s]
Adding requests:  85%|████████▌ | 3482/4096 [00:08<00:01, 443.30it/s]
Adding requests:  86%|████████▌ | 3527/4096 [00:08<00:01, 436.64it/s]
Adding requests:  87%|████████▋ | 3571/4096 [00:08<00:01, 435.38it/s]
Adding requests:  88%|████████▊ | 3617/4096 [00:08<00:01, 441.07it/s]
Adding requests:  89%|████████▉ | 3662/4096 [00:08<00:00, 436.60it/s]
Adding requests:  91%|█████████ | 3708/4096 [00:08<00:00, 440.80it/s]
Adding requests:  92%|█████████▏| 3753/4096 [00:08<00:00, 428.16it/s]
Adding requests:  93%|█████████▎| 3796/4096 [00:08<00:00, 425.37it/s]
Adding requests:  94%|█████████▎| 3839/4096 [00:08<00:00, 406.42it/s]
Adding requests:  95%|█████████▍| 3880/4096 [00:09<00:00, 403.72it/s]
Adding requests:  96%|█████████▌| 3921/4096 [00:09<00:00, 405.34it/s]
Adding requests:  97%|█████████▋| 3963/4096 [00:09<00:00, 407.45it/s]
Adding requests:  98%|█████████▊| 4006/4096 [00:09<00:00, 413.54it/s]
Adding requests:  99%|█████████▉| 4051/4096 [00:09<00:00, 421.79it/s]
Adding requests: 100%|█████████▉| 4094/4096 [00:09<00:00, 414.53it/s]
Adding requests: 100%|██████████| 4096/4096 [00:09<00:00, 426.84it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 34/4096 [00:00<00:40, 100.33it/s, est. speed input: 102740.94 toks/s, output: 100.33 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:05<06:05, 11.02it/s, est. speed input: 13085.14 toks/s, output: 12.78 toks/s]   
Processed prompts:   2%|▏         | 98/4096 [00:10<07:51,  8.48it/s, est. speed input: 10032.53 toks/s, output: 9.80 toks/s] 
Processed prompts:   3%|▎         | 130/4096 [00:14<08:39,  7.63it/s, est. speed input: 8967.39 toks/s, output: 8.76 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:19<09:06,  7.20it/s, est. speed input: 8405.72 toks/s, output: 8.21 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:24<09:12,  7.06it/s, est. speed input: 8126.10 toks/s, output: 7.94 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:29<09:20,  6.90it/s, est. speed input: 7899.16 toks/s, output: 7.71 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:34<09:24,  6.80it/s, est. speed input: 7733.83 toks/s, output: 7.55 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:38<09:20,  6.79it/s, est. speed input: 7638.63 toks/s, output: 7.46 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:43<09:20,  6.73it/s, est. speed input: 7539.97 toks/s, output: 7.36 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:48<09:19,  6.69it/s, est. speed input: 7461.20 toks/s, output: 7.29 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:53<09:20,  6.62it/s, est. speed input: 7384.65 toks/s, output: 7.21 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:58<09:11,  6.67it/s, est. speed input: 7350.06 toks/s, output: 7.18 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:03<09:08,  6.65it/s, est. speed input: 7305.00 toks/s, output: 7.13 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:07<09:04,  6.63it/s, est. speed input: 7264.70 toks/s, output: 7.09 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:12<09:01,  6.62it/s, est. speed input: 7230.37 toks/s, output: 7.06 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:17<08:57,  6.61it/s, est. speed input: 7200.13 toks/s, output: 7.03 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:22<08:52,  6.60it/s, est. speed input: 7173.49 toks/s, output: 7.01 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:27<08:48,  6.60it/s, est. speed input: 7149.44 toks/s, output: 6.98 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:32<08:43,  6.59it/s, est. speed input: 7128.17 toks/s, output: 6.96 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:37<08:39,  6.59it/s, est. speed input: 7108.77 toks/s, output: 6.94 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:41<08:34,  6.59it/s, est. speed input: 7091.81 toks/s, output: 6.93 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:46<08:29,  6.59it/s, est. speed input: 7075.85 toks/s, output: 6.91 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:51<08:20,  6.65it/s, est. speed input: 7070.82 toks/s, output: 6.91 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:56<08:16,  6.63it/s, est. speed input: 7056.83 toks/s, output: 6.89 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:01<08:12,  6.62it/s, est. speed input: 7044.94 toks/s, output: 6.88 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:06<08:08,  6.61it/s, est. speed input: 7033.60 toks/s, output: 6.87 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:10<08:04,  6.60it/s, est. speed input: 7022.73 toks/s, output: 6.86 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:15<07:59,  6.60it/s, est. speed input: 7012.85 toks/s, output: 6.85 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:20<07:55,  6.59it/s, est. speed input: 7003.44 toks/s, output: 6.84 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:25<07:50,  6.59it/s, est. speed input: 6994.90 toks/s, output: 6.83 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:30<07:45,  6.59it/s, est. speed input: 6986.85 toks/s, output: 6.82 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:35<07:41,  6.59it/s, est. speed input: 6979.07 toks/s, output: 6.82 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:40<07:36,  6.59it/s, est. speed input: 6971.84 toks/s, output: 6.81 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:44<07:31,  6.59it/s, est. speed input: 6965.05 toks/s, output: 6.80 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:49<07:28,  6.56it/s, est. speed input: 6956.32 toks/s, output: 6.79 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:54<07:19,  6.61it/s, est. speed input: 6954.90 toks/s, output: 6.79 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:59<07:12,  6.66it/s, est. speed input: 6954.43 toks/s, output: 6.79 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:04<07:08,  6.64it/s, est. speed input: 6949.24 toks/s, output: 6.79 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:09<07:04,  6.63it/s, est. speed input: 6944.01 toks/s, output: 6.78 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:13<06:56,  6.67it/s, est. speed input: 6944.26 toks/s, output: 6.78 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:18<06:53,  6.65it/s, est. speed input: 6939.12 toks/s, output: 6.78 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:23<06:50,  6.63it/s, est. speed input: 6934.59 toks/s, output: 6.77 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:28<06:46,  6.61it/s, est. speed input: 6930.05 toks/s, output: 6.77 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:32<06:34,  6.73it/s, est. speed input: 6935.20 toks/s, output: 6.77 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:37<06:32,  6.68it/s, est. speed input: 6930.87 toks/s, output: 6.77 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:42<06:25,  6.71it/s, est. speed input: 6931.29 toks/s, output: 6.77 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:47<06:19,  6.73it/s, est. speed input: 6931.43 toks/s, output: 6.77 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:52<06:17,  6.69it/s, est. speed input: 6927.71 toks/s, output: 6.77 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [03:56<06:11,  6.72it/s, est. speed input: 6928.13 toks/s, output: 6.77 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:01<06:08,  6.68it/s, est. speed input: 6924.46 toks/s, output: 6.76 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:06<06:05,  6.65it/s, est. speed input: 6921.11 toks/s, output: 6.76 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:11<06:01,  6.63it/s, est. speed input: 6917.48 toks/s, output: 6.76 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:15<05:47,  6.81it/s, est. speed input: 6926.61 toks/s, output: 6.76 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:20<05:46,  6.74it/s, est. speed input: 6923.21 toks/s, output: 6.76 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:25<05:43,  6.70it/s, est. speed input: 6919.98 toks/s, output: 6.76 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:30<05:40,  6.66it/s, est. speed input: 6916.74 toks/s, output: 6.75 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:35<05:37,  6.64it/s, est. speed input: 6913.69 toks/s, output: 6.75 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:39<05:30,  6.68it/s, est. speed input: 6913.93 toks/s, output: 6.75 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:44<05:27,  6.65it/s, est. speed input: 6911.00 toks/s, output: 6.75 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:49<05:23,  6.63it/s, est. speed input: 6907.99 toks/s, output: 6.75 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [04:54<05:16,  6.67it/s, est. speed input: 6908.50 toks/s, output: 6.75 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [04:59<05:12,  6.64it/s, est. speed input: 6905.80 toks/s, output: 6.74 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:03<05:03,  6.75it/s, est. speed input: 6909.70 toks/s, output: 6.75 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:08<05:00,  6.69it/s, est. speed input: 6906.83 toks/s, output: 6.74 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:13<04:57,  6.66it/s, est. speed input: 6904.23 toks/s, output: 6.74 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:18<04:53,  6.64it/s, est. speed input: 6901.75 toks/s, output: 6.74 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:23<04:47,  6.68it/s, est. speed input: 6902.30 toks/s, output: 6.74 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:27<04:43,  6.65it/s, est. speed input: 6900.03 toks/s, output: 6.74 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:32<04:39,  6.63it/s, est. speed input: 6897.54 toks/s, output: 6.74 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:37<04:35,  6.61it/s, est. speed input: 6895.26 toks/s, output: 6.73 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [05:42<04:31,  6.60it/s, est. speed input: 6893.04 toks/s, output: 6.73 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:47<04:24,  6.65it/s, est. speed input: 6893.68 toks/s, output: 6.73 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [05:52<04:20,  6.64it/s, est. speed input: 6891.67 toks/s, output: 6.73 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [05:57<04:16,  6.62it/s, est. speed input: 6889.49 toks/s, output: 6.73 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [06:01<04:11,  6.60it/s, est. speed input: 6887.38 toks/s, output: 6.73 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [06:06<04:07,  6.60it/s, est. speed input: 6885.41 toks/s, output: 6.72 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:11<04:02,  6.59it/s, est. speed input: 6883.42 toks/s, output: 6.72 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:16<03:55,  6.65it/s, est. speed input: 6884.12 toks/s, output: 6.72 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:21<03:51,  6.63it/s, est. speed input: 6882.36 toks/s, output: 6.72 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:25<03:45,  6.67it/s, est. speed input: 6883.03 toks/s, output: 6.72 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:30<03:41,  6.64it/s, est. speed input: 6881.14 toks/s, output: 6.72 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [06:35<03:35,  6.68it/s, est. speed input: 6881.79 toks/s, output: 6.72 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [06:40<03:31,  6.65it/s, est. speed input: 6880.08 toks/s, output: 6.72 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [06:45<03:25,  6.69it/s, est. speed input: 6880.71 toks/s, output: 6.72 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [06:49<03:21,  6.65it/s, est. speed input: 6878.90 toks/s, output: 6.72 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [06:54<03:17,  6.63it/s, est. speed input: 6877.22 toks/s, output: 6.72 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [06:59<03:13,  6.61it/s, est. speed input: 6875.35 toks/s, output: 6.71 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [07:04<03:08,  6.60it/s, est. speed input: 6873.88 toks/s, output: 6.71 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:08<02:58,  6.79it/s, est. speed input: 6879.72 toks/s, output: 6.72 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:13<02:54,  6.78it/s, est. speed input: 6880.29 toks/s, output: 6.72 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:18<02:51,  6.72it/s, est. speed input: 6878.75 toks/s, output: 6.72 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:23<02:46,  6.73it/s, est. speed input: 6879.27 toks/s, output: 6.72 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [07:28<02:42,  6.68it/s, est. speed input: 6877.57 toks/s, output: 6.72 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [07:33<02:38,  6.65it/s, est. speed input: 6876.16 toks/s, output: 6.72 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [07:37<02:34,  6.63it/s, est. speed input: 6874.64 toks/s, output: 6.71 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [07:42<02:29,  6.61it/s, est. speed input: 6873.06 toks/s, output: 6.71 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [07:47<02:25,  6.60it/s, est. speed input: 6871.67 toks/s, output: 6.71 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [07:52<02:19,  6.65it/s, est. speed input: 6872.32 toks/s, output: 6.71 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [07:57<02:14,  6.63it/s, est. speed input: 6870.90 toks/s, output: 6.71 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [08:02<02:10,  6.61it/s, est. speed input: 6869.46 toks/s, output: 6.71 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [08:06<02:05,  6.60it/s, est. speed input: 6868.17 toks/s, output: 6.71 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:11<02:00,  6.60it/s, est. speed input: 6866.95 toks/s, output: 6.71 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:16<01:56,  6.59it/s, est. speed input: 6865.50 toks/s, output: 6.70 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:21<01:51,  6.58it/s, est. speed input: 6864.19 toks/s, output: 6.70 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [08:26<01:45,  6.64it/s, est. speed input: 6864.90 toks/s, output: 6.70 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [08:31<01:41,  6.62it/s, est. speed input: 6863.63 toks/s, output: 6.70 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [08:35<01:36,  6.61it/s, est. speed input: 6862.43 toks/s, output: 6.70 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [08:40<01:31,  6.59it/s, est. speed input: 6861.12 toks/s, output: 6.70 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [08:45<01:27,  6.59it/s, est. speed input: 6860.08 toks/s, output: 6.70 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [08:50<01:21,  6.64it/s, est. speed input: 6860.54 toks/s, output: 6.70 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [08:55<01:17,  6.61it/s, est. speed input: 6859.21 toks/s, output: 6.70 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [09:00<01:11,  6.66it/s, est. speed input: 6859.86 toks/s, output: 6.70 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [09:04<01:07,  6.63it/s, est. speed input: 6858.65 toks/s, output: 6.70 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:09<01:01,  6.73it/s, est. speed input: 6861.07 toks/s, output: 6.70 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:14<00:57,  6.68it/s, est. speed input: 6859.80 toks/s, output: 6.70 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:19<00:52,  6.65it/s, est. speed input: 6858.64 toks/s, output: 6.70 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [09:24<00:48,  6.62it/s, est. speed input: 6857.52 toks/s, output: 6.70 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [09:29<00:43,  6.60it/s, est. speed input: 6856.27 toks/s, output: 6.70 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [09:33<00:38,  6.59it/s, est. speed input: 6855.15 toks/s, output: 6.69 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [09:38<00:33,  6.58it/s, est. speed input: 6854.06 toks/s, output: 6.69 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [09:43<00:28,  6.64it/s, est. speed input: 6854.68 toks/s, output: 6.69 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [09:48<00:23,  6.67it/s, est. speed input: 6855.20 toks/s, output: 6.69 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [09:53<00:18,  6.64it/s, est. speed input: 6854.17 toks/s, output: 6.69 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [09:57<00:14,  6.68it/s, est. speed input: 6854.74 toks/s, output: 6.69 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [10:02<00:09,  6.70it/s, est. speed input: 6855.28 toks/s, output: 6.69 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [10:07<00:04,  6.78it/s, est. speed input: 6857.50 toks/s, output: 6.70 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:07<00:00,  6.78it/s, est. speed input: 6908.09 toks/s, output: 6.75 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:07<00:00,  6.75it/s, est. speed input: 6908.09 toks/s, output: 6.75 toks/s]
[rank0]:[W126 18:13:22.227045854 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 702.0s

测试结果:
  Requests/s:   6.64
  Tokens/s:     6807.21
  Total Reqs:   4096
  Elapsed:      616.76s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     6800.57

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:13:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:13:57 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 698, in apply_weights
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 483, in apply
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 181, in cuBLASLt_FP8_linear
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     qinput, scale_a_pad = quant_only_fp8_kernel(input, model_name)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 245, in quant_only_fp8_kernel
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return torch.ops.slidesparse.quant_only_fp8(input, model_name)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 500, in _quant_only_fp8_impl
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     return fn(input)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]            ^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/quant_only_triton/build/GB10_cc121_py312_cu129_aarch64/quant_only_tuned_Qwen2.5-7B.py", line 120, in quant_only_fp8_triton
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]     out = torch.zeros(M_padded, K_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1586327) ERROR 01-26 18:14:36 [core.py:866] 


─── STDERR ───
[2026-01-26 18:13:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:13:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:13:56] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:13:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:13:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:13:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:13:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:13:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:13:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:14:00] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:14:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:14:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:14:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:14:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:14:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:01] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:01] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:01] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:01] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:01] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=1586327) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1586327) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:16<00:16, 16.23s/it]
(EngineCore_DP0 pid=1586327) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:32<00:00, 16.23s/it]
(EngineCore_DP0 pid=1586327) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:32<00:00, 16.23s/it]
(EngineCore_DP0 pid=1586327) 
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:35] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=4608, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:35] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=3584, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=1586327) [2026-01-26 18:14:35] WARNING gemm_wrapper.py:352: cuBLASLt: M=65536 exceeds max searched M=32768 for (N=37888, K=3584), falling back to default heuristic
(EngineCore_DP0 pid=1586327) Process EngineCore_DP0:
(EngineCore_DP0 pid=1586327) Traceback (most recent call last):
(EngineCore_DP0 pid=1586327)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1586327)     self.run()
(EngineCore_DP0 pid=1586327)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1586327)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1586327)     raise e
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1586327)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1586327)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1586327)     super().__init__(
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1586327)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1586327)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1586327)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1586327)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1586327)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1586327)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1586327)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1586327)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1586327)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1586327)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1586327)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1586327)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1586327)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1586327)     outputs = self.model(
(EngineCore_DP0 pid=1586327)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1586327)     hidden_states = self.model(
(EngineCore_DP0 pid=1586327)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1586327)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1586327)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1586327)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1586327)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1586327)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1586327)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1586327)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1586327)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1586327)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1586327)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1586327)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 698, in apply_weights
(EngineCore_DP0 pid=1586327)     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 483, in apply
(EngineCore_DP0 pid=1586327)     return self._linear_fn(
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 181, in cuBLASLt_FP8_linear
(EngineCore_DP0 pid=1586327)     qinput, scale_a_pad = quant_only_fp8_kernel(input, model_name)
(EngineCore_DP0 pid=1586327)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/core/kernels.py", line 245, in quant_only_fp8_kernel
(EngineCore_DP0 pid=1586327)     return torch.ops.slidesparse.quant_only_fp8(input, model_name)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1586327)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/core/kernels.py", line 500, in _quant_only_fp8_impl
(EngineCore_DP0 pid=1586327)     return fn(input)
(EngineCore_DP0 pid=1586327)            ^^^^^^^^^
(EngineCore_DP0 pid=1586327)   File "/root/vllmbench/slidesparse/csrc/quant_only_triton/build/GB10_cc121_py312_cu129_aarch64/quant_only_tuned_Qwen2.5-7B.py", line 120, in quant_only_fp8_triton
(EngineCore_DP0 pid=1586327)     out = torch.zeros(M_padded, K_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1586327)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1586327) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1586327) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1586327) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1586327) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1586327) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1586327) 
[rank0]:[W126 18:14:36.582087888 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cublaslt/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,11.3639,5829.6694,11.2638
1024,1024,1,128,128,6.6167,6782.1380,19.3449
2048,1024,2,256,128,6.7420,6910.5136,37.9711
4096,1024,4,512,128,6.8860,7058.1770,74.3535
8192,1024,8,1024,128,6.6255,6791.0927,154.5554
16384,1024,16,2048,128,6.6362,6802.1010,308.6105
32768,1024,32,4096,128,6.6412,6807.2090,616.7579
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_4

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:14:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:14:42 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1587141) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1587141) WARNING 01-26 18:15:39 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 12.38 requests/s, 6348.77 total tokens/s, 12.38 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 18:14:41] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:14:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:42] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:14:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:14:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:14:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:14:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:14:45] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:14:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:14:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:14:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:14:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:14:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:14:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:14:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1587141) [2026-01-26 18:14:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1587141) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1587141) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.91s/it]
(EngineCore_DP0 pid=1587141) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.94s/it]
(EngineCore_DP0 pid=1587141) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.93s/it]
(EngineCore_DP0 pid=1587141) 
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1587141) [2026-01-26 18:15:29] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1587141) 2026-01-26 18:15:36,528 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1587141) 2026-01-26 18:15:36,643 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<01:50,  1.15it/s]
Adding requests:   2%|▏         | 2/128 [00:01<01:03,  1.97it/s]
Adding requests:   2%|▏         | 3/128 [00:01<00:42,  2.93it/s]
Adding requests:   3%|▎         | 4/128 [00:01<00:30,  4.01it/s]
Adding requests:   4%|▍         | 5/128 [00:01<00:24,  5.04it/s]
Adding requests:   5%|▌         | 7/128 [00:01<00:17,  7.07it/s]
Adding requests:   7%|▋         | 9/128 [00:01<00:13,  8.63it/s]
Adding requests:   9%|▉         | 12/128 [00:01<00:09, 12.40it/s]
Adding requests:  12%|█▏        | 15/128 [00:02<00:06, 16.16it/s]
Adding requests:  15%|█▍        | 19/128 [00:02<00:05, 21.20it/s]
Adding requests:  20%|█▉        | 25/128 [00:02<00:03, 29.42it/s]
Adding requests:  26%|██▌       | 33/128 [00:02<00:02, 41.61it/s]
Adding requests:  41%|████      | 52/128 [00:02<00:00, 80.01it/s]
Adding requests:  62%|██████▎   | 80/128 [00:02<00:00, 133.57it/s]
Adding requests:  88%|████████▊ | 112/128 [00:02<00:00, 185.27it/s]
Adding requests: 100%|██████████| 128/128 [00:02<00:00, 46.85it/s] 

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:00, 168.40it/s, est. speed input: 86240.41 toks/s, output: 168.41 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:03, 26.00it/s, est. speed input: 15585.33 toks/s, output: 30.44 toks/s]  
Processed prompts:  38%|███▊      | 48/128 [00:01<00:03, 21.52it/s, est. speed input: 13131.60 toks/s, output: 25.65 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:03, 19.71it/s, est. speed input: 12234.87 toks/s, output: 23.90 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:03, 18.51it/s, est. speed input: 11693.72 toks/s, output: 22.84 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:02<00:03, 17.69it/s, est. speed input: 11354.11 toks/s, output: 22.18 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:02<00:03, 16.93it/s, est. speed input: 11061.64 toks/s, output: 21.60 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 16.32it/s, est. speed input: 10813.43 toks/s, output: 21.12 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:03<00:03, 15.90it/s, est. speed input: 10656.76 toks/s, output: 20.81 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:03<00:03, 15.65it/s, est. speed input: 10531.19 toks/s, output: 20.57 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:03<00:03, 15.37it/s, est. speed input: 10408.07 toks/s, output: 20.33 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:03<00:03, 15.11it/s, est. speed input: 10291.20 toks/s, output: 20.10 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:03<00:03, 14.87it/s, est. speed input: 10179.94 toks/s, output: 19.88 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:03<00:03, 14.60it/s, est. speed input: 10068.26 toks/s, output: 19.66 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:03, 14.51it/s, est. speed input: 9974.38 toks/s, output: 19.48 toks/s] 
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:03, 14.48it/s, est. speed input: 9888.98 toks/s, output: 19.31 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:03, 14.47it/s, est. speed input: 9810.74 toks/s, output: 19.16 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:04<00:02, 14.41it/s, est. speed input: 9732.62 toks/s, output: 19.01 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:04<00:02, 14.42it/s, est. speed input: 9663.19 toks/s, output: 18.87 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:04<00:02, 14.41it/s, est. speed input: 9597.09 toks/s, output: 18.74 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:04<00:02, 14.33it/s, est. speed input: 9529.80 toks/s, output: 18.61 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:02, 14.19it/s, est. speed input: 9460.63 toks/s, output: 18.48 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:02, 14.30it/s, est. speed input: 9408.31 toks/s, output: 18.38 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:02, 14.26it/s, est. speed input: 9351.37 toks/s, output: 18.26 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 14.36it/s, est. speed input: 9304.91 toks/s, output: 18.17 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 14.31it/s, est. speed input: 9253.85 toks/s, output: 18.07 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:05<00:01, 14.26it/s, est. speed input: 9204.96 toks/s, output: 17.98 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:05<00:01, 14.30it/s, est. speed input: 9161.76 toks/s, output: 17.89 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 14.19it/s, est. speed input: 9113.72 toks/s, output: 17.80 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 14.18it/s, est. speed input: 9071.16 toks/s, output: 17.72 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:01, 14.24it/s, est. speed input: 9034.11 toks/s, output: 17.64 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 14.31it/s, est. speed input: 8999.56 toks/s, output: 17.58 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 14.34it/s, est. speed input: 8965.63 toks/s, output: 17.51 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 14.34it/s, est. speed input: 8932.13 toks/s, output: 17.45 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 14.41it/s, est. speed input: 8902.67 toks/s, output: 17.39 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 14.33it/s, est. speed input: 8869.29 toks/s, output: 17.32 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 14.16it/s, est. speed input: 8832.75 toks/s, output: 17.25 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 14.18it/s, est. speed input: 8803.23 toks/s, output: 17.19 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 13.93it/s, est. speed input: 8763.93 toks/s, output: 17.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 13.93it/s, est. speed input: 8763.93 toks/s, output: 17.12 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.12it/s, est. speed input: 8763.93 toks/s, output: 17.12 toks/s]
[rank0]:[W126 18:15:51.409725887 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 89.1s

测试结果:
  Requests/s:   12.38
  Tokens/s:     6348.77
  Total Reqs:   128
  Elapsed:      10.34s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     6336.39

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:16:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:16:11 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1588568) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1588568) WARNING 01-26 18:17:05 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.43 requests/s, 7611.07 total tokens/s, 7.43 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 18:16:11] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:16:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:16:11] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:16:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:16:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:16:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:16:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:16:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:16:14] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:16:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:16:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:16:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:16:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:16:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:16:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:16:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:16:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:15] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1588568) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1588568) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.28s/it]
(EngineCore_DP0 pid=1588568) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.06s/it]
(EngineCore_DP0 pid=1588568) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.10s/it]
(EngineCore_DP0 pid=1588568) 
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1588568) [2026-01-26 18:16:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1588568) 2026-01-26 18:17:04,959 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1588568) 2026-01-26 18:17:05,020 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 32/128 [00:00<00:00, 312.11it/s]
Adding requests:  55%|█████▌    | 71/128 [00:00<00:00, 353.90it/s]
Adding requests:  86%|████████▌ | 110/128 [00:00<00:00, 365.91it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 361.61it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:05, 22.13it/s, est. speed input: 22664.85 toks/s, output: 22.13 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:11, 10.33it/s, est. speed input: 11497.10 toks/s, output: 11.23 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:13,  9.08it/s, est. speed input: 10215.17 toks/s, output: 9.98 toks/s] 
Processed prompts:   8%|▊         | 10/128 [00:01<00:13,  8.46it/s, est. speed input: 9568.61 toks/s, output: 9.34 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:14,  8.28it/s, est. speed input: 9373.47 toks/s, output: 9.15 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:14,  8.10it/s, est. speed input: 9205.08 toks/s, output: 8.99 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:14,  7.94it/s, est. speed input: 9064.37 toks/s, output: 8.85 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:14,  7.81it/s, est. speed input: 8945.20 toks/s, output: 8.74 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:14,  7.77it/s, est. speed input: 8861.48 toks/s, output: 8.65 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:14,  7.66it/s, est. speed input: 8768.19 toks/s, output: 8.56 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:14,  7.52it/s, est. speed input: 8671.02 toks/s, output: 8.47 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:14,  7.58it/s, est. speed input: 8624.60 toks/s, output: 8.42 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:14,  7.53it/s, est. speed input: 8564.32 toks/s, output: 8.36 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:02<00:14,  7.56it/s, est. speed input: 8522.92 toks/s, output: 8.32 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:02<00:14,  7.54it/s, est. speed input: 8477.71 toks/s, output: 8.28 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:02<00:14,  7.54it/s, est. speed input: 8441.24 toks/s, output: 8.24 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:13,  7.53it/s, est. speed input: 8405.15 toks/s, output: 8.21 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:02<00:13,  7.55it/s, est. speed input: 8376.48 toks/s, output: 8.18 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:13,  7.47it/s, est. speed input: 8336.08 toks/s, output: 8.14 toks/s]
Processed prompts:  20%|██        | 26/128 [00:03<00:13,  7.48it/s, est. speed input: 8308.90 toks/s, output: 8.11 toks/s]
Processed prompts:  21%|██        | 27/128 [00:03<00:13,  7.46it/s, est. speed input: 8279.32 toks/s, output: 8.09 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:03<00:13,  7.48it/s, est. speed input: 8257.21 toks/s, output: 8.06 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:03<00:13,  7.48it/s, est. speed input: 8234.88 toks/s, output: 8.04 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:03<00:13,  7.49it/s, est. speed input: 8215.75 toks/s, output: 8.02 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:03<00:13,  7.45it/s, est. speed input: 8192.05 toks/s, output: 8.00 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:04<00:12,  7.49it/s, est. speed input: 8177.65 toks/s, output: 7.99 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:04<00:12,  7.43it/s, est. speed input: 8154.16 toks/s, output: 7.96 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:04<00:12,  7.45it/s, est. speed input: 8139.20 toks/s, output: 7.95 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:04<00:12,  7.52it/s, est. speed input: 8131.22 toks/s, output: 7.94 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:04<00:12,  7.55it/s, est. speed input: 8121.61 toks/s, output: 7.93 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:04<00:12,  7.55it/s, est. speed input: 8110.61 toks/s, output: 7.92 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:04<00:11,  7.53it/s, est. speed input: 8097.90 toks/s, output: 7.91 toks/s]
Processed prompts:  30%|███       | 39/128 [00:04<00:11,  7.52it/s, est. speed input: 8086.30 toks/s, output: 7.90 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:05<00:11,  7.52it/s, est. speed input: 8076.21 toks/s, output: 7.89 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:05<00:11,  7.48it/s, est. speed input: 8063.00 toks/s, output: 7.87 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:05<00:11,  7.51it/s, est. speed input: 8055.87 toks/s, output: 7.87 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:05<00:11,  7.53it/s, est. speed input: 8048.17 toks/s, output: 7.86 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:05<00:11,  7.52it/s, est. speed input: 8039.82 toks/s, output: 7.85 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:05<00:11,  7.48it/s, est. speed input: 8028.68 toks/s, output: 7.84 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:05<00:10,  7.50it/s, est. speed input: 8021.90 toks/s, output: 7.83 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:06<00:10,  7.50it/s, est. speed input: 8014.51 toks/s, output: 7.83 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:06<00:10,  7.47it/s, est. speed input: 8004.65 toks/s, output: 7.82 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:06<00:10,  7.37it/s, est. speed input: 7989.27 toks/s, output: 7.80 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:06<00:10,  7.46it/s, est. speed input: 7986.89 toks/s, output: 7.80 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:06<00:10,  7.47it/s, est. speed input: 7980.35 toks/s, output: 7.79 toks/s]
Processed prompts:  41%|████      | 52/128 [00:06<00:10,  7.47it/s, est. speed input: 7973.76 toks/s, output: 7.79 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:06<00:10,  7.47it/s, est. speed input: 7967.15 toks/s, output: 7.78 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:06<00:09,  7.47it/s, est. speed input: 7960.88 toks/s, output: 7.77 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:07<00:09,  7.51it/s, est. speed input: 7957.58 toks/s, output: 7.77 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:07<00:09,  7.49it/s, est. speed input: 7951.45 toks/s, output: 7.77 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:07<00:09,  7.41it/s, est. speed input: 7940.99 toks/s, output: 7.75 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:07<00:09,  7.44it/s, est. speed input: 7936.44 toks/s, output: 7.75 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:07<00:09,  7.49it/s, est. speed input: 7934.04 toks/s, output: 7.75 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:07<00:09,  7.44it/s, est. speed input: 7926.72 toks/s, output: 7.74 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:07<00:08,  7.47it/s, est. speed input: 7922.99 toks/s, output: 7.74 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:08<00:08,  7.52it/s, est. speed input: 7921.66 toks/s, output: 7.74 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:08<00:08,  7.51it/s, est. speed input: 7917.19 toks/s, output: 7.73 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:08<00:08,  7.54it/s, est. speed input: 7915.53 toks/s, output: 7.73 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:08<00:08,  7.46it/s, est. speed input: 7907.85 toks/s, output: 7.72 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:08<00:08,  7.44it/s, est. speed input: 7902.32 toks/s, output: 7.72 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:08<00:08,  7.45it/s, est. speed input: 7898.76 toks/s, output: 7.71 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:08<00:08,  7.48it/s, est. speed input: 7896.07 toks/s, output: 7.71 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:08<00:07,  7.48it/s, est. speed input: 7892.68 toks/s, output: 7.71 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:09<00:07,  7.49it/s, est. speed input: 7889.50 toks/s, output: 7.70 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:09<00:07,  7.50it/s, est. speed input: 7886.81 toks/s, output: 7.70 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:09<00:07,  7.47it/s, est. speed input: 7882.48 toks/s, output: 7.70 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:09<00:07,  7.39it/s, est. speed input: 7875.18 toks/s, output: 7.69 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:09<00:07,  7.44it/s, est. speed input: 7873.55 toks/s, output: 7.69 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:09<00:07,  7.49it/s, est. speed input: 7872.10 toks/s, output: 7.69 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:09<00:06,  7.48it/s, est. speed input: 7869.07 toks/s, output: 7.68 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:10<00:06,  7.49it/s, est. speed input: 7866.82 toks/s, output: 7.68 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:10<00:06,  7.50it/s, est. speed input: 7864.84 toks/s, output: 7.68 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:10<00:06,  7.46it/s, est. speed input: 7860.34 toks/s, output: 7.68 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:10<00:06,  7.43it/s, est. speed input: 7856.23 toks/s, output: 7.67 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:10<00:06,  7.39it/s, est. speed input: 7851.38 toks/s, output: 7.67 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:10<00:06,  7.43it/s, est. speed input: 7849.55 toks/s, output: 7.67 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:10<00:06,  7.40it/s, est. speed input: 7845.38 toks/s, output: 7.66 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:10<00:05,  7.43it/s, est. speed input: 7843.16 toks/s, output: 7.66 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:11<00:05,  7.45it/s, est. speed input: 7841.15 toks/s, output: 7.66 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:11<00:05,  7.49it/s, est. speed input: 7840.39 toks/s, output: 7.66 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:11<00:05,  7.44it/s, est. speed input: 7836.29 toks/s, output: 7.65 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:11<00:05,  7.41it/s, est. speed input: 7832.43 toks/s, output: 7.65 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:11<00:05,  7.42it/s, est. speed input: 7830.12 toks/s, output: 7.65 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:11<00:05,  7.43it/s, est. speed input: 7827.81 toks/s, output: 7.64 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:11<00:04,  7.42it/s, est. speed input: 7825.09 toks/s, output: 7.64 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:12<00:04,  7.50it/s, est. speed input: 7825.47 toks/s, output: 7.64 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:12<00:04,  7.51it/s, est. speed input: 7824.33 toks/s, output: 7.64 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:12<00:04,  7.50it/s, est. speed input: 7822.33 toks/s, output: 7.64 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:12<00:04,  7.54it/s, est. speed input: 7822.34 toks/s, output: 7.64 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:12<00:04,  7.43it/s, est. speed input: 7817.09 toks/s, output: 7.63 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:12<00:04,  7.41it/s, est. speed input: 7814.24 toks/s, output: 7.63 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:12<00:04,  7.45it/s, est. speed input: 7813.50 toks/s, output: 7.63 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:12<00:03,  7.45it/s, est. speed input: 7811.64 toks/s, output: 7.63 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:13<00:03,  7.48it/s, est. speed input: 7810.65 toks/s, output: 7.63 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:13<00:03,  7.49it/s, est. speed input: 7809.67 toks/s, output: 7.63 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:13<00:03,  7.48it/s, est. speed input: 7807.75 toks/s, output: 7.62 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:13<00:03,  7.44it/s, est. speed input: 7805.12 toks/s, output: 7.62 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:13<00:03,  7.38it/s, est. speed input: 7800.92 toks/s, output: 7.62 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:13<00:03,  7.36it/s, est. speed input: 7798.08 toks/s, output: 7.62 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:13<00:02,  7.44it/s, est. speed input: 7797.99 toks/s, output: 7.62 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:14<00:02,  7.44it/s, est. speed input: 7796.40 toks/s, output: 7.61 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:14<00:02,  7.43it/s, est. speed input: 7794.53 toks/s, output: 7.61 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:14<00:02,  7.46it/s, est. speed input: 7793.53 toks/s, output: 7.61 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:14<00:02,  7.48it/s, est. speed input: 7792.78 toks/s, output: 7.61 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:14<00:02,  7.51it/s, est. speed input: 7792.43 toks/s, output: 7.61 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:14<00:02,  7.40it/s, est. speed input: 7788.25 toks/s, output: 7.61 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:14<00:02,  7.42it/s, est. speed input: 7786.96 toks/s, output: 7.60 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:14<00:01,  7.43it/s, est. speed input: 7785.40 toks/s, output: 7.60 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:15<00:01,  7.41it/s, est. speed input: 7783.26 toks/s, output: 7.60 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:15<00:01,  7.39it/s, est. speed input: 7780.97 toks/s, output: 7.60 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:15<00:01,  7.39it/s, est. speed input: 7779.06 toks/s, output: 7.60 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:15<00:01,  7.46it/s, est. speed input: 7779.22 toks/s, output: 7.60 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:15<00:01,  7.45it/s, est. speed input: 7777.73 toks/s, output: 7.60 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:15<00:01,  7.35it/s, est. speed input: 7773.43 toks/s, output: 7.59 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:15<00:00,  7.37it/s, est. speed input: 7772.08 toks/s, output: 7.59 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:16<00:00,  7.39it/s, est. speed input: 7770.86 toks/s, output: 7.59 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:16<00:00,  7.40it/s, est. speed input: 7769.24 toks/s, output: 7.59 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:16<00:00,  7.42it/s, est. speed input: 7768.40 toks/s, output: 7.59 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:16<00:00,  7.44it/s, est. speed input: 7767.52 toks/s, output: 7.59 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:16<00:00,  7.46it/s, est. speed input: 7766.98 toks/s, output: 7.58 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:16<00:00,  7.52it/s, est. speed input: 7767.43 toks/s, output: 7.59 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:16<00:00,  7.40it/s, est. speed input: 7763.62 toks/s, output: 7.58 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:16<00:00,  7.40it/s, est. speed input: 7763.62 toks/s, output: 7.58 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:16<00:00,  7.58it/s, est. speed input: 7763.62 toks/s, output: 7.58 toks/s]
[rank0]:[W126 18:17:23.399393628 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 78.3s

测试结果:
  Requests/s:   7.43
  Tokens/s:     7611.07
  Total Reqs:   128
  Elapsed:      17.24s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     7603.65

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:17:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:17:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1589875) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1589875) WARNING 01-26 18:18:20 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.40 requests/s, 7590.03 total tokens/s, 7.40 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 18:17:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:17:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:17:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:17:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:17:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:17:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:17:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:17:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:17:35] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:17:35] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:17:35] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:17:35] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:17:35] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:17:35] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:17:35] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:17:35] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:17:35] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1589875) [2026-01-26 18:17:36] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1589875) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1589875) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:15<00:15, 15.29s/it]
(EngineCore_DP0 pid=1589875) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:36<00:00, 18.61s/it]
(EngineCore_DP0 pid=1589875) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:36<00:00, 18.11s/it]
(EngineCore_DP0 pid=1589875) 
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1589875) [2026-01-26 18:18:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1589875) 2026-01-26 18:18:19,352 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1589875) 2026-01-26 18:18:19,445 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 28/256 [00:00<00:00, 278.24it/s]
Adding requests:  25%|██▍       | 63/256 [00:00<00:00, 319.34it/s]
Adding requests:  39%|███▉      | 100/256 [00:00<00:00, 341.57it/s]
Adding requests:  54%|█████▍    | 139/256 [00:00<00:00, 359.08it/s]
Adding requests:  71%|███████   | 181/256 [00:00<00:00, 380.06it/s]
Adding requests:  88%|████████▊ | 225/256 [00:00<00:00, 396.90it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 375.44it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:15, 16.10it/s, est. speed input: 16485.99 toks/s, output: 16.10 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:00<00:21, 11.69it/s, est. speed input: 12753.45 toks/s, output: 12.45 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:00<00:24,  9.91it/s, est. speed input: 11242.81 toks/s, output: 10.98 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:27,  9.02it/s, est. speed input: 10446.15 toks/s, output: 10.20 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:01<00:28,  8.44it/s, est. speed input: 9898.99 toks/s, output: 9.67 toks/s]  
Processed prompts:   6%|▋         | 16/256 [00:01<00:29,  8.13it/s, est. speed input: 9554.46 toks/s, output: 9.33 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:30,  7.73it/s, est. speed input: 9202.64 toks/s, output: 8.99 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:02<00:30,  7.64it/s, est. speed input: 9015.80 toks/s, output: 8.80 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:02<00:31,  7.55it/s, est. speed input: 8854.99 toks/s, output: 8.65 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:02<00:30,  7.52it/s, est. speed input: 8739.78 toks/s, output: 8.53 toks/s]
Processed prompts:  10%|█         | 26/256 [00:03<00:30,  7.49it/s, est. speed input: 8640.89 toks/s, output: 8.44 toks/s]
Processed prompts:  11%|█         | 28/256 [00:03<00:30,  7.47it/s, est. speed input: 8557.93 toks/s, output: 8.36 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:03<00:30,  7.43it/s, est. speed input: 8478.67 toks/s, output: 8.28 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:03<00:30,  7.43it/s, est. speed input: 8417.82 toks/s, output: 8.22 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:04<00:29,  7.44it/s, est. speed input: 8367.22 toks/s, output: 8.17 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:04<00:29,  7.46it/s, est. speed input: 8327.86 toks/s, output: 8.13 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:04<00:29,  7.43it/s, est. speed input: 8280.53 toks/s, output: 8.09 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:04<00:29,  7.44it/s, est. speed input: 8246.42 toks/s, output: 8.05 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:05<00:28,  7.44it/s, est. speed input: 8214.93 toks/s, output: 8.02 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:05<00:28,  7.44it/s, est. speed input: 8184.82 toks/s, output: 7.99 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:05<00:28,  7.41it/s, est. speed input: 8153.54 toks/s, output: 7.96 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:06<00:28,  7.43it/s, est. speed input: 8130.92 toks/s, output: 7.94 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:06<00:27,  7.44it/s, est. speed input: 8109.95 toks/s, output: 7.92 toks/s]
Processed prompts:  20%|██        | 52/256 [00:06<00:27,  7.43it/s, est. speed input: 8089.40 toks/s, output: 7.90 toks/s]
Processed prompts:  21%|██        | 54/256 [00:06<00:27,  7.40it/s, est. speed input: 8066.18 toks/s, output: 7.88 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:07<00:26,  7.42it/s, est. speed input: 8050.05 toks/s, output: 7.86 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:07<00:26,  7.42it/s, est. speed input: 8034.20 toks/s, output: 7.85 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:07<00:26,  7.42it/s, est. speed input: 8019.07 toks/s, output: 7.83 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:07<00:26,  7.38it/s, est. speed input: 7999.49 toks/s, output: 7.81 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:08<00:25,  7.39it/s, est. speed input: 7986.61 toks/s, output: 7.80 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:08<00:25,  7.41it/s, est. speed input: 7975.04 toks/s, output: 7.79 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:08<00:25,  7.42it/s, est. speed input: 7963.81 toks/s, output: 7.78 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:09<00:25,  7.38it/s, est. speed input: 7948.61 toks/s, output: 7.76 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:09<00:24,  7.39it/s, est. speed input: 7938.77 toks/s, output: 7.75 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:09<00:24,  7.41it/s, est. speed input: 7930.49 toks/s, output: 7.74 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:09<00:24,  7.42it/s, est. speed input: 7921.63 toks/s, output: 7.74 toks/s]
Processed prompts:  30%|███       | 78/256 [00:10<00:24,  7.40it/s, est. speed input: 7911.08 toks/s, output: 7.73 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:10<00:23,  7.43it/s, est. speed input: 7905.00 toks/s, output: 7.72 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:10<00:23,  7.42it/s, est. speed input: 7896.43 toks/s, output: 7.71 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:10<00:23,  7.42it/s, est. speed input: 7889.23 toks/s, output: 7.70 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:11<00:22,  7.40it/s, est. speed input: 7880.84 toks/s, output: 7.70 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:11<00:22,  7.42it/s, est. speed input: 7874.97 toks/s, output: 7.69 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:11<00:22,  7.44it/s, est. speed input: 7870.10 toks/s, output: 7.69 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:11<00:22,  7.44it/s, est. speed input: 7864.39 toks/s, output: 7.68 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:12<00:21,  7.40it/s, est. speed input: 7855.76 toks/s, output: 7.67 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:12<00:21,  7.41it/s, est. speed input: 7850.43 toks/s, output: 7.67 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:12<00:21,  7.42it/s, est. speed input: 7846.11 toks/s, output: 7.66 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:13<00:21,  7.43it/s, est. speed input: 7841.30 toks/s, output: 7.66 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:13<00:20,  7.40it/s, est. speed input: 7834.91 toks/s, output: 7.65 toks/s]
Processed prompts:  41%|████      | 104/256 [00:13<00:20,  7.42it/s, est. speed input: 7831.15 toks/s, output: 7.65 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:13<00:20,  7.44it/s, est. speed input: 7827.86 toks/s, output: 7.64 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:14<00:19,  7.43it/s, est. speed input: 7823.00 toks/s, output: 7.64 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:14<00:19,  7.41it/s, est. speed input: 7817.55 toks/s, output: 7.63 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:14<00:19,  7.43it/s, est. speed input: 7814.93 toks/s, output: 7.63 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:14<00:19,  7.43it/s, est. speed input: 7811.00 toks/s, output: 7.63 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:15<00:18,  7.40it/s, est. speed input: 7805.36 toks/s, output: 7.62 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:15<00:18,  7.41it/s, est. speed input: 7802.40 toks/s, output: 7.62 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:15<00:18,  7.43it/s, est. speed input: 7799.82 toks/s, output: 7.62 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:16<00:18,  7.44it/s, est. speed input: 7796.99 toks/s, output: 7.61 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:16<00:17,  7.41it/s, est. speed input: 7792.26 toks/s, output: 7.61 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:16<00:17,  7.42it/s, est. speed input: 7789.40 toks/s, output: 7.61 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:16<00:17,  7.42it/s, est. speed input: 7786.60 toks/s, output: 7.60 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:17<00:16,  7.43it/s, est. speed input: 7784.22 toks/s, output: 7.60 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:17<00:16,  7.39it/s, est. speed input: 7779.42 toks/s, output: 7.60 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:17<00:16,  7.41it/s, est. speed input: 7777.22 toks/s, output: 7.59 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:17<00:16,  7.41it/s, est. speed input: 7774.27 toks/s, output: 7.59 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:18<00:15,  7.42it/s, est. speed input: 7771.98 toks/s, output: 7.59 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:18<00:15,  7.39it/s, est. speed input: 7767.90 toks/s, output: 7.59 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:18<00:15,  7.42it/s, est. speed input: 7766.72 toks/s, output: 7.58 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:18<00:15,  7.41it/s, est. speed input: 7763.74 toks/s, output: 7.58 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:19<00:14,  7.44it/s, est. speed input: 7762.54 toks/s, output: 7.58 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:19<00:14,  7.41it/s, est. speed input: 7759.46 toks/s, output: 7.58 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:19<00:14,  7.41it/s, est. speed input: 7757.20 toks/s, output: 7.58 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:20<00:14,  7.42it/s, est. speed input: 7755.25 toks/s, output: 7.57 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:20<00:13,  7.42it/s, est. speed input: 7753.20 toks/s, output: 7.57 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:20<00:13,  7.39it/s, est. speed input: 7749.96 toks/s, output: 7.57 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:20<00:13,  7.40it/s, est. speed input: 7747.98 toks/s, output: 7.57 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:21<00:12,  7.40it/s, est. speed input: 7745.87 toks/s, output: 7.56 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:21<00:12,  7.41it/s, est. speed input: 7744.33 toks/s, output: 7.56 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:21<00:12,  7.41it/s, est. speed input: 7742.02 toks/s, output: 7.56 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:21<00:12,  7.40it/s, est. speed input: 7740.00 toks/s, output: 7.56 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:22<00:11,  7.43it/s, est. speed input: 7739.03 toks/s, output: 7.56 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:22<00:11,  7.42it/s, est. speed input: 7737.22 toks/s, output: 7.56 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:22<00:11,  7.39it/s, est. speed input: 7734.15 toks/s, output: 7.55 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:23<00:11,  7.38it/s, est. speed input: 7731.81 toks/s, output: 7.55 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:23<00:10,  7.39it/s, est. speed input: 7730.04 toks/s, output: 7.55 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:23<00:10,  7.39it/s, est. speed input: 7728.44 toks/s, output: 7.55 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:23<00:10,  7.39it/s, est. speed input: 7726.43 toks/s, output: 7.55 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:24<00:10,  7.40it/s, est. speed input: 7725.07 toks/s, output: 7.54 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:24<00:09,  7.42it/s, est. speed input: 7724.04 toks/s, output: 7.54 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:24<00:09,  7.41it/s, est. speed input: 7722.30 toks/s, output: 7.54 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:24<00:09,  7.37it/s, est. speed input: 7719.30 toks/s, output: 7.54 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:25<00:08,  7.39it/s, est. speed input: 7718.27 toks/s, output: 7.54 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:25<00:08,  7.41it/s, est. speed input: 7717.49 toks/s, output: 7.54 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:25<00:08,  7.43it/s, est. speed input: 7716.95 toks/s, output: 7.54 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:26<00:08,  7.39it/s, est. speed input: 7714.21 toks/s, output: 7.53 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:26<00:07,  7.42it/s, est. speed input: 7713.66 toks/s, output: 7.53 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:26<00:07,  7.43it/s, est. speed input: 7712.99 toks/s, output: 7.53 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:26<00:06,  8.31it/s, est. speed input: 7739.22 toks/s, output: 7.56 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:27<00:06,  7.97it/s, est. speed input: 7736.32 toks/s, output: 7.55 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:27<00:06,  7.82it/s, est. speed input: 7735.66 toks/s, output: 7.55 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:27<00:06,  7.69it/s, est. speed input: 7734.13 toks/s, output: 7.55 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:27<00:06,  7.63it/s, est. speed input: 7733.45 toks/s, output: 7.55 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:28<00:05,  7.54it/s, est. speed input: 7731.26 toks/s, output: 7.55 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:28<00:05,  7.50it/s, est. speed input: 7730.04 toks/s, output: 7.55 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:28<00:05,  7.47it/s, est. speed input: 7728.69 toks/s, output: 7.55 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:28<00:05,  7.47it/s, est. speed input: 7728.00 toks/s, output: 7.55 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:29<00:04,  7.43it/s, est. speed input: 7725.91 toks/s, output: 7.54 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:29<00:04,  7.42it/s, est. speed input: 7724.53 toks/s, output: 7.54 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:29<00:04,  7.43it/s, est. speed input: 7723.55 toks/s, output: 7.54 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:29<00:04,  7.43it/s, est. speed input: 7722.68 toks/s, output: 7.54 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:30<00:03,  7.38it/s, est. speed input: 7720.06 toks/s, output: 7.54 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:30<00:03,  7.40it/s, est. speed input: 7719.25 toks/s, output: 7.54 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:30<00:03,  7.41it/s, est. speed input: 7718.31 toks/s, output: 7.54 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:31<00:02,  7.41it/s, est. speed input: 7717.24 toks/s, output: 7.54 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:31<00:02,  7.39it/s, est. speed input: 7715.50 toks/s, output: 7.53 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:31<00:02,  7.39it/s, est. speed input: 7714.24 toks/s, output: 7.53 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:31<00:02,  7.41it/s, est. speed input: 7713.52 toks/s, output: 7.53 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:32<00:01,  7.41it/s, est. speed input: 7712.42 toks/s, output: 7.53 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:32<00:01,  7.37it/s, est. speed input: 7710.17 toks/s, output: 7.53 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:32<00:01,  7.39it/s, est. speed input: 7709.42 toks/s, output: 7.53 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:32<00:01,  7.41it/s, est. speed input: 7708.91 toks/s, output: 7.53 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:33<00:00,  7.43it/s, est. speed input: 7708.35 toks/s, output: 7.53 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:33<00:00,  7.39it/s, est. speed input: 7706.36 toks/s, output: 7.53 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:33<00:00,  7.41it/s, est. speed input: 7706.02 toks/s, output: 7.53 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  8.71it/s, est. speed input: 7735.49 toks/s, output: 7.55 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  8.71it/s, est. speed input: 7735.49 toks/s, output: 7.55 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:33<00:00,  7.55it/s, est. speed input: 7735.49 toks/s, output: 7.55 toks/s]
[rank0]:[W126 18:18:55.252150087 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 91.6s

测试结果:
  Requests/s:   7.40
  Tokens/s:     7590.03
  Total Reqs:   256
  Elapsed:      34.57s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     7582.62

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:19:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:19:02 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1591318) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1591318) WARNING 01-26 18:19:55 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.16 requests/s, 7336.61 total tokens/s, 7.16 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 18:19:02] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:19:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:19:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:19:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:19:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:19:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:19:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:19:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:19:05] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:19:06] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:19:06] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:19:06] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:19:06] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:19:06] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:19:06] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:19:06] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:19:06] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:06] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1591318) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1591318) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.21s/it]
(EngineCore_DP0 pid=1591318) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.30s/it]
(EngineCore_DP0 pid=1591318) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.28s/it]
(EngineCore_DP0 pid=1591318) 
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1591318) [2026-01-26 18:19:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1591318) 2026-01-26 18:19:54,151 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1591318) 2026-01-26 18:19:54,254 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 40/512 [00:00<00:01, 386.15it/s]
Adding requests:  15%|█▌        | 79/512 [00:00<00:01, 372.76it/s]
Adding requests:  23%|██▎       | 117/512 [00:00<00:01, 370.12it/s]
Adding requests:  30%|███       | 156/512 [00:00<00:00, 377.13it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:00, 378.49it/s]
Adding requests:  46%|████▋     | 237/512 [00:00<00:00, 392.00it/s]
Adding requests:  54%|█████▍    | 278/512 [00:00<00:00, 396.95it/s]
Adding requests:  63%|██████▎   | 321/512 [00:00<00:00, 404.62it/s]
Adding requests:  71%|███████   | 364/512 [00:00<00:00, 410.68it/s]
Adding requests:  80%|███████▉  | 408/512 [00:01<00:00, 417.31it/s]
Adding requests:  88%|████████▊ | 450/512 [00:01<00:00, 416.98it/s]
Adding requests:  96%|█████████▋| 493/512 [00:01<00:00, 420.48it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 403.31it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:00<00:32, 15.50it/s, est. speed input: 15874.22 toks/s, output: 15.50 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:01<00:45, 10.94it/s, est. speed input: 11952.95 toks/s, output: 11.67 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:01<00:53,  9.25it/s, est. speed input: 10475.89 toks/s, output: 10.23 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:02<00:57,  8.46it/s, est. speed input: 9730.58 toks/s, output: 9.50 toks/s]  
Processed prompts:   5%|▌         | 26/512 [00:02<01:00,  7.97it/s, est. speed input: 9247.39 toks/s, output: 9.03 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:03<01:02,  7.71it/s, est. speed input: 8942.04 toks/s, output: 8.73 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:03<01:03,  7.53it/s, est. speed input: 8717.84 toks/s, output: 8.51 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:04<01:03,  7.42it/s, est. speed input: 8549.56 toks/s, output: 8.35 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:05<01:04,  7.33it/s, est. speed input: 8412.40 toks/s, output: 8.22 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:05<01:03,  7.28it/s, est. speed input: 8307.92 toks/s, output: 8.11 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:06<01:03,  7.24it/s, est. speed input: 8218.89 toks/s, output: 8.03 toks/s]
Processed prompts:  11%|█         | 54/512 [00:06<01:03,  7.23it/s, est. speed input: 8149.81 toks/s, output: 7.96 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:07<01:03,  7.19it/s, est. speed input: 8082.52 toks/s, output: 7.89 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:07<01:02,  7.18it/s, est. speed input: 8028.52 toks/s, output: 7.84 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:08<01:02,  7.18it/s, est. speed input: 7985.03 toks/s, output: 7.80 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:09<01:01,  7.16it/s, est. speed input: 7941.85 toks/s, output: 7.76 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:09<01:01,  7.17it/s, est. speed input: 7907.97 toks/s, output: 7.72 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:10<01:00,  7.15it/s, est. speed input: 7873.13 toks/s, output: 7.69 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:10<01:00,  7.15it/s, est. speed input: 7844.24 toks/s, output: 7.66 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:11<00:59,  7.13it/s, est. speed input: 7814.74 toks/s, output: 7.63 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:11<00:59,  7.15it/s, est. speed input: 7792.98 toks/s, output: 7.61 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:12<00:58,  7.14it/s, est. speed input: 7770.07 toks/s, output: 7.59 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:12<00:57,  7.14it/s, est. speed input: 7750.66 toks/s, output: 7.57 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:13<00:57,  7.14it/s, est. speed input: 7732.73 toks/s, output: 7.55 toks/s]
Processed prompts:  21%|██        | 106/512 [00:14<00:56,  7.15it/s, est. speed input: 7717.33 toks/s, output: 7.54 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:14<00:56,  7.13it/s, est. speed input: 7699.41 toks/s, output: 7.52 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:15<00:55,  7.14it/s, est. speed input: 7685.86 toks/s, output: 7.51 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:15<00:55,  7.12it/s, est. speed input: 7670.56 toks/s, output: 7.49 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:16<00:54,  7.14it/s, est. speed input: 7659.34 toks/s, output: 7.48 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:16<00:54,  7.12it/s, est. speed input: 7645.79 toks/s, output: 7.47 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:17<00:53,  7.13it/s, est. speed input: 7635.27 toks/s, output: 7.46 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:17<00:53,  7.13it/s, est. speed input: 7624.40 toks/s, output: 7.45 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:18<00:52,  7.14it/s, est. speed input: 7616.11 toks/s, output: 7.44 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:19<00:51,  7.13it/s, est. speed input: 7606.34 toks/s, output: 7.43 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:19<00:51,  7.13it/s, est. speed input: 7597.55 toks/s, output: 7.42 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:20<00:50,  7.14it/s, est. speed input: 7589.88 toks/s, output: 7.41 toks/s]
Processed prompts:  30%|███       | 154/512 [00:20<00:50,  7.12it/s, est. speed input: 7580.99 toks/s, output: 7.40 toks/s]
Processed prompts:  31%|███       | 158/512 [00:21<00:49,  7.12it/s, est. speed input: 7573.63 toks/s, output: 7.40 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:21<00:49,  7.11it/s, est. speed input: 7565.43 toks/s, output: 7.39 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:22<00:48,  7.12it/s, est. speed input: 7558.66 toks/s, output: 7.38 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:23<00:48,  7.11it/s, est. speed input: 7551.10 toks/s, output: 7.37 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:23<00:47,  7.13it/s, est. speed input: 7546.35 toks/s, output: 7.37 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:24<00:46,  7.12it/s, est. speed input: 7540.11 toks/s, output: 7.36 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:24<00:46,  7.14it/s, est. speed input: 7535.98 toks/s, output: 7.36 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:25<00:45,  7.14it/s, est. speed input: 7530.87 toks/s, output: 7.35 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:25<00:45,  7.14it/s, est. speed input: 7526.37 toks/s, output: 7.35 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:26<00:44,  7.13it/s, est. speed input: 7521.04 toks/s, output: 7.34 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:26<00:43,  7.14it/s, est. speed input: 7517.23 toks/s, output: 7.34 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:27<00:40,  7.62it/s, est. speed input: 7545.48 toks/s, output: 7.37 toks/s]
Processed prompts:  40%|████      | 206/512 [00:27<00:40,  7.47it/s, est. speed input: 7540.96 toks/s, output: 7.36 toks/s]
Processed prompts:  41%|████      | 210/512 [00:28<00:41,  7.36it/s, est. speed input: 7535.48 toks/s, output: 7.36 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:29<00:40,  7.30it/s, est. speed input: 7531.78 toks/s, output: 7.36 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:29<00:40,  7.23it/s, est. speed input: 7526.38 toks/s, output: 7.35 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:30<00:40,  7.21it/s, est. speed input: 7523.06 toks/s, output: 7.35 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:30<00:39,  7.18it/s, est. speed input: 7518.49 toks/s, output: 7.34 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:31<00:39,  7.18it/s, est. speed input: 7515.47 toks/s, output: 7.34 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:31<00:38,  7.15it/s, est. speed input: 7510.69 toks/s, output: 7.33 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:32<00:38,  7.16it/s, est. speed input: 7507.83 toks/s, output: 7.33 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:33<00:37,  7.14it/s, est. speed input: 7504.15 toks/s, output: 7.33 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:33<00:37,  7.14it/s, est. speed input: 7500.53 toks/s, output: 7.32 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:34<00:36,  7.14it/s, est. speed input: 7497.46 toks/s, output: 7.32 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:34<00:36,  7.13it/s, est. speed input: 7493.94 toks/s, output: 7.32 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:35<00:35,  7.14it/s, est. speed input: 7491.59 toks/s, output: 7.32 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:35<00:35,  7.12it/s, est. speed input: 7487.32 toks/s, output: 7.31 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:36<00:34,  7.12it/s, est. speed input: 7484.65 toks/s, output: 7.31 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:36<00:34,  7.11it/s, est. speed input: 7480.88 toks/s, output: 7.31 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:37<00:33,  7.12it/s, est. speed input: 7478.53 toks/s, output: 7.30 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:38<00:32,  7.12it/s, est. speed input: 7475.91 toks/s, output: 7.30 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:38<00:32,  7.13it/s, est. speed input: 7473.74 toks/s, output: 7.30 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:39<00:31,  7.13it/s, est. speed input: 7471.01 toks/s, output: 7.30 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:39<00:31,  7.13it/s, est. speed input: 7468.97 toks/s, output: 7.29 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:40<00:30,  7.12it/s, est. speed input: 7466.18 toks/s, output: 7.29 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:40<00:30,  7.12it/s, est. speed input: 7463.72 toks/s, output: 7.29 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:41<00:29,  7.11it/s, est. speed input: 7460.83 toks/s, output: 7.29 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:41<00:26,  7.69it/s, est. speed input: 7483.61 toks/s, output: 7.31 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:42<00:26,  7.50it/s, est. speed input: 7480.84 toks/s, output: 7.31 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:42<00:26,  7.40it/s, est. speed input: 7479.08 toks/s, output: 7.30 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:43<00:26,  7.32it/s, est. speed input: 7476.82 toks/s, output: 7.30 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:44<00:26,  7.27it/s, est. speed input: 7474.80 toks/s, output: 7.30 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:44<00:25,  7.22it/s, est. speed input: 7472.51 toks/s, output: 7.30 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:45<00:25,  7.22it/s, est. speed input: 7471.29 toks/s, output: 7.30 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:45<00:24,  7.18it/s, est. speed input: 7468.65 toks/s, output: 7.29 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:46<00:24,  7.17it/s, est. speed input: 7466.87 toks/s, output: 7.29 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:46<00:23,  7.15it/s, est. speed input: 7464.55 toks/s, output: 7.29 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:47<00:23,  7.15it/s, est. speed input: 7462.82 toks/s, output: 7.29 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:48<00:22,  7.13it/s, est. speed input: 7460.38 toks/s, output: 7.29 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:48<00:22,  7.13it/s, est. speed input: 7458.66 toks/s, output: 7.28 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:49<00:21,  7.14it/s, est. speed input: 7457.24 toks/s, output: 7.28 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:49<00:21,  7.13it/s, est. speed input: 7455.13 toks/s, output: 7.28 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:50<00:20,  7.13it/s, est. speed input: 7453.56 toks/s, output: 7.28 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:50<00:19,  7.12it/s, est. speed input: 7451.46 toks/s, output: 7.28 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:51<00:19,  7.13it/s, est. speed input: 7449.97 toks/s, output: 7.28 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:51<00:18,  7.11it/s, est. speed input: 7447.76 toks/s, output: 7.27 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:52<00:18,  7.11it/s, est. speed input: 7446.02 toks/s, output: 7.27 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:53<00:17,  7.11it/s, est. speed input: 7444.25 toks/s, output: 7.27 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:53<00:17,  7.12it/s, est. speed input: 7442.92 toks/s, output: 7.27 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:54<00:16,  7.13it/s, est. speed input: 7441.62 toks/s, output: 7.27 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:54<00:15,  7.13it/s, est. speed input: 7440.10 toks/s, output: 7.27 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:55<00:15,  7.11it/s, est. speed input: 7438.11 toks/s, output: 7.26 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:55<00:14,  7.12it/s, est. speed input: 7436.86 toks/s, output: 7.26 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:56<00:14,  7.12it/s, est. speed input: 7435.22 toks/s, output: 7.26 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:57<00:13,  7.13it/s, est. speed input: 7434.17 toks/s, output: 7.26 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:57<00:13,  7.11it/s, est. speed input: 7432.38 toks/s, output: 7.26 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:58<00:12,  7.11it/s, est. speed input: 7430.98 toks/s, output: 7.26 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:58<00:12,  7.11it/s, est. speed input: 7429.35 toks/s, output: 7.26 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:59<00:11,  7.12it/s, est. speed input: 7428.29 toks/s, output: 7.25 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:59<00:10,  7.70it/s, est. speed input: 7444.49 toks/s, output: 7.27 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:00<00:09,  7.53it/s, est. speed input: 7443.38 toks/s, output: 7.27 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:00<00:09,  7.38it/s, est. speed input: 7441.33 toks/s, output: 7.27 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:01<00:09,  7.30it/s, est. speed input: 7439.95 toks/s, output: 7.27 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:01<00:08,  7.23it/s, est. speed input: 7438.14 toks/s, output: 7.26 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:02<00:08,  7.18it/s, est. speed input: 7436.26 toks/s, output: 7.26 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:03<00:07,  7.16it/s, est. speed input: 7435.02 toks/s, output: 7.26 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:03<00:07,  7.13it/s, est. speed input: 7433.11 toks/s, output: 7.26 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:04<00:06,  7.13it/s, est. speed input: 7432.09 toks/s, output: 7.26 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:04<00:05,  7.12it/s, est. speed input: 7430.52 toks/s, output: 7.26 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:05<00:05,  7.13it/s, est. speed input: 7429.56 toks/s, output: 7.26 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:05<00:04,  7.10it/s, est. speed input: 7427.77 toks/s, output: 7.25 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:06<00:04,  7.11it/s, est. speed input: 7426.76 toks/s, output: 7.25 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:07<00:03,  7.10it/s, est. speed input: 7425.16 toks/s, output: 7.25 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:07<00:03,  7.12it/s, est. speed input: 7424.34 toks/s, output: 7.25 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:08<00:02,  7.11it/s, est. speed input: 7423.15 toks/s, output: 7.25 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:08<00:01,  7.14it/s, est. speed input: 7422.73 toks/s, output: 7.25 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:09<00:01,  7.12it/s, est. speed input: 7421.34 toks/s, output: 7.25 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:09<00:00,  7.14it/s, est. speed input: 7420.69 toks/s, output: 7.25 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:10<00:00,  7.64it/s, est. speed input: 7432.92 toks/s, output: 7.26 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:10<00:00,  7.64it/s, est. speed input: 7462.06 toks/s, output: 7.29 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:10<00:00,  7.29it/s, est. speed input: 7462.06 toks/s, output: 7.29 toks/s]
[rank0]:[W126 18:21:07.224875732 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 132.0s

测试结果:
  Requests/s:   7.16
  Tokens/s:     7336.61
  Total Reqs:   512
  Elapsed:      71.53s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     7329.45

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:21:16 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:21:16 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1593337) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1593337) WARNING 01-26 18:22:09 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.26 requests/s, 7444.30 total tokens/s, 7.26 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 18:21:16] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:21:16] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:21:16] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:16] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:21:16] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:21:16] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:21:16] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:21:16] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:21:16] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:21:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:21:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:21:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:21:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:21:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:21:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:21:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:21:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:21:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1593337) [2026-01-26 18:21:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1593337) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1593337) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:19<00:19, 19.84s/it]
(EngineCore_DP0 pid=1593337) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.09s/it]
(EngineCore_DP0 pid=1593337) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:40<00:00, 20.05s/it]
(EngineCore_DP0 pid=1593337) 
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1593337) [2026-01-26 18:22:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1593337) 2026-01-26 18:22:08,082 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1593337) 2026-01-26 18:22:08,298 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 41/1024 [00:00<00:02, 409.25it/s]
Adding requests:   8%|▊         | 82/1024 [00:00<00:02, 382.55it/s]
Adding requests:  12%|█▏        | 121/1024 [00:00<00:02, 370.19it/s]
Adding requests:  16%|█▌        | 161/1024 [00:00<00:02, 378.38it/s]
Adding requests:  20%|█▉        | 203/1024 [00:00<00:02, 389.79it/s]
Adding requests:  24%|██▍       | 245/1024 [00:00<00:01, 398.01it/s]
Adding requests:  28%|██▊       | 286/1024 [00:00<00:01, 400.96it/s]
Adding requests:  32%|███▏      | 330/1024 [00:00<00:01, 411.02it/s]
Adding requests:  36%|███▋      | 372/1024 [00:00<00:01, 411.58it/s]
Adding requests:  41%|████      | 416/1024 [00:01<00:01, 417.42it/s]
Adding requests:  45%|████▍     | 458/1024 [00:01<00:01, 412.64it/s]
Adding requests:  49%|████▉     | 502/1024 [00:01<00:01, 419.91it/s]
Adding requests:  53%|█████▎    | 545/1024 [00:01<00:01, 422.57it/s]
Adding requests:  57%|█████▋    | 588/1024 [00:01<00:01, 412.58it/s]
Adding requests:  62%|██████▏   | 630/1024 [00:01<00:00, 413.89it/s]
Adding requests:  66%|██████▌   | 672/1024 [00:01<00:00, 382.52it/s]
Adding requests:  70%|██████▉   | 715/1024 [00:01<00:00, 394.42it/s]
Adding requests:  74%|███████▎  | 755/1024 [00:01<00:00, 380.87it/s]
Adding requests:  78%|███████▊  | 797/1024 [00:01<00:00, 390.42it/s]
Adding requests:  82%|████████▏ | 838/1024 [00:02<00:00, 393.22it/s]
Adding requests:  86%|████████▌ | 879/1024 [00:02<00:00, 395.69it/s]
Adding requests:  90%|████████▉ | 919/1024 [00:02<00:00, 395.56it/s]
Adding requests:  94%|█████████▎| 959/1024 [00:02<00:00, 392.49it/s]
Adding requests:  98%|█████████▊| 999/1024 [00:02<00:00, 387.85it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 397.14it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:00<00:53, 18.96it/s, est. speed input: 19418.89 toks/s, output: 18.96 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:02<01:25, 11.65it/s, est. speed input: 12971.68 toks/s, output: 12.67 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:03<01:43,  9.59it/s, est. speed input: 11040.48 toks/s, output: 10.78 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:04<01:53,  8.64it/s, est. speed input: 10095.34 toks/s, output: 9.86 toks/s] 
Processed prompts:   5%|▍         | 50/1024 [00:05<01:59,  8.14it/s, est. speed input: 9549.58 toks/s, output: 9.33 toks/s] 
Processed prompts:   6%|▌         | 58/1024 [00:06<02:03,  7.83it/s, est. speed input: 9187.62 toks/s, output: 8.97 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:07<02:05,  7.65it/s, est. speed input: 8933.72 toks/s, output: 8.72 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:08<02:06,  7.52it/s, est. speed input: 8740.06 toks/s, output: 8.54 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:09<02:06,  7.43it/s, est. speed input: 8591.72 toks/s, output: 8.39 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:10<02:06,  7.38it/s, est. speed input: 8474.74 toks/s, output: 8.28 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:11<02:06,  7.34it/s, est. speed input: 8376.10 toks/s, output: 8.18 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:13<02:05,  7.31it/s, est. speed input: 8295.84 toks/s, output: 8.10 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:14<02:04,  7.29it/s, est. speed input: 8227.01 toks/s, output: 8.03 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:15<02:03,  7.28it/s, est. speed input: 8169.07 toks/s, output: 7.98 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:16<02:02,  7.27it/s, est. speed input: 8118.96 toks/s, output: 7.93 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:17<02:02,  7.26it/s, est. speed input: 8073.84 toks/s, output: 7.88 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:18<02:00,  7.26it/s, est. speed input: 8036.13 toks/s, output: 7.85 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:19<01:59,  7.25it/s, est. speed input: 8001.33 toks/s, output: 7.81 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:20<01:58,  7.26it/s, est. speed input: 7971.93 toks/s, output: 7.79 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:21<01:57,  7.26it/s, est. speed input: 7944.39 toks/s, output: 7.76 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:23<01:56,  7.25it/s, est. speed input: 7919.30 toks/s, output: 7.73 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:24<01:55,  7.25it/s, est. speed input: 7896.64 toks/s, output: 7.71 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:25<01:54,  7.24it/s, est. speed input: 7874.81 toks/s, output: 7.69 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:26<01:50,  7.47it/s, est. speed input: 7888.99 toks/s, output: 7.70 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:27<01:49,  7.41it/s, est. speed input: 7871.35 toks/s, output: 7.69 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:28<01:49,  7.36it/s, est. speed input: 7853.29 toks/s, output: 7.67 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:29<01:48,  7.32it/s, est. speed input: 7837.24 toks/s, output: 7.65 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:30<01:48,  7.30it/s, est. speed input: 7822.61 toks/s, output: 7.64 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:31<01:47,  7.29it/s, est. speed input: 7809.51 toks/s, output: 7.63 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:32<01:46,  7.28it/s, est. speed input: 7796.85 toks/s, output: 7.61 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:33<01:45,  7.27it/s, est. speed input: 7784.66 toks/s, output: 7.60 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:35<01:44,  7.26it/s, est. speed input: 7772.18 toks/s, output: 7.59 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:36<01:43,  7.26it/s, est. speed input: 7761.87 toks/s, output: 7.58 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:37<01:42,  7.26it/s, est. speed input: 7752.01 toks/s, output: 7.57 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:38<01:41,  7.26it/s, est. speed input: 7742.95 toks/s, output: 7.56 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:39<01:40,  7.25it/s, est. speed input: 7733.40 toks/s, output: 7.55 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:40<01:35,  7.52it/s, est. speed input: 7749.81 toks/s, output: 7.57 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:41<01:35,  7.44it/s, est. speed input: 7741.69 toks/s, output: 7.56 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:42<01:35,  7.38it/s, est. speed input: 7732.92 toks/s, output: 7.55 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:43<01:34,  7.34it/s, est. speed input: 7724.97 toks/s, output: 7.54 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:44<01:33,  7.31it/s, est. speed input: 7717.91 toks/s, output: 7.54 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:45<01:32,  7.29it/s, est. speed input: 7710.71 toks/s, output: 7.53 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:47<01:32,  7.27it/s, est. speed input: 7703.44 toks/s, output: 7.52 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:48<01:31,  7.26it/s, est. speed input: 7696.63 toks/s, output: 7.52 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:49<01:30,  7.26it/s, est. speed input: 7690.77 toks/s, output: 7.51 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:50<01:29,  7.25it/s, est. speed input: 7684.71 toks/s, output: 7.50 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:51<01:28,  7.25it/s, est. speed input: 7678.66 toks/s, output: 7.50 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:52<01:27,  7.23it/s, est. speed input: 7672.29 toks/s, output: 7.49 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:53<01:25,  7.23it/s, est. speed input: 7666.82 toks/s, output: 7.49 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:54<01:24,  7.23it/s, est. speed input: 7661.53 toks/s, output: 7.48 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:55<01:23,  7.23it/s, est. speed input: 7656.39 toks/s, output: 7.48 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:57<01:22,  7.23it/s, est. speed input: 7651.51 toks/s, output: 7.47 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:57<01:18,  7.50it/s, est. speed input: 7664.16 toks/s, output: 7.48 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:59<01:18,  7.42it/s, est. speed input: 7659.41 toks/s, output: 7.48 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:00<01:17,  7.37it/s, est. speed input: 7655.21 toks/s, output: 7.48 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:01<01:17,  7.33it/s, est. speed input: 7651.00 toks/s, output: 7.47 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:02<01:16,  7.30it/s, est. speed input: 7646.64 toks/s, output: 7.47 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:03<01:15,  7.28it/s, est. speed input: 7642.56 toks/s, output: 7.46 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:04<01:14,  7.27it/s, est. speed input: 7638.86 toks/s, output: 7.46 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:05<01:13,  7.26it/s, est. speed input: 7634.96 toks/s, output: 7.46 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:06<01:12,  7.25it/s, est. speed input: 7631.16 toks/s, output: 7.45 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:07<01:11,  7.25it/s, est. speed input: 7627.56 toks/s, output: 7.45 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:09<01:10,  7.24it/s, est. speed input: 7623.71 toks/s, output: 7.45 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:10<01:09,  7.24it/s, est. speed input: 7620.41 toks/s, output: 7.44 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:11<01:08,  7.24it/s, est. speed input: 7617.34 toks/s, output: 7.44 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:12<01:07,  7.24it/s, est. speed input: 7613.93 toks/s, output: 7.44 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:13<01:06,  7.23it/s, est. speed input: 7610.63 toks/s, output: 7.43 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:14<01:04,  7.24it/s, est. speed input: 7607.80 toks/s, output: 7.43 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:15<01:03,  7.24it/s, est. speed input: 7605.08 toks/s, output: 7.43 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:16<01:02,  7.24it/s, est. speed input: 7602.37 toks/s, output: 7.42 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:17<01:01,  7.24it/s, est. speed input: 7599.48 toks/s, output: 7.42 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:18<01:00,  7.24it/s, est. speed input: 7596.82 toks/s, output: 7.42 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:20<00:59,  7.24it/s, est. speed input: 7594.51 toks/s, output: 7.42 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:21<00:58,  7.25it/s, est. speed input: 7592.24 toks/s, output: 7.41 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:22<00:57,  7.24it/s, est. speed input: 7589.86 toks/s, output: 7.41 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:23<00:56,  7.24it/s, est. speed input: 7587.19 toks/s, output: 7.41 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:24<00:54,  7.24it/s, est. speed input: 7585.03 toks/s, output: 7.41 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:25<00:53,  7.24it/s, est. speed input: 7583.02 toks/s, output: 7.41 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:26<00:52,  7.25it/s, est. speed input: 7581.11 toks/s, output: 7.40 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:27<00:51,  7.24it/s, est. speed input: 7578.90 toks/s, output: 7.40 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:28<00:50,  7.24it/s, est. speed input: 7576.75 toks/s, output: 7.40 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:30<00:49,  7.24it/s, est. speed input: 7574.74 toks/s, output: 7.40 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:31<00:48,  7.24it/s, est. speed input: 7572.63 toks/s, output: 7.40 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:32<00:47,  7.24it/s, est. speed input: 7570.76 toks/s, output: 7.39 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:33<00:46,  7.24it/s, est. speed input: 7569.14 toks/s, output: 7.39 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:34<00:44,  7.25it/s, est. speed input: 7567.40 toks/s, output: 7.39 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:35<00:43,  7.24it/s, est. speed input: 7565.61 toks/s, output: 7.39 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [01:36<00:42,  7.24it/s, est. speed input: 7563.75 toks/s, output: 7.39 toks/s]
Processed prompts:  71%|███████   | 722/1024 [01:37<00:41,  7.24it/s, est. speed input: 7562.09 toks/s, output: 7.38 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [01:38<00:40,  7.24it/s, est. speed input: 7560.48 toks/s, output: 7.38 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [01:39<00:39,  7.23it/s, est. speed input: 7558.58 toks/s, output: 7.38 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [01:41<00:38,  7.23it/s, est. speed input: 7556.81 toks/s, output: 7.38 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [01:42<00:37,  7.24it/s, est. speed input: 7555.34 toks/s, output: 7.38 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [01:43<00:36,  7.23it/s, est. speed input: 7553.71 toks/s, output: 7.38 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [01:44<00:35,  7.24it/s, est. speed input: 7552.26 toks/s, output: 7.38 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [01:45<00:34,  7.23it/s, est. speed input: 7550.69 toks/s, output: 7.37 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [01:46<00:31,  7.51it/s, est. speed input: 7558.72 toks/s, output: 7.38 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [01:47<00:30,  7.42it/s, est. speed input: 7557.10 toks/s, output: 7.38 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [01:48<00:30,  7.36it/s, est. speed input: 7555.59 toks/s, output: 7.38 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [01:49<00:29,  7.32it/s, est. speed input: 7554.09 toks/s, output: 7.38 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [01:50<00:28,  7.30it/s, est. speed input: 7552.64 toks/s, output: 7.38 toks/s]
Processed prompts:  81%|████████  | 826/1024 [01:52<00:27,  7.28it/s, est. speed input: 7551.27 toks/s, output: 7.37 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [01:53<00:26,  7.27it/s, est. speed input: 7550.05 toks/s, output: 7.37 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [01:54<00:25,  7.26it/s, est. speed input: 7548.52 toks/s, output: 7.37 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [01:55<00:23,  7.25it/s, est. speed input: 7547.33 toks/s, output: 7.37 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [01:56<00:22,  7.25it/s, est. speed input: 7546.03 toks/s, output: 7.37 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:57<00:21,  7.24it/s, est. speed input: 7544.60 toks/s, output: 7.37 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:58<00:20,  7.24it/s, est. speed input: 7543.38 toks/s, output: 7.37 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:59<00:19,  7.24it/s, est. speed input: 7542.29 toks/s, output: 7.37 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:00<00:18,  7.25it/s, est. speed input: 7541.23 toks/s, output: 7.36 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:01<00:17,  7.24it/s, est. speed input: 7539.90 toks/s, output: 7.36 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:03<00:16,  7.24it/s, est. speed input: 7538.79 toks/s, output: 7.36 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:04<00:15,  7.24it/s, est. speed input: 7537.58 toks/s, output: 7.36 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:05<00:14,  7.24it/s, est. speed input: 7536.54 toks/s, output: 7.36 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:06<00:12,  7.24it/s, est. speed input: 7535.51 toks/s, output: 7.36 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:07<00:11,  7.24it/s, est. speed input: 7534.29 toks/s, output: 7.36 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:08<00:10,  7.23it/s, est. speed input: 7532.99 toks/s, output: 7.36 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:09<00:09,  7.24it/s, est. speed input: 7532.24 toks/s, output: 7.36 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:10<00:08,  7.23it/s, est. speed input: 7531.01 toks/s, output: 7.35 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:11<00:07,  7.23it/s, est. speed input: 7529.93 toks/s, output: 7.35 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:13<00:06,  7.24it/s, est. speed input: 7529.02 toks/s, output: 7.35 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:14<00:05,  7.24it/s, est. speed input: 7528.04 toks/s, output: 7.35 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:15<00:04,  7.23it/s, est. speed input: 7526.91 toks/s, output: 7.35 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:16<00:03,  7.23it/s, est. speed input: 7525.96 toks/s, output: 7.35 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:17<00:01,  7.23it/s, est. speed input: 7525.05 toks/s, output: 7.35 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:18<00:00,  7.50it/s, est. speed input: 7531.28 toks/s, output: 7.35 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:18<00:00,  7.50it/s, est. speed input: 7575.66 toks/s, output: 7.40 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:18<00:00,  7.40it/s, est. speed input: 7575.66 toks/s, output: 7.40 toks/s]
[rank0]:[W126 18:24:31.332472623 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 204.1s

测试结果:
  Requests/s:   7.26
  Tokens/s:     7444.30
  Total Reqs:   1024
  Elapsed:      140.99s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     7437.04

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:24:44 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:24:44 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1596380) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1596380) WARNING 01-26 18:25:41 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.33 requests/s, 7511.97 total tokens/s, 7.33 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 18:24:44] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:24:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:24:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:24:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:24:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:24:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:24:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:24:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:24:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:24:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:24:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:24:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:24:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:24:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:24:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:24:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:24:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1596380) [2026-01-26 18:24:48] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1596380) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1596380) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.72s/it]
(EngineCore_DP0 pid=1596380) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.62s/it]
(EngineCore_DP0 pid=1596380) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.64s/it]
(EngineCore_DP0 pid=1596380) 
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1596380) [2026-01-26 18:25:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1596380) 2026-01-26 18:25:38,111 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1596380) 2026-01-26 18:25:38,451 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 29/2048 [00:00<00:07, 285.03it/s]
Adding requests:   3%|▎         | 65/2048 [00:00<00:06, 325.40it/s]
Adding requests:   5%|▍         | 101/2048 [00:00<00:05, 338.79it/s]
Adding requests:   7%|▋         | 142/2048 [00:00<00:05, 366.07it/s]
Adding requests:   9%|▉         | 185/2048 [00:00<00:04, 385.42it/s]
Adding requests:  11%|█         | 229/2048 [00:00<00:04, 402.55it/s]
Adding requests:  13%|█▎        | 270/2048 [00:00<00:04, 404.55it/s]
Adding requests:  15%|█▌        | 315/2048 [00:00<00:04, 418.58it/s]
Adding requests:  17%|█▋        | 357/2048 [00:00<00:04, 415.29it/s]
Adding requests:  19%|█▉        | 399/2048 [00:01<00:04, 412.10it/s]
Adding requests:  22%|██▏       | 441/2048 [00:01<00:03, 408.99it/s]
Adding requests:  24%|██▎       | 482/2048 [00:01<00:03, 408.45it/s]
Adding requests:  26%|██▌       | 530/2048 [00:01<00:03, 428.85it/s]
Adding requests:  28%|██▊       | 574/2048 [00:01<00:03, 429.04it/s]
Adding requests:  30%|███       | 617/2048 [00:01<00:03, 411.07it/s]
Adding requests:  32%|███▏      | 659/2048 [00:01<00:03, 405.39it/s]
Adding requests:  34%|███▍      | 700/2048 [00:01<00:03, 404.91it/s]
Adding requests:  36%|███▌      | 741/2048 [00:01<00:03, 395.17it/s]
Adding requests:  38%|███▊      | 781/2048 [00:01<00:03, 374.86it/s]
Adding requests:  40%|████      | 820/2048 [00:02<00:03, 376.97it/s]
Adding requests:  42%|████▏     | 858/2048 [00:02<00:09, 124.36it/s]
Adding requests:  44%|████▎     | 894/2048 [00:02<00:07, 151.73it/s]
Adding requests:  46%|████▌     | 932/2048 [00:03<00:06, 184.23it/s]
Adding requests:  47%|████▋     | 971/2048 [00:03<00:04, 219.16it/s]
Adding requests:  49%|████▉     | 1010/2048 [00:03<00:04, 252.09it/s]
Adding requests:  51%|█████▏    | 1051/2048 [00:03<00:03, 285.20it/s]
Adding requests:  53%|█████▎    | 1091/2048 [00:03<00:03, 312.30it/s]
Adding requests:  55%|█████▌    | 1134/2048 [00:03<00:02, 341.74it/s]
Adding requests:  57%|█████▋    | 1175/2048 [00:03<00:02, 357.85it/s]
Adding requests:  59%|█████▉    | 1217/2048 [00:03<00:02, 372.51it/s]
Adding requests:  61%|██████▏   | 1258/2048 [00:03<00:02, 375.02it/s]
Adding requests:  63%|██████▎   | 1298/2048 [00:04<00:01, 381.64it/s]
Adding requests:  65%|██████▌   | 1338/2048 [00:04<00:01, 380.11it/s]
Adding requests:  67%|██████▋   | 1380/2048 [00:04<00:01, 389.00it/s]
Adding requests:  69%|██████▉   | 1421/2048 [00:04<00:01, 393.81it/s]
Adding requests:  71%|███████▏  | 1462/2048 [00:04<00:01, 398.27it/s]
Adding requests:  73%|███████▎  | 1505/2048 [00:04<00:01, 405.94it/s]
Adding requests:  75%|███████▌  | 1546/2048 [00:04<00:01, 406.15it/s]
Adding requests:  77%|███████▋  | 1587/2048 [00:04<00:01, 395.43it/s]
Adding requests:  79%|███████▉  | 1627/2048 [00:04<00:01, 393.33it/s]
Adding requests:  81%|████████▏ | 1667/2048 [00:04<00:01, 379.26it/s]
Adding requests:  83%|████████▎ | 1708/2048 [00:05<00:00, 384.11it/s]
Adding requests:  85%|████████▌ | 1747/2048 [00:05<00:00, 377.18it/s]
Adding requests:  87%|████████▋ | 1787/2048 [00:05<00:00, 383.04it/s]
Adding requests:  89%|████████▉ | 1828/2048 [00:05<00:00, 390.57it/s]
Adding requests:  91%|█████████ | 1868/2048 [00:05<00:00, 388.31it/s]
Adding requests:  93%|█████████▎| 1911/2048 [00:05<00:00, 398.88it/s]
Adding requests:  95%|█████████▌| 1953/2048 [00:05<00:00, 404.41it/s]
Adding requests:  97%|█████████▋| 1994/2048 [00:05<00:00, 401.77it/s]
Adding requests:  99%|█████████▉| 2035/2048 [00:05<00:00, 362.89it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 344.10it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:00<00:51, 39.33it/s, est. speed input: 40271.02 toks/s, output: 39.33 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:03<02:24, 13.85it/s, est. speed input: 16346.70 toks/s, output: 15.96 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:05<03:09, 10.43it/s, est. speed input: 12691.08 toks/s, output: 12.39 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:07<03:36,  9.08it/s, est. speed input: 11156.38 toks/s, output: 10.89 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:09<03:52,  8.40it/s, est. speed input: 10320.61 toks/s, output: 10.08 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:11<04:01,  8.01it/s, est. speed input: 9793.76 toks/s, output: 9.56 toks/s] 
Processed prompts:   6%|▋         | 130/2048 [00:14<04:07,  7.75it/s, est. speed input: 9420.96 toks/s, output: 9.20 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:16<04:10,  7.60it/s, est. speed input: 9157.24 toks/s, output: 8.94 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:18<04:11,  7.50it/s, est. speed input: 8955.79 toks/s, output: 8.75 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:20<04:11,  7.43it/s, est. speed input: 8796.79 toks/s, output: 8.59 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:22<04:06,  7.53it/s, est. speed input: 8719.78 toks/s, output: 8.52 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:24<04:06,  7.44it/s, est. speed input: 8605.27 toks/s, output: 8.40 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:27<04:06,  7.39it/s, est. speed input: 8511.90 toks/s, output: 8.31 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:29<04:05,  7.36it/s, est. speed input: 8433.77 toks/s, output: 8.24 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:31<04:04,  7.33it/s, est. speed input: 8364.86 toks/s, output: 8.17 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:33<04:02,  7.32it/s, est. speed input: 8305.78 toks/s, output: 8.11 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:35<04:00,  7.30it/s, est. speed input: 8252.80 toks/s, output: 8.06 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:38<03:53,  7.44it/s, est. speed input: 8238.44 toks/s, output: 8.05 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:40<03:53,  7.39it/s, est. speed input: 8195.67 toks/s, output: 8.00 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:42<03:52,  7.36it/s, est. speed input: 8156.84 toks/s, output: 7.97 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:44<03:51,  7.33it/s, est. speed input: 8121.96 toks/s, output: 7.93 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:46<03:49,  7.32it/s, est. speed input: 8090.77 toks/s, output: 7.90 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:49<03:47,  7.30it/s, est. speed input: 8061.86 toks/s, output: 7.87 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:51<03:45,  7.29it/s, est. speed input: 8034.96 toks/s, output: 7.85 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:53<03:43,  7.29it/s, est. speed input: 8010.78 toks/s, output: 7.82 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:55<03:37,  7.43it/s, est. speed input: 8009.71 toks/s, output: 7.82 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:57<03:36,  7.38it/s, est. speed input: 7987.93 toks/s, output: 7.80 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:59<03:35,  7.35it/s, est. speed input: 7967.74 toks/s, output: 7.78 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:02<03:33,  7.32it/s, est. speed input: 7949.04 toks/s, output: 7.76 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:04<03:32,  7.30it/s, est. speed input: 7931.50 toks/s, output: 7.75 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:06<03:30,  7.29it/s, est. speed input: 7915.23 toks/s, output: 7.73 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:08<03:28,  7.29it/s, est. speed input: 7900.25 toks/s, output: 7.72 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:10<03:26,  7.28it/s, est. speed input: 7885.60 toks/s, output: 7.70 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:13<03:24,  7.27it/s, est. speed input: 7871.89 toks/s, output: 7.69 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:15<03:22,  7.27it/s, est. speed input: 7859.40 toks/s, output: 7.68 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:17<03:19,  7.27it/s, est. speed input: 7847.72 toks/s, output: 7.66 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:19<03:17,  7.27it/s, est. speed input: 7836.48 toks/s, output: 7.65 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:21<03:15,  7.27it/s, est. speed input: 7825.91 toks/s, output: 7.64 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:24<03:13,  7.27it/s, est. speed input: 7816.05 toks/s, output: 7.63 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:26<03:11,  7.27it/s, est. speed input: 7806.67 toks/s, output: 7.62 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:28<03:09,  7.27it/s, est. speed input: 7797.28 toks/s, output: 7.61 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:30<03:06,  7.27it/s, est. speed input: 7788.80 toks/s, output: 7.61 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:32<03:04,  7.27it/s, est. speed input: 7780.78 toks/s, output: 7.60 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:35<03:02,  7.27it/s, est. speed input: 7772.84 toks/s, output: 7.59 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [01:37<03:00,  7.27it/s, est. speed input: 7765.36 toks/s, output: 7.58 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [01:39<02:58,  7.27it/s, est. speed input: 7758.16 toks/s, output: 7.58 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [01:41<02:55,  7.26it/s, est. speed input: 7751.08 toks/s, output: 7.57 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [01:43<02:50,  7.42it/s, est. speed input: 7755.68 toks/s, output: 7.57 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [01:45<02:49,  7.37it/s, est. speed input: 7749.18 toks/s, output: 7.57 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [01:48<02:47,  7.34it/s, est. speed input: 7742.87 toks/s, output: 7.56 toks/s]
Processed prompts:  41%|████      | 834/2048 [01:50<02:45,  7.32it/s, est. speed input: 7736.94 toks/s, output: 7.56 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [01:52<02:44,  7.30it/s, est. speed input: 7731.03 toks/s, output: 7.55 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [01:54<02:42,  7.30it/s, est. speed input: 7725.76 toks/s, output: 7.54 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [01:56<02:40,  7.28it/s, est. speed input: 7720.29 toks/s, output: 7.54 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [01:59<02:38,  7.28it/s, est. speed input: 7715.02 toks/s, output: 7.53 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:01<02:35,  7.27it/s, est. speed input: 7709.84 toks/s, output: 7.53 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:03<02:33,  7.27it/s, est. speed input: 7705.23 toks/s, output: 7.52 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:05<02:31,  7.27it/s, est. speed input: 7700.58 toks/s, output: 7.52 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:07<02:29,  7.27it/s, est. speed input: 7696.16 toks/s, output: 7.52 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:10<02:27,  7.27it/s, est. speed input: 7691.89 toks/s, output: 7.51 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:12<02:25,  7.27it/s, est. speed input: 7687.60 toks/s, output: 7.51 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:14<02:22,  7.27it/s, est. speed input: 7683.74 toks/s, output: 7.50 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:16<02:20,  7.27it/s, est. speed input: 7679.77 toks/s, output: 7.50 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:19<02:18,  7.27it/s, est. speed input: 7675.93 toks/s, output: 7.50 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:21<02:16,  7.27it/s, est. speed input: 7672.39 toks/s, output: 7.49 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [02:23<02:14,  7.27it/s, est. speed input: 7668.85 toks/s, output: 7.49 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [02:25<02:11,  7.27it/s, est. speed input: 7665.38 toks/s, output: 7.49 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [02:27<02:09,  7.27it/s, est. speed input: 7662.10 toks/s, output: 7.48 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [02:30<02:07,  7.27it/s, est. speed input: 7658.83 toks/s, output: 7.48 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [02:32<02:05,  7.27it/s, est. speed input: 7655.72 toks/s, output: 7.48 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [02:34<02:03,  7.26it/s, est. speed input: 7652.44 toks/s, output: 7.47 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [02:36<02:00,  7.26it/s, est. speed input: 7649.24 toks/s, output: 7.47 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [02:38<01:58,  7.26it/s, est. speed input: 7646.20 toks/s, output: 7.47 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [02:40<01:54,  7.42it/s, est. speed input: 7650.84 toks/s, output: 7.47 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [02:43<01:52,  7.37it/s, est. speed input: 7647.88 toks/s, output: 7.47 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [02:45<01:48,  7.50it/s, est. speed input: 7652.27 toks/s, output: 7.47 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [02:47<01:47,  7.43it/s, est. speed input: 7649.41 toks/s, output: 7.47 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [02:49<01:46,  7.37it/s, est. speed input: 7646.56 toks/s, output: 7.47 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [02:51<01:44,  7.34it/s, est. speed input: 7643.91 toks/s, output: 7.46 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [02:53<01:42,  7.32it/s, est. speed input: 7641.24 toks/s, output: 7.46 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [02:56<01:40,  7.31it/s, est. speed input: 7638.92 toks/s, output: 7.46 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [02:58<01:36,  7.45it/s, est. speed input: 7642.95 toks/s, output: 7.46 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:00<01:34,  7.39it/s, est. speed input: 7640.42 toks/s, output: 7.46 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:02<01:33,  7.36it/s, est. speed input: 7638.13 toks/s, output: 7.46 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:04<01:31,  7.33it/s, est. speed input: 7635.77 toks/s, output: 7.46 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:07<01:29,  7.31it/s, est. speed input: 7633.29 toks/s, output: 7.45 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:09<01:27,  7.29it/s, est. speed input: 7631.03 toks/s, output: 7.45 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [03:11<01:25,  7.29it/s, est. speed input: 7628.85 toks/s, output: 7.45 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [03:13<01:21,  7.43it/s, est. speed input: 7632.54 toks/s, output: 7.45 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [03:15<01:18,  7.53it/s, est. speed input: 7636.18 toks/s, output: 7.46 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [03:17<01:17,  7.45it/s, est. speed input: 7633.93 toks/s, output: 7.46 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [03:19<01:15,  7.40it/s, est. speed input: 7631.91 toks/s, output: 7.45 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [03:22<01:13,  7.36it/s, est. speed input: 7629.86 toks/s, output: 7.45 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [03:24<01:10,  7.48it/s, est. speed input: 7633.40 toks/s, output: 7.45 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [03:26<01:08,  7.42it/s, est. speed input: 7631.35 toks/s, output: 7.45 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [03:28<01:05,  7.53it/s, est. speed input: 7634.87 toks/s, output: 7.46 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [03:30<01:04,  7.45it/s, est. speed input: 7632.85 toks/s, output: 7.45 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [03:32<01:02,  7.39it/s, est. speed input: 7630.83 toks/s, output: 7.45 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [03:35<01:00,  7.35it/s, est. speed input: 7628.89 toks/s, output: 7.45 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [03:37<00:57,  7.48it/s, est. speed input: 7632.24 toks/s, output: 7.45 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [03:39<00:55,  7.42it/s, est. speed input: 7630.33 toks/s, output: 7.45 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [03:41<00:54,  7.36it/s, est. speed input: 7628.23 toks/s, output: 7.45 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [03:43<00:52,  7.33it/s, est. speed input: 7626.33 toks/s, output: 7.45 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [03:45<00:50,  7.31it/s, est. speed input: 7624.50 toks/s, output: 7.45 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [03:48<00:47,  7.30it/s, est. speed input: 7622.78 toks/s, output: 7.44 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [03:50<00:45,  7.29it/s, est. speed input: 7620.96 toks/s, output: 7.44 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [03:52<00:42,  7.43it/s, est. speed input: 7624.22 toks/s, output: 7.45 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [03:54<00:39,  7.66it/s, est. speed input: 7630.92 toks/s, output: 7.45 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [03:56<00:37,  7.54it/s, est. speed input: 7629.17 toks/s, output: 7.45 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [03:58<00:36,  7.45it/s, est. speed input: 7627.44 toks/s, output: 7.45 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [04:00<00:34,  7.39it/s, est. speed input: 7625.56 toks/s, output: 7.45 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [04:03<00:32,  7.35it/s, est. speed input: 7623.93 toks/s, output: 7.45 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [04:05<00:30,  7.32it/s, est. speed input: 7622.19 toks/s, output: 7.44 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [04:07<00:28,  7.31it/s, est. speed input: 7620.55 toks/s, output: 7.44 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [04:09<00:26,  7.29it/s, est. speed input: 7618.89 toks/s, output: 7.44 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [04:11<00:23,  7.28it/s, est. speed input: 7617.34 toks/s, output: 7.44 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [04:13<00:21,  7.43it/s, est. speed input: 7620.40 toks/s, output: 7.44 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [04:16<00:19,  7.39it/s, est. speed input: 7618.91 toks/s, output: 7.44 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [04:18<00:17,  7.35it/s, est. speed input: 7617.41 toks/s, output: 7.44 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [04:20<00:15,  7.32it/s, est. speed input: 7615.83 toks/s, output: 7.44 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [04:22<00:12,  7.30it/s, est. speed input: 7614.25 toks/s, output: 7.44 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [04:24<00:10,  7.29it/s, est. speed input: 7612.75 toks/s, output: 7.43 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [04:27<00:08,  7.44it/s, est. speed input: 7615.71 toks/s, output: 7.44 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [04:29<00:06,  7.38it/s, est. speed input: 7614.15 toks/s, output: 7.44 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [04:31<00:04,  7.35it/s, est. speed input: 7612.75 toks/s, output: 7.43 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [04:33<00:01,  7.48it/s, est. speed input: 7615.60 toks/s, output: 7.44 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [04:33<00:00,  7.48it/s, est. speed input: 7668.01 toks/s, output: 7.49 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [04:33<00:00,  7.49it/s, est. speed input: 7668.01 toks/s, output: 7.49 toks/s]
[rank0]:[W126 18:30:21.574438540 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 350.3s

测试结果:
  Requests/s:   7.33
  Tokens/s:     7511.97
  Total Reqs:   2048
  Elapsed:      279.45s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     7504.64

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:30:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:30:41 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1601489) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1601489) WARNING 01-26 18:31:43 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 7.44 requests/s, 7625.99 total tokens/s, 7.44 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 18:30:41] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:30:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:30:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:30:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:30:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:30:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:30:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:30:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:30:44] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:30:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:30:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:30:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:30:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:30:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:30:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:30:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:30:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1601489) [2026-01-26 18:30:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1601489) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1601489) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:20<00:20, 20.15s/it]
(EngineCore_DP0 pid=1601489) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.68s/it]
(EngineCore_DP0 pid=1601489) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:41<00:00, 20.60s/it]
(EngineCore_DP0 pid=1601489) 
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1601489) [2026-01-26 18:31:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1601489) 2026-01-26 18:31:37,558 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1601489) 2026-01-26 18:31:38,128 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 48/4096 [00:00<00:08, 465.69it/s]
Adding requests:   2%|▏         | 95/4096 [00:00<00:09, 405.83it/s]
Adding requests:   3%|▎         | 137/4096 [00:00<00:10, 386.73it/s]
Adding requests:   4%|▍         | 176/4096 [00:00<00:10, 386.29it/s]
Adding requests:   5%|▌         | 220/4096 [00:00<00:09, 402.91it/s]
Adding requests:   6%|▋         | 261/4096 [00:00<00:09, 399.65it/s]
Adding requests:   7%|▋         | 303/4096 [00:00<00:09, 404.85it/s]
Adding requests:   8%|▊         | 344/4096 [00:00<00:09, 405.23it/s]
Adding requests:   9%|▉         | 387/4096 [00:00<00:09, 411.28it/s]
Adding requests:  10%|█         | 429/4096 [00:01<00:08, 410.94it/s]
Adding requests:  11%|█▏        | 471/4096 [00:01<00:08, 413.61it/s]
Adding requests:  13%|█▎        | 517/4096 [00:01<00:08, 426.41it/s]
Adding requests:  14%|█▎        | 561/4096 [00:01<00:08, 427.75it/s]
Adding requests:  15%|█▍        | 604/4096 [00:01<00:08, 415.04it/s]
Adding requests:  16%|█▌        | 647/4096 [00:01<00:08, 415.88it/s]
Adding requests:  17%|█▋        | 689/4096 [00:01<00:08, 414.67it/s]
Adding requests:  18%|█▊        | 731/4096 [00:01<00:08, 409.11it/s]
Adding requests:  19%|█▉        | 772/4096 [00:01<00:08, 408.35it/s]
Adding requests:  20%|█▉        | 814/4096 [00:01<00:08, 409.00it/s]
Adding requests:  21%|██        | 855/4096 [00:02<00:07, 407.00it/s]
Adding requests:  22%|██▏       | 900/4096 [00:02<00:07, 417.24it/s]
Adding requests:  23%|██▎       | 942/4096 [00:02<00:07, 409.97it/s]
Adding requests:  24%|██▍       | 984/4096 [00:02<00:07, 412.83it/s]
Adding requests:  25%|██▌       | 1026/4096 [00:02<00:07, 413.77it/s]
Adding requests:  26%|██▌       | 1068/4096 [00:02<00:07, 409.78it/s]
Adding requests:  27%|██▋       | 1110/4096 [00:02<00:07, 411.80it/s]
Adding requests:  28%|██▊       | 1153/4096 [00:02<00:07, 415.97it/s]
Adding requests:  29%|██▉       | 1195/4096 [00:02<00:07, 383.98it/s]
Adding requests:  30%|███       | 1234/4096 [00:03<00:07, 378.21it/s]
Adding requests:  31%|███       | 1275/4096 [00:03<00:07, 385.52it/s]
Adding requests:  32%|███▏      | 1317/4096 [00:03<00:07, 393.51it/s]
Adding requests:  33%|███▎      | 1359/4096 [00:03<00:06, 400.16it/s]
Adding requests:  34%|███▍      | 1401/4096 [00:03<00:06, 405.55it/s]
Adding requests:  35%|███▌      | 1444/4096 [00:03<00:06, 411.57it/s]
Adding requests:  36%|███▋      | 1488/4096 [00:03<00:06, 417.45it/s]
Adding requests:  37%|███▋      | 1530/4096 [00:03<00:06, 414.84it/s]
Adding requests:  38%|███▊      | 1572/4096 [00:03<00:06, 412.63it/s]
Adding requests:  39%|███▉      | 1614/4096 [00:03<00:06, 404.47it/s]
Adding requests:  40%|████      | 1655/4096 [00:04<00:06, 397.36it/s]
Adding requests:  41%|████▏     | 1697/4096 [00:04<00:05, 400.92it/s]
Adding requests:  42%|████▏     | 1738/4096 [00:04<00:05, 403.44it/s]
Adding requests:  44%|████▎     | 1783/4096 [00:04<00:05, 413.18it/s]
Adding requests:  45%|████▍     | 1825/4096 [00:04<00:05, 408.08it/s]
Adding requests:  46%|████▌     | 1867/4096 [00:04<00:05, 409.80it/s]
Adding requests:  47%|████▋     | 1909/4096 [00:04<00:05, 404.66it/s]
Adding requests:  48%|████▊     | 1952/4096 [00:04<00:05, 410.69it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:04<00:05, 401.59it/s]
Adding requests:  50%|████▉     | 2035/4096 [00:05<00:05, 388.35it/s]
Adding requests:  51%|█████     | 2075/4096 [00:05<00:05, 390.38it/s]
Adding requests:  52%|█████▏    | 2116/4096 [00:05<00:05, 395.45it/s]
Adding requests:  53%|█████▎    | 2157/4096 [00:05<00:04, 398.98it/s]
Adding requests:  54%|█████▎    | 2197/4096 [00:05<00:04, 395.98it/s]
Adding requests:  55%|█████▍    | 2238/4096 [00:05<00:04, 398.27it/s]
Adding requests:  56%|█████▌    | 2284/4096 [00:05<00:04, 412.40it/s]
Adding requests:  57%|█████▋    | 2326/4096 [00:05<00:04, 413.92it/s]
Adding requests:  58%|█████▊    | 2370/4096 [00:05<00:04, 420.76it/s]
Adding requests:  59%|█████▉    | 2417/4096 [00:05<00:03, 431.62it/s]
Adding requests:  60%|██████    | 2461/4096 [00:06<00:04, 387.02it/s]
Adding requests:  61%|██████    | 2503/4096 [00:06<00:04, 395.06it/s]
Adding requests:  62%|██████▏   | 2549/4096 [00:06<00:03, 411.03it/s]
Adding requests:  63%|██████▎   | 2592/4096 [00:06<00:03, 416.16it/s]
Adding requests:  64%|██████▍   | 2635/4096 [00:06<00:03, 408.92it/s]
Adding requests:  65%|██████▌   | 2678/4096 [00:06<00:03, 411.61it/s]
Adding requests:  66%|██████▋   | 2720/4096 [00:06<00:03, 408.03it/s]
Adding requests:  67%|██████▋   | 2763/4096 [00:06<00:03, 413.56it/s]
Adding requests:  68%|██████▊   | 2805/4096 [00:06<00:03, 411.48it/s]
Adding requests:  70%|██████▉   | 2848/4096 [00:06<00:02, 416.65it/s]
Adding requests:  71%|███████   | 2890/4096 [00:07<00:02, 409.74it/s]
Adding requests:  72%|███████▏  | 2932/4096 [00:07<00:02, 405.40it/s]
Adding requests:  73%|███████▎  | 2979/4096 [00:07<00:02, 422.26it/s]
Adding requests:  74%|███████▍  | 3022/4096 [00:07<00:02, 418.37it/s]
Adding requests:  75%|███████▍  | 3067/4096 [00:07<00:02, 425.27it/s]
Adding requests:  76%|███████▌  | 3113/4096 [00:07<00:02, 433.71it/s]
Adding requests:  77%|███████▋  | 3157/4096 [00:07<00:02, 424.17it/s]
Adding requests:  78%|███████▊  | 3200/4096 [00:07<00:02, 421.19it/s]
Adding requests:  79%|███████▉  | 3246/4096 [00:07<00:01, 431.20it/s]
Adding requests:  80%|████████  | 3290/4096 [00:08<00:01, 414.61it/s]
Adding requests:  81%|████████▏ | 3332/4096 [00:08<00:01, 414.17it/s]
Adding requests:  82%|████████▏ | 3377/4096 [00:08<00:01, 421.62it/s]
Adding requests:  83%|████████▎ | 3420/4096 [00:08<00:01, 418.60it/s]
Adding requests:  85%|████████▍ | 3463/4096 [00:08<00:01, 421.43it/s]
Adding requests:  86%|████████▌ | 3507/4096 [00:08<00:01, 424.20it/s]
Adding requests:  87%|████████▋ | 3550/4096 [00:08<00:01, 419.63it/s]
Adding requests:  88%|████████▊ | 3603/4096 [00:08<00:01, 449.11it/s]
Adding requests:  89%|████████▉ | 3648/4096 [00:08<00:01, 433.12it/s]
Adding requests:  90%|█████████ | 3692/4096 [00:08<00:00, 424.54it/s]
Adding requests:  91%|█████████ | 3735/4096 [00:09<00:00, 416.71it/s]
Adding requests:  92%|█████████▏| 3777/4096 [00:09<00:00, 394.43it/s]
Adding requests:  93%|█████████▎| 3817/4096 [00:09<00:00, 359.77it/s]
Adding requests:  94%|█████████▍| 3855/4096 [00:09<00:00, 364.86it/s]
Adding requests:  95%|█████████▌| 3896/4096 [00:09<00:00, 375.56it/s]
Adding requests:  96%|█████████▌| 3936/4096 [00:09<00:00, 380.75it/s]
Adding requests:  97%|█████████▋| 3977/4096 [00:09<00:00, 387.53it/s]
Adding requests:  98%|█████████▊| 4017/4096 [00:09<00:00, 382.69it/s]
Adding requests:  99%|█████████▉| 4056/4096 [00:09<00:00, 379.78it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 406.85it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:03<03:20, 20.06it/s, est. speed input: 20543.23 toks/s, output: 20.06 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:07<05:39, 11.79it/s, est. speed input: 13165.79 toks/s, output: 12.86 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:11<06:50,  9.66it/s, est. speed input: 11136.14 toks/s, output: 10.88 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:16<07:30,  8.74it/s, est. speed input: 10188.58 toks/s, output: 9.95 toks/s] 
Processed prompts:   5%|▍         | 194/4096 [00:20<07:48,  8.33it/s, est. speed input: 9693.64 toks/s, output: 9.47 toks/s] 
Processed prompts:   6%|▌         | 226/4096 [00:24<08:04,  7.99it/s, est. speed input: 9317.62 toks/s, output: 9.10 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:29<08:12,  7.79it/s, est. speed input: 9055.54 toks/s, output: 8.84 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:33<08:11,  7.74it/s, est. speed input: 8898.18 toks/s, output: 8.69 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:37<08:15,  7.62it/s, est. speed input: 8743.46 toks/s, output: 8.54 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:42<08:15,  7.55it/s, est. speed input: 8620.56 toks/s, output: 8.42 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:46<08:15,  7.49it/s, est. speed input: 8519.70 toks/s, output: 8.32 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:50<08:08,  7.53it/s, est. speed input: 8460.70 toks/s, output: 8.26 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:54<08:07,  7.48it/s, est. speed input: 8388.74 toks/s, output: 8.19 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:59<08:05,  7.45it/s, est. speed input: 8326.92 toks/s, output: 8.13 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:03<08:02,  7.42it/s, est. speed input: 8273.87 toks/s, output: 8.08 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:07<07:59,  7.41it/s, est. speed input: 8227.40 toks/s, output: 8.03 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:12<07:55,  7.40it/s, est. speed input: 8186.57 toks/s, output: 7.99 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:16<07:51,  7.39it/s, est. speed input: 8150.57 toks/s, output: 7.96 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:20<07:47,  7.39it/s, est. speed input: 8119.20 toks/s, output: 7.93 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:25<07:43,  7.39it/s, est. speed input: 8090.73 toks/s, output: 7.90 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:29<07:39,  7.38it/s, est. speed input: 8063.99 toks/s, output: 7.87 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:33<07:35,  7.38it/s, est. speed input: 8040.18 toks/s, output: 7.85 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [01:38<07:26,  7.45it/s, est. speed input: 8030.05 toks/s, output: 7.84 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [01:42<07:23,  7.42it/s, est. speed input: 8009.41 toks/s, output: 7.82 toks/s]
Processed prompts:  20%|██        | 834/4096 [01:46<07:20,  7.41it/s, est. speed input: 7990.87 toks/s, output: 7.80 toks/s]
Processed prompts:  21%|██        | 866/4096 [01:51<07:16,  7.40it/s, est. speed input: 7973.54 toks/s, output: 7.79 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [01:55<07:12,  7.39it/s, est. speed input: 7957.86 toks/s, output: 7.77 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:59<07:08,  7.39it/s, est. speed input: 7943.13 toks/s, output: 7.76 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:04<07:04,  7.38it/s, est. speed input: 7929.12 toks/s, output: 7.74 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:08<07:00,  7.38it/s, est. speed input: 7916.58 toks/s, output: 7.73 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:12<06:55,  7.38it/s, est. speed input: 7904.81 toks/s, output: 7.72 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:17<06:51,  7.38it/s, est. speed input: 7893.46 toks/s, output: 7.71 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:21<06:47,  7.37it/s, est. speed input: 7882.79 toks/s, output: 7.70 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:25<06:43,  7.37it/s, est. speed input: 7872.73 toks/s, output: 7.69 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [02:30<06:39,  7.37it/s, est. speed input: 7863.31 toks/s, output: 7.68 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [02:34<06:31,  7.44it/s, est. speed input: 7861.48 toks/s, output: 7.68 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [02:38<06:24,  7.49it/s, est. speed input: 7859.84 toks/s, output: 7.68 toks/s]
Processed prompts:  31%|███       | 1250/4096 [02:43<06:21,  7.46it/s, est. speed input: 7851.51 toks/s, output: 7.67 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [02:47<06:18,  7.43it/s, est. speed input: 7843.73 toks/s, output: 7.66 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [02:51<06:11,  7.49it/s, est. speed input: 7842.71 toks/s, output: 7.66 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [02:55<06:09,  7.45it/s, est. speed input: 7835.28 toks/s, output: 7.65 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:00<06:06,  7.42it/s, est. speed input: 7828.06 toks/s, output: 7.64 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:04<06:02,  7.41it/s, est. speed input: 7821.61 toks/s, output: 7.64 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:08<05:53,  7.51it/s, est. speed input: 7824.63 toks/s, output: 7.64 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:13<05:51,  7.47it/s, est. speed input: 7818.33 toks/s, output: 7.64 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:17<05:44,  7.51it/s, est. speed input: 7817.96 toks/s, output: 7.63 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [03:21<05:39,  7.54it/s, est. speed input: 7817.21 toks/s, output: 7.63 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [03:25<05:37,  7.49it/s, est. speed input: 7811.51 toks/s, output: 7.63 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [03:30<05:31,  7.52it/s, est. speed input: 7811.20 toks/s, output: 7.63 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [03:34<05:29,  7.48it/s, est. speed input: 7805.78 toks/s, output: 7.62 toks/s]
Processed prompts:  41%|████      | 1666/4096 [03:38<05:26,  7.44it/s, est. speed input: 7800.59 toks/s, output: 7.62 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [03:43<05:23,  7.42it/s, est. speed input: 7795.56 toks/s, output: 7.61 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [03:46<05:10,  7.62it/s, est. speed input: 7804.65 toks/s, output: 7.62 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [03:51<05:09,  7.54it/s, est. speed input: 7799.90 toks/s, output: 7.62 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [03:55<05:07,  7.49it/s, est. speed input: 7795.36 toks/s, output: 7.61 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [03:59<05:04,  7.46it/s, est. speed input: 7790.99 toks/s, output: 7.61 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:04<05:01,  7.43it/s, est. speed input: 7786.63 toks/s, output: 7.60 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [04:08<04:54,  7.48it/s, est. speed input: 7786.66 toks/s, output: 7.60 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [04:12<04:51,  7.45it/s, est. speed input: 7782.68 toks/s, output: 7.60 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [04:17<04:48,  7.43it/s, est. speed input: 7778.69 toks/s, output: 7.60 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [04:21<04:42,  7.48it/s, est. speed input: 7778.99 toks/s, output: 7.60 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [04:25<04:39,  7.45it/s, est. speed input: 7775.05 toks/s, output: 7.59 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [04:29<04:31,  7.54it/s, est. speed input: 7778.06 toks/s, output: 7.60 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [04:34<04:28,  7.49it/s, est. speed input: 7774.35 toks/s, output: 7.59 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [04:38<04:25,  7.46it/s, est. speed input: 7770.96 toks/s, output: 7.59 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [04:42<04:22,  7.43it/s, est. speed input: 7767.42 toks/s, output: 7.59 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [04:47<04:16,  7.48it/s, est. speed input: 7767.65 toks/s, output: 7.59 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [04:51<04:13,  7.45it/s, est. speed input: 7764.47 toks/s, output: 7.58 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [04:55<04:09,  7.43it/s, est. speed input: 7761.39 toks/s, output: 7.58 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [05:00<04:05,  7.41it/s, est. speed input: 7758.36 toks/s, output: 7.58 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [05:04<04:01,  7.40it/s, est. speed input: 7755.27 toks/s, output: 7.57 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [05:08<03:55,  7.46it/s, est. speed input: 7755.63 toks/s, output: 7.57 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [05:13<03:52,  7.43it/s, est. speed input: 7752.69 toks/s, output: 7.57 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [05:17<03:48,  7.41it/s, est. speed input: 7749.78 toks/s, output: 7.57 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [05:21<03:44,  7.40it/s, est. speed input: 7746.96 toks/s, output: 7.57 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [05:26<03:40,  7.39it/s, est. speed input: 7744.29 toks/s, output: 7.56 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [05:30<03:36,  7.38it/s, est. speed input: 7741.60 toks/s, output: 7.56 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [05:34<03:30,  7.45it/s, est. speed input: 7742.24 toks/s, output: 7.56 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [05:38<03:26,  7.42it/s, est. speed input: 7739.76 toks/s, output: 7.56 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [05:43<03:20,  7.48it/s, est. speed input: 7740.27 toks/s, output: 7.56 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [05:47<03:17,  7.45it/s, est. speed input: 7737.93 toks/s, output: 7.56 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [05:51<03:11,  7.49it/s, est. speed input: 7738.56 toks/s, output: 7.56 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [05:56<03:08,  7.46it/s, est. speed input: 7736.20 toks/s, output: 7.55 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [06:00<03:03,  7.50it/s, est. speed input: 7736.91 toks/s, output: 7.56 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [06:04<02:59,  7.46it/s, est. speed input: 7734.62 toks/s, output: 7.55 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [06:08<02:56,  7.43it/s, est. speed input: 7732.45 toks/s, output: 7.55 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [06:13<02:52,  7.42it/s, est. speed input: 7730.37 toks/s, output: 7.55 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [06:17<02:48,  7.40it/s, est. speed input: 7728.21 toks/s, output: 7.55 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [06:21<02:39,  7.61it/s, est. speed input: 7734.45 toks/s, output: 7.55 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [06:25<02:35,  7.61it/s, est. speed input: 7735.01 toks/s, output: 7.55 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [06:30<02:32,  7.54it/s, est. speed input: 7732.96 toks/s, output: 7.55 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [06:34<02:27,  7.55it/s, est. speed input: 7733.50 toks/s, output: 7.55 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [06:38<02:24,  7.50it/s, est. speed input: 7731.36 toks/s, output: 7.55 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [06:43<02:21,  7.46it/s, est. speed input: 7729.37 toks/s, output: 7.55 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [06:47<02:17,  7.43it/s, est. speed input: 7727.51 toks/s, output: 7.55 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [06:51<02:13,  7.41it/s, est. speed input: 7725.54 toks/s, output: 7.54 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [06:56<02:09,  7.40it/s, est. speed input: 7723.58 toks/s, output: 7.54 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [07:00<02:04,  7.46it/s, est. speed input: 7724.16 toks/s, output: 7.54 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [07:04<02:00,  7.43it/s, est. speed input: 7722.34 toks/s, output: 7.54 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [07:08<01:56,  7.41it/s, est. speed input: 7720.57 toks/s, output: 7.54 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [07:13<01:52,  7.40it/s, est. speed input: 7718.73 toks/s, output: 7.54 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [07:17<01:47,  7.39it/s, est. speed input: 7717.10 toks/s, output: 7.54 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [07:21<01:43,  7.39it/s, est. speed input: 7715.46 toks/s, output: 7.53 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [07:26<01:39,  7.38it/s, est. speed input: 7713.84 toks/s, output: 7.53 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [07:30<01:34,  7.45it/s, est. speed input: 7714.54 toks/s, output: 7.53 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [07:34<01:30,  7.42it/s, est. speed input: 7712.90 toks/s, output: 7.53 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [07:39<01:26,  7.41it/s, est. speed input: 7711.27 toks/s, output: 7.53 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [07:43<01:21,  7.39it/s, est. speed input: 7709.71 toks/s, output: 7.53 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [07:47<01:17,  7.39it/s, est. speed input: 7708.17 toks/s, output: 7.53 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [07:52<01:12,  7.45it/s, est. speed input: 7708.97 toks/s, output: 7.53 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [07:56<01:08,  7.43it/s, est. speed input: 7707.43 toks/s, output: 7.53 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [08:00<01:03,  7.48it/s, est. speed input: 7708.10 toks/s, output: 7.53 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [08:04<00:59,  7.45it/s, est. speed input: 7706.67 toks/s, output: 7.53 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [08:09<00:54,  7.54it/s, est. speed input: 7708.81 toks/s, output: 7.53 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [08:13<00:51,  7.49it/s, est. speed input: 7707.39 toks/s, output: 7.53 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [08:17<00:46,  7.45it/s, est. speed input: 7705.91 toks/s, output: 7.53 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [08:22<00:42,  7.42it/s, est. speed input: 7704.45 toks/s, output: 7.52 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [08:26<00:38,  7.41it/s, est. speed input: 7703.08 toks/s, output: 7.52 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [08:30<00:34,  7.39it/s, est. speed input: 7701.70 toks/s, output: 7.52 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [08:35<00:30,  7.39it/s, est. speed input: 7700.37 toks/s, output: 7.52 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [08:39<00:25,  7.45it/s, est. speed input: 7701.10 toks/s, output: 7.52 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [08:43<00:21,  7.50it/s, est. speed input: 7701.76 toks/s, output: 7.52 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [08:47<00:16,  7.46it/s, est. speed input: 7700.46 toks/s, output: 7.52 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [08:52<00:12,  7.50it/s, est. speed input: 7701.26 toks/s, output: 7.52 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [08:56<00:08,  7.53it/s, est. speed input: 7701.86 toks/s, output: 7.52 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [09:00<00:03,  7.60it/s, est. speed input: 7703.67 toks/s, output: 7.52 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [09:00<00:00,  7.60it/s, est. speed input: 7760.51 toks/s, output: 7.58 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [09:00<00:00,  7.58it/s, est. speed input: 7760.51 toks/s, output: 7.58 toks/s]
[rank0]:[W126 18:40:54.943358900 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 633.4s

测试结果:
  Requests/s:   7.44
  Tokens/s:     7625.99
  Total Reqs:   4096
  Elapsed:      550.54s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     7618.55

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:41:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:41:29 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1610544) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1610544) ERROR 01-26 18:42:19 [core.py:866] 


─── STDERR ───
[2026-01-26 18:41:29] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:41:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:41:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:41:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:41:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:41:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:41:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:41:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:41:32] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:41:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:41:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:41:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:41:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:41:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:41:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:41:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:41:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1610544) [2026-01-26 18:41:34] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1610544) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1610544) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:21<00:21, 21.31s/it]
(EngineCore_DP0 pid=1610544) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.29s/it]
(EngineCore_DP0 pid=1610544) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:42<00:00, 21.29s/it]
(EngineCore_DP0 pid=1610544) 
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 3584] -> 1D uint8
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10321920 bytes
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 3584] -> 1D uint8
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8028160 bytes
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 3584] -> 1D uint8
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 84869120 bytes
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 18944] -> 1D uint8
(EngineCore_DP0 pid=1610544) [2026-01-26 18:42:17] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 42434560 bytes
(EngineCore_DP0 pid=1610544) Process EngineCore_DP0:
(EngineCore_DP0 pid=1610544) Traceback (most recent call last):
(EngineCore_DP0 pid=1610544)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1610544)     self.run()
(EngineCore_DP0 pid=1610544)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1610544)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1610544)     raise e
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1610544)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1610544)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1610544)     super().__init__(
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1610544)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1610544)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1610544)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1610544)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1610544)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1610544)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1610544)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1610544)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1610544)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1610544)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1610544)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1610544)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1610544)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1610544)     outputs = self.model(
(EngineCore_DP0 pid=1610544)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1610544)     hidden_states = self.model(
(EngineCore_DP0 pid=1610544)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1610544)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1610544)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1610544)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1610544)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1610544)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1610544)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1610544)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1610544)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1610544)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1610544)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1610544)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1610544)     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1610544)     return self._linear_fn(
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1610544)     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1610544)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1610544)     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1610544)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1610544)     return fn(input, L)
(EngineCore_DP0 pid=1610544)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1610544)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1610544)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1610544) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1610544) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1610544) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1610544) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1610544) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1610544) 
[rank0]:[W126 18:42:19.097930897 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_4/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,12.3758,6348.7660,10.3428
1024,1024,1,128,128,7.4254,7611.0746,17.2380
2048,1024,2,256,128,7.4049,7590.0250,34.5717
4096,1024,4,512,128,7.1577,7336.6120,71.5317
8192,1024,8,1024,128,7.2627,7444.3021,140.9937
16384,1024,16,2048,128,7.3288,7511.9719,279.4473
32768,1024,32,4096,128,7.4400,7625.9932,550.5381
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_6

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:42:25 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:42:25 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1611492) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1611492) WARNING 01-26 18:43:35 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 11.60 requests/s, 5948.67 total tokens/s, 11.60 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 18:42:25] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:42:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:42:25] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:42:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:42:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:42:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:42:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:42:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:42:28] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:42:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:42:28] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:42:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:42:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:42:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:42:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:42:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:42:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1611492) [2026-01-26 18:42:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1611492) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1611492) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:23<00:23, 23.81s/it]
(EngineCore_DP0 pid=1611492) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 29.44s/it]
(EngineCore_DP0 pid=1611492) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 28.60s/it]
(EngineCore_DP0 pid=1611492) 
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1611492) [2026-01-26 18:43:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1611492) 2026-01-26 18:43:34,937 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1611492) 2026-01-26 18:43:34,963 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  12%|█▎        | 16/128 [00:00<00:00, 157.39it/s]
Adding requests:  74%|███████▍  | 95/128 [00:00<00:00, 524.74it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 525.27it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:09, 13.63it/s, est. speed input: 6979.78 toks/s, output: 13.63 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:09, 12.55it/s, est. speed input: 6501.63 toks/s, output: 12.70 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 12.27it/s, est. speed input: 6370.07 toks/s, output: 12.44 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:09, 12.14it/s, est. speed input: 6303.08 toks/s, output: 12.31 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:09, 12.05it/s, est. speed input: 6259.79 toks/s, output: 12.23 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:09, 12.04it/s, est. speed input: 6241.00 toks/s, output: 12.19 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:09, 12.02it/s, est. speed input: 6226.87 toks/s, output: 12.16 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:09, 12.06it/s, est. speed input: 6224.42 toks/s, output: 12.16 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:09, 11.96it/s, est. speed input: 6201.82 toks/s, output: 12.11 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:09, 11.99it/s, est. speed input: 6198.66 toks/s, output: 12.11 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:08, 11.92it/s, est. speed input: 6182.55 toks/s, output: 12.08 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:08, 11.84it/s, est. speed input: 6164.50 toks/s, output: 12.04 toks/s]
Processed prompts:  20%|██        | 26/128 [00:02<00:08, 11.88it/s, est. speed input: 6161.12 toks/s, output: 12.03 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:02<00:08, 11.91it/s, est. speed input: 6159.19 toks/s, output: 12.03 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:02<00:08, 12.01it/s, est. speed input: 6166.91 toks/s, output: 12.04 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:08, 12.00it/s, est. speed input: 6164.32 toks/s, output: 12.04 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:07, 12.03it/s, est. speed input: 6166.12 toks/s, output: 12.04 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:07, 11.88it/s, est. speed input: 6151.36 toks/s, output: 12.01 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:03<00:07, 11.94it/s, est. speed input: 6153.69 toks/s, output: 12.02 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:03<00:07, 11.93it/s, est. speed input: 6150.85 toks/s, output: 12.01 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:03<00:07, 11.94it/s, est. speed input: 6149.80 toks/s, output: 12.01 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:03<00:07, 11.92it/s, est. speed input: 6146.27 toks/s, output: 12.00 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:03<00:06, 11.91it/s, est. speed input: 6143.73 toks/s, output: 12.00 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:04<00:06, 11.79it/s, est. speed input: 6133.11 toks/s, output: 11.98 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:04<00:06, 11.84it/s, est. speed input: 6132.38 toks/s, output: 11.98 toks/s]
Processed prompts:  41%|████      | 52/128 [00:04<00:06, 11.87it/s, est. speed input: 6131.61 toks/s, output: 11.98 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:04<00:06, 11.89it/s, est. speed input: 6131.30 toks/s, output: 11.98 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:04<00:06, 12.00it/s, est. speed input: 6136.02 toks/s, output: 11.98 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:04<00:05, 11.97it/s, est. speed input: 6134.53 toks/s, output: 11.98 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:05<00:05, 11.95it/s, est. speed input: 6133.08 toks/s, output: 11.98 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:05<00:05, 11.89it/s, est. speed input: 6129.31 toks/s, output: 11.97 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:05<00:05, 11.89it/s, est. speed input: 6128.34 toks/s, output: 11.97 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:05<00:05, 11.91it/s, est. speed input: 6128.14 toks/s, output: 11.97 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:05<00:05, 11.92it/s, est. speed input: 6127.67 toks/s, output: 11.97 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:05<00:04, 11.90it/s, est. speed input: 6126.08 toks/s, output: 11.96 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:06<00:04, 11.85it/s, est. speed input: 6122.54 toks/s, output: 11.96 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:06<00:04, 11.80it/s, est. speed input: 6118.96 toks/s, output: 11.95 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:06<00:04, 11.86it/s, est. speed input: 6119.36 toks/s, output: 11.95 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:06<00:04, 11.85it/s, est. speed input: 6117.80 toks/s, output: 11.95 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:06<00:04, 11.84it/s, est. speed input: 6116.01 toks/s, output: 11.95 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:03, 11.83it/s, est. speed input: 6114.21 toks/s, output: 11.94 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:07<00:03, 11.83it/s, est. speed input: 6113.06 toks/s, output: 11.94 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:07<00:03, 11.72it/s, est. speed input: 6106.93 toks/s, output: 11.93 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:07<00:03, 11.75it/s, est. speed input: 6105.70 toks/s, output: 11.93 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:07<00:03, 11.79it/s, est. speed input: 6105.45 toks/s, output: 11.92 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:07<00:03, 11.83it/s, est. speed input: 6105.34 toks/s, output: 11.92 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:07<00:02, 11.84it/s, est. speed input: 6104.78 toks/s, output: 11.92 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:08<00:02, 11.90it/s, est. speed input: 6105.92 toks/s, output: 11.93 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:08<00:02, 11.76it/s, est. speed input: 6100.59 toks/s, output: 11.92 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:08<00:02, 11.82it/s, est. speed input: 6101.03 toks/s, output: 11.92 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:08<00:02, 11.90it/s, est. speed input: 6102.71 toks/s, output: 11.92 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:08<00:02, 11.86it/s, est. speed input: 6101.29 toks/s, output: 11.92 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:08<00:01, 11.93it/s, est. speed input: 6103.15 toks/s, output: 11.92 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:09<00:01, 11.95it/s, est. speed input: 6103.86 toks/s, output: 11.92 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:09<00:01, 11.98it/s, est. speed input: 6104.85 toks/s, output: 11.92 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:09<00:01, 11.77it/s, est. speed input: 6099.12 toks/s, output: 11.91 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:09<00:01, 11.81it/s, est. speed input: 6098.91 toks/s, output: 11.91 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:09<00:01, 11.81it/s, est. speed input: 6098.16 toks/s, output: 11.91 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:09<00:00, 11.76it/s, est. speed input: 6095.66 toks/s, output: 11.91 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:10<00:00, 11.85it/s, est. speed input: 6096.95 toks/s, output: 11.91 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:10<00:00, 11.85it/s, est. speed input: 6096.41 toks/s, output: 11.91 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:10<00:00, 11.67it/s, est. speed input: 6091.02 toks/s, output: 11.90 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:10<00:00, 11.73it/s, est. speed input: 6090.67 toks/s, output: 11.90 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.62it/s, est. speed input: 6086.30 toks/s, output: 11.89 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.62it/s, est. speed input: 6086.30 toks/s, output: 11.89 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 11.89it/s, est. speed input: 6086.30 toks/s, output: 11.89 toks/s]
[rank0]:[W126 18:43:47.202657167 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 90.9s

测试结果:
  Requests/s:   11.60
  Tokens/s:     5948.67
  Total Reqs:   128
  Elapsed:      11.04s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5937.08

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:43:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:43:59 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1612994) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1612994) WARNING 01-26 18:45:10 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.05 requests/s, 6201.39 total tokens/s, 6.05 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 18:43:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:43:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:43:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:43:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:43:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:43:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:43:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:43:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:43:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:44:03] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:44:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:44:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:44:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:44:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:44:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:44:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:44:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:44:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1612994) [2026-01-26 18:44:04] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1612994) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1612994) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.61s/it]
(EngineCore_DP0 pid=1612994) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 30.04s/it]
(EngineCore_DP0 pid=1612994) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.22s/it]
(EngineCore_DP0 pid=1612994) 
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1612994) [2026-01-26 18:45:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1612994) 2026-01-26 18:45:10,049 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1612994) 2026-01-26 18:45:10,113 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  36%|███▌      | 46/128 [00:00<00:00, 459.52it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 395.24it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 390.78it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:10, 11.38it/s, est. speed input: 11649.06 toks/s, output: 11.38 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:15,  8.04it/s, est. speed input: 8692.68 toks/s, output: 8.49 toks/s]  
Processed prompts:   5%|▍         | 6/128 [00:00<00:16,  7.50it/s, est. speed input: 8210.35 toks/s, output: 8.02 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:17,  7.01it/s, est. speed input: 7825.97 toks/s, output: 7.64 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:17,  6.73it/s, est. speed input: 7584.19 toks/s, output: 7.41 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:18,  6.54it/s, est. speed input: 7411.70 toks/s, output: 7.24 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:18,  6.43it/s, est. speed input: 7282.63 toks/s, output: 7.11 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:18,  6.35it/s, est. speed input: 7182.22 toks/s, output: 7.01 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:18,  6.29it/s, est. speed input: 7100.45 toks/s, output: 6.93 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:18,  6.26it/s, est. speed input: 7035.38 toks/s, output: 6.87 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:18,  6.16it/s, est. speed input: 6958.49 toks/s, output: 6.80 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:18,  6.16it/s, est. speed input: 6908.73 toks/s, output: 6.75 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:18,  6.12it/s, est. speed input: 6858.44 toks/s, output: 6.70 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:18,  6.13it/s, est. speed input: 6821.77 toks/s, output: 6.66 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:17,  6.11it/s, est. speed input: 6786.12 toks/s, output: 6.63 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:02<00:17,  6.11it/s, est. speed input: 6755.98 toks/s, output: 6.60 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:17,  6.04it/s, est. speed input: 6715.55 toks/s, output: 6.56 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:17,  6.09it/s, est. speed input: 6697.96 toks/s, output: 6.54 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:17,  6.13it/s, est. speed input: 6681.80 toks/s, output: 6.53 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:17,  6.17it/s, est. speed input: 6669.70 toks/s, output: 6.51 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:16,  6.16it/s, est. speed input: 6653.12 toks/s, output: 6.50 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:03<00:16,  6.17it/s, est. speed input: 6639.40 toks/s, output: 6.48 toks/s]
Processed prompts:  20%|██        | 26/128 [00:04<00:16,  6.16it/s, est. speed input: 6624.85 toks/s, output: 6.47 toks/s]
Processed prompts:  21%|██        | 27/128 [00:04<00:16,  6.09it/s, est. speed input: 6603.18 toks/s, output: 6.45 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:16,  6.10it/s, est. speed input: 6590.33 toks/s, output: 6.44 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:16,  6.08it/s, est. speed input: 6574.94 toks/s, output: 6.42 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:16,  6.09it/s, est. speed input: 6563.66 toks/s, output: 6.41 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:04<00:15,  6.07it/s, est. speed input: 6550.43 toks/s, output: 6.40 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:05<00:15,  6.10it/s, est. speed input: 6542.57 toks/s, output: 6.39 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:05<00:15,  6.05it/s, est. speed input: 6527.70 toks/s, output: 6.37 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:05<00:15,  6.07it/s, est. speed input: 6519.61 toks/s, output: 6.37 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:05<00:15,  6.10it/s, est. speed input: 6513.75 toks/s, output: 6.36 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:15,  6.11it/s, est. speed input: 6506.75 toks/s, output: 6.35 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:05<00:14,  6.11it/s, est. speed input: 6499.77 toks/s, output: 6.35 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:05<00:14,  6.10it/s, est. speed input: 6492.19 toks/s, output: 6.34 toks/s]
Processed prompts:  30%|███       | 39/128 [00:06<00:14,  6.07it/s, est. speed input: 6482.51 toks/s, output: 6.33 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:06<00:14,  6.06it/s, est. speed input: 6474.78 toks/s, output: 6.32 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:06<00:14,  6.06it/s, est. speed input: 6468.34 toks/s, output: 6.32 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:06<00:14,  6.08it/s, est. speed input: 6463.74 toks/s, output: 6.31 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:06<00:13,  6.07it/s, est. speed input: 6457.21 toks/s, output: 6.31 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:06<00:13,  6.11it/s, est. speed input: 6454.36 toks/s, output: 6.30 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:07<00:13,  6.13it/s, est. speed input: 6451.73 toks/s, output: 6.30 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:07<00:13,  6.06it/s, est. speed input: 6442.35 toks/s, output: 6.29 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:07<00:13,  6.05it/s, est. speed input: 6436.16 toks/s, output: 6.29 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:07<00:13,  6.08it/s, est. speed input: 6433.18 toks/s, output: 6.28 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:07<00:12,  6.08it/s, est. speed input: 6428.97 toks/s, output: 6.28 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:07<00:12,  6.09it/s, est. speed input: 6425.56 toks/s, output: 6.27 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:08<00:12,  6.08it/s, est. speed input: 6420.92 toks/s, output: 6.27 toks/s]
Processed prompts:  41%|████      | 52/128 [00:08<00:12,  6.08it/s, est. speed input: 6416.78 toks/s, output: 6.27 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:08<00:12,  6.08it/s, est. speed input: 6413.03 toks/s, output: 6.26 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:08<00:12,  6.09it/s, est. speed input: 6410.09 toks/s, output: 6.26 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:08<00:11,  6.09it/s, est. speed input: 6406.71 toks/s, output: 6.26 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:08<00:11,  6.06it/s, est. speed input: 6402.11 toks/s, output: 6.25 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:09<00:11,  6.06it/s, est. speed input: 6398.35 toks/s, output: 6.25 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:09<00:11,  6.07it/s, est. speed input: 6395.49 toks/s, output: 6.25 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:09<00:11,  6.03it/s, est. speed input: 6389.89 toks/s, output: 6.24 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:09<00:11,  6.05it/s, est. speed input: 6387.51 toks/s, output: 6.24 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:09<00:11,  6.05it/s, est. speed input: 6384.41 toks/s, output: 6.23 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:09<00:10,  6.07it/s, est. speed input: 6382.06 toks/s, output: 6.23 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:10<00:10,  6.06it/s, est. speed input: 6378.83 toks/s, output: 6.23 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:10<00:10,  6.06it/s, est. speed input: 6376.07 toks/s, output: 6.23 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:10<00:10,  6.02it/s, est. speed input: 6371.18 toks/s, output: 6.22 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:10<00:10,  6.03it/s, est. speed input: 6368.67 toks/s, output: 6.22 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:10<00:10,  6.04it/s, est. speed input: 6365.91 toks/s, output: 6.22 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:10<00:09,  6.04it/s, est. speed input: 6363.53 toks/s, output: 6.21 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:11<00:09,  6.05it/s, est. speed input: 6361.44 toks/s, output: 6.21 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:11<00:09,  6.07it/s, est. speed input: 6359.83 toks/s, output: 6.21 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:11<00:09,  6.07it/s, est. speed input: 6357.58 toks/s, output: 6.21 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:11<00:09,  6.02it/s, est. speed input: 6353.07 toks/s, output: 6.20 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:11<00:09,  6.02it/s, est. speed input: 6350.57 toks/s, output: 6.20 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:11<00:08,  6.04it/s, est. speed input: 6349.11 toks/s, output: 6.20 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:12<00:08,  6.09it/s, est. speed input: 6349.28 toks/s, output: 6.20 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:12<00:08,  6.09it/s, est. speed input: 6347.77 toks/s, output: 6.20 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:12<00:08,  6.10it/s, est. speed input: 6346.47 toks/s, output: 6.20 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:12<00:08,  6.02it/s, est. speed input: 6341.61 toks/s, output: 6.19 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:12<00:08,  6.05it/s, est. speed input: 6340.82 toks/s, output: 6.19 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:12<00:07,  6.09it/s, est. speed input: 6340.60 toks/s, output: 6.19 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:13<00:07,  6.11it/s, est. speed input: 6340.34 toks/s, output: 6.19 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:13<00:07,  6.10it/s, est. speed input: 6338.92 toks/s, output: 6.19 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:13<00:07,  6.08it/s, est. speed input: 6337.00 toks/s, output: 6.19 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:13<00:07,  6.10it/s, est. speed input: 6336.55 toks/s, output: 6.19 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:13<00:07,  6.03it/s, est. speed input: 6332.48 toks/s, output: 6.18 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:13<00:06,  6.06it/s, est. speed input: 6331.91 toks/s, output: 6.18 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:14<00:06,  6.06it/s, est. speed input: 6330.24 toks/s, output: 6.18 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:14<00:06,  6.09it/s, est. speed input: 6329.93 toks/s, output: 6.18 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:14<00:06,  6.10it/s, est. speed input: 6329.32 toks/s, output: 6.18 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:14<00:06,  6.11it/s, est. speed input: 6328.70 toks/s, output: 6.18 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:14<00:06,  6.06it/s, est. speed input: 6326.11 toks/s, output: 6.18 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:14<00:05,  6.08it/s, est. speed input: 6325.64 toks/s, output: 6.18 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:15<00:05,  6.09it/s, est. speed input: 6324.78 toks/s, output: 6.18 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:15<00:05,  6.07it/s, est. speed input: 6323.28 toks/s, output: 6.18 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:15<00:05,  6.10it/s, est. speed input: 6322.99 toks/s, output: 6.17 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:15<00:05,  6.10it/s, est. speed input: 6322.37 toks/s, output: 6.17 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:15<00:05,  6.10it/s, est. speed input: 6321.64 toks/s, output: 6.17 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:15<00:04,  6.03it/s, est. speed input: 6318.13 toks/s, output: 6.17 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:16<00:04,  6.03it/s, est. speed input: 6316.75 toks/s, output: 6.17 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:16<00:04,  6.05it/s, est. speed input: 6316.15 toks/s, output: 6.17 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:16<00:04,  6.05it/s, est. speed input: 6314.70 toks/s, output: 6.17 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:16<00:04,  6.06it/s, est. speed input: 6313.94 toks/s, output: 6.17 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:16<00:04,  6.06it/s, est. speed input: 6312.98 toks/s, output: 6.17 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:16<00:03,  6.03it/s, est. speed input: 6310.77 toks/s, output: 6.16 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:17<00:03,  6.02it/s, est. speed input: 6309.28 toks/s, output: 6.16 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:17<00:03,  6.04it/s, est. speed input: 6308.36 toks/s, output: 6.16 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:17<00:03,  6.07it/s, est. speed input: 6308.32 toks/s, output: 6.16 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:17<00:03,  6.08it/s, est. speed input: 6307.77 toks/s, output: 6.16 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:17<00:03,  6.10it/s, est. speed input: 6307.58 toks/s, output: 6.16 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:17<00:02,  6.06it/s, est. speed input: 6305.62 toks/s, output: 6.16 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:18<00:02,  6.03it/s, est. speed input: 6303.91 toks/s, output: 6.16 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:18<00:02,  6.07it/s, est. speed input: 6303.91 toks/s, output: 6.16 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:18<00:02,  6.07it/s, est. speed input: 6303.21 toks/s, output: 6.16 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:18<00:02,  6.06it/s, est. speed input: 6302.22 toks/s, output: 6.15 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:18<00:02,  6.08it/s, est. speed input: 6302.01 toks/s, output: 6.15 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:18<00:01,  6.06it/s, est. speed input: 6300.78 toks/s, output: 6.15 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:19<00:01,  6.03it/s, est. speed input: 6298.92 toks/s, output: 6.15 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:19<00:01,  6.03it/s, est. speed input: 6297.86 toks/s, output: 6.15 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:19<00:01,  6.06it/s, est. speed input: 6297.68 toks/s, output: 6.15 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:19<00:01,  6.12it/s, est. speed input: 6298.66 toks/s, output: 6.15 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:19<00:01,  6.11it/s, est. speed input: 6298.12 toks/s, output: 6.15 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:19<00:00,  6.09it/s, est. speed input: 6297.29 toks/s, output: 6.15 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:20<00:00,  6.03it/s, est. speed input: 6295.09 toks/s, output: 6.15 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:20<00:00,  6.07it/s, est. speed input: 6295.27 toks/s, output: 6.15 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:20<00:00,  6.08it/s, est. speed input: 6294.90 toks/s, output: 6.15 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:20<00:00,  6.08it/s, est. speed input: 6294.26 toks/s, output: 6.15 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:20<00:00,  6.09it/s, est. speed input: 6293.99 toks/s, output: 6.15 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:20<00:00,  6.07it/s, est. speed input: 6293.13 toks/s, output: 6.15 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:20<00:00,  6.07it/s, est. speed input: 6293.13 toks/s, output: 6.15 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:20<00:00,  6.15it/s, est. speed input: 6293.13 toks/s, output: 6.15 toks/s]
[rank0]:[W126 18:45:32.344108994 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 101.8s

测试结果:
  Requests/s:   6.05
  Tokens/s:     6201.39
  Total Reqs:   128
  Elapsed:      21.16s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     6195.34

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:45:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:45:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1614564) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1614564) WARNING 01-26 18:46:51 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.03 requests/s, 6185.84 total tokens/s, 6.03 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 18:45:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:45:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:45:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:45:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:45:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:45:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:45:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:45:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:45:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:45:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:45:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:45:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:45:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:45:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:45:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:45:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:45:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1614564) [2026-01-26 18:45:44] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1614564) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1614564) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:23<00:23, 23.92s/it]
(EngineCore_DP0 pid=1614564) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 29.80s/it]
(EngineCore_DP0 pid=1614564) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:57<00:00, 28.92s/it]
(EngineCore_DP0 pid=1614564) 
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1614564) [2026-01-26 18:46:43] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1614564) 2026-01-26 18:46:50,214 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1614564) 2026-01-26 18:46:50,305 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  11%|█         | 28/256 [00:00<00:00, 276.11it/s]
Adding requests:  28%|██▊       | 71/256 [00:00<00:00, 364.82it/s]
Adding requests:  45%|████▍     | 115/256 [00:00<00:00, 396.72it/s]
Adding requests:  63%|██████▎   | 161/256 [00:00<00:00, 415.91it/s]
Adding requests:  79%|███████▉  | 203/256 [00:00<00:00, 398.56it/s]
Adding requests:  95%|█████████▍| 243/256 [00:00<00:00, 370.65it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 376.97it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:26,  9.64it/s, est. speed input: 9873.64 toks/s, output: 9.64 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:01<00:45,  5.47it/s, est. speed input: 6136.80 toks/s, output: 5.99 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:01<00:43,  5.69it/s, est. speed input: 6162.95 toks/s, output: 6.02 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:41,  5.88it/s, est. speed input: 6210.49 toks/s, output: 6.06 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:40,  5.97it/s, est. speed input: 6228.29 toks/s, output: 6.08 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:02<00:40,  6.03it/s, est. speed input: 6239.46 toks/s, output: 6.09 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:39,  6.08it/s, est. speed input: 6251.37 toks/s, output: 6.10 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:38,  6.12it/s, est. speed input: 6263.07 toks/s, output: 6.12 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:03<00:38,  6.11it/s, est. speed input: 6261.11 toks/s, output: 6.11 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:38,  6.14it/s, est. speed input: 6268.30 toks/s, output: 6.12 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:03<00:37,  6.14it/s, est. speed input: 6271.38 toks/s, output: 6.12 toks/s]
Processed prompts:  10%|█         | 26/256 [00:04<00:37,  6.13it/s, est. speed input: 6269.38 toks/s, output: 6.12 toks/s]
Processed prompts:  11%|█         | 28/256 [00:04<00:37,  6.15it/s, est. speed input: 6274.71 toks/s, output: 6.13 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:04<00:36,  6.17it/s, est. speed input: 6281.34 toks/s, output: 6.13 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:05<00:36,  6.18it/s, est. speed input: 6286.37 toks/s, output: 6.14 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:05<00:36,  6.15it/s, est. speed input: 6281.80 toks/s, output: 6.13 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:05<00:35,  6.17it/s, est. speed input: 6286.40 toks/s, output: 6.14 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:06<00:35,  6.17it/s, est. speed input: 6287.92 toks/s, output: 6.14 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:06<00:35,  6.14it/s, est. speed input: 6284.61 toks/s, output: 6.14 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:06<00:34,  6.16it/s, est. speed input: 6287.20 toks/s, output: 6.14 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:07<00:34,  6.16it/s, est. speed input: 6287.89 toks/s, output: 6.14 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:07<00:34,  6.13it/s, est. speed input: 6284.68 toks/s, output: 6.14 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:07<00:33,  6.14it/s, est. speed input: 6285.40 toks/s, output: 6.14 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:08<00:33,  6.16it/s, est. speed input: 6288.45 toks/s, output: 6.14 toks/s]
Processed prompts:  20%|██        | 52/256 [00:08<00:33,  6.17it/s, est. speed input: 6290.04 toks/s, output: 6.14 toks/s]
Processed prompts:  21%|██        | 54/256 [00:08<00:32,  6.16it/s, est. speed input: 6289.83 toks/s, output: 6.14 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:09<00:32,  6.17it/s, est. speed input: 6292.15 toks/s, output: 6.14 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:09<00:32,  6.17it/s, est. speed input: 6293.12 toks/s, output: 6.15 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:09<00:31,  6.14it/s, est. speed input: 6290.88 toks/s, output: 6.14 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:10<00:31,  6.16it/s, est. speed input: 6292.13 toks/s, output: 6.14 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:10<00:31,  6.15it/s, est. speed input: 6291.68 toks/s, output: 6.14 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:10<00:31,  6.12it/s, est. speed input: 6288.86 toks/s, output: 6.14 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:11<00:30,  6.14it/s, est. speed input: 6290.14 toks/s, output: 6.14 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:11<00:30,  6.16it/s, est. speed input: 6292.19 toks/s, output: 6.14 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:11<00:29,  6.16it/s, est. speed input: 6292.36 toks/s, output: 6.14 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:12<00:29,  6.16it/s, est. speed input: 6293.04 toks/s, output: 6.15 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:12<00:29,  6.16it/s, est. speed input: 6292.92 toks/s, output: 6.15 toks/s]
Processed prompts:  30%|███       | 78/256 [00:12<00:28,  6.17it/s, est. speed input: 6294.22 toks/s, output: 6.15 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:13<00:28,  6.12it/s, est. speed input: 6290.93 toks/s, output: 6.14 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:13<00:28,  6.15it/s, est. speed input: 6292.47 toks/s, output: 6.14 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:13<00:27,  6.17it/s, est. speed input: 6294.10 toks/s, output: 6.15 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:13<00:27,  6.14it/s, est. speed input: 6292.49 toks/s, output: 6.14 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:14<00:27,  6.15it/s, est. speed input: 6292.77 toks/s, output: 6.15 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:14<00:26,  6.16it/s, est. speed input: 6293.52 toks/s, output: 6.15 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:14<00:26,  6.13it/s, est. speed input: 6292.15 toks/s, output: 6.14 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:15<00:26,  6.14it/s, est. speed input: 6292.15 toks/s, output: 6.14 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:15<00:26,  6.15it/s, est. speed input: 6292.70 toks/s, output: 6.15 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:15<00:25,  6.12it/s, est. speed input: 6291.09 toks/s, output: 6.14 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:16<00:25,  6.13it/s, est. speed input: 6290.89 toks/s, output: 6.14 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:16<00:25,  6.13it/s, est. speed input: 6290.72 toks/s, output: 6.14 toks/s]
Processed prompts:  41%|████      | 104/256 [00:16<00:24,  6.14it/s, est. speed input: 6291.23 toks/s, output: 6.14 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:17<00:24,  6.14it/s, est. speed input: 6290.83 toks/s, output: 6.14 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:17<00:24,  6.12it/s, est. speed input: 6289.86 toks/s, output: 6.14 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:17<00:23,  6.15it/s, est. speed input: 6291.10 toks/s, output: 6.14 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:18<00:23,  6.12it/s, est. speed input: 6289.68 toks/s, output: 6.14 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:18<00:23,  6.12it/s, est. speed input: 6288.94 toks/s, output: 6.14 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:18<00:22,  6.12it/s, est. speed input: 6288.59 toks/s, output: 6.14 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:19<00:22,  6.12it/s, est. speed input: 6288.04 toks/s, output: 6.14 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:19<00:22,  6.11it/s, est. speed input: 6287.54 toks/s, output: 6.14 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:19<00:21,  6.14it/s, est. speed input: 6288.53 toks/s, output: 6.14 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:20<00:21,  6.15it/s, est. speed input: 6289.18 toks/s, output: 6.14 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:20<00:21,  6.13it/s, est. speed input: 6287.92 toks/s, output: 6.14 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:20<00:20,  6.12it/s, est. speed input: 6287.19 toks/s, output: 6.14 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:21<00:20,  6.13it/s, est. speed input: 6287.77 toks/s, output: 6.14 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:21<00:20,  6.11it/s, est. speed input: 6286.42 toks/s, output: 6.14 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:21<00:19,  6.12it/s, est. speed input: 6286.72 toks/s, output: 6.14 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:22<00:19,  6.13it/s, est. speed input: 6286.74 toks/s, output: 6.14 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:22<00:19,  6.11it/s, est. speed input: 6285.56 toks/s, output: 6.14 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:22<00:18,  6.13it/s, est. speed input: 6286.14 toks/s, output: 6.14 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:23<00:18,  6.15it/s, est. speed input: 6287.09 toks/s, output: 6.14 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:23<00:18,  6.13it/s, est. speed input: 6286.10 toks/s, output: 6.14 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:23<00:17,  6.14it/s, est. speed input: 6286.58 toks/s, output: 6.14 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:24<00:17,  6.17it/s, est. speed input: 6287.79 toks/s, output: 6.14 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:24<00:17,  6.15it/s, est. speed input: 6287.60 toks/s, output: 6.14 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:24<00:16,  6.13it/s, est. speed input: 6286.86 toks/s, output: 6.14 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:25<00:16,  6.13it/s, est. speed input: 6286.57 toks/s, output: 6.14 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:25<00:16,  6.12it/s, est. speed input: 6286.21 toks/s, output: 6.14 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:25<00:16,  6.11it/s, est. speed input: 6285.21 toks/s, output: 6.14 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:26<00:15,  6.12it/s, est. speed input: 6285.34 toks/s, output: 6.14 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:26<00:15,  6.15it/s, est. speed input: 6286.63 toks/s, output: 6.14 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:26<00:15,  6.12it/s, est. speed input: 6285.45 toks/s, output: 6.14 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:27<00:14,  6.12it/s, est. speed input: 6285.31 toks/s, output: 6.14 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:27<00:14,  6.13it/s, est. speed input: 6285.30 toks/s, output: 6.14 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:27<00:14,  6.11it/s, est. speed input: 6284.27 toks/s, output: 6.14 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:28<00:13,  6.11it/s, est. speed input: 6284.21 toks/s, output: 6.14 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:28<00:13,  6.13it/s, est. speed input: 6284.43 toks/s, output: 6.14 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:28<00:13,  6.14it/s, est. speed input: 6284.83 toks/s, output: 6.14 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:29<00:12,  6.11it/s, est. speed input: 6283.78 toks/s, output: 6.14 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:29<00:12,  6.11it/s, est. speed input: 6283.60 toks/s, output: 6.14 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:29<00:12,  6.12it/s, est. speed input: 6283.75 toks/s, output: 6.14 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:29<00:11,  6.10it/s, est. speed input: 6282.62 toks/s, output: 6.14 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:30<00:11,  6.10it/s, est. speed input: 6282.38 toks/s, output: 6.14 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:30<00:11,  6.13it/s, est. speed input: 6282.87 toks/s, output: 6.14 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:30<00:10,  6.09it/s, est. speed input: 6281.53 toks/s, output: 6.13 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:31<00:10,  6.09it/s, est. speed input: 6281.12 toks/s, output: 6.13 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:31<00:10,  6.12it/s, est. speed input: 6281.73 toks/s, output: 6.13 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:31<00:09,  6.10it/s, est. speed input: 6280.94 toks/s, output: 6.13 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:32<00:09,  6.14it/s, est. speed input: 6282.06 toks/s, output: 6.13 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:32<00:09,  6.14it/s, est. speed input: 6282.08 toks/s, output: 6.13 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:32<00:07,  6.89it/s, est. speed input: 6304.67 toks/s, output: 6.16 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:33<00:07,  6.62it/s, est. speed input: 6303.68 toks/s, output: 6.16 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:33<00:08,  5.63it/s, est. speed input: 6274.92 toks/s, output: 6.13 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:34<00:08,  5.35it/s, est. speed input: 6257.89 toks/s, output: 6.11 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:34<00:08,  5.55it/s, est. speed input: 6257.90 toks/s, output: 6.11 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:34<00:07,  5.72it/s, est. speed input: 6258.36 toks/s, output: 6.11 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:35<00:07,  5.86it/s, est. speed input: 6259.11 toks/s, output: 6.11 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:35<00:06,  5.91it/s, est. speed input: 6258.26 toks/s, output: 6.11 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:35<00:06,  5.97it/s, est. speed input: 6258.31 toks/s, output: 6.11 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:35<00:05,  6.02it/s, est. speed input: 6258.49 toks/s, output: 6.11 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:36<00:05,  6.03it/s, est. speed input: 6257.93 toks/s, output: 6.11 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:36<00:05,  6.07it/s, est. speed input: 6258.46 toks/s, output: 6.11 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:36<00:04,  6.08it/s, est. speed input: 6258.43 toks/s, output: 6.11 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:37<00:04,  6.07it/s, est. speed input: 6257.80 toks/s, output: 6.11 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:37<00:04,  6.10it/s, est. speed input: 6258.30 toks/s, output: 6.11 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:37<00:03,  6.11it/s, est. speed input: 6258.46 toks/s, output: 6.11 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:38<00:03,  6.10it/s, est. speed input: 6258.05 toks/s, output: 6.11 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:38<00:03,  6.09it/s, est. speed input: 6257.86 toks/s, output: 6.11 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:38<00:02,  6.11it/s, est. speed input: 6258.18 toks/s, output: 6.11 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:39<00:02,  6.13it/s, est. speed input: 6258.77 toks/s, output: 6.11 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:39<00:02,  6.12it/s, est. speed input: 6258.53 toks/s, output: 6.11 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:39<00:01,  6.13it/s, est. speed input: 6258.96 toks/s, output: 6.11 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:40<00:01,  6.16it/s, est. speed input: 6259.84 toks/s, output: 6.11 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:40<00:01,  6.12it/s, est. speed input: 6259.22 toks/s, output: 6.11 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:40<00:00,  6.13it/s, est. speed input: 6259.62 toks/s, output: 6.11 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:41<00:00,  6.16it/s, est. speed input: 6260.48 toks/s, output: 6.11 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:41<00:00,  6.13it/s, est. speed input: 6259.95 toks/s, output: 6.11 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  7.19it/s, est. speed input: 6284.24 toks/s, output: 6.14 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  7.19it/s, est. speed input: 6284.24 toks/s, output: 6.14 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:41<00:00,  6.14it/s, est. speed input: 6284.24 toks/s, output: 6.14 toks/s]
[rank0]:[W126 18:47:34.241353409 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 122.1s

测试结果:
  Requests/s:   6.03
  Tokens/s:     6185.84
  Total Reqs:   256
  Elapsed:      42.42s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     6179.80

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:47:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:47:41 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1616453) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1616453) WARNING 01-26 18:48:52 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.91 requests/s, 6052.66 total tokens/s, 5.91 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 18:47:41] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:47:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:47:41] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:47:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:47:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:47:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:47:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:47:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:47:45] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:47:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:47:45] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:47:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:47:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:47:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:47:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:47:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:47:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1616453) [2026-01-26 18:47:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1616453) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1616453) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.38s/it]
(EngineCore_DP0 pid=1616453) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.84s/it]
(EngineCore_DP0 pid=1616453) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.02s/it]
(EngineCore_DP0 pid=1616453) 
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1616453) [2026-01-26 18:48:45] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1616453) 2026-01-26 18:48:51,491 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1616453) 2026-01-26 18:48:51,590 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   8%|▊         | 41/512 [00:00<00:01, 396.25it/s]
Adding requests:  16%|█▌        | 81/512 [00:00<00:01, 367.09it/s]
Adding requests:  24%|██▍       | 122/512 [00:00<00:01, 381.49it/s]
Adding requests:  32%|███▏      | 163/512 [00:00<00:00, 390.78it/s]
Adding requests:  40%|████      | 207/512 [00:00<00:00, 404.37it/s]
Adding requests:  49%|████▉     | 251/512 [00:00<00:00, 414.37it/s]
Adding requests:  58%|█████▊    | 295/512 [00:00<00:00, 421.22it/s]
Adding requests:  67%|██████▋   | 342/512 [00:00<00:00, 435.41it/s]
Adding requests:  76%|███████▌  | 387/512 [00:00<00:00, 438.17it/s]
Adding requests:  84%|████████▍ | 431/512 [00:01<00:00, 437.05it/s]
Adding requests:  93%|█████████▎| 475/512 [00:01<00:00, 431.16it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 421.52it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:34, 14.87it/s, est. speed input: 15226.77 toks/s, output: 14.87 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:01<00:58,  8.56it/s, est. speed input: 9493.77 toks/s, output: 9.27 toks/s] 
Processed prompts:   3%|▎         | 14/512 [00:01<01:08,  7.25it/s, est. speed input: 8181.06 toks/s, output: 7.99 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:02<01:13,  6.68it/s, est. speed input: 7581.67 toks/s, output: 7.40 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:03<01:16,  6.41it/s, est. speed input: 7258.51 toks/s, output: 7.09 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:17,  6.23it/s, est. speed input: 7042.54 toks/s, output: 6.88 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:18,  6.12it/s, est. speed input: 6886.84 toks/s, output: 6.73 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:05<01:18,  6.07it/s, est. speed input: 6784.80 toks/s, output: 6.63 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:05<01:18,  6.01it/s, est. speed input: 6697.41 toks/s, output: 6.54 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:18,  5.97it/s, est. speed input: 6626.41 toks/s, output: 6.47 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:07<01:18,  5.96it/s, est. speed input: 6575.01 toks/s, output: 6.42 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:07<01:17,  5.93it/s, est. speed input: 6525.63 toks/s, output: 6.37 toks/s]
Processed prompts:  11%|█         | 54/512 [00:08<01:17,  5.93it/s, est. speed input: 6489.79 toks/s, output: 6.34 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:09<01:16,  5.93it/s, est. speed input: 6458.36 toks/s, output: 6.31 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:09<01:16,  5.91it/s, est. speed input: 6427.52 toks/s, output: 6.28 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:10<01:15,  5.92it/s, est. speed input: 6404.64 toks/s, output: 6.25 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:11<01:14,  5.90it/s, est. speed input: 6381.35 toks/s, output: 6.23 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:11<01:14,  5.90it/s, est. speed input: 6361.62 toks/s, output: 6.21 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:12<01:13,  5.90it/s, est. speed input: 6344.91 toks/s, output: 6.20 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:13<01:12,  5.90it/s, est. speed input: 6328.34 toks/s, output: 6.18 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:13<01:12,  5.90it/s, est. speed input: 6314.78 toks/s, output: 6.17 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:14<01:11,  5.91it/s, est. speed input: 6304.25 toks/s, output: 6.16 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:15<01:10,  5.90it/s, est. speed input: 6291.62 toks/s, output: 6.14 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:15<01:10,  5.90it/s, est. speed input: 6280.35 toks/s, output: 6.13 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:16<01:09,  5.91it/s, est. speed input: 6271.84 toks/s, output: 6.12 toks/s]
Processed prompts:  21%|██        | 106/512 [00:17<01:08,  5.90it/s, est. speed input: 6262.20 toks/s, output: 6.12 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:18<01:08,  5.91it/s, est. speed input: 6255.41 toks/s, output: 6.11 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:18<01:07,  5.90it/s, est. speed input: 6246.56 toks/s, output: 6.10 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:19<01:06,  5.90it/s, est. speed input: 6238.90 toks/s, output: 6.09 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:20<01:06,  5.91it/s, est. speed input: 6233.22 toks/s, output: 6.09 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:20<01:05,  5.89it/s, est. speed input: 6225.55 toks/s, output: 6.08 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:21<01:04,  5.89it/s, est. speed input: 6219.44 toks/s, output: 6.07 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:22<01:04,  5.90it/s, est. speed input: 6214.38 toks/s, output: 6.07 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:22<01:03,  5.89it/s, est. speed input: 6208.60 toks/s, output: 6.06 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:23<01:02,  5.89it/s, est. speed input: 6203.76 toks/s, output: 6.06 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:24<01:02,  5.89it/s, est. speed input: 6198.51 toks/s, output: 6.05 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:24<01:01,  5.89it/s, est. speed input: 6193.81 toks/s, output: 6.05 toks/s]
Processed prompts:  30%|███       | 154/512 [00:25<01:00,  5.89it/s, est. speed input: 6189.89 toks/s, output: 6.04 toks/s]
Processed prompts:  31%|███       | 158/512 [00:26<01:00,  5.89it/s, est. speed input: 6185.24 toks/s, output: 6.04 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:26<00:59,  5.89it/s, est. speed input: 6181.20 toks/s, output: 6.04 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:27<00:58,  5.89it/s, est. speed input: 6177.73 toks/s, output: 6.03 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:28<00:58,  5.89it/s, est. speed input: 6174.62 toks/s, output: 6.03 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:28<00:57,  5.89it/s, est. speed input: 6171.01 toks/s, output: 6.03 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:29<00:56,  5.89it/s, est. speed input: 6168.08 toks/s, output: 6.02 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:30<00:56,  5.88it/s, est. speed input: 6164.28 toks/s, output: 6.02 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:30<00:55,  5.89it/s, est. speed input: 6161.60 toks/s, output: 6.02 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:31<00:56,  5.72it/s, est. speed input: 6145.67 toks/s, output: 6.00 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:32<00:55,  5.76it/s, est. speed input: 6142.74 toks/s, output: 6.00 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:33<00:54,  5.80it/s, est. speed input: 6140.72 toks/s, output: 6.00 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:33<00:50,  6.18it/s, est. speed input: 6162.13 toks/s, output: 6.02 toks/s]
Processed prompts:  40%|████      | 206/512 [00:34<00:50,  6.09it/s, est. speed input: 6159.32 toks/s, output: 6.01 toks/s]
Processed prompts:  41%|████      | 210/512 [00:34<00:50,  6.03it/s, est. speed input: 6156.84 toks/s, output: 6.01 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:35<00:49,  5.97it/s, est. speed input: 6153.80 toks/s, output: 6.01 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:36<00:49,  5.95it/s, est. speed input: 6151.64 toks/s, output: 6.01 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:36<00:48,  5.93it/s, est. speed input: 6149.18 toks/s, output: 6.01 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:37<00:48,  5.92it/s, est. speed input: 6147.05 toks/s, output: 6.00 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:38<00:47,  5.91it/s, est. speed input: 6145.08 toks/s, output: 6.00 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:39<00:47,  5.90it/s, est. speed input: 6142.87 toks/s, output: 6.00 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:39<00:46,  5.89it/s, est. speed input: 6140.36 toks/s, output: 6.00 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:40<00:45,  5.89it/s, est. speed input: 6138.77 toks/s, output: 5.99 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:41<00:45,  5.88it/s, est. speed input: 6136.52 toks/s, output: 5.99 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:41<00:44,  5.88it/s, est. speed input: 6134.62 toks/s, output: 5.99 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:42<00:43,  5.89it/s, est. speed input: 6133.34 toks/s, output: 5.99 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:43<00:43,  5.88it/s, est. speed input: 6131.27 toks/s, output: 5.99 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:43<00:42,  5.88it/s, est. speed input: 6129.34 toks/s, output: 5.99 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:44<00:41,  5.88it/s, est. speed input: 6127.72 toks/s, output: 5.98 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:45<00:41,  5.88it/s, est. speed input: 6125.96 toks/s, output: 5.98 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:45<00:40,  5.89it/s, est. speed input: 6124.99 toks/s, output: 5.98 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:46<00:39,  5.88it/s, est. speed input: 6123.00 toks/s, output: 5.98 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:47<00:39,  5.88it/s, est. speed input: 6121.65 toks/s, output: 5.98 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:47<00:38,  5.88it/s, est. speed input: 6120.41 toks/s, output: 5.98 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:48<00:37,  5.88it/s, est. speed input: 6118.83 toks/s, output: 5.98 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:49<00:37,  5.87it/s, est. speed input: 6117.04 toks/s, output: 5.97 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:49<00:36,  5.88it/s, est. speed input: 6115.96 toks/s, output: 5.97 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:50<00:35,  5.87it/s, est. speed input: 6114.32 toks/s, output: 5.97 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:51<00:32,  6.37it/s, est. speed input: 6134.29 toks/s, output: 5.99 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:51<00:32,  6.22it/s, est. speed input: 6132.91 toks/s, output: 5.99 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:52<00:32,  6.10it/s, est. speed input: 6131.10 toks/s, output: 5.99 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:53<00:32,  6.04it/s, est. speed input: 6129.86 toks/s, output: 5.99 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:53<00:31,  5.98it/s, est. speed input: 6128.19 toks/s, output: 5.98 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:54<00:31,  5.95it/s, est. speed input: 6126.91 toks/s, output: 5.98 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:55<00:30,  5.94it/s, est. speed input: 6126.00 toks/s, output: 5.98 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:55<00:30,  5.92it/s, est. speed input: 6124.52 toks/s, output: 5.98 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:56<00:29,  5.91it/s, est. speed input: 6123.42 toks/s, output: 5.98 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:57<00:28,  5.90it/s, est. speed input: 6122.07 toks/s, output: 5.98 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:57<00:28,  5.88it/s, est. speed input: 6120.41 toks/s, output: 5.98 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:58<00:27,  5.88it/s, est. speed input: 6119.43 toks/s, output: 5.98 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:59<00:26,  5.88it/s, est. speed input: 6118.33 toks/s, output: 5.97 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:59<00:26,  5.88it/s, est. speed input: 6117.04 toks/s, output: 5.97 toks/s]
Processed prompts:  71%|███████   | 362/512 [01:00<00:25,  5.88it/s, est. speed input: 6116.12 toks/s, output: 5.97 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [01:01<00:24,  5.88it/s, est. speed input: 6114.90 toks/s, output: 5.97 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [01:01<00:24,  5.87it/s, est. speed input: 6113.65 toks/s, output: 5.97 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [01:02<00:23,  5.87it/s, est. speed input: 6112.57 toks/s, output: 5.97 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [01:03<00:22,  5.87it/s, est. speed input: 6111.36 toks/s, output: 5.97 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:04<00:22,  5.85it/s, est. speed input: 6109.58 toks/s, output: 5.97 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:04<00:21,  5.86it/s, est. speed input: 6108.52 toks/s, output: 5.97 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:05<00:20,  5.85it/s, est. speed input: 6107.31 toks/s, output: 5.96 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:06<00:20,  5.87it/s, est. speed input: 6106.59 toks/s, output: 5.96 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:06<00:19,  5.87it/s, est. speed input: 6105.54 toks/s, output: 5.96 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:07<00:18,  5.86it/s, est. speed input: 6104.41 toks/s, output: 5.96 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:08<00:18,  5.87it/s, est. speed input: 6103.75 toks/s, output: 5.96 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:08<00:17,  5.87it/s, est. speed input: 6102.66 toks/s, output: 5.96 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:09<00:16,  5.86it/s, est. speed input: 6101.61 toks/s, output: 5.96 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:10<00:16,  5.87it/s, est. speed input: 6100.92 toks/s, output: 5.96 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:10<00:15,  5.87it/s, est. speed input: 6099.97 toks/s, output: 5.96 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:11<00:14,  5.88it/s, est. speed input: 6099.60 toks/s, output: 5.96 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:12<00:13,  5.87it/s, est. speed input: 6098.61 toks/s, output: 5.96 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:12<00:12,  6.35it/s, est. speed input: 6112.12 toks/s, output: 5.97 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:13<00:11,  6.21it/s, est. speed input: 6111.60 toks/s, output: 5.97 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:14<00:11,  6.11it/s, est. speed input: 6110.69 toks/s, output: 5.97 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:14<00:10,  6.04it/s, est. speed input: 6109.96 toks/s, output: 5.97 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:15<00:10,  5.98it/s, est. speed input: 6108.93 toks/s, output: 5.97 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:16<00:09,  5.95it/s, est. speed input: 6108.03 toks/s, output: 5.96 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:16<00:09,  5.94it/s, est. speed input: 6107.72 toks/s, output: 5.96 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:17<00:08,  5.91it/s, est. speed input: 6106.56 toks/s, output: 5.96 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:18<00:07,  5.89it/s, est. speed input: 6105.46 toks/s, output: 5.96 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:18<00:07,  5.89it/s, est. speed input: 6104.92 toks/s, output: 5.96 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:19<00:06,  5.88it/s, est. speed input: 6103.97 toks/s, output: 5.96 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:20<00:05,  5.88it/s, est. speed input: 6103.10 toks/s, output: 5.96 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:20<00:05,  5.89it/s, est. speed input: 6102.88 toks/s, output: 5.96 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:21<00:04,  5.88it/s, est. speed input: 6101.96 toks/s, output: 5.96 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:22<00:03,  5.88it/s, est. speed input: 6101.30 toks/s, output: 5.96 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:22<00:03,  5.88it/s, est. speed input: 6100.52 toks/s, output: 5.96 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:23<00:02,  5.87it/s, est. speed input: 6099.61 toks/s, output: 5.96 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:24<00:01,  5.88it/s, est. speed input: 6099.08 toks/s, output: 5.96 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:24<00:01,  5.86it/s, est. speed input: 6098.10 toks/s, output: 5.96 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:25<00:00,  6.31it/s, est. speed input: 6108.80 toks/s, output: 5.97 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:25<00:00,  6.31it/s, est. speed input: 6132.75 toks/s, output: 5.99 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:25<00:00,  5.99it/s, est. speed input: 6132.75 toks/s, output: 5.99 toks/s]
[rank0]:[W126 18:50:19.915371482 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 165.4s

测试结果:
  Requests/s:   5.91
  Tokens/s:     6052.66
  Total Reqs:   512
  Elapsed:      86.71s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     6046.75

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:50:29 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:50:29 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1618934) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1618934) WARNING 01-26 18:51:43 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.04 requests/s, 6191.22 total tokens/s, 6.04 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 18:50:29] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:50:29] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:50:29] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:29] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:50:29] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:50:29] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:50:29] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:50:29] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:50:29] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:50:32] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:50:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:50:32] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:50:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:50:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:50:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:50:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:50:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:50:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1618934) [2026-01-26 18:50:33] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1618934) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1618934) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.72s/it]
(EngineCore_DP0 pid=1618934) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 30.07s/it]
(EngineCore_DP0 pid=1618934) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.27s/it]
(EngineCore_DP0 pid=1618934) 
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1618934) [2026-01-26 18:51:33] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1618934) 2026-01-26 18:51:40,618 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1618934) 2026-01-26 18:51:40,933 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 45/1024 [00:00<00:02, 448.12it/s]
Adding requests:   9%|▉         | 90/1024 [00:00<00:02, 353.00it/s]
Adding requests:  13%|█▎        | 131/1024 [00:00<00:02, 373.04it/s]
Adding requests:  17%|█▋        | 170/1024 [00:00<00:02, 375.74it/s]
Adding requests:  21%|██        | 214/1024 [00:00<00:02, 396.38it/s]
Adding requests:  25%|██▌       | 256/1024 [00:00<00:01, 402.17it/s]
Adding requests:  29%|██▉       | 301/1024 [00:00<00:01, 414.00it/s]
Adding requests:  34%|███▎      | 344/1024 [00:00<00:01, 418.77it/s]
Adding requests:  38%|███▊      | 387/1024 [00:00<00:01, 422.09it/s]
Adding requests:  42%|████▏     | 431/1024 [00:01<00:01, 427.18it/s]
Adding requests:  46%|████▋     | 474/1024 [00:01<00:01, 418.93it/s]
Adding requests:  51%|█████     | 519/1024 [00:01<00:01, 427.09it/s]
Adding requests:  55%|█████▍    | 562/1024 [00:01<00:01, 416.17it/s]
Adding requests:  59%|█████▉    | 604/1024 [00:01<00:01, 411.38it/s]
Adding requests:  63%|██████▎   | 646/1024 [00:01<00:00, 409.44it/s]
Adding requests:  67%|██████▋   | 687/1024 [00:01<00:00, 408.90it/s]
Adding requests:  71%|███████   | 728/1024 [00:01<00:00, 403.95it/s]
Adding requests:  75%|███████▌  | 769/1024 [00:01<00:00, 402.80it/s]
Adding requests:  79%|███████▉  | 813/1024 [00:01<00:00, 412.27it/s]
Adding requests:  83%|████████▎ | 855/1024 [00:02<00:00, 411.23it/s]
Adding requests:  88%|████████▊ | 897/1024 [00:02<00:00, 411.41it/s]
Adding requests:  92%|█████████▏| 939/1024 [00:02<00:00, 409.77it/s]
Adding requests:  96%|█████████▌| 981/1024 [00:02<00:00, 412.09it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 413.08it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 408.94it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<00:45, 22.19it/s, est. speed input: 22727.22 toks/s, output: 22.19 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:01<01:49,  9.17it/s, est. speed input: 10406.94 toks/s, output: 10.16 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:03<02:13,  7.50it/s, est. speed input: 8608.34 toks/s, output: 8.41 toks/s]  
Processed prompts:   3%|▎         | 34/1024 [00:04<02:23,  6.88it/s, est. speed input: 7890.04 toks/s, output: 7.71 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:05<02:29,  6.56it/s, est. speed input: 7498.42 toks/s, output: 7.32 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:07<02:32,  6.38it/s, est. speed input: 7252.60 toks/s, output: 7.08 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:08<02:34,  6.27it/s, est. speed input: 7085.10 toks/s, output: 6.92 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:09<02:34,  6.20it/s, est. speed input: 6964.13 toks/s, output: 6.80 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:11<02:34,  6.15it/s, est. speed input: 6870.73 toks/s, output: 6.71 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:12<02:34,  6.11it/s, est. speed input: 6794.21 toks/s, output: 6.63 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:13<02:33,  6.08it/s, est. speed input: 6733.91 toks/s, output: 6.58 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:15<02:32,  6.07it/s, est. speed input: 6687.21 toks/s, output: 6.53 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:16<02:31,  6.06it/s, est. speed input: 6646.72 toks/s, output: 6.49 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:17<02:30,  6.05it/s, est. speed input: 6610.80 toks/s, output: 6.46 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:18<02:29,  6.05it/s, est. speed input: 6581.21 toks/s, output: 6.43 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:20<02:27,  6.04it/s, est. speed input: 6554.84 toks/s, output: 6.40 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:21<02:26,  6.05it/s, est. speed input: 6532.72 toks/s, output: 6.38 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:22<02:25,  6.03it/s, est. speed input: 6510.75 toks/s, output: 6.36 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:24<02:24,  6.04it/s, est. speed input: 6493.34 toks/s, output: 6.34 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:25<02:22,  6.04it/s, est. speed input: 6477.68 toks/s, output: 6.33 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:26<02:21,  6.04it/s, est. speed input: 6463.46 toks/s, output: 6.31 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:28<02:20,  6.03it/s, est. speed input: 6449.28 toks/s, output: 6.30 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:29<02:19,  5.99it/s, est. speed input: 6430.19 toks/s, output: 6.28 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:31<02:21,  5.87it/s, est. speed input: 6397.82 toks/s, output: 6.25 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:32<02:14,  6.10it/s, est. speed input: 6416.26 toks/s, output: 6.27 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:33<02:13,  6.08it/s, est. speed input: 6407.01 toks/s, output: 6.26 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:34<02:12,  6.07it/s, est. speed input: 6398.06 toks/s, output: 6.25 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:36<02:11,  6.06it/s, est. speed input: 6390.66 toks/s, output: 6.24 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:37<02:10,  6.05it/s, est. speed input: 6383.34 toks/s, output: 6.23 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:38<02:09,  6.05it/s, est. speed input: 6376.68 toks/s, output: 6.23 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:40<02:08,  6.04it/s, est. speed input: 6369.65 toks/s, output: 6.22 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:41<02:06,  6.04it/s, est. speed input: 6364.00 toks/s, output: 6.21 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:42<02:05,  6.04it/s, est. speed input: 6358.31 toks/s, output: 6.21 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:44<02:04,  6.04it/s, est. speed input: 6353.01 toks/s, output: 6.20 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:45<02:03,  6.03it/s, est. speed input: 6347.24 toks/s, output: 6.20 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:46<02:01,  6.03it/s, est. speed input: 6342.47 toks/s, output: 6.19 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:48<02:00,  6.03it/s, est. speed input: 6338.14 toks/s, output: 6.19 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:49<01:54,  6.26it/s, est. speed input: 6354.13 toks/s, output: 6.21 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:50<01:54,  6.19it/s, est. speed input: 6349.59 toks/s, output: 6.20 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:51<01:54,  6.14it/s, est. speed input: 6344.81 toks/s, output: 6.20 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:53<01:53,  6.11it/s, est. speed input: 6340.94 toks/s, output: 6.19 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:54<01:52,  6.09it/s, est. speed input: 6337.26 toks/s, output: 6.19 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:55<01:51,  6.07it/s, est. speed input: 6333.63 toks/s, output: 6.19 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:57<01:50,  6.06it/s, est. speed input: 6329.88 toks/s, output: 6.18 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:58<01:49,  6.06it/s, est. speed input: 6327.01 toks/s, output: 6.18 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:59<01:48,  6.05it/s, est. speed input: 6323.53 toks/s, output: 6.18 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [01:01<01:46,  6.04it/s, est. speed input: 6320.39 toks/s, output: 6.17 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:02<01:46,  5.97it/s, est. speed input: 6311.84 toks/s, output: 6.16 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:03<01:45,  5.99it/s, est. speed input: 6309.22 toks/s, output: 6.16 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:05<01:43,  6.00it/s, est. speed input: 6306.71 toks/s, output: 6.16 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:06<01:42,  6.02it/s, est. speed input: 6304.40 toks/s, output: 6.16 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:07<01:40,  6.02it/s, est. speed input: 6301.51 toks/s, output: 6.15 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:09<01:39,  6.02it/s, est. speed input: 6299.19 toks/s, output: 6.15 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:10<01:34,  6.25it/s, est. speed input: 6311.00 toks/s, output: 6.16 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:11<01:34,  6.19it/s, est. speed input: 6308.78 toks/s, output: 6.16 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:13<01:33,  6.14it/s, est. speed input: 6306.63 toks/s, output: 6.16 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:14<01:32,  6.10it/s, est. speed input: 6303.79 toks/s, output: 6.16 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:15<01:31,  6.09it/s, est. speed input: 6302.05 toks/s, output: 6.15 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:17<01:30,  6.07it/s, est. speed input: 6299.92 toks/s, output: 6.15 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:18<01:29,  6.06it/s, est. speed input: 6297.94 toks/s, output: 6.15 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:19<01:28,  6.05it/s, est. speed input: 6295.64 toks/s, output: 6.15 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:21<01:27,  6.05it/s, est. speed input: 6293.85 toks/s, output: 6.15 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:22<01:25,  6.04it/s, est. speed input: 6292.01 toks/s, output: 6.14 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:23<01:24,  6.04it/s, est. speed input: 6290.08 toks/s, output: 6.14 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:25<01:23,  6.03it/s, est. speed input: 6288.09 toks/s, output: 6.14 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:26<01:21,  6.03it/s, est. speed input: 6286.31 toks/s, output: 6.14 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:27<01:20,  6.04it/s, est. speed input: 6284.96 toks/s, output: 6.14 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:28<01:19,  6.04it/s, est. speed input: 6283.51 toks/s, output: 6.14 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:30<01:17,  6.03it/s, est. speed input: 6281.65 toks/s, output: 6.13 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:31<01:16,  6.03it/s, est. speed input: 6280.06 toks/s, output: 6.13 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:32<01:15,  6.04it/s, est. speed input: 6278.90 toks/s, output: 6.13 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:34<01:13,  6.04it/s, est. speed input: 6277.54 toks/s, output: 6.13 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:35<01:13,  5.99it/s, est. speed input: 6274.02 toks/s, output: 6.13 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:36<01:11,  6.00it/s, est. speed input: 6272.50 toks/s, output: 6.13 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:38<01:10,  6.01it/s, est. speed input: 6271.12 toks/s, output: 6.12 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:39<01:08,  6.02it/s, est. speed input: 6269.93 toks/s, output: 6.12 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:40<01:07,  6.02it/s, est. speed input: 6268.81 toks/s, output: 6.12 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:42<01:06,  6.02it/s, est. speed input: 6267.37 toks/s, output: 6.12 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:43<01:04,  6.03it/s, est. speed input: 6266.36 toks/s, output: 6.12 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:44<01:03,  6.03it/s, est. speed input: 6265.26 toks/s, output: 6.12 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:46<01:02,  6.03it/s, est. speed input: 6264.17 toks/s, output: 6.12 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:47<01:00,  6.03it/s, est. speed input: 6262.90 toks/s, output: 6.12 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:48<00:59,  6.03it/s, est. speed input: 6261.86 toks/s, output: 6.12 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:50<00:58,  6.03it/s, est. speed input: 6260.82 toks/s, output: 6.11 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:51<00:56,  6.03it/s, est. speed input: 6259.71 toks/s, output: 6.11 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:52<00:55,  6.02it/s, est. speed input: 6258.41 toks/s, output: 6.11 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:54<00:54,  6.03it/s, est. speed input: 6257.55 toks/s, output: 6.11 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:55<00:52,  6.03it/s, est. speed input: 6256.78 toks/s, output: 6.11 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [01:56<00:51,  6.03it/s, est. speed input: 6255.96 toks/s, output: 6.11 toks/s]
Processed prompts:  71%|███████   | 722/1024 [01:58<00:50,  6.03it/s, est. speed input: 6254.75 toks/s, output: 6.11 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [01:59<00:48,  6.03it/s, est. speed input: 6253.90 toks/s, output: 6.11 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [02:00<00:47,  6.03it/s, est. speed input: 6253.09 toks/s, output: 6.11 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [02:02<00:46,  6.03it/s, est. speed input: 6252.18 toks/s, output: 6.11 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [02:03<00:44,  6.02it/s, est. speed input: 6251.18 toks/s, output: 6.10 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:04<00:43,  6.03it/s, est. speed input: 6250.37 toks/s, output: 6.10 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:06<00:42,  6.03it/s, est. speed input: 6249.60 toks/s, output: 6.10 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:07<00:41,  5.99it/s, est. speed input: 6247.42 toks/s, output: 6.10 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:08<00:38,  6.23it/s, est. speed input: 6254.46 toks/s, output: 6.11 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:10<00:37,  6.16it/s, est. speed input: 6253.46 toks/s, output: 6.11 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:11<00:36,  6.12it/s, est. speed input: 6252.64 toks/s, output: 6.11 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:12<00:35,  6.09it/s, est. speed input: 6251.79 toks/s, output: 6.11 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:13<00:33,  6.08it/s, est. speed input: 6251.19 toks/s, output: 6.10 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:15<00:32,  6.05it/s, est. speed input: 6250.14 toks/s, output: 6.10 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:16<00:31,  6.05it/s, est. speed input: 6249.53 toks/s, output: 6.10 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:17<00:30,  6.05it/s, est. speed input: 6248.92 toks/s, output: 6.10 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:19<00:28,  6.04it/s, est. speed input: 6248.30 toks/s, output: 6.10 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:20<00:27,  6.04it/s, est. speed input: 6247.43 toks/s, output: 6.10 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:21<00:26,  6.04it/s, est. speed input: 6246.85 toks/s, output: 6.10 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:23<00:24,  6.04it/s, est. speed input: 6246.33 toks/s, output: 6.10 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:24<00:23,  6.04it/s, est. speed input: 6245.64 toks/s, output: 6.10 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:25<00:22,  6.02it/s, est. speed input: 6244.63 toks/s, output: 6.10 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:27<00:20,  6.03it/s, est. speed input: 6244.10 toks/s, output: 6.10 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:28<00:19,  6.03it/s, est. speed input: 6243.60 toks/s, output: 6.10 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:29<00:18,  6.03it/s, est. speed input: 6243.06 toks/s, output: 6.10 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:31<00:16,  6.03it/s, est. speed input: 6242.47 toks/s, output: 6.10 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:32<00:15,  6.02it/s, est. speed input: 6241.65 toks/s, output: 6.10 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:33<00:14,  6.03it/s, est. speed input: 6241.24 toks/s, output: 6.09 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:35<00:12,  6.03it/s, est. speed input: 6240.70 toks/s, output: 6.09 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:36<00:11,  6.03it/s, est. speed input: 6240.15 toks/s, output: 6.09 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:37<00:10,  6.02it/s, est. speed input: 6239.37 toks/s, output: 6.09 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:39<00:08,  6.00it/s, est. speed input: 6238.22 toks/s, output: 6.09 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:40<00:07,  6.01it/s, est. speed input: 6237.73 toks/s, output: 6.09 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:41<00:06,  6.02it/s, est. speed input: 6237.16 toks/s, output: 6.09 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:43<00:04,  6.01it/s, est. speed input: 6236.44 toks/s, output: 6.09 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:44<00:03,  6.02it/s, est. speed input: 6236.01 toks/s, output: 6.09 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:45<00:02,  6.03it/s, est. speed input: 6235.59 toks/s, output: 6.09 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:47<00:00,  6.26it/s, est. speed input: 6241.17 toks/s, output: 6.09 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:47<00:00,  6.26it/s, est. speed input: 6277.95 toks/s, output: 6.13 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:47<00:00,  6.13it/s, est. speed input: 6277.95 toks/s, output: 6.13 toks/s]
[rank0]:[W126 18:54:33.226662190 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 253.5s

测试结果:
  Requests/s:   6.04
  Tokens/s:     6191.22
  Total Reqs:   1024
  Elapsed:      169.53s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     6185.18

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 18:54:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 18:54:48 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1622680) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1622680) WARNING 01-26 18:56:04 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.11 requests/s, 6264.85 total tokens/s, 6.11 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 18:54:48] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:54:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:54:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:54:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:54:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:54:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:54:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:54:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 18:54:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 18:54:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:54:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 18:54:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 18:54:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 18:54:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 18:54:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 18:54:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 18:54:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1622680) [2026-01-26 18:54:53] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1622680) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1622680) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.39s/it]
(EngineCore_DP0 pid=1622680) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 30.14s/it]
(EngineCore_DP0 pid=1622680) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:58<00:00, 29.27s/it]
(EngineCore_DP0 pid=1622680) 
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1622680) [2026-01-26 18:55:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1622680) 2026-01-26 18:56:01,149 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1622680) 2026-01-26 18:56:01,455 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 31/2048 [00:00<00:06, 301.42it/s]
Adding requests:   3%|▎         | 65/2048 [00:00<00:06, 321.21it/s]
Adding requests:   5%|▌         | 103/2048 [00:00<00:05, 347.64it/s]
Adding requests:   7%|▋         | 144/2048 [00:00<00:05, 371.01it/s]
Adding requests:   9%|▉         | 187/2048 [00:00<00:04, 390.10it/s]
Adding requests:  11%|█▏        | 232/2048 [00:00<00:04, 406.79it/s]
Adding requests:  13%|█▎        | 273/2048 [00:00<00:04, 405.34it/s]
Adding requests:  16%|█▌        | 319/2048 [00:00<00:04, 421.94it/s]
Adding requests:  18%|█▊        | 365/2048 [00:00<00:03, 432.51it/s]
Adding requests:  20%|█▉        | 409/2048 [00:01<00:03, 432.41it/s]
Adding requests:  22%|██▏       | 453/2048 [00:01<00:03, 432.90it/s]
Adding requests:  24%|██▍       | 498/2048 [00:01<00:03, 437.55it/s]
Adding requests:  27%|██▋       | 543/2048 [00:01<00:03, 439.09it/s]
Adding requests:  29%|██▊       | 587/2048 [00:01<00:03, 434.38it/s]
Adding requests:  31%|███       | 631/2048 [00:01<00:03, 433.62it/s]
Adding requests:  33%|███▎      | 675/2048 [00:01<00:03, 427.87it/s]
Adding requests:  35%|███▌      | 720/2048 [00:01<00:03, 429.78it/s]
Adding requests:  37%|███▋      | 763/2048 [00:01<00:03, 421.26it/s]
Adding requests:  39%|███▉      | 807/2048 [00:01<00:02, 423.73it/s]
Adding requests:  42%|████▏     | 853/2048 [00:02<00:02, 432.86it/s]
Adding requests:  44%|████▍     | 897/2048 [00:02<00:02, 415.44it/s]
Adding requests:  46%|████▌     | 940/2048 [00:02<00:02, 418.88it/s]
Adding requests:  48%|████▊     | 983/2048 [00:03<00:07, 144.49it/s]
Adding requests:  50%|█████     | 1024/2048 [00:03<00:05, 176.92it/s]
Adding requests:  52%|█████▏    | 1066/2048 [00:03<00:04, 212.76it/s]
Adding requests:  54%|█████▍    | 1107/2048 [00:03<00:03, 247.40it/s]
Adding requests:  56%|█████▌    | 1148/2048 [00:03<00:03, 279.33it/s]
Adding requests:  58%|█████▊    | 1190/2048 [00:03<00:02, 310.61it/s]
Adding requests:  60%|██████    | 1233/2048 [00:03<00:02, 337.98it/s]
Adding requests:  62%|██████▏   | 1274/2048 [00:03<00:02, 353.02it/s]
Adding requests:  64%|██████▍   | 1317/2048 [00:03<00:01, 371.73it/s]
Adding requests:  66%|██████▋   | 1358/2048 [00:03<00:01, 379.67it/s]
Adding requests:  68%|██████▊   | 1401/2048 [00:04<00:01, 392.41it/s]
Adding requests:  71%|███████   | 1444/2048 [00:04<00:01, 402.39it/s]
Adding requests:  73%|███████▎  | 1489/2048 [00:04<00:01, 414.36it/s]
Adding requests:  75%|███████▍  | 1532/2048 [00:04<00:01, 416.66it/s]
Adding requests:  77%|███████▋  | 1575/2048 [00:04<00:01, 411.47it/s]
Adding requests:  79%|███████▉  | 1617/2048 [00:04<00:01, 413.16it/s]
Adding requests:  81%|████████  | 1659/2048 [00:04<00:00, 401.45it/s]
Adding requests:  83%|████████▎ | 1702/2048 [00:04<00:00, 408.04it/s]
Adding requests:  85%|████████▌ | 1745/2048 [00:04<00:00, 413.02it/s]
Adding requests:  87%|████████▋ | 1789/2048 [00:04<00:00, 419.99it/s]
Adding requests:  89%|████████▉ | 1832/2048 [00:05<00:00, 420.81it/s]
Adding requests:  92%|█████████▏| 1875/2048 [00:05<00:00, 422.32it/s]
Adding requests:  94%|█████████▍| 1921/2048 [00:05<00:00, 432.46it/s]
Adding requests:  96%|█████████▌| 1965/2048 [00:05<00:00, 427.68it/s]
Adding requests:  98%|█████████▊| 2008/2048 [00:05<00:00, 422.72it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 366.63it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:02<02:31, 13.28it/s, est. speed input: 13600.78 toks/s, output: 13.28 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:05<03:41,  9.01it/s, est. speed input: 9877.50 toks/s, output: 9.65 toks/s]  
Processed prompts:   3%|▎         | 66/2048 [00:07<04:18,  7.67it/s, est. speed input: 8649.24 toks/s, output: 8.45 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:10<04:39,  7.04it/s, est. speed input: 8043.13 toks/s, output: 7.85 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:13<04:51,  6.70it/s, est. speed input: 7678.30 toks/s, output: 7.50 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:15<04:57,  6.49it/s, est. speed input: 7437.89 toks/s, output: 7.26 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:18<05:01,  6.36it/s, est. speed input: 7264.20 toks/s, output: 7.09 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:20<05:03,  6.27it/s, est. speed input: 7135.38 toks/s, output: 6.97 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:23<05:03,  6.21it/s, est. speed input: 7034.69 toks/s, output: 6.87 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:26<05:02,  6.18it/s, est. speed input: 6955.34 toks/s, output: 6.79 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:28<04:55,  6.26it/s, est. speed input: 6927.36 toks/s, output: 6.76 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:31<04:56,  6.21it/s, est. speed input: 6868.29 toks/s, output: 6.71 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:33<04:55,  6.17it/s, est. speed input: 6818.57 toks/s, output: 6.66 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:36<04:54,  6.13it/s, est. speed input: 6774.10 toks/s, output: 6.62 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:39<04:52,  6.12it/s, est. speed input: 6737.53 toks/s, output: 6.58 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:41<04:50,  6.10it/s, est. speed input: 6704.02 toks/s, output: 6.55 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:44<04:48,  6.10it/s, est. speed input: 6675.83 toks/s, output: 6.52 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:46<04:40,  6.22it/s, est. speed input: 6675.79 toks/s, output: 6.52 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:49<04:39,  6.17it/s, est. speed input: 6650.49 toks/s, output: 6.49 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:52<04:38,  6.14it/s, est. speed input: 6628.20 toks/s, output: 6.47 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:54<04:36,  6.12it/s, est. speed input: 6608.59 toks/s, output: 6.45 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:57<04:34,  6.10it/s, est. speed input: 6590.47 toks/s, output: 6.44 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [01:00<04:32,  6.09it/s, est. speed input: 6574.07 toks/s, output: 6.42 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:02<04:30,  6.08it/s, est. speed input: 6558.72 toks/s, output: 6.40 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:05<04:28,  6.08it/s, est. speed input: 6544.92 toks/s, output: 6.39 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:07<04:20,  6.20it/s, est. speed input: 6549.43 toks/s, output: 6.40 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:10<04:19,  6.16it/s, est. speed input: 6536.57 toks/s, output: 6.38 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:13<04:17,  6.13it/s, est. speed input: 6525.00 toks/s, output: 6.37 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:15<04:16,  6.11it/s, est. speed input: 6513.91 toks/s, output: 6.36 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:18<04:14,  6.10it/s, est. speed input: 6503.87 toks/s, output: 6.35 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:21<04:11,  6.09it/s, est. speed input: 6494.30 toks/s, output: 6.34 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:23<04:09,  6.08it/s, est. speed input: 6485.75 toks/s, output: 6.33 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:26<04:07,  6.08it/s, est. speed input: 6477.33 toks/s, output: 6.33 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:28<04:04,  6.07it/s, est. speed input: 6468.79 toks/s, output: 6.32 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:31<04:02,  6.07it/s, est. speed input: 6461.29 toks/s, output: 6.31 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:34<03:59,  6.06it/s, est. speed input: 6453.83 toks/s, output: 6.30 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:36<03:57,  6.06it/s, est. speed input: 6447.12 toks/s, output: 6.30 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:39<03:54,  6.06it/s, est. speed input: 6440.66 toks/s, output: 6.29 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:42<03:51,  6.06it/s, est. speed input: 6434.74 toks/s, output: 6.28 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:44<03:49,  6.07it/s, est. speed input: 6429.44 toks/s, output: 6.28 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:47<03:46,  6.07it/s, est. speed input: 6424.23 toks/s, output: 6.27 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:50<03:44,  6.06it/s, est. speed input: 6418.66 toks/s, output: 6.27 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:52<03:41,  6.06it/s, est. speed input: 6413.79 toks/s, output: 6.26 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [01:55<03:38,  6.06it/s, est. speed input: 6409.00 toks/s, output: 6.26 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [01:57<03:36,  6.06it/s, est. speed input: 6404.50 toks/s, output: 6.25 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [02:00<03:33,  6.06it/s, est. speed input: 6399.76 toks/s, output: 6.25 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [02:03<03:30,  6.06it/s, est. speed input: 6395.78 toks/s, output: 6.25 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:05<03:23,  6.19it/s, est. speed input: 6401.04 toks/s, output: 6.25 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:08<03:23,  6.12it/s, est. speed input: 6395.15 toks/s, output: 6.25 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:11<03:21,  6.10it/s, est. speed input: 6391.18 toks/s, output: 6.24 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:13<03:19,  6.08it/s, est. speed input: 6386.94 toks/s, output: 6.24 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:16<03:17,  6.07it/s, est. speed input: 6383.33 toks/s, output: 6.23 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:18<03:14,  6.07it/s, est. speed input: 6379.93 toks/s, output: 6.23 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:21<03:12,  6.07it/s, est. speed input: 6376.67 toks/s, output: 6.23 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:24<03:09,  6.06it/s, est. speed input: 6373.06 toks/s, output: 6.22 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:26<03:07,  6.06it/s, est. speed input: 6370.16 toks/s, output: 6.22 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:29<03:04,  6.06it/s, est. speed input: 6367.00 toks/s, output: 6.22 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:32<03:02,  6.05it/s, est. speed input: 6363.97 toks/s, output: 6.21 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:34<02:59,  6.05it/s, est. speed input: 6361.00 toks/s, output: 6.21 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:37<02:56,  6.06it/s, est. speed input: 6358.57 toks/s, output: 6.21 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:40<02:54,  6.05it/s, est. speed input: 6355.87 toks/s, output: 6.21 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:42<02:51,  6.06it/s, est. speed input: 6353.40 toks/s, output: 6.20 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:45<02:48,  6.05it/s, est. speed input: 6350.85 toks/s, output: 6.20 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:48<02:46,  6.06it/s, est. speed input: 6348.59 toks/s, output: 6.20 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:50<02:43,  6.05it/s, est. speed input: 6346.13 toks/s, output: 6.20 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [02:53<02:40,  6.05it/s, est. speed input: 6343.92 toks/s, output: 6.20 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [02:56<02:38,  6.05it/s, est. speed input: 6341.70 toks/s, output: 6.19 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [02:58<02:35,  6.06it/s, est. speed input: 6339.74 toks/s, output: 6.19 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [03:01<02:32,  6.05it/s, est. speed input: 6337.66 toks/s, output: 6.19 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [03:03<02:30,  6.06it/s, est. speed input: 6335.75 toks/s, output: 6.19 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:06<02:27,  6.06it/s, est. speed input: 6333.81 toks/s, output: 6.19 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:09<02:24,  6.06it/s, est. speed input: 6332.00 toks/s, output: 6.18 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:11<02:22,  6.05it/s, est. speed input: 6330.14 toks/s, output: 6.18 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:14<02:16,  6.19it/s, est. speed input: 6334.44 toks/s, output: 6.19 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:16<02:14,  6.15it/s, est. speed input: 6332.76 toks/s, output: 6.18 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:19<02:10,  6.25it/s, est. speed input: 6336.65 toks/s, output: 6.19 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:22<02:08,  6.19it/s, est. speed input: 6334.90 toks/s, output: 6.19 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:24<02:07,  6.15it/s, est. speed input: 6333.08 toks/s, output: 6.18 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:27<02:05,  6.12it/s, est. speed input: 6331.36 toks/s, output: 6.18 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:29<02:03,  6.10it/s, est. speed input: 6329.56 toks/s, output: 6.18 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:32<02:00,  6.08it/s, est. speed input: 6327.88 toks/s, output: 6.18 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:35<01:55,  6.21it/s, est. speed input: 6331.83 toks/s, output: 6.18 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:37<01:54,  6.16it/s, est. speed input: 6330.12 toks/s, output: 6.18 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:40<01:52,  6.12it/s, est. speed input: 6328.45 toks/s, output: 6.18 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:43<01:49,  6.10it/s, est. speed input: 6326.77 toks/s, output: 6.18 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:45<01:47,  6.09it/s, est. speed input: 6325.37 toks/s, output: 6.18 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:48<01:45,  6.07it/s, est. speed input: 6323.81 toks/s, output: 6.18 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [03:50<01:42,  6.07it/s, est. speed input: 6322.39 toks/s, output: 6.17 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [03:53<01:37,  6.19it/s, est. speed input: 6325.96 toks/s, output: 6.18 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [03:55<01:33,  6.29it/s, est. speed input: 6329.70 toks/s, output: 6.18 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [03:58<01:32,  6.22it/s, est. speed input: 6328.32 toks/s, output: 6.18 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [04:01<01:30,  6.17it/s, est. speed input: 6326.98 toks/s, output: 6.18 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [04:03<01:28,  6.14it/s, est. speed input: 6325.62 toks/s, output: 6.18 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [04:06<01:24,  6.24it/s, est. speed input: 6328.92 toks/s, output: 6.18 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:08<01:22,  6.19it/s, est. speed input: 6327.68 toks/s, output: 6.18 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:11<01:18,  6.28it/s, est. speed input: 6330.97 toks/s, output: 6.18 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:13<01:17,  6.21it/s, est. speed input: 6329.49 toks/s, output: 6.18 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:16<01:14,  6.16it/s, est. speed input: 6328.24 toks/s, output: 6.18 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:19<01:12,  6.13it/s, est. speed input: 6326.77 toks/s, output: 6.18 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:21<01:08,  6.23it/s, est. speed input: 6329.86 toks/s, output: 6.18 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:24<01:07,  6.18it/s, est. speed input: 6328.50 toks/s, output: 6.18 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:27<01:04,  6.14it/s, est. speed input: 6327.13 toks/s, output: 6.18 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:29<01:02,  6.11it/s, est. speed input: 6325.89 toks/s, output: 6.18 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:32<01:00,  6.09it/s, est. speed input: 6324.66 toks/s, output: 6.18 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:34<00:57,  6.08it/s, est. speed input: 6323.38 toks/s, output: 6.18 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [04:37<00:55,  6.07it/s, est. speed input: 6322.17 toks/s, output: 6.17 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [04:40<00:51,  6.19it/s, est. speed input: 6325.07 toks/s, output: 6.18 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [04:42<00:47,  6.38it/s, est. speed input: 6330.76 toks/s, output: 6.18 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [04:45<00:45,  6.28it/s, est. speed input: 6329.59 toks/s, output: 6.18 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [04:47<00:43,  6.21it/s, est. speed input: 6328.31 toks/s, output: 6.18 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [04:50<00:41,  6.16it/s, est. speed input: 6327.12 toks/s, output: 6.18 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [04:53<00:38,  6.12it/s, est. speed input: 6325.73 toks/s, output: 6.18 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [04:55<00:36,  6.10it/s, est. speed input: 6324.70 toks/s, output: 6.18 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [04:58<00:33,  6.09it/s, est. speed input: 6323.51 toks/s, output: 6.18 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [05:00<00:31,  6.07it/s, est. speed input: 6322.36 toks/s, output: 6.17 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [05:03<00:28,  6.07it/s, est. speed input: 6321.24 toks/s, output: 6.17 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [05:06<00:25,  6.19it/s, est. speed input: 6323.95 toks/s, output: 6.18 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [05:08<00:23,  6.14it/s, est. speed input: 6322.75 toks/s, output: 6.17 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:11<00:20,  6.11it/s, est. speed input: 6321.59 toks/s, output: 6.17 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:13<00:18,  6.10it/s, est. speed input: 6320.66 toks/s, output: 6.17 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:16<00:15,  6.08it/s, est. speed input: 6319.42 toks/s, output: 6.17 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:19<00:12,  6.07it/s, est. speed input: 6318.33 toks/s, output: 6.17 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:21<00:10,  6.19it/s, est. speed input: 6320.78 toks/s, output: 6.17 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:24<00:07,  6.14it/s, est. speed input: 6319.77 toks/s, output: 6.17 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:27<00:04,  6.11it/s, est. speed input: 6318.67 toks/s, output: 6.17 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:29<00:02,  6.23it/s, est. speed input: 6321.39 toks/s, output: 6.17 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:29<00:00,  6.23it/s, est. speed input: 6364.90 toks/s, output: 6.22 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:29<00:00,  6.22it/s, est. speed input: 6364.90 toks/s, output: 6.22 toks/s]
[rank0]:[W126 19:01:40.404375557 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 427.0s

测试结果:
  Requests/s:   6.11
  Tokens/s:     6264.85
  Total Reqs:   2048
  Elapsed:      335.08s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     6258.74

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:02:00 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:02:00 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1628796) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1628796) WARNING 01-26 19:03:23 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 6.20 requests/s, 6350.94 total tokens/s, 6.20 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 19:02:00] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:02:00] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:02:00] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:00] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:02:00] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:02:00] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:02:00] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:02:00] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:02:00] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:02:03] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:02:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:02:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:02:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:02:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:02:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:02:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:02:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:02:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1628796) [2026-01-26 19:02:04] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1628796) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1628796) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:25<00:25, 25.14s/it]
(EngineCore_DP0 pid=1628796) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.46s/it]
(EngineCore_DP0 pid=1628796) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.66s/it]
(EngineCore_DP0 pid=1628796) 
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1628796) [2026-01-26 19:03:05] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1628796) 2026-01-26 19:03:15,564 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1628796) 2026-01-26 19:03:16,506 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:08, 489.81it/s]
Adding requests:   2%|▏         | 98/4096 [00:00<00:09, 404.83it/s]
Adding requests:   3%|▎         | 140/4096 [00:00<00:09, 406.19it/s]
Adding requests:   4%|▍         | 182/4096 [00:00<00:09, 404.04it/s]
Adding requests:   5%|▌         | 223/4096 [00:00<00:09, 404.10it/s]
Adding requests:   6%|▋         | 264/4096 [00:00<00:09, 402.30it/s]
Adding requests:   8%|▊         | 308/4096 [00:00<00:09, 413.30it/s]
Adding requests:   9%|▊         | 350/4096 [00:00<00:09, 413.27it/s]
Adding requests:  10%|▉         | 396/4096 [00:00<00:08, 427.36it/s]
Adding requests:  11%|█         | 439/4096 [00:01<00:08, 413.17it/s]
Adding requests:  12%|█▏        | 487/4096 [00:01<00:08, 432.37it/s]
Adding requests:  13%|█▎        | 531/4096 [00:01<00:08, 431.42it/s]
Adding requests:  14%|█▍        | 576/4096 [00:01<00:08, 434.50it/s]
Adding requests:  15%|█▌        | 620/4096 [00:01<00:08, 419.88it/s]
Adding requests:  16%|█▌        | 663/4096 [00:01<00:08, 420.48it/s]
Adding requests:  17%|█▋        | 706/4096 [00:01<00:08, 422.29it/s]
Adding requests:  18%|█▊        | 749/4096 [00:01<00:08, 409.92it/s]
Adding requests:  19%|█▉        | 794/4096 [00:01<00:07, 421.34it/s]
Adding requests:  20%|██        | 837/4096 [00:02<00:07, 408.11it/s]
Adding requests:  22%|██▏       | 882/4096 [00:02<00:07, 419.09it/s]
Adding requests:  23%|██▎       | 925/4096 [00:02<00:07, 413.30it/s]
Adding requests:  24%|██▎       | 968/4096 [00:02<00:07, 415.61it/s]
Adding requests:  25%|██▍       | 1010/4096 [00:02<00:07, 413.14it/s]
Adding requests:  26%|██▌       | 1052/4096 [00:02<00:07, 403.25it/s]
Adding requests:  27%|██▋       | 1096/4096 [00:02<00:07, 411.32it/s]
Adding requests:  28%|██▊       | 1138/4096 [00:02<00:07, 405.50it/s]
Adding requests:  29%|██▉       | 1180/4096 [00:02<00:07, 409.17it/s]
Adding requests:  30%|██▉       | 1221/4096 [00:02<00:07, 383.30it/s]
Adding requests:  31%|███       | 1261/4096 [00:03<00:07, 386.09it/s]
Adding requests:  32%|███▏      | 1305/4096 [00:03<00:06, 400.54it/s]
Adding requests:  33%|███▎      | 1346/4096 [00:03<00:06, 400.13it/s]
Adding requests:  34%|███▍      | 1392/4096 [00:03<00:06, 414.60it/s]
Adding requests:  35%|███▌      | 1434/4096 [00:03<00:06, 398.56it/s]
Adding requests:  36%|███▌      | 1478/4096 [00:03<00:06, 406.77it/s]
Adding requests:  37%|███▋      | 1519/4096 [00:03<00:06, 404.74it/s]
Adding requests:  38%|███▊      | 1560/4096 [00:03<00:06, 405.47it/s]
Adding requests:  39%|███▉      | 1601/4096 [00:03<00:06, 404.43it/s]
Adding requests:  40%|████      | 1642/4096 [00:04<00:06, 399.33it/s]
Adding requests:  41%|████      | 1687/4096 [00:04<00:05, 412.62it/s]
Adding requests:  42%|████▏     | 1729/4096 [00:04<00:05, 404.20it/s]
Adding requests:  43%|████▎     | 1776/4096 [00:04<00:05, 421.16it/s]
Adding requests:  44%|████▍     | 1819/4096 [00:04<00:05, 403.61it/s]
Adding requests:  45%|████▌     | 1861/4096 [00:04<00:05, 406.09it/s]
Adding requests:  46%|████▋     | 1903/4096 [00:04<00:05, 409.74it/s]
Adding requests:  47%|████▋     | 1945/4096 [00:04<00:05, 412.57it/s]
Adding requests:  49%|████▊     | 1989/4096 [00:04<00:05, 419.28it/s]
Adding requests:  50%|████▉     | 2032/4096 [00:04<00:05, 397.29it/s]
Adding requests:  51%|█████     | 2075/4096 [00:05<00:04, 404.32it/s]
Adding requests:  52%|█████▏    | 2116/4096 [00:05<00:04, 400.13it/s]
Adding requests:  53%|█████▎    | 2158/4096 [00:05<00:04, 402.73it/s]
Adding requests:  54%|█████▎    | 2199/4096 [00:05<00:04, 402.95it/s]
Adding requests:  55%|█████▍    | 2240/4096 [00:05<00:04, 404.48it/s]
Adding requests:  56%|█████▌    | 2283/4096 [00:05<00:04, 410.66it/s]
Adding requests:  57%|█████▋    | 2325/4096 [00:05<00:04, 405.54it/s]
Adding requests:  58%|█████▊    | 2370/4096 [00:05<00:04, 418.26it/s]
Adding requests:  59%|█████▉    | 2412/4096 [00:05<00:04, 412.26it/s]
Adding requests:  60%|█████▉    | 2454/4096 [00:05<00:04, 395.39it/s]
Adding requests:  61%|██████    | 2495/4096 [00:06<00:04, 396.79it/s]
Adding requests:  62%|██████▏   | 2541/4096 [00:06<00:03, 414.70it/s]
Adding requests:  63%|██████▎   | 2585/4096 [00:06<00:03, 420.46it/s]
Adding requests:  64%|██████▍   | 2628/4096 [00:06<00:03, 418.52it/s]
Adding requests:  65%|██████▌   | 2671/4096 [00:06<00:03, 421.45it/s]
Adding requests:  66%|██████▋   | 2714/4096 [00:06<00:03, 414.40it/s]
Adding requests:  67%|██████▋   | 2763/4096 [00:06<00:03, 435.83it/s]
Adding requests:  69%|██████▊   | 2807/4096 [00:06<00:03, 420.95it/s]
Adding requests:  70%|██████▉   | 2851/4096 [00:06<00:02, 425.37it/s]
Adding requests:  71%|███████   | 2894/4096 [00:07<00:02, 410.44it/s]
Adding requests:  72%|███████▏  | 2936/4096 [00:07<00:02, 412.53it/s]
Adding requests:  73%|███████▎  | 2978/4096 [00:07<00:02, 412.39it/s]
Adding requests:  74%|███████▎  | 3020/4096 [00:07<00:02, 408.69it/s]
Adding requests:  75%|███████▍  | 3067/4096 [00:07<00:02, 425.93it/s]
Adding requests:  76%|███████▌  | 3110/4096 [00:07<00:02, 419.17it/s]
Adding requests:  77%|███████▋  | 3156/4096 [00:07<00:02, 427.88it/s]
Adding requests:  78%|███████▊  | 3199/4096 [00:07<00:02, 420.30it/s]
Adding requests:  79%|███████▉  | 3244/4096 [00:07<00:01, 426.20it/s]
Adding requests:  80%|████████  | 3287/4096 [00:07<00:01, 417.31it/s]
Adding requests:  81%|████████▏ | 3329/4096 [00:08<00:01, 413.73it/s]
Adding requests:  82%|████████▏ | 3376/4096 [00:08<00:01, 428.60it/s]
Adding requests:  83%|████████▎ | 3419/4096 [00:08<00:01, 424.16it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:08<00:01, 443.03it/s]
Adding requests:  86%|████████▌ | 3514/4096 [00:08<00:01, 425.90it/s]
Adding requests:  87%|████████▋ | 3563/4096 [00:08<00:01, 443.86it/s]
Adding requests:  88%|████████▊ | 3608/4096 [00:08<00:01, 435.35it/s]
Adding requests:  89%|████████▉ | 3654/4096 [00:08<00:01, 440.42it/s]
Adding requests:  90%|█████████ | 3699/4096 [00:08<00:00, 438.08it/s]
Adding requests:  91%|█████████▏| 3743/4096 [00:09<00:00, 434.29it/s]
Adding requests:  92%|█████████▏| 3788/4096 [00:09<00:00, 437.02it/s]
Adding requests:  94%|█████████▎| 3832/4096 [00:09<00:00, 383.81it/s]
Adding requests:  95%|█████████▍| 3873/4096 [00:09<00:00, 388.41it/s]
Adding requests:  96%|█████████▌| 3917/4096 [00:09<00:00, 401.26it/s]
Adding requests:  97%|█████████▋| 3959/4096 [00:09<00:00, 405.63it/s]
Adding requests:  98%|█████████▊| 4005/4096 [00:09<00:00, 420.78it/s]
Adding requests:  99%|█████████▉| 4048/4096 [00:09<00:00, 411.98it/s]
Adding requests: 100%|█████████▉| 4093/4096 [00:09<00:00, 422.69it/s]
Adding requests: 100%|██████████| 4096/4096 [00:09<00:00, 414.03it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 34/4096 [00:00<01:37, 41.71it/s, est. speed input: 42715.57 toks/s, output: 41.71 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:05<06:53,  9.74it/s, est. speed input: 11312.48 toks/s, output: 11.05 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:11<08:36,  7.74it/s, est. speed input: 9003.98 toks/s, output: 8.79 toks/s]  
Processed prompts:   3%|▎         | 130/4096 [00:16<09:22,  7.04it/s, est. speed input: 8156.05 toks/s, output: 7.96 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:22<10:15,  6.39it/s, est. speed input: 7484.83 toks/s, output: 7.31 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:27<10:12,  6.37it/s, est. speed input: 7300.20 toks/s, output: 7.13 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:32<10:13,  6.30it/s, est. speed input: 7142.97 toks/s, output: 6.98 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:37<10:13,  6.26it/s, est. speed input: 7027.65 toks/s, output: 6.86 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:42<10:05,  6.29it/s, est. speed input: 6965.93 toks/s, output: 6.80 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:47<10:03,  6.25it/s, est. speed input: 6895.60 toks/s, output: 6.73 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:53<10:05,  6.18it/s, est. speed input: 6823.16 toks/s, output: 6.66 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:58<10:00,  6.17it/s, est. speed input: 6777.29 toks/s, output: 6.62 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:03<09:50,  6.23it/s, est. speed input: 6755.57 toks/s, output: 6.60 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:08<09:47,  6.21it/s, est. speed input: 6721.33 toks/s, output: 6.56 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:13<09:43,  6.19it/s, est. speed input: 6691.90 toks/s, output: 6.54 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:18<09:39,  6.18it/s, est. speed input: 6667.05 toks/s, output: 6.51 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:24<09:35,  6.17it/s, est. speed input: 6642.52 toks/s, output: 6.49 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:29<09:30,  6.16it/s, est. speed input: 6622.64 toks/s, output: 6.47 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:34<09:25,  6.16it/s, est. speed input: 6605.16 toks/s, output: 6.45 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:39<09:20,  6.16it/s, est. speed input: 6590.10 toks/s, output: 6.44 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:44<09:15,  6.16it/s, est. speed input: 6576.01 toks/s, output: 6.42 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [01:50<09:10,  6.16it/s, est. speed input: 6563.41 toks/s, output: 6.41 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [01:55<09:05,  6.16it/s, est. speed input: 6551.25 toks/s, output: 6.40 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [02:00<08:56,  6.21it/s, est. speed input: 6547.97 toks/s, output: 6.39 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:05<08:52,  6.19it/s, est. speed input: 6537.43 toks/s, output: 6.38 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:10<08:47,  6.18it/s, est. speed input: 6528.60 toks/s, output: 6.38 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:16<08:43,  6.18it/s, est. speed input: 6520.31 toks/s, output: 6.37 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:21<08:38,  6.17it/s, est. speed input: 6512.49 toks/s, output: 6.36 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:26<08:33,  6.17it/s, est. speed input: 6505.22 toks/s, output: 6.35 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:31<08:28,  6.16it/s, est. speed input: 6497.99 toks/s, output: 6.35 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:36<08:23,  6.16it/s, est. speed input: 6491.57 toks/s, output: 6.34 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:41<08:18,  6.16it/s, est. speed input: 6485.75 toks/s, output: 6.33 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [02:47<08:13,  6.16it/s, est. speed input: 6480.08 toks/s, output: 6.33 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [02:52<08:08,  6.16it/s, est. speed input: 6474.65 toks/s, output: 6.32 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [02:57<08:02,  6.16it/s, est. speed input: 6469.75 toks/s, output: 6.32 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [03:02<07:57,  6.15it/s, est. speed input: 6464.80 toks/s, output: 6.31 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:07<07:48,  6.21it/s, est. speed input: 6465.85 toks/s, output: 6.31 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:12<07:40,  6.25it/s, est. speed input: 6466.96 toks/s, output: 6.32 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:18<07:37,  6.22it/s, est. speed input: 6462.57 toks/s, output: 6.31 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:23<07:33,  6.20it/s, est. speed input: 6458.42 toks/s, output: 6.31 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:28<07:25,  6.25it/s, est. speed input: 6459.67 toks/s, output: 6.31 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:33<07:22,  6.21it/s, est. speed input: 6455.21 toks/s, output: 6.30 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [03:38<07:18,  6.19it/s, est. speed input: 6451.57 toks/s, output: 6.30 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [03:43<07:14,  6.18it/s, est. speed input: 6448.24 toks/s, output: 6.30 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [03:48<07:03,  6.26it/s, est. speed input: 6451.81 toks/s, output: 6.30 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [03:54<07:00,  6.23it/s, est. speed input: 6448.43 toks/s, output: 6.30 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [03:59<06:53,  6.26it/s, est. speed input: 6449.50 toks/s, output: 6.30 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [04:04<06:46,  6.29it/s, est. speed input: 6450.40 toks/s, output: 6.30 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:09<06:44,  6.24it/s, est. speed input: 6446.71 toks/s, output: 6.30 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:14<06:37,  6.27it/s, est. speed input: 6447.74 toks/s, output: 6.30 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:19<06:34,  6.23it/s, est. speed input: 6444.68 toks/s, output: 6.29 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:24<06:31,  6.21it/s, est. speed input: 6441.67 toks/s, output: 6.29 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:30<06:27,  6.19it/s, est. speed input: 6438.84 toks/s, output: 6.29 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [04:34<06:12,  6.35it/s, est. speed input: 6447.47 toks/s, output: 6.30 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [04:39<06:11,  6.29it/s, est. speed input: 6444.49 toks/s, output: 6.29 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [04:45<06:08,  6.25it/s, est. speed input: 6441.78 toks/s, output: 6.29 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [04:50<06:05,  6.22it/s, est. speed input: 6439.24 toks/s, output: 6.29 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [04:55<06:01,  6.19it/s, est. speed input: 6436.62 toks/s, output: 6.29 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [05:00<05:53,  6.24it/s, est. speed input: 6437.43 toks/s, output: 6.29 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [05:05<05:50,  6.21it/s, est. speed input: 6434.86 toks/s, output: 6.28 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [05:11<05:46,  6.18it/s, est. speed input: 6432.18 toks/s, output: 6.28 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:16<05:38,  6.23it/s, est. speed input: 6433.18 toks/s, output: 6.28 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:21<05:34,  6.20it/s, est. speed input: 6430.86 toks/s, output: 6.28 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [05:26<05:25,  6.28it/s, est. speed input: 6433.58 toks/s, output: 6.28 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [05:31<05:22,  6.24it/s, est. speed input: 6431.34 toks/s, output: 6.28 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [05:36<05:19,  6.21it/s, est. speed input: 6429.25 toks/s, output: 6.28 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [05:41<05:15,  6.19it/s, est. speed input: 6427.04 toks/s, output: 6.28 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [05:46<05:07,  6.23it/s, est. speed input: 6427.85 toks/s, output: 6.28 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [05:52<05:03,  6.21it/s, est. speed input: 6425.91 toks/s, output: 6.28 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [05:57<04:59,  6.19it/s, est. speed input: 6423.90 toks/s, output: 6.27 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [06:02<04:55,  6.17it/s, est. speed input: 6421.95 toks/s, output: 6.27 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [06:07<04:50,  6.16it/s, est. speed input: 6420.06 toks/s, output: 6.27 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [06:12<04:42,  6.22it/s, est. speed input: 6421.07 toks/s, output: 6.27 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:18<04:38,  6.19it/s, est. speed input: 6419.24 toks/s, output: 6.27 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [06:23<04:34,  6.18it/s, est. speed input: 6417.49 toks/s, output: 6.27 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [06:28<04:29,  6.17it/s, est. speed input: 6415.69 toks/s, output: 6.27 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [06:33<04:24,  6.16it/s, est. speed input: 6414.15 toks/s, output: 6.26 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [06:38<04:19,  6.15it/s, est. speed input: 6412.47 toks/s, output: 6.26 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [06:43<04:12,  6.21it/s, est. speed input: 6413.41 toks/s, output: 6.26 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [06:49<04:08,  6.19it/s, est. speed input: 6411.72 toks/s, output: 6.26 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [06:54<04:01,  6.23it/s, est. speed input: 6412.60 toks/s, output: 6.26 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [06:59<03:57,  6.20it/s, est. speed input: 6411.05 toks/s, output: 6.26 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [07:04<03:50,  6.24it/s, est. speed input: 6411.88 toks/s, output: 6.26 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [07:09<03:46,  6.21it/s, est. speed input: 6410.41 toks/s, output: 6.26 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [07:14<03:39,  6.25it/s, est. speed input: 6411.30 toks/s, output: 6.26 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [07:19<03:35,  6.22it/s, est. speed input: 6409.85 toks/s, output: 6.26 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [07:25<03:31,  6.19it/s, est. speed input: 6408.41 toks/s, output: 6.26 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [07:30<03:26,  6.18it/s, est. speed input: 6407.07 toks/s, output: 6.26 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [07:35<03:22,  6.17it/s, est. speed input: 6405.75 toks/s, output: 6.26 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [07:40<03:11,  6.34it/s, est. speed input: 6411.27 toks/s, output: 6.26 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [07:45<03:06,  6.34it/s, est. speed input: 6412.17 toks/s, output: 6.26 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [07:50<03:03,  6.28it/s, est. speed input: 6410.66 toks/s, output: 6.26 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [07:55<02:57,  6.29it/s, est. speed input: 6411.46 toks/s, output: 6.26 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [08:00<02:53,  6.25it/s, est. speed input: 6410.19 toks/s, output: 6.26 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [08:06<02:49,  6.21it/s, est. speed input: 6408.85 toks/s, output: 6.26 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [08:11<02:45,  6.19it/s, est. speed input: 6407.54 toks/s, output: 6.26 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [08:16<02:40,  6.18it/s, est. speed input: 6406.33 toks/s, output: 6.26 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [08:21<02:35,  6.16it/s, est. speed input: 6405.03 toks/s, output: 6.25 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [08:26<02:29,  6.21it/s, est. speed input: 6405.66 toks/s, output: 6.26 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [08:31<02:24,  6.19it/s, est. speed input: 6404.42 toks/s, output: 6.25 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [08:37<02:19,  6.17it/s, est. speed input: 6403.28 toks/s, output: 6.25 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [08:42<02:14,  6.16it/s, est. speed input: 6402.11 toks/s, output: 6.25 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [08:47<02:09,  6.15it/s, est. speed input: 6400.91 toks/s, output: 6.25 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [08:52<02:04,  6.15it/s, est. speed input: 6399.79 toks/s, output: 6.25 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [08:58<01:59,  6.14it/s, est. speed input: 6398.61 toks/s, output: 6.25 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [09:03<01:53,  6.20it/s, est. speed input: 6399.38 toks/s, output: 6.25 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [09:08<01:48,  6.18it/s, est. speed input: 6398.33 toks/s, output: 6.25 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [09:13<01:43,  6.17it/s, est. speed input: 6397.21 toks/s, output: 6.25 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [09:18<01:38,  6.16it/s, est. speed input: 6396.16 toks/s, output: 6.25 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [09:23<01:33,  6.15it/s, est. speed input: 6395.21 toks/s, output: 6.25 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [09:29<01:27,  6.20it/s, est. speed input: 6395.83 toks/s, output: 6.25 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [09:34<01:22,  6.18it/s, est. speed input: 6394.91 toks/s, output: 6.25 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [09:39<01:16,  6.23it/s, est. speed input: 6395.70 toks/s, output: 6.25 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [09:44<01:11,  6.20it/s, est. speed input: 6394.79 toks/s, output: 6.24 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [09:49<01:05,  6.27it/s, est. speed input: 6396.49 toks/s, output: 6.25 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [09:54<01:01,  6.23it/s, est. speed input: 6395.53 toks/s, output: 6.25 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [09:59<00:56,  6.20it/s, est. speed input: 6394.36 toks/s, output: 6.24 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [10:05<00:51,  6.18it/s, est. speed input: 6393.43 toks/s, output: 6.24 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [10:10<00:46,  6.17it/s, est. speed input: 6392.48 toks/s, output: 6.24 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [10:15<00:41,  6.16it/s, est. speed input: 6391.59 toks/s, output: 6.24 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [10:20<00:36,  6.15it/s, est. speed input: 6390.63 toks/s, output: 6.24 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [10:25<00:30,  6.21it/s, est. speed input: 6391.45 toks/s, output: 6.24 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [10:30<00:25,  6.24it/s, est. speed input: 6392.16 toks/s, output: 6.24 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [10:36<00:20,  6.20it/s, est. speed input: 6391.09 toks/s, output: 6.24 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [10:41<00:15,  6.24it/s, est. speed input: 6391.68 toks/s, output: 6.24 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [10:46<00:09,  6.26it/s, est. speed input: 6392.40 toks/s, output: 6.24 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [10:51<00:04,  6.32it/s, est. speed input: 6393.99 toks/s, output: 6.24 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:51<00:00,  6.32it/s, est. speed input: 6441.16 toks/s, output: 6.29 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [10:51<00:00,  6.29it/s, est. speed input: 6441.16 toks/s, output: 6.29 toks/s]
[rank0]:[W126 19:14:25.462708659 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 765.2s

测试结果:
  Requests/s:   6.20
  Tokens/s:     6350.94
  Total Reqs:   4096
  Elapsed:      661.07s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     6344.74

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:15:02 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:15:02 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1639717) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1639717) ERROR 01-26 19:16:09 [core.py:866] 


─── STDERR ───
[2026-01-26 19:15:02] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:15:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:15:02] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:15:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:15:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:15:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:15:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:15:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:15:05] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:15:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:15:05] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:15:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:15:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:15:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:15:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:15:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:15:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1639717) [2026-01-26 19:15:07] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1639717) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1639717) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:24<00:24, 24.54s/it]
(EngineCore_DP0 pid=1639717) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 30.66s/it]
(EngineCore_DP0 pid=1639717) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:59<00:00, 29.74s/it]
(EngineCore_DP0 pid=1639717) 
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 4800] -> 1D uint8
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 13860864 bytes
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 4800] -> 1D uint8
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 10780672 bytes
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 4800] -> 1D uint8
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 113967104 bytes
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 25280] -> 1D uint8
(EngineCore_DP0 pid=1639717) [2026-01-26 19:16:07] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 56655872 bytes
(EngineCore_DP0 pid=1639717) Process EngineCore_DP0:
(EngineCore_DP0 pid=1639717) Traceback (most recent call last):
(EngineCore_DP0 pid=1639717)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1639717)     self.run()
(EngineCore_DP0 pid=1639717)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1639717)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1639717)     raise e
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1639717)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1639717)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1639717)     super().__init__(
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1639717)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1639717)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1639717)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1639717)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1639717)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1639717)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1639717)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1639717)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1639717)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1639717)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1639717)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1639717)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1639717)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1639717)     outputs = self.model(
(EngineCore_DP0 pid=1639717)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1639717)     hidden_states = self.model(
(EngineCore_DP0 pid=1639717)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1639717)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1639717)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1639717)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1639717)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1639717)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1639717)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1639717)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1639717)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1639717)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1639717)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1639717)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1639717)     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1639717)     return self._linear_fn(
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1639717)     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1639717)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1639717)     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1639717)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1639717)     return fn(input, L)
(EngineCore_DP0 pid=1639717)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1639717)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1639717)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1639717) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1639717) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1639717) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1639717) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1639717) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1639717) 
[rank0]:[W126 19:16:09.095472418 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_6/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,11.5959,5948.6727,11.0384
1024,1024,1,128,128,6.0501,6201.3887,21.1566
2048,1024,2,256,128,6.0350,6185.8380,42.4195
4096,1024,4,512,128,5.9050,6052.6586,86.7057
8192,1024,8,1024,128,6.0402,6191.2224,169.5303
16384,1024,16,2048,128,6.1121,6264.8543,335.0756
32768,1024,32,4096,128,6.1960,6350.9391,661.0676
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_8

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:16:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:16:15 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1640888) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1640888) WARNING 01-26 19:17:30 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 11.07 requests/s, 5679.84 total tokens/s, 11.07 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 19:16:15] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:16:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:16:15] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:16:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:16:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:16:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:16:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:16:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:16:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:16:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:16:19] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:16:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:16:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:16:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:16:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:16:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:16:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1640888) [2026-01-26 19:16:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1640888) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1640888) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:27<00:27, 27.56s/it]
(EngineCore_DP0 pid=1640888) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 30.99s/it]
(EngineCore_DP0 pid=1640888) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 30.47s/it]
(EngineCore_DP0 pid=1640888) 
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1640888) [2026-01-26 19:17:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1640888) 2026-01-26 19:17:29,484 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1640888) 2026-01-26 19:17:29,539 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  14%|█▍        | 18/128 [00:00<00:00, 178.25it/s]
Adding requests:  72%|███████▏  | 92/128 [00:00<00:00, 505.12it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 537.33it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:17,  7.31it/s, est. speed input: 3741.95 toks/s, output: 7.31 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:12, 10.12it/s, est. speed input: 4991.02 toks/s, output: 9.75 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:11, 10.78it/s, est. speed input: 5312.89 toks/s, output: 10.38 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:10, 11.03it/s, est. speed input: 5451.92 toks/s, output: 10.65 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:10, 11.19it/s, est. speed input: 5538.27 toks/s, output: 10.82 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:10, 11.22it/s, est. speed input: 5580.00 toks/s, output: 10.90 toks/s]
Processed prompts:  10%|█         | 13/128 [00:01<00:10, 11.29it/s, est. speed input: 5619.84 toks/s, output: 10.98 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:09, 11.41it/s, est. speed input: 5664.63 toks/s, output: 11.06 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:09, 11.39it/s, est. speed input: 5682.07 toks/s, output: 11.10 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:09, 11.42it/s, est. speed input: 5701.54 toks/s, output: 11.14 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:09, 11.44it/s, est. speed input: 5718.63 toks/s, output: 11.17 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:02<00:09, 11.31it/s, est. speed input: 5712.17 toks/s, output: 11.16 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:02<00:09, 11.38it/s, est. speed input: 5726.81 toks/s, output: 11.19 toks/s]
Processed prompts:  21%|██        | 27/128 [00:02<00:08, 11.39it/s, est. speed input: 5735.81 toks/s, output: 11.20 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:08, 11.46it/s, est. speed input: 5750.29 toks/s, output: 11.23 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:08, 11.49it/s, est. speed input: 5760.29 toks/s, output: 11.25 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:08, 11.49it/s, est. speed input: 5767.87 toks/s, output: 11.27 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:03<00:08, 11.38it/s, est. speed input: 5764.01 toks/s, output: 11.26 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:03<00:07, 11.44it/s, est. speed input: 5772.38 toks/s, output: 11.27 toks/s]
Processed prompts:  30%|███       | 39/128 [00:03<00:07, 11.48it/s, est. speed input: 5780.14 toks/s, output: 11.29 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:03<00:07, 11.46it/s, est. speed input: 5783.26 toks/s, output: 11.30 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:03<00:07, 11.46it/s, est. speed input: 5787.01 toks/s, output: 11.30 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:07, 11.45it/s, est. speed input: 5789.91 toks/s, output: 11.31 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:04<00:07, 11.32it/s, est. speed input: 5783.45 toks/s, output: 11.30 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:04<00:06, 11.38it/s, est. speed input: 5787.92 toks/s, output: 11.30 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:04<00:06, 11.42it/s, est. speed input: 5792.32 toks/s, output: 11.31 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:04<00:06, 11.43it/s, est. speed input: 5795.18 toks/s, output: 11.32 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:04<00:06, 11.47it/s, est. speed input: 5799.66 toks/s, output: 11.33 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:05<00:06, 11.46it/s, est. speed input: 5801.51 toks/s, output: 11.33 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:05<00:06, 11.36it/s, est. speed input: 5798.09 toks/s, output: 11.32 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:05<00:05, 11.42it/s, est. speed input: 5802.20 toks/s, output: 11.33 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:05<00:05, 11.44it/s, est. speed input: 5804.58 toks/s, output: 11.34 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:05<00:05, 11.43it/s, est. speed input: 5805.53 toks/s, output: 11.34 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:05<00:05, 11.50it/s, est. speed input: 5810.55 toks/s, output: 11.35 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:06<00:05, 11.50it/s, est. speed input: 5812.58 toks/s, output: 11.35 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:06<00:05, 11.34it/s, est. speed input: 5807.07 toks/s, output: 11.34 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:06<00:04, 11.42it/s, est. speed input: 5810.72 toks/s, output: 11.35 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:06<00:04, 11.41it/s, est. speed input: 5811.31 toks/s, output: 11.35 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:06<00:04, 11.41it/s, est. speed input: 5812.31 toks/s, output: 11.35 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:06<00:04, 11.43it/s, est. speed input: 5813.70 toks/s, output: 11.35 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:07<00:04, 11.46it/s, est. speed input: 5816.08 toks/s, output: 11.36 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:07<00:03, 11.37it/s, est. speed input: 5813.36 toks/s, output: 11.35 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:07<00:03, 11.40it/s, est. speed input: 5815.03 toks/s, output: 11.36 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:07<00:03, 11.41it/s, est. speed input: 5815.67 toks/s, output: 11.36 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:07<00:03, 11.43it/s, est. speed input: 5817.22 toks/s, output: 11.36 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:08<00:03, 11.50it/s, est. speed input: 5820.49 toks/s, output: 11.37 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:08<00:03, 11.47it/s, est. speed input: 5821.02 toks/s, output: 11.37 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:08<00:02, 11.39it/s, est. speed input: 5819.17 toks/s, output: 11.37 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:08<00:02, 11.36it/s, est. speed input: 5818.52 toks/s, output: 11.36 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:08<00:02, 11.50it/s, est. speed input: 5822.96 toks/s, output: 11.37 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:08<00:02, 11.48it/s, est. speed input: 5823.84 toks/s, output: 11.37 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:09<00:02, 11.45it/s, est. speed input: 5823.64 toks/s, output: 11.37 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:09<00:02, 11.48it/s, est. speed input: 5825.35 toks/s, output: 11.38 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:09<00:01, 11.39it/s, est. speed input: 5823.55 toks/s, output: 11.37 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:09<00:01, 11.44it/s, est. speed input: 5825.10 toks/s, output: 11.38 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:09<00:01, 11.44it/s, est. speed input: 5825.75 toks/s, output: 11.38 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:09<00:01, 11.44it/s, est. speed input: 5826.34 toks/s, output: 11.38 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:10<00:01, 11.37it/s, est. speed input: 5824.85 toks/s, output: 11.38 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:10<00:00, 11.38it/s, est. speed input: 5825.11 toks/s, output: 11.38 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:10<00:00, 11.34it/s, est. speed input: 5823.95 toks/s, output: 11.37 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:10<00:00, 11.31it/s, est. speed input: 5822.79 toks/s, output: 11.37 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:10<00:00, 11.40it/s, est. speed input: 5824.78 toks/s, output: 11.38 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:10<00:00, 11.38it/s, est. speed input: 5824.31 toks/s, output: 11.38 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:11<00:00, 11.36it/s, est. speed input: 5823.89 toks/s, output: 11.37 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.36it/s, est. speed input: 5817.67 toks/s, output: 11.36 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:11<00:00, 11.36it/s, est. speed input: 5817.67 toks/s, output: 11.36 toks/s]
[rank0]:[W126 19:17:42.602630569 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 96.9s

测试结果:
  Requests/s:   11.07
  Tokens/s:     5679.84
  Total Reqs:   128
  Elapsed:      11.56s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5668.77

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:17:55 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:17:56 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1642494) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1642494) WARNING 01-26 19:19:12 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.84 requests/s, 5983.65 total tokens/s, 5.84 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 19:17:55] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:17:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:17:55] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:17:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:17:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:17:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:17:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:17:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:17:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:17:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:17:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:17:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:17:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:17:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:17:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:17:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:17:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1642494) [2026-01-26 19:18:00] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1642494) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1642494) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.90s/it]
(EngineCore_DP0 pid=1642494) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.81s/it]
(EngineCore_DP0 pid=1642494) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.38s/it]
(EngineCore_DP0 pid=1642494) 
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1642494) [2026-01-26 19:19:04] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1642494) 2026-01-26 19:19:11,275 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1642494) 2026-01-26 19:19:11,319 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  38%|███▊      | 48/128 [00:00<00:00, 478.87it/s]
Adding requests:  75%|███████▌  | 96/128 [00:00<00:00, 438.54it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 436.30it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 14.95it/s, est. speed input: 15305.66 toks/s, output: 14.95 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:15,  7.83it/s, est. speed input: 8633.04 toks/s, output: 8.43 toks/s]  
Processed prompts:   4%|▍         | 5/128 [00:00<00:17,  7.12it/s, est. speed input: 7935.44 toks/s, output: 7.75 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:18,  6.75it/s, est. speed input: 7571.75 toks/s, output: 7.39 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:18,  6.43it/s, est. speed input: 7282.78 toks/s, output: 7.11 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:19,  6.24it/s, est. speed input: 7086.14 toks/s, output: 6.92 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:19,  6.12it/s, est. speed input: 6948.95 toks/s, output: 6.79 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:19,  6.05it/s, est. speed input: 6844.64 toks/s, output: 6.68 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:19,  5.99it/s, est. speed input: 6758.13 toks/s, output: 6.60 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:19,  6.00it/s, est. speed input: 6703.57 toks/s, output: 6.55 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:19,  5.92it/s, est. speed input: 6632.57 toks/s, output: 6.48 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:19,  5.90it/s, est. speed input: 6581.45 toks/s, output: 6.43 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:19,  5.90it/s, est. speed input: 6543.49 toks/s, output: 6.39 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:18,  5.90it/s, est. speed input: 6508.87 toks/s, output: 6.36 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:18,  5.92it/s, est. speed input: 6484.44 toks/s, output: 6.33 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:18,  5.93it/s, est. speed input: 6461.70 toks/s, output: 6.31 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:03<00:18,  5.88it/s, est. speed input: 6428.72 toks/s, output: 6.28 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:18,  5.87it/s, est. speed input: 6405.83 toks/s, output: 6.26 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:18,  5.90it/s, est. speed input: 6390.60 toks/s, output: 6.24 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:17,  5.90it/s, est. speed input: 6374.57 toks/s, output: 6.23 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:17,  5.91it/s, est. speed input: 6361.48 toks/s, output: 6.21 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:17,  5.91it/s, est. speed input: 6347.88 toks/s, output: 6.20 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:04<00:17,  5.88it/s, est. speed input: 6331.16 toks/s, output: 6.18 toks/s]
Processed prompts:  20%|██        | 26/128 [00:04<00:17,  5.86it/s, est. speed input: 6316.00 toks/s, output: 6.17 toks/s]
Processed prompts:  21%|██        | 27/128 [00:04<00:17,  5.89it/s, est. speed input: 6307.72 toks/s, output: 6.16 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:16,  5.88it/s, est. speed input: 6296.60 toks/s, output: 6.15 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:16,  5.90it/s, est. speed input: 6288.51 toks/s, output: 6.14 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:04<00:16,  5.88it/s, est. speed input: 6277.81 toks/s, output: 6.13 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:05<00:16,  5.91it/s, est. speed input: 6272.80 toks/s, output: 6.13 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:05<00:16,  5.84it/s, est. speed input: 6257.85 toks/s, output: 6.11 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:05<00:16,  5.85it/s, est. speed input: 6250.02 toks/s, output: 6.10 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:05<00:16,  5.87it/s, est. speed input: 6243.78 toks/s, output: 6.10 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:05<00:15,  5.88it/s, est. speed input: 6238.71 toks/s, output: 6.09 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:05<00:15,  5.90it/s, est. speed input: 6233.67 toks/s, output: 6.09 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:06<00:15,  5.89it/s, est. speed input: 6227.58 toks/s, output: 6.08 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:06<00:15,  5.84it/s, est. speed input: 6217.35 toks/s, output: 6.07 toks/s]
Processed prompts:  30%|███       | 39/128 [00:06<00:15,  5.88it/s, est. speed input: 6214.82 toks/s, output: 6.07 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:06<00:14,  5.88it/s, est. speed input: 6210.27 toks/s, output: 6.06 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:06<00:14,  5.92it/s, est. speed input: 6208.72 toks/s, output: 6.06 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:06<00:14,  5.91it/s, est. speed input: 6204.59 toks/s, output: 6.06 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:07<00:14,  5.92it/s, est. speed input: 6201.48 toks/s, output: 6.06 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:07<00:14,  5.85it/s, est. speed input: 6192.67 toks/s, output: 6.05 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:07<00:14,  5.87it/s, est. speed input: 6189.82 toks/s, output: 6.04 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:07<00:13,  5.88it/s, est. speed input: 6186.67 toks/s, output: 6.04 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:07<00:13,  5.89it/s, est. speed input: 6183.72 toks/s, output: 6.04 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:07<00:13,  5.89it/s, est. speed input: 6180.28 toks/s, output: 6.04 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:08<00:13,  5.90it/s, est. speed input: 6177.97 toks/s, output: 6.03 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:08<00:13,  5.84it/s, est. speed input: 6170.54 toks/s, output: 6.03 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:08<00:13,  5.86it/s, est. speed input: 6168.37 toks/s, output: 6.02 toks/s]
Processed prompts:  41%|████      | 52/128 [00:08<00:12,  5.88it/s, est. speed input: 6166.20 toks/s, output: 6.02 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:08<00:12,  5.87it/s, est. speed input: 6162.74 toks/s, output: 6.02 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:08<00:12,  5.86it/s, est. speed input: 6159.55 toks/s, output: 6.02 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:09<00:12,  5.88it/s, est. speed input: 6157.80 toks/s, output: 6.01 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:09<00:12,  5.90it/s, est. speed input: 6156.80 toks/s, output: 6.01 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:09<00:12,  5.84it/s, est. speed input: 6150.86 toks/s, output: 6.01 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:09<00:11,  5.84it/s, est. speed input: 6147.52 toks/s, output: 6.00 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:09<00:11,  5.85it/s, est. speed input: 6145.35 toks/s, output: 6.00 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:09<00:11,  5.88it/s, est. speed input: 6144.37 toks/s, output: 6.00 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:10<00:11,  5.86it/s, est. speed input: 6141.23 toks/s, output: 6.00 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:10<00:11,  5.89it/s, est. speed input: 6140.80 toks/s, output: 6.00 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:10<00:11,  5.83it/s, est. speed input: 6135.80 toks/s, output: 5.99 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:10<00:10,  5.85it/s, est. speed input: 6133.88 toks/s, output: 5.99 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:10<00:10,  5.88it/s, est. speed input: 6133.17 toks/s, output: 5.99 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:11<00:10,  5.90it/s, est. speed input: 6132.83 toks/s, output: 5.99 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:11<00:10,  5.89it/s, est. speed input: 6130.86 toks/s, output: 5.99 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:11<00:10,  5.89it/s, est. speed input: 6129.24 toks/s, output: 5.99 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:11<00:10,  5.84it/s, est. speed input: 6125.27 toks/s, output: 5.98 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:11<00:09,  5.83it/s, est. speed input: 6122.60 toks/s, output: 5.98 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:11<00:09,  5.84it/s, est. speed input: 6121.16 toks/s, output: 5.98 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:12<00:09,  5.85it/s, est. speed input: 6119.72 toks/s, output: 5.98 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:12<00:09,  5.85it/s, est. speed input: 6117.75 toks/s, output: 5.97 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:12<00:09,  5.86it/s, est. speed input: 6116.55 toks/s, output: 5.97 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:12<00:09,  5.83it/s, est. speed input: 6113.42 toks/s, output: 5.97 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:12<00:08,  5.83it/s, est. speed input: 6111.42 toks/s, output: 5.97 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:12<00:08,  5.84it/s, est. speed input: 6110.02 toks/s, output: 5.97 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:13<00:08,  5.86it/s, est. speed input: 6109.37 toks/s, output: 5.97 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:13<00:08,  5.86it/s, est. speed input: 6108.12 toks/s, output: 5.96 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:13<00:08,  5.85it/s, est. speed input: 6106.05 toks/s, output: 5.96 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:13<00:08,  5.83it/s, est. speed input: 6103.61 toks/s, output: 5.96 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:13<00:07,  5.82it/s, est. speed input: 6101.62 toks/s, output: 5.96 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:13<00:07,  5.81it/s, est. speed input: 6099.58 toks/s, output: 5.96 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:14<00:07,  5.83it/s, est. speed input: 6098.62 toks/s, output: 5.96 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:14<00:07,  5.86it/s, est. speed input: 6098.12 toks/s, output: 5.96 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:14<00:07,  5.87it/s, est. speed input: 6097.41 toks/s, output: 5.95 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:14<00:06,  5.86it/s, est. speed input: 6096.18 toks/s, output: 5.95 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:14<00:06,  5.81it/s, est. speed input: 6093.07 toks/s, output: 5.95 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:14<00:06,  5.83it/s, est. speed input: 6092.12 toks/s, output: 5.95 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:15<00:06,  5.85it/s, est. speed input: 6091.35 toks/s, output: 5.95 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:15<00:06,  5.84it/s, est. speed input: 6090.14 toks/s, output: 5.95 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:15<00:06,  5.85it/s, est. speed input: 6089.26 toks/s, output: 5.95 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:15<00:05,  5.87it/s, est. speed input: 6088.74 toks/s, output: 5.95 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:15<00:05,  5.81it/s, est. speed input: 6085.67 toks/s, output: 5.94 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:15<00:05,  5.84it/s, est. speed input: 6085.44 toks/s, output: 5.94 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:16<00:05,  5.85it/s, est. speed input: 6084.71 toks/s, output: 5.94 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:16<00:05,  5.84it/s, est. speed input: 6083.38 toks/s, output: 5.94 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:16<00:05,  5.85it/s, est. speed input: 6082.63 toks/s, output: 5.94 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:16<00:04,  5.85it/s, est. speed input: 6081.66 toks/s, output: 5.94 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:16<00:04,  5.82it/s, est. speed input: 6079.84 toks/s, output: 5.94 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:17<00:04,  5.84it/s, est. speed input: 6079.29 toks/s, output: 5.94 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:17<00:04,  5.83it/s, est. speed input: 6078.01 toks/s, output: 5.94 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:17<00:04,  5.85it/s, est. speed input: 6077.41 toks/s, output: 5.93 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:17<00:04,  5.88it/s, est. speed input: 6077.58 toks/s, output: 5.94 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:17<00:03,  5.85it/s, est. speed input: 6076.17 toks/s, output: 5.93 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:17<00:03,  5.80it/s, est. speed input: 6073.65 toks/s, output: 5.93 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:18<00:03,  5.83it/s, est. speed input: 6073.39 toks/s, output: 5.93 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:18<00:03,  5.84it/s, est. speed input: 6072.84 toks/s, output: 5.93 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:18<00:03,  5.89it/s, est. speed input: 6073.44 toks/s, output: 5.93 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:18<00:03,  5.89it/s, est. speed input: 6072.96 toks/s, output: 5.93 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:18<00:02,  5.88it/s, est. speed input: 6072.29 toks/s, output: 5.93 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:18<00:02,  5.88it/s, est. speed input: 6071.98 toks/s, output: 5.93 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:19<00:02,  5.83it/s, est. speed input: 6069.89 toks/s, output: 5.93 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:19<00:02,  5.82it/s, est. speed input: 6068.55 toks/s, output: 5.93 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:19<00:02,  5.82it/s, est. speed input: 6067.81 toks/s, output: 5.93 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:19<00:02,  5.82it/s, est. speed input: 6066.88 toks/s, output: 5.92 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:19<00:01,  5.84it/s, est. speed input: 6066.63 toks/s, output: 5.92 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:19<00:01,  5.85it/s, est. speed input: 6066.15 toks/s, output: 5.92 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:20<00:01,  5.81it/s, est. speed input: 6064.24 toks/s, output: 5.92 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:20<00:01,  5.82it/s, est. speed input: 6063.48 toks/s, output: 5.92 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:20<00:01,  5.83it/s, est. speed input: 6062.84 toks/s, output: 5.92 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:20<00:01,  5.85it/s, est. speed input: 6062.75 toks/s, output: 5.92 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:20<00:00,  5.86it/s, est. speed input: 6062.52 toks/s, output: 5.92 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:20<00:00,  5.86it/s, est. speed input: 6062.07 toks/s, output: 5.92 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:21<00:00,  5.84it/s, est. speed input: 6060.93 toks/s, output: 5.92 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:21<00:00,  5.84it/s, est. speed input: 6060.35 toks/s, output: 5.92 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:21<00:00,  5.85it/s, est. speed input: 6059.93 toks/s, output: 5.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  5.84it/s, est. speed input: 6059.19 toks/s, output: 5.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  5.84it/s, est. speed input: 6059.19 toks/s, output: 5.92 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:21<00:00,  5.92it/s, est. speed input: 6059.19 toks/s, output: 5.92 toks/s]
[rank0]:[W126 19:19:34.344539713 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 107.7s

测试结果:
  Requests/s:   5.84
  Tokens/s:     5983.65
  Total Reqs:   128
  Elapsed:      21.93s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     5977.81

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:19:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:19:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1644138) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1644138) WARNING 01-26 19:20:55 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.82 requests/s, 5962.32 total tokens/s, 5.82 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 19:19:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:19:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:19:40] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:19:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:19:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:19:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:19:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:19:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:19:44] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:19:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:19:44] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:19:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:19:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:19:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:19:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:19:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:19:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1644138) [2026-01-26 19:19:45] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1644138) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1644138) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.09s/it]
(EngineCore_DP0 pid=1644138) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 31.49s/it]
(EngineCore_DP0 pid=1644138) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:01<00:00, 30.98s/it]
(EngineCore_DP0 pid=1644138) 
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1644138) [2026-01-26 19:20:48] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1644138) 2026-01-26 19:20:54,681 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1644138) 2026-01-26 19:20:54,743 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  16%|█▌        | 41/256 [00:00<00:00, 405.28it/s]
Adding requests:  32%|███▏      | 82/256 [00:00<00:00, 402.00it/s]
Adding requests:  48%|████▊     | 123/256 [00:00<00:00, 395.74it/s]
Adding requests:  65%|██████▌   | 167/256 [00:00<00:00, 406.99it/s]
Adding requests:  81%|████████▏ | 208/256 [00:00<00:00, 401.64it/s]
Adding requests:  98%|█████████▊| 250/256 [00:00<00:00, 407.47it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 403.53it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 2/256 [00:00<00:33,  7.48it/s, est. speed input: 7662.16 toks/s, output: 7.48 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:40,  6.18it/s, est. speed input: 6493.75 toks/s, output: 6.34 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:41,  6.06it/s, est. speed input: 6343.27 toks/s, output: 6.19 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:01<00:41,  5.96it/s, est. speed input: 6239.98 toks/s, output: 6.09 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:41,  5.95it/s, est. speed input: 6208.50 toks/s, output: 6.06 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:01<00:41,  5.93it/s, est. speed input: 6179.51 toks/s, output: 6.03 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:02<00:40,  5.92it/s, est. speed input: 6156.49 toks/s, output: 6.01 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:40,  5.94it/s, est. speed input: 6153.94 toks/s, output: 6.01 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:02<00:40,  5.94it/s, est. speed input: 6145.69 toks/s, output: 6.00 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:03<00:40,  5.90it/s, est. speed input: 6125.10 toks/s, output: 5.98 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:39,  5.90it/s, est. speed input: 6118.30 toks/s, output: 5.97 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:04<00:39,  5.90it/s, est. speed input: 6112.03 toks/s, output: 5.97 toks/s]
Processed prompts:  10%|█         | 26/256 [00:04<00:39,  5.88it/s, est. speed input: 6100.77 toks/s, output: 5.96 toks/s]
Processed prompts:  11%|█         | 28/256 [00:04<00:38,  5.90it/s, est. speed input: 6099.02 toks/s, output: 5.96 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:05<00:38,  5.89it/s, est. speed input: 6093.77 toks/s, output: 5.95 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:05<00:37,  5.92it/s, est. speed input: 6095.17 toks/s, output: 5.95 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:05<00:37,  5.89it/s, est. speed input: 6086.80 toks/s, output: 5.94 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:06<00:37,  5.89it/s, est. speed input: 6084.63 toks/s, output: 5.94 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:06<00:36,  5.91it/s, est. speed input: 6085.54 toks/s, output: 5.94 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:06<00:36,  5.88it/s, est. speed input: 6078.61 toks/s, output: 5.94 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:07<00:36,  5.88it/s, est. speed input: 6075.96 toks/s, output: 5.93 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:07<00:35,  5.91it/s, est. speed input: 6077.60 toks/s, output: 5.94 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:07<00:35,  5.86it/s, est. speed input: 6069.63 toks/s, output: 5.93 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:08<00:35,  5.88it/s, est. speed input: 6069.75 toks/s, output: 5.93 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:08<00:34,  5.90it/s, est. speed input: 6070.22 toks/s, output: 5.93 toks/s]
Processed prompts:  20%|██        | 52/256 [00:08<00:34,  5.87it/s, est. speed input: 6064.76 toks/s, output: 5.92 toks/s]
Processed prompts:  21%|██        | 54/256 [00:09<00:34,  5.88it/s, est. speed input: 6064.68 toks/s, output: 5.92 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:09<00:33,  5.89it/s, est. speed input: 6063.67 toks/s, output: 5.92 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:09<00:33,  5.87it/s, est. speed input: 6060.93 toks/s, output: 5.92 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:10<00:33,  5.89it/s, est. speed input: 6061.40 toks/s, output: 5.92 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:10<00:32,  5.90it/s, est. speed input: 6061.67 toks/s, output: 5.92 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:10<00:32,  5.90it/s, est. speed input: 6060.51 toks/s, output: 5.92 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:11<00:32,  5.91it/s, est. speed input: 6060.73 toks/s, output: 5.92 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:11<00:31,  5.90it/s, est. speed input: 6059.54 toks/s, output: 5.92 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:11<00:31,  5.87it/s, est. speed input: 6055.77 toks/s, output: 5.91 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:12<00:31,  5.88it/s, est. speed input: 6055.62 toks/s, output: 5.91 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:12<00:30,  5.90it/s, est. speed input: 6056.24 toks/s, output: 5.91 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:12<00:30,  5.88it/s, est. speed input: 6053.98 toks/s, output: 5.91 toks/s]
Processed prompts:  30%|███       | 78/256 [00:13<00:30,  5.87it/s, est. speed input: 6052.87 toks/s, output: 5.91 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:13<00:29,  5.89it/s, est. speed input: 6053.16 toks/s, output: 5.91 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:13<00:29,  5.90it/s, est. speed input: 6053.18 toks/s, output: 5.91 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:14<00:29,  5.87it/s, est. speed input: 6050.89 toks/s, output: 5.91 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:14<00:28,  5.88it/s, est. speed input: 6050.55 toks/s, output: 5.91 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:14<00:28,  5.89it/s, est. speed input: 6050.95 toks/s, output: 5.91 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:15<00:28,  5.87it/s, est. speed input: 6048.53 toks/s, output: 5.91 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:15<00:27,  5.87it/s, est. speed input: 6047.71 toks/s, output: 5.91 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:15<00:27,  5.88it/s, est. speed input: 6047.55 toks/s, output: 5.91 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:16<00:27,  5.86it/s, est. speed input: 6045.60 toks/s, output: 5.90 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:16<00:26,  5.86it/s, est. speed input: 6045.10 toks/s, output: 5.90 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:16<00:26,  5.88it/s, est. speed input: 6045.03 toks/s, output: 5.90 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:17<00:26,  5.85it/s, est. speed input: 6043.07 toks/s, output: 5.90 toks/s]
Processed prompts:  41%|████      | 104/256 [00:17<00:25,  5.87it/s, est. speed input: 6043.34 toks/s, output: 5.90 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:17<00:25,  5.88it/s, est. speed input: 6043.17 toks/s, output: 5.90 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:18<00:25,  5.86it/s, est. speed input: 6041.59 toks/s, output: 5.90 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:18<00:24,  5.87it/s, est. speed input: 6041.19 toks/s, output: 5.90 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:18<00:24,  5.87it/s, est. speed input: 6041.11 toks/s, output: 5.90 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:19<00:24,  5.85it/s, est. speed input: 6039.35 toks/s, output: 5.90 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:19<00:23,  5.86it/s, est. speed input: 6039.08 toks/s, output: 5.90 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:20<00:23,  5.87it/s, est. speed input: 6039.08 toks/s, output: 5.90 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:20<00:23,  5.86it/s, est. speed input: 6037.69 toks/s, output: 5.90 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:20<00:22,  5.86it/s, est. speed input: 6037.47 toks/s, output: 5.90 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:21<00:22,  5.89it/s, est. speed input: 6038.14 toks/s, output: 5.90 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:21<00:22,  5.87it/s, est. speed input: 6037.08 toks/s, output: 5.90 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:21<00:21,  5.88it/s, est. speed input: 6037.15 toks/s, output: 5.90 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:22<00:21,  5.87it/s, est. speed input: 6036.39 toks/s, output: 5.89 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:22<00:21,  5.87it/s, est. speed input: 6036.02 toks/s, output: 5.89 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:22<00:20,  5.89it/s, est. speed input: 6036.42 toks/s, output: 5.89 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:23<00:20,  5.89it/s, est. speed input: 6036.65 toks/s, output: 5.90 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:23<00:19,  5.90it/s, est. speed input: 6036.99 toks/s, output: 5.90 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:23<00:19,  5.87it/s, est. speed input: 6035.47 toks/s, output: 5.89 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:24<00:19,  5.89it/s, est. speed input: 6036.10 toks/s, output: 5.89 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:24<00:19,  5.88it/s, est. speed input: 6035.53 toks/s, output: 5.89 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:24<00:18,  5.87it/s, est. speed input: 6034.87 toks/s, output: 5.89 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:25<00:18,  5.88it/s, est. speed input: 6035.16 toks/s, output: 5.89 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:25<00:18,  5.88it/s, est. speed input: 6035.06 toks/s, output: 5.89 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:25<00:17,  5.88it/s, est. speed input: 6034.55 toks/s, output: 5.89 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:26<00:17,  5.88it/s, est. speed input: 6034.71 toks/s, output: 5.89 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:26<00:16,  5.88it/s, est. speed input: 6034.51 toks/s, output: 5.89 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:26<00:16,  5.87it/s, est. speed input: 6033.62 toks/s, output: 5.89 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:27<00:16,  5.87it/s, est. speed input: 6033.44 toks/s, output: 5.89 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:27<00:16,  5.87it/s, est. speed input: 6033.17 toks/s, output: 5.89 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:27<00:15,  5.86it/s, est. speed input: 6032.55 toks/s, output: 5.89 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:28<00:15,  5.86it/s, est. speed input: 6032.10 toks/s, output: 5.89 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:28<00:15,  5.86it/s, est. speed input: 6031.87 toks/s, output: 5.89 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:28<00:14,  5.85it/s, est. speed input: 6030.89 toks/s, output: 5.89 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:29<00:14,  5.87it/s, est. speed input: 6031.23 toks/s, output: 5.89 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:29<00:13,  5.88it/s, est. speed input: 6031.27 toks/s, output: 5.89 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:29<00:13,  5.85it/s, est. speed input: 6030.00 toks/s, output: 5.89 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:30<00:13,  5.86it/s, est. speed input: 6030.08 toks/s, output: 5.89 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:30<00:12,  5.87it/s, est. speed input: 6029.98 toks/s, output: 5.89 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:30<00:12,  5.85it/s, est. speed input: 6028.98 toks/s, output: 5.89 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:31<00:12,  5.87it/s, est. speed input: 6029.23 toks/s, output: 5.89 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:31<00:11,  5.87it/s, est. speed input: 6029.03 toks/s, output: 5.89 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:31<00:11,  5.87it/s, est. speed input: 6028.73 toks/s, output: 5.89 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:32<00:11,  5.86it/s, est. speed input: 6028.21 toks/s, output: 5.89 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:32<00:10,  5.87it/s, est. speed input: 6028.23 toks/s, output: 5.89 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:33<00:11,  5.37it/s, est. speed input: 6008.80 toks/s, output: 5.87 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:33<00:10,  5.49it/s, est. speed input: 6008.13 toks/s, output: 5.87 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:33<00:10,  5.60it/s, est. speed input: 6008.13 toks/s, output: 5.87 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:34<00:09,  5.66it/s, est. speed input: 6007.56 toks/s, output: 5.87 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:34<00:08,  6.42it/s, est. speed input: 6029.73 toks/s, output: 5.89 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:34<00:08,  6.24it/s, est. speed input: 6029.46 toks/s, output: 5.89 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:34<00:08,  6.12it/s, est. speed input: 6029.25 toks/s, output: 5.89 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:35<00:07,  6.01it/s, est. speed input: 6028.09 toks/s, output: 5.89 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:35<00:07,  5.98it/s, est. speed input: 6028.25 toks/s, output: 5.89 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:36<00:07,  5.96it/s, est. speed input: 6028.34 toks/s, output: 5.89 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:36<00:07,  5.92it/s, est. speed input: 6027.84 toks/s, output: 5.89 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:36<00:06,  5.90it/s, est. speed input: 6027.53 toks/s, output: 5.89 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:37<00:06,  5.91it/s, est. speed input: 6027.88 toks/s, output: 5.89 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:37<00:06,  5.87it/s, est. speed input: 6027.09 toks/s, output: 5.89 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:37<00:05,  5.88it/s, est. speed input: 6027.23 toks/s, output: 5.89 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:38<00:05,  5.88it/s, est. speed input: 6027.15 toks/s, output: 5.89 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:38<00:05,  5.87it/s, est. speed input: 6026.84 toks/s, output: 5.89 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:38<00:04,  5.89it/s, est. speed input: 6027.12 toks/s, output: 5.89 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:39<00:04,  5.88it/s, est. speed input: 6026.81 toks/s, output: 5.89 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:39<00:04,  5.85it/s, est. speed input: 6026.03 toks/s, output: 5.88 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:39<00:03,  5.86it/s, est. speed input: 6025.84 toks/s, output: 5.88 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:40<00:03,  5.86it/s, est. speed input: 6025.74 toks/s, output: 5.88 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:40<00:03,  5.85it/s, est. speed input: 6025.21 toks/s, output: 5.88 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:40<00:02,  5.86it/s, est. speed input: 6025.14 toks/s, output: 5.88 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:41<00:02,  5.88it/s, est. speed input: 6025.47 toks/s, output: 5.88 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:41<00:02,  5.88it/s, est. speed input: 6025.42 toks/s, output: 5.88 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:41<00:01,  5.86it/s, est. speed input: 6024.95 toks/s, output: 5.88 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:42<00:01,  5.86it/s, est. speed input: 6024.69 toks/s, output: 5.88 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:42<00:01,  5.86it/s, est. speed input: 6024.63 toks/s, output: 5.88 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:42<00:00,  5.84it/s, est. speed input: 6023.80 toks/s, output: 5.88 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:43<00:00,  5.86it/s, est. speed input: 6023.89 toks/s, output: 5.88 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:43<00:00,  6.89it/s, est. speed input: 6047.40 toks/s, output: 5.91 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:43<00:00,  6.89it/s, est. speed input: 6047.40 toks/s, output: 5.91 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:43<00:00,  5.91it/s, est. speed input: 6047.40 toks/s, output: 5.91 toks/s]
[rank0]:[W126 19:21:40.301962314 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 126.7s

测试结果:
  Requests/s:   5.82
  Tokens/s:     5962.32
  Total Reqs:   256
  Elapsed:      44.01s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     5956.51

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:21:49 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:21:50 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1646107) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1646107) WARNING 01-26 19:23:06 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.70 requests/s, 5845.99 total tokens/s, 5.70 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 19:21:49] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:21:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:21:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:21:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:21:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:21:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:21:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:21:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:21:53] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:21:53] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:21:53] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:21:53] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:21:53] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:21:53] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:21:53] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:21:53] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:21:53] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1646107) [2026-01-26 19:21:54] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1646107) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1646107) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.68s/it]
(EngineCore_DP0 pid=1646107) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 32.03s/it]
(EngineCore_DP0 pid=1646107) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:03<00:00, 31.53s/it]
(EngineCore_DP0 pid=1646107) 
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1646107) [2026-01-26 19:22:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1646107) 2026-01-26 19:23:05,257 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1646107) 2026-01-26 19:23:05,361 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   6%|▋         | 33/512 [00:00<00:01, 328.22it/s]
Adding requests:  15%|█▍        | 75/512 [00:00<00:01, 378.52it/s]
Adding requests:  22%|██▏       | 114/512 [00:00<00:01, 380.75it/s]
Adding requests:  30%|██▉       | 153/512 [00:00<00:00, 378.32it/s]
Adding requests:  38%|███▊      | 195/512 [00:00<00:00, 392.47it/s]
Adding requests:  46%|████▋     | 238/512 [00:00<00:00, 403.35it/s]
Adding requests:  55%|█████▍    | 281/512 [00:00<00:00, 409.97it/s]
Adding requests:  63%|██████▎   | 325/512 [00:00<00:00, 417.27it/s]
Adding requests:  73%|███████▎  | 373/512 [00:00<00:00, 434.91it/s]
Adding requests:  82%|████████▏ | 419/512 [00:01<00:00, 439.48it/s]
Adding requests:  90%|█████████ | 463/512 [00:01<00:00, 433.42it/s]
Adding requests:  99%|█████████▉| 508/512 [00:01<00:00, 437.34it/s]
Adding requests: 100%|██████████| 512/512 [00:01<00:00, 415.37it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 6/512 [00:00<00:40, 12.54it/s, est. speed input: 12837.12 toks/s, output: 12.54 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:01<01:03,  7.93it/s, est. speed input: 8694.88 toks/s, output: 8.49 toks/s] 
Processed prompts:   3%|▎         | 14/512 [00:01<01:12,  6.85it/s, est. speed input: 7643.33 toks/s, output: 7.46 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:02<01:17,  6.39it/s, est. speed input: 7159.31 toks/s, output: 6.99 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:03<01:19,  6.13it/s, est. speed input: 6876.09 toks/s, output: 6.71 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:03<01:20,  6.00it/s, est. speed input: 6703.54 toks/s, output: 6.55 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:04<01:21,  5.90it/s, est. speed input: 6572.50 toks/s, output: 6.42 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:05<01:21,  5.83it/s, est. speed input: 6474.37 toks/s, output: 6.32 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:06<01:21,  5.80it/s, est. speed input: 6406.92 toks/s, output: 6.26 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:06<01:21,  5.77it/s, est. speed input: 6345.83 toks/s, output: 6.20 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:07<01:21,  5.75it/s, est. speed input: 6298.14 toks/s, output: 6.15 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:08<01:20,  5.75it/s, est. speed input: 6263.53 toks/s, output: 6.12 toks/s]
Processed prompts:  11%|█         | 54/512 [00:08<01:19,  5.73it/s, est. speed input: 6229.02 toks/s, output: 6.08 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:09<01:19,  5.72it/s, est. speed input: 6198.86 toks/s, output: 6.05 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:10<01:18,  5.72it/s, est. speed input: 6176.36 toks/s, output: 6.03 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:10<01:18,  5.71it/s, est. speed input: 6153.20 toks/s, output: 6.01 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:11<01:17,  5.71it/s, est. speed input: 6134.99 toks/s, output: 5.99 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:12<01:16,  5.71it/s, est. speed input: 6119.37 toks/s, output: 5.98 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:13<01:15,  5.71it/s, est. speed input: 6105.15 toks/s, output: 5.96 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:13<01:15,  5.71it/s, est. speed input: 6091.85 toks/s, output: 5.95 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:14<01:14,  5.69it/s, est. speed input: 6077.11 toks/s, output: 5.93 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:15<01:14,  5.69it/s, est. speed input: 6064.77 toks/s, output: 5.92 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:15<01:13,  5.69it/s, est. speed input: 6054.65 toks/s, output: 5.91 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:16<01:12,  5.69it/s, est. speed input: 6045.23 toks/s, output: 5.90 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:17<01:12,  5.68it/s, est. speed input: 6034.98 toks/s, output: 5.89 toks/s]
Processed prompts:  21%|██        | 106/512 [00:18<01:11,  5.69it/s, est. speed input: 6027.82 toks/s, output: 5.89 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:18<01:10,  5.69it/s, est. speed input: 6019.59 toks/s, output: 5.88 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:19<01:10,  5.68it/s, est. speed input: 6011.61 toks/s, output: 5.87 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:20<01:09,  5.70it/s, est. speed input: 6006.72 toks/s, output: 5.87 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:20<01:08,  5.69it/s, est. speed input: 5999.90 toks/s, output: 5.86 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:21<01:07,  5.68it/s, est. speed input: 5993.69 toks/s, output: 5.85 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:22<01:07,  5.69it/s, est. speed input: 5988.75 toks/s, output: 5.85 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:22<01:06,  5.68it/s, est. speed input: 5982.75 toks/s, output: 5.84 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:23<01:05,  5.68it/s, est. speed input: 5977.40 toks/s, output: 5.84 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:24<01:05,  5.68it/s, est. speed input: 5973.39 toks/s, output: 5.83 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:25<01:04,  5.67it/s, est. speed input: 5968.09 toks/s, output: 5.83 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:25<01:03,  5.68it/s, est. speed input: 5964.32 toks/s, output: 5.82 toks/s]
Processed prompts:  30%|███       | 154/512 [00:26<01:02,  5.69it/s, est. speed input: 5961.42 toks/s, output: 5.82 toks/s]
Processed prompts:  31%|███       | 158/512 [00:27<01:02,  5.70it/s, est. speed input: 5958.57 toks/s, output: 5.82 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:27<01:01,  5.69it/s, est. speed input: 5955.14 toks/s, output: 5.82 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:28<01:00,  5.69it/s, est. speed input: 5951.84 toks/s, output: 5.81 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:29<01:00,  5.69it/s, est. speed input: 5948.65 toks/s, output: 5.81 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:29<00:59,  5.69it/s, est. speed input: 5945.54 toks/s, output: 5.81 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:30<00:58,  5.70it/s, est. speed input: 5943.45 toks/s, output: 5.80 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:31<00:58,  5.69it/s, est. speed input: 5940.34 toks/s, output: 5.80 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:32<00:57,  5.68it/s, est. speed input: 5937.26 toks/s, output: 5.80 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:32<00:56,  5.69it/s, est. speed input: 5935.09 toks/s, output: 5.80 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:33<00:55,  5.69it/s, est. speed input: 5933.29 toks/s, output: 5.79 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:34<00:55,  5.68it/s, est. speed input: 5930.15 toks/s, output: 5.79 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:34<00:51,  6.06it/s, est. speed input: 5953.03 toks/s, output: 5.81 toks/s]
Processed prompts:  40%|████      | 206/512 [00:35<00:51,  5.94it/s, est. speed input: 5950.55 toks/s, output: 5.81 toks/s]
Processed prompts:  41%|████      | 210/512 [00:36<00:51,  5.87it/s, est. speed input: 5948.10 toks/s, output: 5.81 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:36<00:51,  5.80it/s, est. speed input: 5944.93 toks/s, output: 5.81 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:37<00:50,  5.76it/s, est. speed input: 5942.69 toks/s, output: 5.80 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:38<00:50,  5.74it/s, est. speed input: 5940.72 toks/s, output: 5.80 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:38<00:49,  5.73it/s, est. speed input: 5938.52 toks/s, output: 5.80 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:39<00:49,  5.71it/s, est. speed input: 5936.23 toks/s, output: 5.80 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:40<00:48,  5.71it/s, est. speed input: 5934.74 toks/s, output: 5.80 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:41<00:48,  5.69it/s, est. speed input: 5932.02 toks/s, output: 5.79 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:41<00:47,  5.68it/s, est. speed input: 5929.51 toks/s, output: 5.79 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:42<00:46,  5.68it/s, est. speed input: 5927.95 toks/s, output: 5.79 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:43<00:46,  5.68it/s, est. speed input: 5925.79 toks/s, output: 5.79 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:43<00:45,  5.68it/s, est. speed input: 5923.97 toks/s, output: 5.79 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:44<00:44,  5.69it/s, est. speed input: 5922.73 toks/s, output: 5.78 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:45<00:44,  5.68it/s, est. speed input: 5920.58 toks/s, output: 5.78 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:46<00:43,  5.67it/s, est. speed input: 5918.90 toks/s, output: 5.78 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:46<00:42,  5.68it/s, est. speed input: 5917.73 toks/s, output: 5.78 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:47<00:41,  5.67it/s, est. speed input: 5915.81 toks/s, output: 5.78 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:48<00:41,  5.67it/s, est. speed input: 5914.02 toks/s, output: 5.78 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:48<00:40,  5.67it/s, est. speed input: 5912.68 toks/s, output: 5.77 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:49<00:39,  5.67it/s, est. speed input: 5911.06 toks/s, output: 5.77 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:50<00:39,  5.67it/s, est. speed input: 5909.50 toks/s, output: 5.77 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:50<00:38,  5.68it/s, est. speed input: 5908.46 toks/s, output: 5.77 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:51<00:37,  5.67it/s, est. speed input: 5906.98 toks/s, output: 5.77 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:52<00:37,  5.67it/s, est. speed input: 5905.48 toks/s, output: 5.77 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:52<00:33,  6.13it/s, est. speed input: 5923.70 toks/s, output: 5.78 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:53<00:33,  5.98it/s, est. speed input: 5922.01 toks/s, output: 5.78 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:54<00:33,  5.89it/s, est. speed input: 5920.92 toks/s, output: 5.78 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:55<00:33,  5.82it/s, est. speed input: 5919.49 toks/s, output: 5.78 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:55<00:32,  5.78it/s, est. speed input: 5918.01 toks/s, output: 5.78 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:56<00:32,  5.75it/s, est. speed input: 5916.84 toks/s, output: 5.78 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:57<00:31,  5.73it/s, est. speed input: 5915.51 toks/s, output: 5.78 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:57<00:31,  5.70it/s, est. speed input: 5913.97 toks/s, output: 5.78 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:58<00:30,  5.70it/s, est. speed input: 5913.03 toks/s, output: 5.77 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:59<00:29,  5.69it/s, est. speed input: 5911.68 toks/s, output: 5.77 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:59<00:29,  5.68it/s, est. speed input: 5910.29 toks/s, output: 5.77 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [01:00<00:28,  5.68it/s, est. speed input: 5909.13 toks/s, output: 5.77 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [01:01<00:27,  5.67it/s, est. speed input: 5907.87 toks/s, output: 5.77 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [01:02<00:27,  5.67it/s, est. speed input: 5906.66 toks/s, output: 5.77 toks/s]
Processed prompts:  71%|███████   | 362/512 [01:02<00:26,  5.68it/s, est. speed input: 5905.88 toks/s, output: 5.77 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [01:03<00:25,  5.67it/s, est. speed input: 5904.45 toks/s, output: 5.77 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [01:04<00:25,  5.66it/s, est. speed input: 5903.09 toks/s, output: 5.76 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [01:04<00:24,  5.68it/s, est. speed input: 5902.54 toks/s, output: 5.76 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [01:05<00:23,  5.68it/s, est. speed input: 5901.50 toks/s, output: 5.76 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [01:06<00:22,  5.67it/s, est. speed input: 5900.18 toks/s, output: 5.76 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [01:06<00:22,  5.68it/s, est. speed input: 5899.56 toks/s, output: 5.76 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [01:07<00:21,  5.68it/s, est. speed input: 5898.69 toks/s, output: 5.76 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [01:08<00:20,  5.67it/s, est. speed input: 5897.51 toks/s, output: 5.76 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [01:09<00:20,  5.68it/s, est. speed input: 5897.06 toks/s, output: 5.76 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [01:09<00:19,  5.67it/s, est. speed input: 5895.99 toks/s, output: 5.76 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [01:10<00:18,  5.66it/s, est. speed input: 5894.78 toks/s, output: 5.76 toks/s]
Processed prompts:  80%|████████  | 410/512 [01:11<00:18,  5.67it/s, est. speed input: 5893.92 toks/s, output: 5.76 toks/s]
Processed prompts:  81%|████████  | 414/512 [01:11<00:17,  5.67it/s, est. speed input: 5893.09 toks/s, output: 5.75 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [01:12<00:16,  5.66it/s, est. speed input: 5892.06 toks/s, output: 5.75 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [01:13<00:15,  5.67it/s, est. speed input: 5891.24 toks/s, output: 5.75 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [01:14<00:15,  5.67it/s, est. speed input: 5890.41 toks/s, output: 5.75 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [01:14<00:14,  5.66it/s, est. speed input: 5889.42 toks/s, output: 5.75 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [01:15<00:12,  6.11it/s, est. speed input: 5902.09 toks/s, output: 5.76 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [01:16<00:12,  5.97it/s, est. speed input: 5901.24 toks/s, output: 5.76 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [01:16<00:11,  5.88it/s, est. speed input: 5900.43 toks/s, output: 5.76 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [01:17<00:11,  5.81it/s, est. speed input: 5899.42 toks/s, output: 5.76 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [01:18<00:10,  5.76it/s, est. speed input: 5898.41 toks/s, output: 5.76 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [01:18<00:10,  5.74it/s, est. speed input: 5897.72 toks/s, output: 5.76 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [01:19<00:09,  5.71it/s, est. speed input: 5896.78 toks/s, output: 5.76 toks/s]
Processed prompts:  90%|█████████ | 462/512 [01:20<00:08,  5.69it/s, est. speed input: 5895.76 toks/s, output: 5.76 toks/s]
Processed prompts:  91%|█████████ | 466/512 [01:20<00:08,  5.69it/s, est. speed input: 5895.16 toks/s, output: 5.76 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [01:21<00:07,  5.68it/s, est. speed input: 5894.11 toks/s, output: 5.76 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [01:22<00:06,  5.67it/s, est. speed input: 5893.10 toks/s, output: 5.75 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [01:23<00:05,  5.68it/s, est. speed input: 5892.76 toks/s, output: 5.75 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [01:23<00:05,  5.67it/s, est. speed input: 5891.87 toks/s, output: 5.75 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [01:24<00:04,  5.66it/s, est. speed input: 5890.90 toks/s, output: 5.75 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [01:25<00:03,  5.67it/s, est. speed input: 5890.43 toks/s, output: 5.75 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [01:25<00:03,  5.67it/s, est. speed input: 5889.72 toks/s, output: 5.75 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [01:26<00:02,  5.67it/s, est. speed input: 5888.97 toks/s, output: 5.75 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [01:27<00:01,  5.68it/s, est. speed input: 5888.61 toks/s, output: 5.75 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [01:28<00:01,  5.68it/s, est. speed input: 5887.91 toks/s, output: 5.75 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [01:28<00:00,  6.12it/s, est. speed input: 5898.58 toks/s, output: 5.76 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:28<00:00,  6.12it/s, est. speed input: 5921.70 toks/s, output: 5.78 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:28<00:00,  5.78it/s, est. speed input: 5921.70 toks/s, output: 5.78 toks/s]
[rank0]:[W126 19:24:36.751983373 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 175.7s

测试结果:
  Requests/s:   5.70
  Tokens/s:     5845.99
  Total Reqs:   512
  Elapsed:      89.77s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     5840.29

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:24:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:24:46 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1648735) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1648735) WARNING 01-26 19:26:03 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.85 requests/s, 5999.45 total tokens/s, 5.85 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 19:24:46] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:24:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:24:46] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:24:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:24:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:24:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:24:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:24:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:24:49] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:24:49] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:24:49] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:24:49] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:24:49] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:24:49] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:24:49] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:24:49] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:24:49] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1648735) [2026-01-26 19:24:50] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1648735) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1648735) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.00s/it]
(EngineCore_DP0 pid=1648735) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.65s/it]
(EngineCore_DP0 pid=1648735) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.10s/it]
(EngineCore_DP0 pid=1648735) 
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1648735) [2026-01-26 19:25:54] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1648735) 2026-01-26 19:26:01,138 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1648735) 2026-01-26 19:26:01,453 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 32/1024 [00:00<00:03, 319.76it/s]
Adding requests:   7%|▋         | 67/1024 [00:00<00:02, 332.63it/s]
Adding requests:  11%|█         | 108/1024 [00:00<00:02, 365.46it/s]
Adding requests:  14%|█▍        | 146/1024 [00:00<00:02, 367.62it/s]
Adding requests:  18%|█▊        | 188/1024 [00:00<00:02, 383.39it/s]
Adding requests:  23%|██▎       | 231/1024 [00:00<00:01, 398.88it/s]
Adding requests:  27%|██▋       | 272/1024 [00:00<00:01, 398.78it/s]
Adding requests:  31%|███       | 319/1024 [00:00<00:01, 419.51it/s]
Adding requests:  35%|███▌      | 362/1024 [00:00<00:01, 422.14it/s]
Adding requests:  40%|███▉      | 407/1024 [00:01<00:01, 426.48it/s]
Adding requests:  44%|████▍     | 450/1024 [00:01<00:01, 414.24it/s]
Adding requests:  48%|████▊     | 496/1024 [00:01<00:01, 426.52it/s]
Adding requests:  53%|█████▎    | 541/1024 [00:01<00:01, 431.42it/s]
Adding requests:  57%|█████▋    | 585/1024 [00:01<00:01, 426.62it/s]
Adding requests:  62%|██████▏   | 630/1024 [00:01<00:00, 431.86it/s]
Adding requests:  66%|██████▌   | 674/1024 [00:01<00:00, 403.26it/s]
Adding requests:  70%|██████▉   | 715/1024 [00:01<00:00, 404.24it/s]
Adding requests:  74%|███████▍  | 756/1024 [00:01<00:00, 396.64it/s]
Adding requests:  78%|███████▊  | 800/1024 [00:01<00:00, 408.46it/s]
Adding requests:  82%|████████▏ | 842/1024 [00:02<00:00, 405.88it/s]
Adding requests:  86%|████████▋ | 885/1024 [00:02<00:00, 410.78it/s]
Adding requests:  91%|█████████ | 927/1024 [00:02<00:00, 411.84it/s]
Adding requests:  95%|█████████▍| 970/1024 [00:02<00:00, 417.04it/s]
Adding requests:  99%|█████████▉| 1012/1024 [00:02<00:00, 416.19it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 407.89it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<00:48, 20.96it/s, est. speed input: 21466.87 toks/s, output: 20.96 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:01<01:53,  8.89it/s, est. speed input: 10069.19 toks/s, output: 9.83 toks/s] 
Processed prompts:   3%|▎         | 26/1024 [00:03<02:16,  7.29it/s, est. speed input: 8357.05 toks/s, output: 8.16 toks/s] 
Processed prompts:   3%|▎         | 34/1024 [00:04<02:27,  6.70it/s, est. speed input: 7675.85 toks/s, output: 7.50 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:05<02:33,  6.40it/s, est. speed input: 7302.24 toks/s, output: 7.13 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:07<02:36,  6.23it/s, est. speed input: 7071.42 toks/s, output: 6.91 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:08<02:37,  6.12it/s, est. speed input: 6909.01 toks/s, output: 6.75 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:09<02:38,  6.05it/s, est. speed input: 6790.97 toks/s, output: 6.63 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:11<02:38,  6.01it/s, est. speed input: 6703.15 toks/s, output: 6.55 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:12<02:37,  5.97it/s, est. speed input: 6630.92 toks/s, output: 6.48 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:14<02:36,  5.95it/s, est. speed input: 6575.24 toks/s, output: 6.42 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:15<02:35,  5.94it/s, est. speed input: 6529.16 toks/s, output: 6.38 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:16<02:34,  5.93it/s, est. speed input: 6489.57 toks/s, output: 6.34 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:18<02:33,  5.92it/s, est. speed input: 6455.24 toks/s, output: 6.30 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:19<02:32,  5.91it/s, est. speed input: 6426.75 toks/s, output: 6.28 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:20<02:31,  5.91it/s, est. speed input: 6401.89 toks/s, output: 6.25 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:22<02:30,  5.91it/s, est. speed input: 6379.58 toks/s, output: 6.23 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:23<02:28,  5.90it/s, est. speed input: 6358.83 toks/s, output: 6.21 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:24<02:27,  5.90it/s, est. speed input: 6341.66 toks/s, output: 6.19 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:26<02:26,  5.90it/s, est. speed input: 6326.37 toks/s, output: 6.18 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:27<02:24,  5.90it/s, est. speed input: 6311.68 toks/s, output: 6.16 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:28<02:23,  5.89it/s, est. speed input: 6298.57 toks/s, output: 6.15 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:30<02:31,  5.54it/s, est. speed input: 6227.79 toks/s, output: 6.08 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:31<02:27,  5.64it/s, est. speed input: 6218.36 toks/s, output: 6.07 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:33<02:20,  5.87it/s, est. speed input: 6234.24 toks/s, output: 6.09 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:34<02:18,  5.88it/s, est. speed input: 6226.74 toks/s, output: 6.08 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:35<02:17,  5.88it/s, est. speed input: 6218.96 toks/s, output: 6.07 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:37<02:15,  5.88it/s, est. speed input: 6212.00 toks/s, output: 6.07 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:38<02:14,  5.88it/s, est. speed input: 6205.08 toks/s, output: 6.06 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:39<02:12,  5.88it/s, est. speed input: 6199.14 toks/s, output: 6.05 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:41<02:11,  5.88it/s, est. speed input: 6193.09 toks/s, output: 6.05 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:42<02:10,  5.87it/s, est. speed input: 6186.79 toks/s, output: 6.04 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:44<02:08,  5.88it/s, est. speed input: 6181.94 toks/s, output: 6.04 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:45<02:07,  5.88it/s, est. speed input: 6177.34 toks/s, output: 6.03 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:46<02:06,  5.87it/s, est. speed input: 6171.79 toks/s, output: 6.03 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:48<02:04,  5.87it/s, est. speed input: 6167.65 toks/s, output: 6.02 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:49<02:03,  5.87it/s, est. speed input: 6163.26 toks/s, output: 6.02 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:50<01:58,  6.07it/s, est. speed input: 6176.92 toks/s, output: 6.03 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:52<01:58,  6.00it/s, est. speed input: 6172.26 toks/s, output: 6.03 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:53<01:57,  5.96it/s, est. speed input: 6168.21 toks/s, output: 6.02 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:54<01:56,  5.94it/s, est. speed input: 6164.40 toks/s, output: 6.02 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:56<01:55,  5.92it/s, est. speed input: 6160.59 toks/s, output: 6.02 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:57<01:54,  5.90it/s, est. speed input: 6156.68 toks/s, output: 6.01 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:58<01:53,  5.89it/s, est. speed input: 6153.06 toks/s, output: 6.01 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [01:00<01:52,  5.88it/s, est. speed input: 6149.85 toks/s, output: 6.01 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [01:01<01:51,  5.87it/s, est. speed input: 6146.56 toks/s, output: 6.00 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [01:03<01:53,  5.67it/s, est. speed input: 6128.12 toks/s, output: 5.98 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:04<01:51,  5.73it/s, est. speed input: 6125.77 toks/s, output: 5.98 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:05<01:49,  5.77it/s, est. speed input: 6122.88 toks/s, output: 5.98 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:07<01:47,  5.80it/s, est. speed input: 6120.60 toks/s, output: 5.98 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:08<01:45,  5.82it/s, est. speed input: 6118.57 toks/s, output: 5.98 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:09<01:43,  5.83it/s, est. speed input: 6116.30 toks/s, output: 5.97 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:11<01:42,  5.84it/s, est. speed input: 6113.94 toks/s, output: 5.97 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:12<01:37,  6.04it/s, est. speed input: 6124.15 toks/s, output: 5.98 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:13<01:37,  5.98it/s, est. speed input: 6121.74 toks/s, output: 5.98 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:15<01:36,  5.95it/s, est. speed input: 6119.59 toks/s, output: 5.98 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:16<01:35,  5.92it/s, est. speed input: 6117.18 toks/s, output: 5.97 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:18<01:34,  5.90it/s, est. speed input: 6115.44 toks/s, output: 5.97 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:19<01:33,  5.89it/s, est. speed input: 6113.69 toks/s, output: 5.97 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:20<01:32,  5.89it/s, est. speed input: 6111.91 toks/s, output: 5.97 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:22<01:30,  5.88it/s, est. speed input: 6110.04 toks/s, output: 5.97 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:23<01:29,  5.88it/s, est. speed input: 6108.48 toks/s, output: 5.97 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:24<01:28,  5.87it/s, est. speed input: 6106.73 toks/s, output: 5.96 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:26<01:26,  5.86it/s, est. speed input: 6104.81 toks/s, output: 5.96 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:27<01:25,  5.87it/s, est. speed input: 6103.45 toks/s, output: 5.96 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:28<01:24,  5.87it/s, est. speed input: 6101.94 toks/s, output: 5.96 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:30<01:22,  5.87it/s, est. speed input: 6100.47 toks/s, output: 5.96 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:31<01:21,  5.86it/s, est. speed input: 6098.69 toks/s, output: 5.96 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:33<01:20,  5.86it/s, est. speed input: 6097.37 toks/s, output: 5.95 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:34<01:18,  5.86it/s, est. speed input: 6095.97 toks/s, output: 5.95 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:35<01:19,  5.68it/s, est. speed input: 6085.18 toks/s, output: 5.94 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:37<01:17,  5.73it/s, est. speed input: 6084.17 toks/s, output: 5.94 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:38<01:15,  5.76it/s, est. speed input: 6082.70 toks/s, output: 5.94 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:40<01:14,  5.79it/s, est. speed input: 6081.33 toks/s, output: 5.94 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:41<01:12,  5.81it/s, est. speed input: 6080.21 toks/s, output: 5.94 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:42<01:11,  5.83it/s, est. speed input: 6079.37 toks/s, output: 5.94 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:44<01:09,  5.84it/s, est. speed input: 6078.56 toks/s, output: 5.94 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:45<01:08,  5.84it/s, est. speed input: 6077.21 toks/s, output: 5.93 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:46<01:06,  5.85it/s, est. speed input: 6076.34 toks/s, output: 5.93 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:48<01:05,  5.85it/s, est. speed input: 6075.24 toks/s, output: 5.93 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:49<01:03,  5.85it/s, est. speed input: 6074.34 toks/s, output: 5.93 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:50<01:02,  5.86it/s, est. speed input: 6073.46 toks/s, output: 5.93 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:52<01:01,  5.85it/s, est. speed input: 6072.49 toks/s, output: 5.93 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:53<00:59,  5.86it/s, est. speed input: 6071.67 toks/s, output: 5.93 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:55<00:58,  5.85it/s, est. speed input: 6070.61 toks/s, output: 5.93 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [01:56<00:57,  5.86it/s, est. speed input: 6069.82 toks/s, output: 5.93 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [01:57<00:55,  5.86it/s, est. speed input: 6069.06 toks/s, output: 5.93 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [01:59<00:54,  5.86it/s, est. speed input: 6068.17 toks/s, output: 5.93 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [02:00<00:52,  5.86it/s, est. speed input: 6067.50 toks/s, output: 5.93 toks/s]
Processed prompts:  71%|███████   | 722/1024 [02:01<00:51,  5.86it/s, est. speed input: 6066.60 toks/s, output: 5.92 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [02:03<00:50,  5.86it/s, est. speed input: 6065.86 toks/s, output: 5.92 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [02:04<00:48,  5.86it/s, est. speed input: 6065.18 toks/s, output: 5.92 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [02:05<00:47,  5.85it/s, est. speed input: 6064.20 toks/s, output: 5.92 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [02:07<00:46,  5.86it/s, est. speed input: 6063.58 toks/s, output: 5.92 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:08<00:46,  5.69it/s, est. speed input: 6056.56 toks/s, output: 5.91 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:10<00:44,  5.74it/s, est. speed input: 6055.95 toks/s, output: 5.91 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:11<00:42,  5.78it/s, est. speed input: 6055.61 toks/s, output: 5.91 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:12<00:39,  5.99it/s, est. speed input: 6061.48 toks/s, output: 5.92 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:14<00:38,  5.94it/s, est. speed input: 6060.64 toks/s, output: 5.92 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:15<00:37,  5.92it/s, est. speed input: 6060.27 toks/s, output: 5.92 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:16<00:36,  5.90it/s, est. speed input: 6059.67 toks/s, output: 5.92 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:18<00:35,  5.89it/s, est. speed input: 6058.89 toks/s, output: 5.92 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:19<00:33,  5.88it/s, est. speed input: 6058.36 toks/s, output: 5.92 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:20<00:32,  5.87it/s, est. speed input: 6057.79 toks/s, output: 5.92 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:22<00:30,  5.87it/s, est. speed input: 6057.35 toks/s, output: 5.92 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:23<00:29,  5.86it/s, est. speed input: 6056.57 toks/s, output: 5.91 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:25<00:28,  5.86it/s, est. speed input: 6055.98 toks/s, output: 5.91 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:26<00:26,  5.86it/s, est. speed input: 6055.46 toks/s, output: 5.91 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:27<00:25,  5.86it/s, est. speed input: 6054.83 toks/s, output: 5.91 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:29<00:24,  5.86it/s, est. speed input: 6054.40 toks/s, output: 5.91 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:30<00:22,  5.86it/s, est. speed input: 6053.90 toks/s, output: 5.91 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:31<00:21,  5.86it/s, est. speed input: 6053.45 toks/s, output: 5.91 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:33<00:20,  5.85it/s, est. speed input: 6052.76 toks/s, output: 5.91 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:34<00:18,  5.85it/s, est. speed input: 6052.22 toks/s, output: 5.91 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:36<00:17,  5.86it/s, est. speed input: 6051.79 toks/s, output: 5.91 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:37<00:16,  5.85it/s, est. speed input: 6051.13 toks/s, output: 5.91 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:38<00:14,  5.85it/s, est. speed input: 6050.67 toks/s, output: 5.91 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:40<00:13,  5.85it/s, est. speed input: 6050.21 toks/s, output: 5.91 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:41<00:12,  5.65it/s, est. speed input: 6043.50 toks/s, output: 5.90 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:43<00:10,  5.71it/s, est. speed input: 6043.14 toks/s, output: 5.90 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:44<00:09,  5.75it/s, est. speed input: 6042.66 toks/s, output: 5.90 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:45<00:07,  5.78it/s, est. speed input: 6042.26 toks/s, output: 5.90 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:47<00:06,  5.80it/s, est. speed input: 6041.70 toks/s, output: 5.90 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:48<00:05,  5.81it/s, est. speed input: 6041.32 toks/s, output: 5.90 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:49<00:03,  5.83it/s, est. speed input: 6040.97 toks/s, output: 5.90 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:51<00:02,  5.83it/s, est. speed input: 6040.40 toks/s, output: 5.90 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:52<00:00,  6.03it/s, est. speed input: 6045.29 toks/s, output: 5.90 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:52<00:00,  6.03it/s, est. speed input: 6080.91 toks/s, output: 5.94 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:52<00:00,  5.94it/s, est. speed input: 6080.91 toks/s, output: 5.94 toks/s]
[rank0]:[W126 19:28:59.314844423 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 262.8s

测试结果:
  Requests/s:   5.85
  Tokens/s:     5999.45
  Total Reqs:   1024
  Elapsed:      174.95s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     5993.60

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:29:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:29:14 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1652606) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1652606) WARNING 01-26 19:30:36 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.86 requests/s, 6008.47 total tokens/s, 5.86 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 19:29:14] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:29:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:29:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:29:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:29:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:29:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:29:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:29:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:29:17] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:29:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:29:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:29:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:29:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:29:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:29:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:29:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:29:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1652606) [2026-01-26 19:29:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1652606) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1652606) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.31s/it]
(EngineCore_DP0 pid=1652606) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:04<00:00, 32.51s/it]
(EngineCore_DP0 pid=1652606) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:04<00:00, 32.03s/it]
(EngineCore_DP0 pid=1652606) 
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1652606) [2026-01-26 19:30:24] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1652606) 2026-01-26 19:30:32,487 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1652606) 2026-01-26 19:30:33,067 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 48/2048 [00:00<00:04, 471.63it/s]
Adding requests:   5%|▍         | 96/2048 [00:00<00:05, 365.68it/s]
Adding requests:   7%|▋         | 138/2048 [00:00<00:04, 384.71it/s]
Adding requests:   9%|▊         | 178/2048 [00:00<00:04, 387.75it/s]
Adding requests:  11%|█         | 223/2048 [00:00<00:04, 408.35it/s]
Adding requests:  13%|█▎        | 265/2048 [00:00<00:04, 411.29it/s]
Adding requests:  15%|█▌        | 308/2048 [00:00<00:04, 415.71it/s]
Adding requests:  17%|█▋        | 354/2048 [00:00<00:03, 427.19it/s]
Adding requests:  20%|█▉        | 400/2048 [00:00<00:03, 434.79it/s]
Adding requests:  22%|██▏       | 444/2048 [00:01<00:03, 435.59it/s]
Adding requests:  24%|██▍       | 492/2048 [00:01<00:03, 446.56it/s]
Adding requests:  26%|██▋       | 540/2048 [00:01<00:03, 456.16it/s]
Adding requests:  29%|██▊       | 586/2048 [00:01<00:03, 445.79it/s]
Adding requests:  31%|███       | 631/2048 [00:01<00:03, 446.45it/s]
Adding requests:  33%|███▎      | 676/2048 [00:01<00:03, 434.55it/s]
Adding requests:  35%|███▌      | 720/2048 [00:01<00:03, 429.44it/s]
Adding requests:  37%|███▋      | 764/2048 [00:01<00:03, 427.43it/s]
Adding requests:  40%|███▉      | 809/2048 [00:01<00:02, 432.14it/s]
Adding requests:  42%|████▏     | 854/2048 [00:01<00:02, 436.80it/s]
Adding requests:  44%|████▍     | 898/2048 [00:02<00:02, 430.83it/s]
Adding requests:  46%|████▌     | 942/2048 [00:02<00:02, 425.40it/s]
Adding requests:  48%|████▊     | 985/2048 [00:02<00:07, 147.52it/s]
Adding requests:  50%|█████     | 1025/2048 [00:03<00:05, 178.80it/s]
Adding requests:  52%|█████▏    | 1065/2048 [00:03<00:04, 212.01it/s]
Adding requests:  54%|█████▍    | 1108/2048 [00:03<00:03, 250.32it/s]
Adding requests:  56%|█████▋    | 1152/2048 [00:03<00:03, 288.52it/s]
Adding requests:  58%|█████▊    | 1196/2048 [00:03<00:02, 321.51it/s]
Adding requests:  61%|██████    | 1241/2048 [00:03<00:02, 352.54it/s]
Adding requests:  63%|██████▎   | 1283/2048 [00:03<00:02, 362.09it/s]
Adding requests:  65%|██████▍   | 1325/2048 [00:03<00:01, 375.15it/s]
Adding requests:  67%|██████▋   | 1368/2048 [00:03<00:01, 390.10it/s]
Adding requests:  69%|██████▉   | 1412/2048 [00:03<00:01, 400.55it/s]
Adding requests:  71%|███████   | 1456/2048 [00:04<00:01, 410.15it/s]
Adding requests:  73%|███████▎  | 1501/2048 [00:04<00:01, 420.29it/s]
Adding requests:  75%|███████▌  | 1545/2048 [00:04<00:01, 422.65it/s]
Adding requests:  78%|███████▊  | 1588/2048 [00:04<00:01, 422.64it/s]
Adding requests:  80%|███████▉  | 1631/2048 [00:04<00:00, 422.24it/s]
Adding requests:  82%|████████▏ | 1674/2048 [00:04<00:00, 415.56it/s]
Adding requests:  84%|████████▍ | 1718/2048 [00:04<00:00, 420.72it/s]
Adding requests:  86%|████████▌ | 1763/2048 [00:04<00:00, 427.14it/s]
Adding requests:  88%|████████▊ | 1806/2048 [00:04<00:00, 425.39it/s]
Adding requests:  90%|█████████ | 1849/2048 [00:05<00:00, 416.45it/s]
Adding requests:  92%|█████████▏| 1894/2048 [00:05<00:00, 424.90it/s]
Adding requests:  95%|█████████▍| 1939/2048 [00:05<00:00, 431.09it/s]
Adding requests:  97%|█████████▋| 1984/2048 [00:05<00:00, 434.14it/s]
Adding requests:  99%|█████████▉| 2028/2048 [00:05<00:00, 429.31it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 374.71it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 18/2048 [00:00<00:34, 59.14it/s, est. speed input: 60573.21 toks/s, output: 59.15 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:03<03:26,  9.75it/s, est. speed input: 11510.76 toks/s, output: 11.24 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:05<04:24,  7.54it/s, est. speed input: 8906.56 toks/s, output: 8.70 toks/s]  
Processed prompts:   3%|▎         | 66/2048 [00:08<04:51,  6.79it/s, est. speed input: 7974.51 toks/s, output: 7.79 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:11<05:05,  6.43it/s, est. speed input: 7496.27 toks/s, output: 7.32 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:13<05:13,  6.22it/s, est. speed input: 7202.34 toks/s, output: 7.03 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:16<05:17,  6.10it/s, est. speed input: 7003.59 toks/s, output: 6.84 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:19<05:18,  6.02it/s, est. speed input: 6861.07 toks/s, output: 6.70 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:22<05:18,  5.96it/s, est. speed input: 6753.67 toks/s, output: 6.60 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:24<05:18,  5.93it/s, est. speed input: 6668.99 toks/s, output: 6.51 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:27<05:17,  5.90it/s, est. speed input: 6600.12 toks/s, output: 6.45 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:30<05:09,  5.99it/s, est. speed input: 6580.53 toks/s, output: 6.43 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:32<05:09,  5.94it/s, est. speed input: 6528.83 toks/s, output: 6.38 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:35<05:08,  5.91it/s, est. speed input: 6486.65 toks/s, output: 6.33 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:38<05:07,  5.88it/s, est. speed input: 6448.94 toks/s, output: 6.30 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:41<05:05,  5.86it/s, est. speed input: 6416.20 toks/s, output: 6.27 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:43<05:03,  5.85it/s, est. speed input: 6388.65 toks/s, output: 6.24 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:46<05:00,  5.84it/s, est. speed input: 6363.46 toks/s, output: 6.21 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:49<04:52,  5.96it/s, est. speed input: 6365.30 toks/s, output: 6.22 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:51<04:51,  5.91it/s, est. speed input: 6343.16 toks/s, output: 6.19 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:54<04:50,  5.89it/s, est. speed input: 6324.43 toks/s, output: 6.18 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:57<04:48,  5.87it/s, est. speed input: 6307.02 toks/s, output: 6.16 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [01:00<04:46,  5.86it/s, est. speed input: 6291.51 toks/s, output: 6.14 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [01:02<04:44,  5.84it/s, est. speed input: 6276.86 toks/s, output: 6.13 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:05<04:42,  5.83it/s, est. speed input: 6263.17 toks/s, output: 6.12 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:08<04:39,  5.83it/s, est. speed input: 6251.30 toks/s, output: 6.10 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:11<04:31,  5.95it/s, est. speed input: 6255.96 toks/s, output: 6.11 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:13<04:30,  5.91it/s, est. speed input: 6245.11 toks/s, output: 6.10 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:16<04:29,  5.88it/s, est. speed input: 6234.50 toks/s, output: 6.09 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:19<04:27,  5.86it/s, est. speed input: 6224.79 toks/s, output: 6.08 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:22<04:25,  5.84it/s, est. speed input: 6215.43 toks/s, output: 6.07 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:24<04:22,  5.84it/s, est. speed input: 6207.07 toks/s, output: 6.06 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:27<04:20,  5.83it/s, est. speed input: 6199.33 toks/s, output: 6.05 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:30<04:17,  5.83it/s, est. speed input: 6191.85 toks/s, output: 6.05 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:33<04:15,  5.82it/s, est. speed input: 6184.98 toks/s, output: 6.04 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:35<04:12,  5.82it/s, est. speed input: 6178.12 toks/s, output: 6.03 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:38<04:09,  5.82it/s, est. speed input: 6171.89 toks/s, output: 6.03 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:41<04:07,  5.82it/s, est. speed input: 6166.00 toks/s, output: 6.02 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:44<04:04,  5.82it/s, est. speed input: 6160.36 toks/s, output: 6.02 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:46<04:01,  5.82it/s, est. speed input: 6155.17 toks/s, output: 6.01 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:49<03:59,  5.82it/s, est. speed input: 6150.01 toks/s, output: 6.01 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:52<03:56,  5.82it/s, est. speed input: 6145.38 toks/s, output: 6.00 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [01:55<03:53,  5.82it/s, est. speed input: 6140.75 toks/s, output: 6.00 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [01:57<03:50,  5.81it/s, est. speed input: 6136.11 toks/s, output: 5.99 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [02:00<03:48,  5.81it/s, est. speed input: 6131.80 toks/s, output: 5.99 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [02:03<03:45,  5.81it/s, est. speed input: 6127.44 toks/s, output: 5.98 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [02:06<03:42,  5.80it/s, est. speed input: 6123.20 toks/s, output: 5.98 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [02:08<03:40,  5.80it/s, est. speed input: 6119.25 toks/s, output: 5.98 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:11<03:33,  5.92it/s, est. speed input: 6124.24 toks/s, output: 5.98 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:14<03:31,  5.89it/s, est. speed input: 6120.52 toks/s, output: 5.98 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:16<03:29,  5.86it/s, est. speed input: 6116.94 toks/s, output: 5.97 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:19<03:27,  5.85it/s, est. speed input: 6113.62 toks/s, output: 5.97 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:22<03:25,  5.83it/s, est. speed input: 6110.27 toks/s, output: 5.97 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:25<03:22,  5.83it/s, est. speed input: 6107.21 toks/s, output: 5.96 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:27<03:20,  5.82it/s, est. speed input: 6104.31 toks/s, output: 5.96 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:30<03:17,  5.82it/s, est. speed input: 6101.52 toks/s, output: 5.96 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:33<03:15,  5.82it/s, est. speed input: 6098.75 toks/s, output: 5.96 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:36<03:12,  5.81it/s, est. speed input: 6096.07 toks/s, output: 5.95 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:38<03:09,  5.81it/s, est. speed input: 6093.59 toks/s, output: 5.95 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:41<03:07,  5.80it/s, est. speed input: 6090.69 toks/s, output: 5.95 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:44<03:04,  5.81it/s, est. speed input: 6088.45 toks/s, output: 5.95 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:47<03:01,  5.81it/s, est. speed input: 6086.13 toks/s, output: 5.94 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:50<02:58,  5.80it/s, est. speed input: 6083.68 toks/s, output: 5.94 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [02:52<02:56,  5.81it/s, est. speed input: 6081.57 toks/s, output: 5.94 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [02:55<02:53,  5.80it/s, est. speed input: 6079.29 toks/s, output: 5.94 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [02:58<02:50,  5.81it/s, est. speed input: 6077.51 toks/s, output: 5.94 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [03:01<02:47,  5.81it/s, est. speed input: 6075.42 toks/s, output: 5.93 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [03:03<02:44,  5.81it/s, est. speed input: 6073.55 toks/s, output: 5.93 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [03:06<02:42,  5.81it/s, est. speed input: 6071.66 toks/s, output: 5.93 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [03:09<02:39,  5.81it/s, est. speed input: 6069.72 toks/s, output: 5.93 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [03:12<02:36,  5.81it/s, est. speed input: 6068.06 toks/s, output: 5.93 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:14<02:34,  5.80it/s, est. speed input: 6066.18 toks/s, output: 5.92 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:17<02:31,  5.80it/s, est. speed input: 6064.48 toks/s, output: 5.92 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:20<02:28,  5.80it/s, est. speed input: 6062.75 toks/s, output: 5.92 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:22<02:22,  5.93it/s, est. speed input: 6066.78 toks/s, output: 5.92 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:25<02:20,  5.89it/s, est. speed input: 6065.12 toks/s, output: 5.92 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:28<02:15,  5.99it/s, est. speed input: 6069.03 toks/s, output: 5.93 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:30<02:14,  5.93it/s, est. speed input: 6067.37 toks/s, output: 5.93 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:33<02:12,  5.89it/s, est. speed input: 6065.88 toks/s, output: 5.92 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:36<02:10,  5.87it/s, est. speed input: 6064.42 toks/s, output: 5.92 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:39<02:08,  5.85it/s, est. speed input: 6062.91 toks/s, output: 5.92 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:41<02:05,  5.84it/s, est. speed input: 6061.58 toks/s, output: 5.92 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:44<02:00,  5.95it/s, est. speed input: 6064.96 toks/s, output: 5.92 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:47<01:58,  5.90it/s, est. speed input: 6063.57 toks/s, output: 5.92 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [03:50<01:56,  5.87it/s, est. speed input: 6062.12 toks/s, output: 5.92 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [03:52<01:54,  5.86it/s, est. speed input: 6060.89 toks/s, output: 5.92 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [03:55<01:51,  5.84it/s, est. speed input: 6059.46 toks/s, output: 5.92 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [03:58<01:49,  5.83it/s, est. speed input: 6058.10 toks/s, output: 5.92 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [04:01<01:46,  5.82it/s, est. speed input: 6056.87 toks/s, output: 5.91 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [04:03<01:42,  5.94it/s, est. speed input: 6060.27 toks/s, output: 5.92 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [04:06<01:37,  6.02it/s, est. speed input: 6063.51 toks/s, output: 5.92 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [04:08<01:36,  5.95it/s, est. speed input: 6062.12 toks/s, output: 5.92 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [04:11<01:34,  5.91it/s, est. speed input: 6060.89 toks/s, output: 5.92 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [04:14<01:32,  5.87it/s, est. speed input: 6059.47 toks/s, output: 5.92 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [04:17<01:28,  5.98it/s, est. speed input: 6062.65 toks/s, output: 5.92 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:19<01:26,  5.92it/s, est. speed input: 6061.25 toks/s, output: 5.92 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:22<01:22,  6.00it/s, est. speed input: 6064.19 toks/s, output: 5.92 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:25<01:20,  5.94it/s, est. speed input: 6062.82 toks/s, output: 5.92 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:27<01:18,  5.90it/s, est. speed input: 6061.60 toks/s, output: 5.92 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:30<01:16,  5.87it/s, est. speed input: 6060.26 toks/s, output: 5.92 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:33<01:12,  5.97it/s, est. speed input: 6063.25 toks/s, output: 5.92 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:36<01:10,  5.91it/s, est. speed input: 6061.86 toks/s, output: 5.92 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:38<01:07,  5.88it/s, est. speed input: 6060.64 toks/s, output: 5.92 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:41<01:05,  5.86it/s, est. speed input: 6059.52 toks/s, output: 5.92 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:44<01:02,  5.84it/s, est. speed input: 6058.24 toks/s, output: 5.92 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [04:47<01:00,  5.83it/s, est. speed input: 6057.20 toks/s, output: 5.92 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [04:49<00:57,  5.82it/s, est. speed input: 6055.97 toks/s, output: 5.91 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [04:52<00:53,  5.93it/s, est. speed input: 6058.67 toks/s, output: 5.92 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [04:54<00:49,  6.11it/s, est. speed input: 6064.26 toks/s, output: 5.92 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [04:57<00:47,  6.02it/s, est. speed input: 6063.13 toks/s, output: 5.92 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [05:00<00:45,  5.95it/s, est. speed input: 6061.99 toks/s, output: 5.92 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [05:03<00:43,  5.90it/s, est. speed input: 6060.86 toks/s, output: 5.92 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [05:05<00:40,  5.87it/s, est. speed input: 6059.75 toks/s, output: 5.92 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [05:08<00:37,  5.85it/s, est. speed input: 6058.64 toks/s, output: 5.92 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [05:11<00:35,  5.83it/s, est. speed input: 6057.60 toks/s, output: 5.92 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [05:14<00:32,  5.82it/s, est. speed input: 6056.45 toks/s, output: 5.91 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [05:16<00:29,  5.81it/s, est. speed input: 6055.36 toks/s, output: 5.91 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [05:19<00:26,  5.93it/s, est. speed input: 6057.85 toks/s, output: 5.92 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [05:22<00:24,  5.89it/s, est. speed input: 6056.86 toks/s, output: 5.91 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:24<00:21,  5.86it/s, est. speed input: 6055.81 toks/s, output: 5.91 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:27<00:18,  5.84it/s, est. speed input: 6054.82 toks/s, output: 5.91 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:30<00:16,  5.83it/s, est. speed input: 6053.85 toks/s, output: 5.91 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:33<00:13,  5.82it/s, est. speed input: 6052.94 toks/s, output: 5.91 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:35<00:10,  5.94it/s, est. speed input: 6055.43 toks/s, output: 5.91 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:38<00:07,  5.90it/s, est. speed input: 6054.47 toks/s, output: 5.91 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:41<00:05,  5.87it/s, est. speed input: 6053.68 toks/s, output: 5.91 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:43<00:02,  5.98it/s, est. speed input: 6056.34 toks/s, output: 5.91 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:43<00:00,  5.98it/s, est. speed input: 6098.02 toks/s, output: 5.96 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:43<00:00,  5.96it/s, est. speed input: 6098.02 toks/s, output: 5.96 toks/s]
[rank0]:[W126 19:36:26.183409365 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 447.1s

测试结果:
  Requests/s:   5.86
  Tokens/s:     6008.47
  Total Reqs:   2048
  Elapsed:      349.37s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     6002.61

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:36:48 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:36:48 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1659109) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1659109) WARNING 01-26 19:38:18 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.84 requests/s, 5989.39 total tokens/s, 5.84 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 19:36:48] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:36:48] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:36:48] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:48] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:36:48] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:36:48] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:36:48] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:36:48] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:36:48] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:36:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:36:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:36:52] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:36:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:36:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:36:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:36:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:36:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:36:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1659109) [2026-01-26 19:36:53] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1659109) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1659109) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:27<00:27, 27.92s/it]
(EngineCore_DP0 pid=1659109) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 30.80s/it]
(EngineCore_DP0 pid=1659109) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:00<00:00, 30.36s/it]
(EngineCore_DP0 pid=1659109) 
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:54] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1659109) [2026-01-26 19:37:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1659109) 2026-01-26 19:38:05,755 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1659109) 2026-01-26 19:38:06,940 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/4096 [00:00<15:04,  4.52it/s]
Adding requests:   0%|          | 3/4096 [00:00<06:32, 10.42it/s]
Adding requests:   0%|          | 5/4096 [00:00<04:57, 13.73it/s]
Adding requests:   0%|          | 9/4096 [00:00<03:08, 21.64it/s]
Adding requests:   0%|          | 17/4096 [00:00<01:46, 38.40it/s]
Adding requests:   1%|          | 31/4096 [00:00<00:59, 68.72it/s]
Adding requests:   1%|          | 49/4096 [00:00<00:40, 101.03it/s]
Adding requests:   2%|▏         | 79/4096 [00:00<00:25, 158.51it/s]
Adding requests:   3%|▎         | 111/4096 [00:01<00:19, 206.23it/s]
Adding requests:   4%|▎         | 149/4096 [00:01<00:15, 256.38it/s]
Adding requests:   4%|▍         | 183/4096 [00:01<00:13, 281.07it/s]
Adding requests:   6%|▌         | 226/4096 [00:01<00:11, 324.49it/s]
Adding requests:   7%|▋         | 271/4096 [00:01<00:10, 360.68it/s]
Adding requests:   8%|▊         | 308/4096 [00:01<00:10, 361.59it/s]
Adding requests:   9%|▊         | 353/4096 [00:01<00:09, 385.76it/s]
Adding requests:  10%|▉         | 392/4096 [00:01<00:09, 376.29it/s]
Adding requests:  11%|█         | 440/4096 [00:01<00:08, 406.58it/s]
Adding requests:  12%|█▏        | 483/4096 [00:01<00:08, 410.19it/s]
Adding requests:  13%|█▎        | 535/4096 [00:02<00:08, 442.41it/s]
Adding requests:  14%|█▍        | 580/4096 [00:02<00:08, 437.14it/s]
Adding requests:  15%|█▌        | 626/4096 [00:02<00:07, 442.12it/s]
Adding requests:  16%|█▋        | 671/4096 [00:02<00:07, 432.59it/s]
Adding requests:  18%|█▊        | 718/4096 [00:02<00:07, 442.86it/s]
Adding requests:  19%|█▊        | 763/4096 [00:02<00:07, 427.10it/s]
Adding requests:  20%|█▉        | 806/4096 [00:02<00:07, 423.12it/s]
Adding requests:  21%|██        | 851/4096 [00:02<00:07, 429.67it/s]
Adding requests:  22%|██▏       | 896/4096 [00:02<00:07, 434.74it/s]
Adding requests:  23%|██▎       | 940/4096 [00:03<00:07, 428.00it/s]
Adding requests:  24%|██▍       | 983/4096 [00:03<00:07, 419.56it/s]
Adding requests:  25%|██▌       | 1029/4096 [00:03<00:07, 431.13it/s]
Adding requests:  26%|██▌       | 1073/4096 [00:03<00:07, 420.01it/s]
Adding requests:  27%|██▋       | 1118/4096 [00:03<00:06, 427.87it/s]
Adding requests:  28%|██▊       | 1161/4096 [00:03<00:06, 420.75it/s]
Adding requests:  29%|██▉       | 1205/4096 [00:03<00:06, 424.76it/s]
Adding requests:  30%|███       | 1248/4096 [00:03<00:06, 421.11it/s]
Adding requests:  32%|███▏      | 1291/4096 [00:03<00:07, 391.05it/s]
Adding requests:  32%|███▏      | 1331/4096 [00:03<00:07, 387.16it/s]
Adding requests:  33%|███▎      | 1371/4096 [00:04<00:07, 385.27it/s]
Adding requests:  35%|███▍      | 1416/4096 [00:04<00:06, 401.49it/s]
Adding requests:  36%|███▌      | 1459/4096 [00:04<00:06, 408.29it/s]
Adding requests:  37%|███▋      | 1510/4096 [00:04<00:05, 435.06it/s]
Adding requests:  38%|███▊      | 1554/4096 [00:04<00:06, 420.59it/s]
Adding requests:  39%|███▉      | 1599/4096 [00:04<00:05, 427.42it/s]
Adding requests:  40%|████      | 1642/4096 [00:04<00:05, 413.29it/s]
Adding requests:  41%|████      | 1685/4096 [00:04<00:05, 417.41it/s]
Adding requests:  42%|████▏     | 1727/4096 [00:04<00:05, 417.07it/s]
Adding requests:  43%|████▎     | 1774/4096 [00:05<00:05, 430.94it/s]
Adding requests:  44%|████▍     | 1818/4096 [00:05<00:05, 415.39it/s]
Adding requests:  45%|████▌     | 1860/4096 [00:05<00:05, 413.76it/s]
Adding requests:  46%|████▋     | 1903/4096 [00:05<00:05, 417.04it/s]
Adding requests:  48%|████▊     | 1948/4096 [00:05<00:05, 425.53it/s]
Adding requests:  49%|████▊     | 1994/4096 [00:05<00:04, 433.67it/s]
Adding requests:  50%|████▉     | 2038/4096 [00:05<00:04, 426.75it/s]
Adding requests:  51%|█████     | 2081/4096 [00:05<00:04, 419.51it/s]
Adding requests:  52%|█████▏    | 2124/4096 [00:05<00:05, 392.63it/s]
Adding requests:  53%|█████▎    | 2164/4096 [00:06<00:05, 369.93it/s]
Adding requests:  54%|█████▍    | 2202/4096 [00:06<00:05, 350.99it/s]
Adding requests:  55%|█████▍    | 2238/4096 [00:06<00:05, 346.95it/s]
Adding requests:  56%|█████▌    | 2281/4096 [00:06<00:04, 367.61it/s]
Adding requests:  57%|█████▋    | 2323/4096 [00:06<00:04, 381.32it/s]
Adding requests:  58%|█████▊    | 2372/4096 [00:06<00:04, 411.82it/s]
Adding requests:  59%|█████▉    | 2414/4096 [00:06<00:04, 413.14it/s]
Adding requests:  60%|██████    | 2458/4096 [00:06<00:03, 418.83it/s]
Adding requests:  61%|██████    | 2501/4096 [00:06<00:03, 406.61it/s]
Adding requests:  62%|██████▏   | 2546/4096 [00:06<00:03, 418.49it/s]
Adding requests:  63%|██████▎   | 2589/4096 [00:07<00:03, 405.59it/s]
Adding requests:  64%|██████▍   | 2635/4096 [00:07<00:03, 418.44it/s]
Adding requests:  65%|██████▌   | 2678/4096 [00:07<00:03, 416.81it/s]
Adding requests:  66%|██████▋   | 2722/4096 [00:07<00:03, 420.73it/s]
Adding requests:  68%|██████▊   | 2765/4096 [00:07<00:03, 419.15it/s]
Adding requests:  69%|██████▊   | 2812/4096 [00:07<00:02, 432.04it/s]
Adding requests:  70%|██████▉   | 2857/4096 [00:07<00:02, 436.51it/s]
Adding requests:  71%|███████   | 2903/4096 [00:07<00:02, 441.49it/s]
Adding requests:  72%|███████▏  | 2948/4096 [00:07<00:02, 439.75it/s]
Adding requests:  73%|███████▎  | 2996/4096 [00:08<00:02, 447.89it/s]
Adding requests:  74%|███████▍  | 3043/4096 [00:08<00:02, 451.47it/s]
Adding requests:  75%|███████▌  | 3089/4096 [00:08<00:02, 451.92it/s]
Adding requests:  77%|███████▋  | 3137/4096 [00:08<00:02, 458.00it/s]
Adding requests:  78%|███████▊  | 3183/4096 [00:08<00:02, 446.59it/s]
Adding requests:  79%|███████▉  | 3233/4096 [00:08<00:01, 461.75it/s]
Adding requests:  80%|████████  | 3280/4096 [00:08<00:01, 438.94it/s]
Adding requests:  81%|████████  | 3327/4096 [00:08<00:01, 446.16it/s]
Adding requests:  82%|████████▏ | 3372/4096 [00:08<00:01, 432.81it/s]
Adding requests:  83%|████████▎ | 3418/4096 [00:08<00:01, 438.02it/s]
Adding requests:  85%|████████▍ | 3462/4096 [00:09<00:01, 431.95it/s]
Adding requests:  86%|████████▌ | 3507/4096 [00:09<00:01, 435.93it/s]
Adding requests:  87%|████████▋ | 3552/4096 [00:09<00:01, 438.17it/s]
Adding requests:  88%|████████▊ | 3596/4096 [00:09<00:01, 436.49it/s]
Adding requests:  89%|████████▉ | 3640/4096 [00:09<00:01, 434.67it/s]
Adding requests:  90%|████████▉ | 3684/4096 [00:09<00:00, 430.97it/s]
Adding requests:  91%|█████████ | 3728/4096 [00:09<00:00, 428.95it/s]
Adding requests:  92%|█████████▏| 3771/4096 [00:09<00:00, 422.63it/s]
Adding requests:  93%|█████████▎| 3814/4096 [00:09<00:00, 417.31it/s]
Adding requests:  94%|█████████▍| 3856/4096 [00:09<00:00, 407.58it/s]
Adding requests:  95%|█████████▌| 3902/4096 [00:10<00:00, 420.45it/s]
Adding requests:  96%|█████████▋| 3945/4096 [00:10<00:00, 381.38it/s]
Adding requests:  97%|█████████▋| 3988/4096 [00:10<00:00, 392.30it/s]
Adding requests:  98%|█████████▊| 4030/4096 [00:10<00:00, 398.23it/s]
Adding requests:  99%|█████████▉| 4073/4096 [00:10<00:00, 404.93it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 386.64it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 39/4096 [00:01<03:02, 22.27it/s, est. speed input: 22801.83 toks/s, output: 22.27 toks/s]
Processed prompts:   2%|▏         | 71/4096 [00:07<07:32,  8.90it/s, est. speed input: 10116.44 toks/s, output: 9.88 toks/s] 
Processed prompts:   3%|▎         | 103/4096 [00:12<09:16,  7.17it/s, est. speed input: 8258.03 toks/s, output: 8.06 toks/s]
Processed prompts:   3%|▎         | 135/4096 [00:18<09:59,  6.61it/s, est. speed input: 7583.63 toks/s, output: 7.41 toks/s]
Processed prompts:   4%|▍         | 167/4096 [00:23<10:21,  6.32it/s, est. speed input: 7216.62 toks/s, output: 7.05 toks/s]
Processed prompts:   5%|▍         | 199/4096 [00:29<10:27,  6.21it/s, est. speed input: 7020.78 toks/s, output: 6.86 toks/s]
Processed prompts:   6%|▌         | 231/4096 [00:34<10:35,  6.08it/s, est. speed input: 6854.31 toks/s, output: 6.69 toks/s]
Processed prompts:   6%|▋         | 263/4096 [00:39<10:38,  6.00it/s, est. speed input: 6733.38 toks/s, output: 6.58 toks/s]
Processed prompts:   7%|▋         | 295/4096 [00:45<10:38,  5.95it/s, est. speed input: 6643.40 toks/s, output: 6.49 toks/s]
Processed prompts:   8%|▊         | 327/4096 [00:50<10:37,  5.92it/s, est. speed input: 6571.76 toks/s, output: 6.42 toks/s]
Processed prompts:   9%|▉         | 359/4096 [00:56<10:34,  5.89it/s, est. speed input: 6512.61 toks/s, output: 6.36 toks/s]
Processed prompts:  10%|▉         | 391/4096 [01:01<10:30,  5.87it/s, est. speed input: 6465.61 toks/s, output: 6.31 toks/s]
Processed prompts:  10%|█         | 423/4096 [01:07<10:21,  5.91it/s, est. speed input: 6440.31 toks/s, output: 6.29 toks/s]
Processed prompts:  11%|█         | 455/4096 [01:12<10:18,  5.88it/s, est. speed input: 6403.99 toks/s, output: 6.25 toks/s]
Processed prompts:  12%|█▏        | 487/4096 [01:18<10:25,  5.77it/s, est. speed input: 6347.93 toks/s, output: 6.20 toks/s]
Processed prompts:  13%|█▎        | 519/4096 [01:24<10:18,  5.78it/s, est. speed input: 6323.00 toks/s, output: 6.17 toks/s]
Processed prompts:  13%|█▎        | 551/4096 [01:29<10:11,  5.80it/s, est. speed input: 6301.32 toks/s, output: 6.15 toks/s]
Processed prompts:  14%|█▍        | 583/4096 [01:35<10:05,  5.81it/s, est. speed input: 6281.78 toks/s, output: 6.13 toks/s]
Processed prompts:  15%|█▌        | 615/4096 [01:40<09:58,  5.81it/s, est. speed input: 6264.94 toks/s, output: 6.12 toks/s]
Processed prompts:  16%|█▌        | 647/4096 [01:46<09:52,  5.82it/s, est. speed input: 6249.71 toks/s, output: 6.10 toks/s]
Processed prompts:  17%|█▋        | 679/4096 [01:51<09:51,  5.78it/s, est. speed input: 6228.22 toks/s, output: 6.08 toks/s]
Processed prompts:  17%|█▋        | 711/4096 [01:57<09:44,  5.79it/s, est. speed input: 6216.09 toks/s, output: 6.07 toks/s]
Processed prompts:  18%|█▊        | 743/4096 [02:02<09:37,  5.80it/s, est. speed input: 6205.07 toks/s, output: 6.06 toks/s]
Processed prompts:  19%|█▉        | 775/4096 [02:07<09:26,  5.86it/s, est. speed input: 6201.91 toks/s, output: 6.06 toks/s]
Processed prompts:  20%|█▉        | 807/4096 [02:13<09:22,  5.85it/s, est. speed input: 6192.07 toks/s, output: 6.05 toks/s]
Processed prompts:  20%|██        | 839/4096 [02:18<09:17,  5.84it/s, est. speed input: 6182.65 toks/s, output: 6.04 toks/s]
Processed prompts:  21%|██▏       | 871/4096 [02:24<09:17,  5.79it/s, est. speed input: 6168.24 toks/s, output: 6.02 toks/s]
Processed prompts:  22%|██▏       | 903/4096 [02:30<09:10,  5.80it/s, est. speed input: 6160.69 toks/s, output: 6.02 toks/s]
Processed prompts:  23%|██▎       | 935/4096 [02:35<09:04,  5.80it/s, est. speed input: 6153.57 toks/s, output: 6.01 toks/s]
Processed prompts:  24%|██▎       | 967/4096 [02:41<08:58,  5.81it/s, est. speed input: 6147.01 toks/s, output: 6.00 toks/s]
Processed prompts:  24%|██▍       | 999/4096 [02:46<08:52,  5.82it/s, est. speed input: 6141.10 toks/s, output: 6.00 toks/s]
Processed prompts:  25%|██▌       | 1031/4096 [02:52<08:47,  5.82it/s, est. speed input: 6135.22 toks/s, output: 5.99 toks/s]
Processed prompts:  26%|██▌       | 1063/4096 [02:57<08:45,  5.77it/s, est. speed input: 6124.66 toks/s, output: 5.98 toks/s]
Processed prompts:  27%|██▋       | 1095/4096 [03:03<08:38,  5.78it/s, est. speed input: 6119.68 toks/s, output: 5.98 toks/s]
Processed prompts:  28%|██▊       | 1127/4096 [03:08<08:32,  5.79it/s, est. speed input: 6114.89 toks/s, output: 5.97 toks/s]
Processed prompts:  28%|██▊       | 1159/4096 [03:14<08:26,  5.80it/s, est. speed input: 6110.60 toks/s, output: 5.97 toks/s]
Processed prompts:  29%|██▉       | 1191/4096 [03:19<08:16,  5.86it/s, est. speed input: 6111.13 toks/s, output: 5.97 toks/s]
Processed prompts:  30%|██▉       | 1223/4096 [03:24<08:07,  5.90it/s, est. speed input: 6111.71 toks/s, output: 5.97 toks/s]
Processed prompts:  31%|███       | 1255/4096 [03:30<08:07,  5.83it/s, est. speed input: 6103.60 toks/s, output: 5.96 toks/s]
Processed prompts:  31%|███▏      | 1287/4096 [03:36<08:02,  5.83it/s, est. speed input: 6099.94 toks/s, output: 5.96 toks/s]
Processed prompts:  32%|███▏      | 1319/4096 [03:41<07:52,  5.87it/s, est. speed input: 6100.85 toks/s, output: 5.96 toks/s]
Processed prompts:  33%|███▎      | 1351/4096 [03:46<07:48,  5.86it/s, est. speed input: 6097.35 toks/s, output: 5.95 toks/s]
Processed prompts:  34%|███▍      | 1383/4096 [03:52<07:43,  5.85it/s, est. speed input: 6094.18 toks/s, output: 5.95 toks/s]
Processed prompts:  35%|███▍      | 1415/4096 [03:57<07:35,  5.89it/s, est. speed input: 6095.09 toks/s, output: 5.95 toks/s]
Processed prompts:  35%|███▌      | 1447/4096 [04:03<07:31,  5.87it/s, est. speed input: 6092.35 toks/s, output: 5.95 toks/s]
Processed prompts:  36%|███▌      | 1479/4096 [04:08<07:26,  5.86it/s, est. speed input: 6089.36 toks/s, output: 5.95 toks/s]
Processed prompts:  37%|███▋      | 1511/4096 [04:14<07:18,  5.90it/s, est. speed input: 6090.27 toks/s, output: 5.95 toks/s]
Processed prompts:  38%|███▊      | 1543/4096 [04:19<07:11,  5.91it/s, est. speed input: 6090.51 toks/s, output: 5.95 toks/s]
Processed prompts:  38%|███▊      | 1575/4096 [04:24<07:08,  5.88it/s, est. speed input: 6087.51 toks/s, output: 5.94 toks/s]
Processed prompts:  39%|███▉      | 1607/4096 [04:30<07:01,  5.91it/s, est. speed input: 6088.11 toks/s, output: 5.95 toks/s]
Processed prompts:  40%|████      | 1639/4096 [04:35<06:57,  5.88it/s, est. speed input: 6085.50 toks/s, output: 5.94 toks/s]
Processed prompts:  41%|████      | 1671/4096 [04:41<06:53,  5.86it/s, est. speed input: 6083.10 toks/s, output: 5.94 toks/s]
Processed prompts:  42%|████▏     | 1703/4096 [04:46<06:49,  5.85it/s, est. speed input: 6080.75 toks/s, output: 5.94 toks/s]
Processed prompts:  42%|████▏     | 1735/4096 [04:51<06:33,  6.00it/s, est. speed input: 6088.77 toks/s, output: 5.95 toks/s]
Processed prompts:  43%|████▎     | 1767/4096 [04:57<06:42,  5.79it/s, est. speed input: 6076.25 toks/s, output: 5.93 toks/s]
Processed prompts:  44%|████▍     | 1799/4096 [05:03<06:36,  5.80it/s, est. speed input: 6074.09 toks/s, output: 5.93 toks/s]
Processed prompts:  45%|████▍     | 1831/4096 [05:08<06:30,  5.80it/s, est. speed input: 6071.91 toks/s, output: 5.93 toks/s]
Processed prompts:  45%|████▌     | 1863/4096 [05:14<06:21,  5.85it/s, est. speed input: 6072.84 toks/s, output: 5.93 toks/s]
Processed prompts:  46%|████▋     | 1895/4096 [05:19<06:16,  5.84it/s, est. speed input: 6070.72 toks/s, output: 5.93 toks/s]
Processed prompts:  47%|████▋     | 1927/4096 [05:25<06:21,  5.68it/s, est. speed input: 6059.66 toks/s, output: 5.92 toks/s]
Processed prompts:  48%|████▊     | 1959/4096 [05:30<06:10,  5.77it/s, est. speed input: 6061.02 toks/s, output: 5.92 toks/s]
Processed prompts:  49%|████▊     | 1991/4096 [05:36<06:03,  5.79it/s, est. speed input: 6059.29 toks/s, output: 5.92 toks/s]
Processed prompts:  49%|████▉     | 2023/4096 [05:41<05:57,  5.80it/s, est. speed input: 6057.65 toks/s, output: 5.92 toks/s]
Processed prompts:  50%|█████     | 2055/4096 [05:47<05:48,  5.85it/s, est. speed input: 6058.72 toks/s, output: 5.92 toks/s]
Processed prompts:  51%|█████     | 2087/4096 [05:52<05:44,  5.84it/s, est. speed input: 6057.05 toks/s, output: 5.92 toks/s]
Processed prompts:  52%|█████▏    | 2119/4096 [05:58<05:45,  5.72it/s, est. speed input: 6049.43 toks/s, output: 5.91 toks/s]
Processed prompts:  53%|█████▎    | 2151/4096 [06:04<05:38,  5.75it/s, est. speed input: 6048.00 toks/s, output: 5.91 toks/s]
Processed prompts:  53%|█████▎    | 2183/4096 [06:09<05:29,  5.81it/s, est. speed input: 6049.00 toks/s, output: 5.91 toks/s]
Processed prompts:  54%|█████▍    | 2215/4096 [06:15<05:23,  5.81it/s, est. speed input: 6047.38 toks/s, output: 5.91 toks/s]
Processed prompts:  55%|█████▍    | 2247/4096 [06:20<05:18,  5.81it/s, est. speed input: 6045.99 toks/s, output: 5.90 toks/s]
Processed prompts:  56%|█████▌    | 2279/4096 [06:26<05:12,  5.81it/s, est. speed input: 6044.59 toks/s, output: 5.90 toks/s]
Processed prompts:  56%|█████▋    | 2311/4096 [06:31<05:07,  5.81it/s, est. speed input: 6043.24 toks/s, output: 5.90 toks/s]
Processed prompts:  57%|█████▋    | 2343/4096 [06:36<04:59,  5.86it/s, est. speed input: 6044.39 toks/s, output: 5.90 toks/s]
Processed prompts:  58%|█████▊    | 2375/4096 [06:42<04:54,  5.84it/s, est. speed input: 6043.06 toks/s, output: 5.90 toks/s]
Processed prompts:  59%|█████▉    | 2407/4096 [06:47<04:49,  5.83it/s, est. speed input: 6041.65 toks/s, output: 5.90 toks/s]
Processed prompts:  60%|█████▉    | 2439/4096 [06:53<04:44,  5.82it/s, est. speed input: 6040.40 toks/s, output: 5.90 toks/s]
Processed prompts:  60%|██████    | 2471/4096 [06:58<04:39,  5.82it/s, est. speed input: 6039.18 toks/s, output: 5.90 toks/s]
Processed prompts:  61%|██████    | 2503/4096 [07:04<04:33,  5.82it/s, est. speed input: 6037.97 toks/s, output: 5.90 toks/s]
Processed prompts:  62%|██████▏   | 2535/4096 [07:09<04:26,  5.86it/s, est. speed input: 6038.92 toks/s, output: 5.90 toks/s]
Processed prompts:  63%|██████▎   | 2567/4096 [07:15<04:21,  5.84it/s, est. speed input: 6037.65 toks/s, output: 5.90 toks/s]
Processed prompts:  63%|██████▎   | 2599/4096 [07:20<04:14,  5.88it/s, est. speed input: 6038.60 toks/s, output: 5.90 toks/s]
Processed prompts:  64%|██████▍   | 2631/4096 [07:26<04:07,  5.91it/s, est. speed input: 6039.55 toks/s, output: 5.90 toks/s]
Processed prompts:  65%|██████▌   | 2663/4096 [07:31<04:03,  5.88it/s, est. speed input: 6038.31 toks/s, output: 5.90 toks/s]
Processed prompts:  66%|██████▌   | 2695/4096 [07:37<03:59,  5.85it/s, est. speed input: 6037.01 toks/s, output: 5.90 toks/s]
Processed prompts:  67%|██████▋   | 2727/4096 [07:42<03:52,  5.89it/s, est. speed input: 6037.88 toks/s, output: 5.90 toks/s]
Processed prompts:  67%|██████▋   | 2759/4096 [07:48<03:48,  5.86it/s, est. speed input: 6036.56 toks/s, output: 5.90 toks/s]
Processed prompts:  68%|██████▊   | 2791/4096 [07:53<03:43,  5.84it/s, est. speed input: 6035.52 toks/s, output: 5.89 toks/s]
Processed prompts:  69%|██████▉   | 2823/4096 [07:59<03:38,  5.82it/s, est. speed input: 6034.19 toks/s, output: 5.89 toks/s]
Processed prompts:  70%|██████▉   | 2855/4096 [08:04<03:33,  5.82it/s, est. speed input: 6033.15 toks/s, output: 5.89 toks/s]
Processed prompts:  70%|███████   | 2887/4096 [08:09<03:25,  5.89it/s, est. speed input: 6035.13 toks/s, output: 5.89 toks/s]
Processed prompts:  71%|███████▏  | 2919/4096 [08:15<03:18,  5.92it/s, est. speed input: 6036.05 toks/s, output: 5.89 toks/s]
Processed prompts:  72%|███████▏  | 2951/4096 [08:20<03:14,  5.89it/s, est. speed input: 6035.15 toks/s, output: 5.89 toks/s]
Processed prompts:  73%|███████▎  | 2983/4096 [08:26<03:08,  5.92it/s, est. speed input: 6036.17 toks/s, output: 5.89 toks/s]
Processed prompts:  74%|███████▎  | 3015/4096 [08:31<03:03,  5.88it/s, est. speed input: 6035.12 toks/s, output: 5.89 toks/s]
Processed prompts:  74%|███████▍  | 3047/4096 [08:37<02:59,  5.86it/s, est. speed input: 6034.08 toks/s, output: 5.89 toks/s]
Processed prompts:  75%|███████▌  | 3079/4096 [08:42<02:54,  5.84it/s, est. speed input: 6033.07 toks/s, output: 5.89 toks/s]
Processed prompts:  76%|███████▌  | 3111/4096 [08:48<02:49,  5.83it/s, est. speed input: 6032.12 toks/s, output: 5.89 toks/s]
Processed prompts:  77%|███████▋  | 3143/4096 [08:53<02:44,  5.81it/s, est. speed input: 6030.80 toks/s, output: 5.89 toks/s]
Processed prompts:  78%|███████▊  | 3175/4096 [08:59<02:37,  5.86it/s, est. speed input: 6031.61 toks/s, output: 5.89 toks/s]
Processed prompts:  78%|███████▊  | 3207/4096 [09:04<02:32,  5.84it/s, est. speed input: 6030.75 toks/s, output: 5.89 toks/s]
Processed prompts:  79%|███████▉  | 3239/4096 [09:10<02:26,  5.83it/s, est. speed input: 6029.89 toks/s, output: 5.89 toks/s]
Processed prompts:  80%|███████▉  | 3271/4096 [09:15<02:21,  5.82it/s, est. speed input: 6029.07 toks/s, output: 5.89 toks/s]
Processed prompts:  81%|████████  | 3303/4096 [09:21<02:16,  5.82it/s, est. speed input: 6028.40 toks/s, output: 5.89 toks/s]
Processed prompts:  81%|████████▏ | 3335/4096 [09:26<02:10,  5.82it/s, est. speed input: 6027.78 toks/s, output: 5.89 toks/s]
Processed prompts:  82%|████████▏ | 3367/4096 [09:32<02:05,  5.82it/s, est. speed input: 6027.16 toks/s, output: 5.89 toks/s]
Processed prompts:  83%|████████▎ | 3399/4096 [09:37<01:58,  5.87it/s, est. speed input: 6028.18 toks/s, output: 5.89 toks/s]
Processed prompts:  84%|████████▍ | 3431/4096 [09:42<01:53,  5.86it/s, est. speed input: 6027.59 toks/s, output: 5.89 toks/s]
Processed prompts:  85%|████████▍ | 3463/4096 [09:48<01:48,  5.85it/s, est. speed input: 6026.93 toks/s, output: 5.89 toks/s]
Processed prompts:  85%|████████▌ | 3495/4096 [09:53<01:42,  5.84it/s, est. speed input: 6026.30 toks/s, output: 5.89 toks/s]
Processed prompts:  86%|████████▌ | 3527/4096 [09:59<01:37,  5.84it/s, est. speed input: 6025.78 toks/s, output: 5.88 toks/s]
Processed prompts:  87%|████████▋ | 3559/4096 [10:04<01:31,  5.88it/s, est. speed input: 6026.80 toks/s, output: 5.89 toks/s]
Processed prompts:  88%|████████▊ | 3591/4096 [10:10<01:26,  5.87it/s, est. speed input: 6026.30 toks/s, output: 5.89 toks/s]
Processed prompts:  88%|████████▊ | 3623/4096 [10:15<01:20,  5.91it/s, est. speed input: 6027.42 toks/s, output: 5.89 toks/s]
Processed prompts:  89%|████████▉ | 3655/4096 [10:20<01:14,  5.89it/s, est. speed input: 6026.96 toks/s, output: 5.89 toks/s]
Processed prompts:  90%|█████████ | 3687/4096 [10:26<01:08,  5.95it/s, est. speed input: 6028.79 toks/s, output: 5.89 toks/s]
Processed prompts:  91%|█████████ | 3719/4096 [10:31<01:03,  5.91it/s, est. speed input: 6028.32 toks/s, output: 5.89 toks/s]
Processed prompts:  92%|█████████▏| 3751/4096 [10:37<00:58,  5.89it/s, est. speed input: 6027.74 toks/s, output: 5.89 toks/s]
Processed prompts:  92%|█████████▏| 3783/4096 [10:42<00:53,  5.87it/s, est. speed input: 6027.27 toks/s, output: 5.89 toks/s]
Processed prompts:  93%|█████████▎| 3815/4096 [10:48<00:47,  5.86it/s, est. speed input: 6026.77 toks/s, output: 5.89 toks/s]
Processed prompts:  94%|█████████▍| 3847/4096 [10:53<00:42,  5.85it/s, est. speed input: 6026.32 toks/s, output: 5.89 toks/s]
Processed prompts:  95%|█████████▍| 3879/4096 [10:59<00:37,  5.85it/s, est. speed input: 6025.96 toks/s, output: 5.88 toks/s]
Processed prompts:  95%|█████████▌| 3911/4096 [11:04<00:31,  5.90it/s, est. speed input: 6026.99 toks/s, output: 5.89 toks/s]
Processed prompts:  96%|█████████▋| 3943/4096 [11:09<00:25,  5.93it/s, est. speed input: 6027.93 toks/s, output: 5.89 toks/s]
Processed prompts:  97%|█████████▋| 3975/4096 [11:15<00:20,  5.90it/s, est. speed input: 6027.46 toks/s, output: 5.89 toks/s]
Processed prompts:  98%|█████████▊| 4007/4096 [11:20<00:15,  5.93it/s, est. speed input: 6028.44 toks/s, output: 5.89 toks/s]
Processed prompts:  99%|█████████▊| 4039/4096 [11:25<00:09,  5.95it/s, est. speed input: 6029.40 toks/s, output: 5.89 toks/s]
Processed prompts:  99%|█████████▉| 4071/4096 [11:30<00:03,  6.29it/s, est. speed input: 6038.31 toks/s, output: 5.90 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:30<00:00,  6.29it/s, est. speed input: 6075.39 toks/s, output: 5.93 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:30<00:00,  5.93it/s, est. speed input: 6075.39 toks/s, output: 5.93 toks/s]
[rank0]:[W126 19:50:06.694487318 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 822.9s

测试结果:
  Requests/s:   5.84
  Tokens/s:     5989.39
  Total Reqs:   4096
  Elapsed:      700.97s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5983.55

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:50:43 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:50:43 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1671147) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1671147) ERROR 01-26 19:51:53 [core.py:866] 


─── STDERR ───
[2026-01-26 19:50:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:50:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:50:43] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:50:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:50:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:50:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:50:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:50:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:50:47] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:50:47] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:50:47] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:50:47] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:50:47] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:50:47] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:50:47] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:50:47] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:50:47] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1671147) [2026-01-26 19:50:48] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1671147) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1671147) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.81s/it]
(EngineCore_DP0 pid=1671147) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.90s/it]
(EngineCore_DP0 pid=1671147) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:02<00:00, 31.44s/it]
(EngineCore_DP0 pid=1671147) 
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5376] -> 1D uint8
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 15482880 bytes
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5376] -> 1D uint8
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:51] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12042240 bytes
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:51] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5376] -> 1D uint8
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 127303680 bytes
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:52] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 28416] -> 1D uint8
(EngineCore_DP0 pid=1671147) [2026-01-26 19:51:52] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 63651840 bytes
(EngineCore_DP0 pid=1671147) Process EngineCore_DP0:
(EngineCore_DP0 pid=1671147) Traceback (most recent call last):
(EngineCore_DP0 pid=1671147)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1671147)     self.run()
(EngineCore_DP0 pid=1671147)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1671147)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1671147)     raise e
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1671147)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1671147)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1671147)     super().__init__(
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1671147)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1671147)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1671147)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1671147)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1671147)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1671147)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1671147)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1671147)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1671147)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1671147)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1671147)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1671147)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1671147)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1671147)     outputs = self.model(
(EngineCore_DP0 pid=1671147)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1671147)     hidden_states = self.model(
(EngineCore_DP0 pid=1671147)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1671147)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1671147)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1671147)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1671147)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1671147)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1671147)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1671147)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1671147)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1671147)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1671147)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1671147)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1671147)     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1671147)     return self._linear_fn(
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1671147)     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1671147)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1671147)     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1671147)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1671147)     return fn(input, L)
(EngineCore_DP0 pid=1671147)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1671147)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1671147)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1671147) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1671147) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1671147) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1671147) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1671147) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1671147) 
[rank0]:[W126 19:51:54.237458237 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_8/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,11.0718,5679.8401,11.5609
1024,1024,1,128,128,5.8377,5983.6464,21.9264
2048,1024,2,256,128,5.8169,5962.3221,44.0097
4096,1024,4,512,128,5.7034,5845.9909,89.7709
8192,1024,8,1024,128,5.8531,5999.4503,174.9494
16384,1024,16,2048,128,5.8619,6008.4696,349.3735
32768,1024,32,4096,128,5.8433,5989.3906,700.9728
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败

============================================================
  Qwen2.5-7B-FP8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/Qwen2.5-7B-FP8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_10

============================================================
[1/8] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:51:59 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:51:59 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1672365) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1672365) WARNING 01-26 19:53:28 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 10.20 requests/s, 5230.07 total tokens/s, 10.20 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-26 19:51:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:51:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:51:59] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:51:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:51:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:51:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:51:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:51:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:51:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:52:03] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:52:03] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:52:03] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:52:03] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:52:03] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:52:03] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:52:03] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:52:03] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:52:03] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1672365) [2026-01-26 19:52:04] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1672365) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1672365) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.15s/it]
(EngineCore_DP0 pid=1672365) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 33.50s/it]
(EngineCore_DP0 pid=1672365) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:05<00:00, 32.70s/it]
(EngineCore_DP0 pid=1672365) 
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1672365) [2026-01-26 19:53:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1672365) 2026-01-26 19:53:19,572 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1672365) 2026-01-26 19:53:19,876 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:   1%|          | 1/128 [00:00<01:29,  1.41it/s]
Adding requests:   2%|▏         | 2/128 [00:00<00:52,  2.40it/s]
Adding requests:   2%|▏         | 3/128 [00:01<00:34,  3.60it/s]
Adding requests:   4%|▍         | 5/128 [00:01<00:20,  6.03it/s]
Adding requests:   5%|▌         | 7/128 [00:01<00:14,  8.51it/s]
Adding requests:   8%|▊         | 10/128 [00:01<00:09, 13.04it/s]
Adding requests:  10%|█         | 13/128 [00:01<00:07, 16.01it/s]
Adding requests:  13%|█▎        | 17/128 [00:01<00:05, 21.66it/s]
Adding requests:  16%|█▌        | 20/128 [00:01<00:04, 23.02it/s]
Adding requests:  21%|██        | 27/128 [00:01<00:02, 33.91it/s]
Adding requests:  34%|███▎      | 43/128 [00:01<00:01, 67.06it/s]
Adding requests:  62%|██████▎   | 80/128 [00:02<00:00, 148.63it/s]
Adding requests: 100%|██████████| 128/128 [00:02<00:00, 58.99it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:01, 95.71it/s, est. speed input: 49008.12 toks/s, output: 95.71 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:04, 20.70it/s, est. speed input: 12391.69 toks/s, output: 24.20 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:05, 17.02it/s, est. speed input: 10422.35 toks/s, output: 20.36 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:06, 15.19it/s, est. speed input: 9508.43 toks/s, output: 18.57 toks/s] 
Processed prompts:  30%|██▉       | 38/128 [00:02<00:06, 14.17it/s, est. speed input: 9023.98 toks/s, output: 17.62 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:06, 13.59it/s, est. speed input: 8767.91 toks/s, output: 17.12 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:06, 13.09it/s, est. speed input: 8554.73 toks/s, output: 16.71 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:06, 12.51it/s, est. speed input: 8341.20 toks/s, output: 16.29 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:06, 12.18it/s, est. speed input: 8179.09 toks/s, output: 15.97 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:03<00:06, 11.87it/s, est. speed input: 8028.04 toks/s, output: 15.68 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:06, 11.64it/s, est. speed input: 7894.64 toks/s, output: 15.42 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:06, 11.53it/s, est. speed input: 7783.82 toks/s, output: 15.20 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:06, 11.35it/s, est. speed input: 7671.29 toks/s, output: 14.98 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:06, 11.24it/s, est. speed input: 7573.25 toks/s, output: 14.79 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:06, 11.22it/s, est. speed input: 7489.57 toks/s, output: 14.63 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:04<00:06, 11.19it/s, est. speed input: 7411.27 toks/s, output: 14.48 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:04<00:05, 11.17it/s, est. speed input: 7340.26 toks/s, output: 14.34 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:04<00:05, 11.15it/s, est. speed input: 7274.28 toks/s, output: 14.21 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:04<00:05, 11.07it/s, est. speed input: 7207.15 toks/s, output: 14.08 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:05, 11.09it/s, est. speed input: 7151.99 toks/s, output: 13.97 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:05<00:05, 11.15it/s, est. speed input: 7103.48 toks/s, output: 13.87 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:05<00:05, 11.12it/s, est. speed input: 7053.60 toks/s, output: 13.78 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:05<00:04, 11.09it/s, est. speed input: 7006.43 toks/s, output: 13.68 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:05<00:04, 11.07it/s, est. speed input: 6962.40 toks/s, output: 13.60 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:05<00:04, 11.00it/s, est. speed input: 6917.36 toks/s, output: 13.51 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:05<00:04, 11.02it/s, est. speed input: 6878.92 toks/s, output: 13.44 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:06<00:04, 11.09it/s, est. speed input: 6846.63 toks/s, output: 13.37 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:06<00:03, 11.13it/s, est. speed input: 6815.72 toks/s, output: 13.31 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:06<00:03, 11.11it/s, est. speed input: 6783.62 toks/s, output: 13.25 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:06<00:03, 11.15it/s, est. speed input: 6756.07 toks/s, output: 13.20 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:06<00:03, 11.04it/s, est. speed input: 6723.17 toks/s, output: 13.13 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:07<00:03, 11.09it/s, est. speed input: 6697.93 toks/s, output: 13.08 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:07<00:03, 11.14it/s, est. speed input: 6675.12 toks/s, output: 13.04 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:07<00:02, 11.11it/s, est. speed input: 6650.00 toks/s, output: 12.99 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:07<00:02, 11.11it/s, est. speed input: 6627.11 toks/s, output: 12.94 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:07<00:02, 11.17it/s, est. speed input: 6608.01 toks/s, output: 12.91 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:07<00:02, 11.06it/s, est. speed input: 6582.86 toks/s, output: 12.86 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:08<00:02, 11.07it/s, est. speed input: 6562.82 toks/s, output: 12.82 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:08<00:01, 11.06it/s, est. speed input: 6542.89 toks/s, output: 12.78 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:08<00:01, 11.04it/s, est. speed input: 6523.27 toks/s, output: 12.74 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:08<00:01, 11.06it/s, est. speed input: 6506.04 toks/s, output: 12.71 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:08<00:01, 11.09it/s, est. speed input: 6489.97 toks/s, output: 12.68 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:09<00:01, 10.97it/s, est. speed input: 6469.11 toks/s, output: 12.63 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:09<00:01, 11.03it/s, est. speed input: 6454.53 toks/s, output: 12.61 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:09<00:00, 11.05it/s, est. speed input: 6439.76 toks/s, output: 12.58 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:09<00:00, 11.06it/s, est. speed input: 6425.30 toks/s, output: 12.55 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:09<00:00, 11.03it/s, est. speed input: 6410.05 toks/s, output: 12.52 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:09<00:00, 11.01it/s, est. speed input: 6395.23 toks/s, output: 12.49 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:10<00:00, 10.96it/s, est. speed input: 6380.01 toks/s, output: 12.46 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 10.98it/s, est. speed input: 6366.96 toks/s, output: 12.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 10.98it/s, est. speed input: 6366.96 toks/s, output: 12.44 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:10<00:00, 12.44it/s, est. speed input: 6366.96 toks/s, output: 12.44 toks/s]
[rank0]:[W126 19:53:42.365909034 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 121.6s

测试结果:
  Requests/s:   10.20
  Tokens/s:     5230.07
  Total Reqs:   128
  Elapsed:      12.56s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     5219.88

============================================================
[2/8] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:54:04 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:54:05 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1674286) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1674286) WARNING 01-26 19:55:25 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.62 requests/s, 5765.21 total tokens/s, 5.62 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-26 19:54:04] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:54:04] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:54:04] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:04] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:54:04] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:54:04] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:54:04] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:54:04] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:54:04] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:54:08] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:54:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:54:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:54:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:54:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:54:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:54:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:54:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:54:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1674286) [2026-01-26 19:54:09] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1674286) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1674286) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.06s/it]
(EngineCore_DP0 pid=1674286) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.71s/it]
(EngineCore_DP0 pid=1674286) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.86s/it]
(EngineCore_DP0 pid=1674286) 
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1674286) [2026-01-26 19:55:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1674286) 2026-01-26 19:55:25,216 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1674286) 2026-01-26 19:55:25,282 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  26%|██▌       | 33/128 [00:00<00:00, 325.04it/s]
Adding requests:  56%|█████▋    | 72/128 [00:00<00:00, 356.79it/s]
Adding requests:  88%|████████▊ | 112/128 [00:00<00:00, 372.48it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 367.67it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:11, 10.85it/s, est. speed input: 11107.86 toks/s, output: 10.85 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:16,  7.49it/s, est. speed input: 8121.46 toks/s, output: 7.93 toks/s]  
Processed prompts:   5%|▍         | 6/128 [00:00<00:17,  6.92it/s, est. speed input: 7616.89 toks/s, output: 7.44 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:18,  6.54it/s, est. speed input: 7295.22 toks/s, output: 7.12 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:01<00:19,  6.30it/s, est. speed input: 7084.28 toks/s, output: 6.92 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:01<00:19,  6.11it/s, est. speed input: 6917.89 toks/s, output: 6.76 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:01<00:19,  5.94it/s, est. speed input: 6773.41 toks/s, output: 6.61 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:01<00:19,  5.88it/s, est. speed input: 6679.86 toks/s, output: 6.52 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:01<00:19,  5.81it/s, est. speed input: 6594.05 toks/s, output: 6.44 toks/s]
Processed prompts:  10%|█         | 13/128 [00:02<00:19,  5.81it/s, est. speed input: 6539.48 toks/s, output: 6.39 toks/s]
Processed prompts:  11%|█         | 14/128 [00:02<00:19,  5.77it/s, est. speed input: 6483.18 toks/s, output: 6.33 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:02<00:19,  5.74it/s, est. speed input: 6432.05 toks/s, output: 6.28 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:02<00:19,  5.70it/s, est. speed input: 6385.72 toks/s, output: 6.24 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:02<00:19,  5.72it/s, est. speed input: 6355.39 toks/s, output: 6.21 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:02<00:19,  5.71it/s, est. speed input: 6323.06 toks/s, output: 6.17 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:03<00:19,  5.69it/s, est. speed input: 6291.29 toks/s, output: 6.14 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:03<00:18,  5.70it/s, est. speed input: 6268.65 toks/s, output: 6.12 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:03<00:18,  5.70it/s, est. speed input: 6246.35 toks/s, output: 6.10 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:03<00:18,  5.65it/s, est. speed input: 6218.12 toks/s, output: 6.07 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:03<00:18,  5.65it/s, est. speed input: 6198.53 toks/s, output: 6.05 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:03<00:18,  5.64it/s, est. speed input: 6178.40 toks/s, output: 6.03 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:04<00:18,  5.66it/s, est. speed input: 6163.79 toks/s, output: 6.02 toks/s]
Processed prompts:  20%|██        | 26/128 [00:04<00:17,  5.70it/s, est. speed input: 6154.25 toks/s, output: 6.01 toks/s]
Processed prompts:  21%|██        | 27/128 [00:04<00:17,  5.72it/s, est. speed input: 6144.75 toks/s, output: 6.00 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:04<00:17,  5.65it/s, est. speed input: 6124.97 toks/s, output: 5.98 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:04<00:17,  5.65it/s, est. speed input: 6112.99 toks/s, output: 5.97 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:05<00:17,  5.69it/s, est. speed input: 6106.57 toks/s, output: 5.96 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:05<00:17,  5.69it/s, est. speed input: 6096.38 toks/s, output: 5.95 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:05<00:16,  5.70it/s, est. speed input: 6089.59 toks/s, output: 5.95 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:05<00:16,  5.71it/s, est. speed input: 6082.29 toks/s, output: 5.94 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:05<00:16,  5.68it/s, est. speed input: 6072.05 toks/s, output: 5.93 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:05<00:16,  5.67it/s, est. speed input: 6062.74 toks/s, output: 5.92 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:06<00:16,  5.66it/s, est. speed input: 6054.68 toks/s, output: 5.91 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:06<00:16,  5.68it/s, est. speed input: 6049.43 toks/s, output: 5.91 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:06<00:15,  5.68it/s, est. speed input: 6043.05 toks/s, output: 5.90 toks/s]
Processed prompts:  30%|███       | 39/128 [00:06<00:15,  5.70it/s, est. speed input: 6039.04 toks/s, output: 5.90 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:06<00:15,  5.64it/s, est. speed input: 6028.09 toks/s, output: 5.89 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:06<00:15,  5.64it/s, est. speed input: 6022.08 toks/s, output: 5.88 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:07<00:15,  5.64it/s, est. speed input: 6015.45 toks/s, output: 5.87 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:07<00:15,  5.64it/s, est. speed input: 6010.20 toks/s, output: 5.87 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:07<00:14,  5.66it/s, est. speed input: 6006.07 toks/s, output: 5.87 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:07<00:14,  5.67it/s, est. speed input: 6002.35 toks/s, output: 5.86 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:07<00:14,  5.62it/s, est. speed input: 5993.95 toks/s, output: 5.85 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:08<00:14,  5.64it/s, est. speed input: 5989.91 toks/s, output: 5.85 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:08<00:14,  5.64it/s, est. speed input: 5985.15 toks/s, output: 5.84 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:08<00:13,  5.65it/s, est. speed input: 5981.54 toks/s, output: 5.84 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:08<00:13,  5.64it/s, est. speed input: 5977.06 toks/s, output: 5.84 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:08<00:13,  5.67it/s, est. speed input: 5975.11 toks/s, output: 5.84 toks/s]
Processed prompts:  41%|████      | 52/128 [00:08<00:13,  5.64it/s, est. speed input: 5969.48 toks/s, output: 5.83 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:09<00:13,  5.65it/s, est. speed input: 5966.42 toks/s, output: 5.83 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:09<00:13,  5.69it/s, est. speed input: 5965.60 toks/s, output: 5.83 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:09<00:12,  5.68it/s, est. speed input: 5962.35 toks/s, output: 5.82 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:09<00:12,  5.67it/s, est. speed input: 5959.17 toks/s, output: 5.82 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:09<00:12,  5.68it/s, est. speed input: 5956.95 toks/s, output: 5.82 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:09<00:12,  5.65it/s, est. speed input: 5952.38 toks/s, output: 5.81 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:10<00:12,  5.65it/s, est. speed input: 5949.40 toks/s, output: 5.81 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:10<00:12,  5.66it/s, est. speed input: 5947.09 toks/s, output: 5.81 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:10<00:11,  5.65it/s, est. speed input: 5944.35 toks/s, output: 5.81 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:10<00:11,  5.67it/s, est. speed input: 5942.73 toks/s, output: 5.80 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:10<00:11,  5.67it/s, est. speed input: 5940.61 toks/s, output: 5.80 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:11<00:11,  5.63it/s, est. speed input: 5936.36 toks/s, output: 5.80 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:11<00:11,  5.64it/s, est. speed input: 5934.27 toks/s, output: 5.80 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:11<00:10,  5.67it/s, est. speed input: 5933.43 toks/s, output: 5.79 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:11<00:10,  5.70it/s, est. speed input: 5932.75 toks/s, output: 5.79 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:11<00:10,  5.67it/s, est. speed input: 5930.15 toks/s, output: 5.79 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:11<00:10,  5.67it/s, est. speed input: 5928.28 toks/s, output: 5.79 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:12<00:10,  5.64it/s, est. speed input: 5924.63 toks/s, output: 5.79 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:12<00:10,  5.65it/s, est. speed input: 5923.14 toks/s, output: 5.78 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:12<00:09,  5.66it/s, est. speed input: 5921.71 toks/s, output: 5.78 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:12<00:09,  5.67it/s, est. speed input: 5920.24 toks/s, output: 5.78 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:12<00:09,  5.66it/s, est. speed input: 5918.43 toks/s, output: 5.78 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:12<00:09,  5.68it/s, est. speed input: 5917.47 toks/s, output: 5.78 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:13<00:09,  5.61it/s, est. speed input: 5913.12 toks/s, output: 5.77 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:13<00:09,  5.62it/s, est. speed input: 5911.03 toks/s, output: 5.77 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:13<00:08,  5.65it/s, est. speed input: 5910.50 toks/s, output: 5.77 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:13<00:08,  5.64it/s, est. speed input: 5908.63 toks/s, output: 5.77 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:13<00:08,  5.64it/s, est. speed input: 5906.59 toks/s, output: 5.77 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:14<00:08,  5.64it/s, est. speed input: 5905.15 toks/s, output: 5.77 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:14<00:08,  5.60it/s, est. speed input: 5901.65 toks/s, output: 5.76 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:14<00:07,  5.63it/s, est. speed input: 5901.10 toks/s, output: 5.76 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:14<00:07,  5.64it/s, est. speed input: 5899.95 toks/s, output: 5.76 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:14<00:07,  5.64it/s, est. speed input: 5898.37 toks/s, output: 5.76 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:14<00:07,  5.65it/s, est. speed input: 5897.29 toks/s, output: 5.76 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:15<00:07,  5.66it/s, est. speed input: 5896.47 toks/s, output: 5.76 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:15<00:07,  5.61it/s, est. speed input: 5893.04 toks/s, output: 5.75 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:15<00:06,  5.62it/s, est. speed input: 5891.82 toks/s, output: 5.75 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:15<00:06,  5.64it/s, est. speed input: 5890.97 toks/s, output: 5.75 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:15<00:06,  5.66it/s, est. speed input: 5890.56 toks/s, output: 5.75 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:15<00:06,  5.64it/s, est. speed input: 5888.88 toks/s, output: 5.75 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:16<00:06,  5.67it/s, est. speed input: 5888.82 toks/s, output: 5.75 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:16<00:06,  5.63it/s, est. speed input: 5886.38 toks/s, output: 5.75 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:16<00:05,  5.63it/s, est. speed input: 5885.02 toks/s, output: 5.75 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:16<00:05,  5.64it/s, est. speed input: 5884.18 toks/s, output: 5.75 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:16<00:05,  5.63it/s, est. speed input: 5882.56 toks/s, output: 5.74 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:17<00:05,  5.63it/s, est. speed input: 5881.41 toks/s, output: 5.74 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:17<00:05,  5.63it/s, est. speed input: 5880.16 toks/s, output: 5.74 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:17<00:05,  5.59it/s, est. speed input: 5877.47 toks/s, output: 5.74 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:17<00:04,  5.58it/s, est. speed input: 5875.79 toks/s, output: 5.74 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:17<00:04,  5.60it/s, est. speed input: 5874.72 toks/s, output: 5.74 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:17<00:04,  5.60it/s, est. speed input: 5873.29 toks/s, output: 5.74 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:18<00:04,  5.59it/s, est. speed input: 5871.75 toks/s, output: 5.73 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:18<00:04,  5.59it/s, est. speed input: 5870.29 toks/s, output: 5.73 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:18<00:03,  5.57it/s, est. speed input: 5868.10 toks/s, output: 5.73 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:18<00:03,  5.59it/s, est. speed input: 5867.28 toks/s, output: 5.73 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:18<00:03,  5.61it/s, est. speed input: 5866.45 toks/s, output: 5.73 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:19<00:03,  5.62it/s, est. speed input: 5865.62 toks/s, output: 5.73 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:19<00:03,  5.63it/s, est. speed input: 5865.07 toks/s, output: 5.73 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:19<00:03,  5.62it/s, est. speed input: 5863.61 toks/s, output: 5.73 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:19<00:02,  5.58it/s, est. speed input: 5861.57 toks/s, output: 5.72 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:19<00:02,  5.61it/s, est. speed input: 5861.15 toks/s, output: 5.72 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:19<00:02,  5.62it/s, est. speed input: 5860.36 toks/s, output: 5.72 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:20<00:02,  5.63it/s, est. speed input: 5859.85 toks/s, output: 5.72 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:20<00:02,  5.63it/s, est. speed input: 5858.88 toks/s, output: 5.72 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:20<00:01,  5.61it/s, est. speed input: 5857.62 toks/s, output: 5.72 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:20<00:01,  5.58it/s, est. speed input: 5855.80 toks/s, output: 5.72 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:20<00:01,  5.61it/s, est. speed input: 5855.28 toks/s, output: 5.72 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:20<00:01,  5.62it/s, est. speed input: 5854.68 toks/s, output: 5.72 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:21<00:01,  5.65it/s, est. speed input: 5854.71 toks/s, output: 5.72 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:21<00:01,  5.65it/s, est. speed input: 5854.29 toks/s, output: 5.72 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:21<00:00,  5.62it/s, est. speed input: 5852.75 toks/s, output: 5.72 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:21<00:00,  5.60it/s, est. speed input: 5851.33 toks/s, output: 5.71 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:21<00:00,  5.61it/s, est. speed input: 5850.60 toks/s, output: 5.71 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:22<00:00,  5.61it/s, est. speed input: 5849.74 toks/s, output: 5.71 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:22<00:00,  5.63it/s, est. speed input: 5849.42 toks/s, output: 5.71 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.65it/s, est. speed input: 5849.45 toks/s, output: 5.71 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.65it/s, est. speed input: 5849.45 toks/s, output: 5.71 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:22<00:00,  5.71it/s, est. speed input: 5849.45 toks/s, output: 5.71 toks/s]
[rank0]:[W126 19:55:48.140137527 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 114.1s

测试结果:
  Requests/s:   5.62
  Tokens/s:     5765.21
  Total Reqs:   128
  Elapsed:      22.76s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     5759.59

============================================================
[3/8] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:55:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:55:58 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1676097) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1676097) WARNING 01-26 19:57:18 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.60 requests/s, 5738.76 total tokens/s, 5.60 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-26 19:55:58] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:55:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:55:58] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:55:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:55:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:55:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:55:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:55:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:55:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:56:01] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:56:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:56:01] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:56:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:56:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:56:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:56:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:56:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:56:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1676097) [2026-01-26 19:56:02] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1676097) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1676097) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.62s/it]
(EngineCore_DP0 pid=1676097) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 34.02s/it]
(EngineCore_DP0 pid=1676097) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:06<00:00, 33.21s/it]
(EngineCore_DP0 pid=1676097) 
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1676097) [2026-01-26 19:57:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1676097) 2026-01-26 19:57:17,240 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1676097) 2026-01-26 19:57:17,365 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  18%|█▊        | 46/256 [00:00<00:00, 453.72it/s]
Adding requests:  36%|███▌      | 92/256 [00:00<00:00, 373.16it/s]
Adding requests:  52%|█████▏    | 133/256 [00:00<00:00, 385.86it/s]
Adding requests:  68%|██████▊   | 174/256 [00:00<00:00, 392.83it/s]
Adding requests:  84%|████████▍ | 215/256 [00:00<00:00, 398.59it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 396.14it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 395.17it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 2/256 [00:00<00:15, 16.36it/s, est. speed input: 16753.95 toks/s, output: 16.36 toks/s]
Processed prompts:   2%|▏         | 4/256 [00:00<00:42,  5.86it/s, est. speed input: 6642.67 toks/s, output: 6.49 toks/s]  
Processed prompts:   2%|▏         | 6/256 [00:01<00:53,  4.69it/s, est. speed input: 5372.58 toks/s, output: 5.25 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:01<00:49,  5.05it/s, est. speed input: 5486.09 toks/s, output: 5.36 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:01<00:46,  5.27it/s, est. speed input: 5556.91 toks/s, output: 5.43 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:02<00:45,  5.41it/s, est. speed input: 5598.54 toks/s, output: 5.47 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:02<00:43,  5.50it/s, est. speed input: 5632.51 toks/s, output: 5.50 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:02<00:43,  5.56it/s, est. speed input: 5656.87 toks/s, output: 5.52 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:03<00:42,  5.58it/s, est. speed input: 5666.85 toks/s, output: 5.53 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:03<00:41,  5.63it/s, est. speed input: 5688.11 toks/s, output: 5.55 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:03<00:41,  5.66it/s, est. speed input: 5703.50 toks/s, output: 5.57 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:04<00:41,  5.66it/s, est. speed input: 5710.78 toks/s, output: 5.58 toks/s]
Processed prompts:  10%|█         | 26/256 [00:04<00:40,  5.67it/s, est. speed input: 5719.00 toks/s, output: 5.58 toks/s]
Processed prompts:  11%|█         | 28/256 [00:05<00:40,  5.67it/s, est. speed input: 5726.67 toks/s, output: 5.59 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:05<00:39,  5.66it/s, est. speed input: 5729.36 toks/s, output: 5.60 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:05<00:39,  5.68it/s, est. speed input: 5737.91 toks/s, output: 5.60 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:06<00:38,  5.70it/s, est. speed input: 5745.59 toks/s, output: 5.61 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:06<00:38,  5.67it/s, est. speed input: 5746.18 toks/s, output: 5.61 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:06<00:38,  5.69it/s, est. speed input: 5751.43 toks/s, output: 5.62 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:07<00:37,  5.69it/s, est. speed input: 5756.32 toks/s, output: 5.62 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:07<00:37,  5.68it/s, est. speed input: 5758.26 toks/s, output: 5.62 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:07<00:37,  5.71it/s, est. speed input: 5764.95 toks/s, output: 5.63 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:08<00:36,  5.70it/s, est. speed input: 5767.20 toks/s, output: 5.63 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:08<00:36,  5.67it/s, est. speed input: 5765.79 toks/s, output: 5.63 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:08<00:36,  5.68it/s, est. speed input: 5768.97 toks/s, output: 5.63 toks/s]
Processed prompts:  20%|██        | 52/256 [00:09<00:35,  5.69it/s, est. speed input: 5771.84 toks/s, output: 5.64 toks/s]
Processed prompts:  21%|██        | 54/256 [00:09<00:35,  5.66it/s, est. speed input: 5769.88 toks/s, output: 5.63 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:09<00:35,  5.68it/s, est. speed input: 5772.87 toks/s, output: 5.64 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:10<00:34,  5.69it/s, est. speed input: 5775.68 toks/s, output: 5.64 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:10<00:34,  5.67it/s, est. speed input: 5774.81 toks/s, output: 5.64 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:10<00:34,  5.67it/s, est. speed input: 5776.09 toks/s, output: 5.64 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:11<00:33,  5.68it/s, est. speed input: 5778.37 toks/s, output: 5.64 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:11<00:33,  5.66it/s, est. speed input: 5777.62 toks/s, output: 5.64 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:12<00:33,  5.66it/s, est. speed input: 5777.60 toks/s, output: 5.64 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:12<00:32,  5.66it/s, est. speed input: 5778.11 toks/s, output: 5.64 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:12<00:32,  5.66it/s, est. speed input: 5778.44 toks/s, output: 5.64 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:13<00:32,  5.66it/s, est. speed input: 5779.45 toks/s, output: 5.64 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:13<00:31,  5.66it/s, est. speed input: 5779.65 toks/s, output: 5.64 toks/s]
Processed prompts:  30%|███       | 78/256 [00:13<00:31,  5.65it/s, est. speed input: 5779.36 toks/s, output: 5.64 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:14<00:31,  5.65it/s, est. speed input: 5779.49 toks/s, output: 5.64 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:14<00:30,  5.65it/s, est. speed input: 5779.80 toks/s, output: 5.64 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:14<00:30,  5.64it/s, est. speed input: 5779.35 toks/s, output: 5.64 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:15<00:30,  5.66it/s, est. speed input: 5780.46 toks/s, output: 5.64 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:15<00:29,  5.66it/s, est. speed input: 5781.06 toks/s, output: 5.65 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:15<00:29,  5.66it/s, est. speed input: 5781.07 toks/s, output: 5.65 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:16<00:28,  5.67it/s, est. speed input: 5782.01 toks/s, output: 5.65 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:16<00:28,  5.66it/s, est. speed input: 5782.32 toks/s, output: 5.65 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:17<00:28,  5.64it/s, est. speed input: 5781.10 toks/s, output: 5.65 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:17<00:27,  5.65it/s, est. speed input: 5781.92 toks/s, output: 5.65 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:17<00:27,  5.66it/s, est. speed input: 5782.21 toks/s, output: 5.65 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:18<00:27,  5.64it/s, est. speed input: 5781.09 toks/s, output: 5.65 toks/s]
Processed prompts:  41%|████      | 104/256 [00:18<00:26,  5.64it/s, est. speed input: 5781.35 toks/s, output: 5.65 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:18<00:26,  5.65it/s, est. speed input: 5781.90 toks/s, output: 5.65 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:19<00:26,  5.64it/s, est. speed input: 5781.21 toks/s, output: 5.65 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:19<00:25,  5.65it/s, est. speed input: 5781.45 toks/s, output: 5.65 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:19<00:25,  5.66it/s, est. speed input: 5782.04 toks/s, output: 5.65 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:20<00:25,  5.63it/s, est. speed input: 5780.73 toks/s, output: 5.65 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:20<00:24,  5.64it/s, est. speed input: 5781.03 toks/s, output: 5.65 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:20<00:24,  5.65it/s, est. speed input: 5781.44 toks/s, output: 5.65 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:21<00:24,  5.63it/s, est. speed input: 5780.61 toks/s, output: 5.65 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:21<00:23,  5.64it/s, est. speed input: 5780.90 toks/s, output: 5.65 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:21<00:23,  5.64it/s, est. speed input: 5780.98 toks/s, output: 5.65 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:22<00:23,  5.63it/s, est. speed input: 5780.38 toks/s, output: 5.64 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:22<00:22,  5.65it/s, est. speed input: 5781.06 toks/s, output: 5.65 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:23<00:22,  5.65it/s, est. speed input: 5780.89 toks/s, output: 5.65 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:23<00:22,  5.63it/s, est. speed input: 5780.24 toks/s, output: 5.64 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:23<00:21,  5.64it/s, est. speed input: 5780.58 toks/s, output: 5.65 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:24<00:21,  5.65it/s, est. speed input: 5780.88 toks/s, output: 5.65 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:24<00:20,  5.64it/s, est. speed input: 5780.23 toks/s, output: 5.64 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:24<00:20,  5.65it/s, est. speed input: 5780.68 toks/s, output: 5.65 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:25<00:20,  5.65it/s, est. speed input: 5780.95 toks/s, output: 5.65 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:25<00:19,  5.64it/s, est. speed input: 5780.23 toks/s, output: 5.64 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:25<00:19,  5.64it/s, est. speed input: 5780.36 toks/s, output: 5.64 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:26<00:19,  5.65it/s, est. speed input: 5780.62 toks/s, output: 5.65 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:26<00:18,  5.63it/s, est. speed input: 5780.03 toks/s, output: 5.64 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:26<00:18,  5.64it/s, est. speed input: 5780.10 toks/s, output: 5.64 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:27<00:18,  5.65it/s, est. speed input: 5780.44 toks/s, output: 5.64 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:27<00:17,  5.64it/s, est. speed input: 5779.96 toks/s, output: 5.64 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:27<00:17,  5.64it/s, est. speed input: 5779.94 toks/s, output: 5.64 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:28<00:16,  5.65it/s, est. speed input: 5780.57 toks/s, output: 5.65 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:28<00:16,  5.63it/s, est. speed input: 5779.57 toks/s, output: 5.64 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:29<00:16,  5.65it/s, est. speed input: 5780.13 toks/s, output: 5.64 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:29<00:15,  5.65it/s, est. speed input: 5780.48 toks/s, output: 5.64 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:29<00:15,  5.63it/s, est. speed input: 5779.59 toks/s, output: 5.64 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:30<00:15,  5.64it/s, est. speed input: 5779.95 toks/s, output: 5.64 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:30<00:14,  5.65it/s, est. speed input: 5780.17 toks/s, output: 5.64 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:30<00:14,  5.63it/s, est. speed input: 5779.54 toks/s, output: 5.64 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:31<00:14,  5.64it/s, est. speed input: 5779.71 toks/s, output: 5.64 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:31<00:13,  5.65it/s, est. speed input: 5780.16 toks/s, output: 5.64 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:31<00:13,  5.63it/s, est. speed input: 5779.55 toks/s, output: 5.64 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:32<00:13,  5.64it/s, est. speed input: 5779.69 toks/s, output: 5.64 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:32<00:12,  5.65it/s, est. speed input: 5780.05 toks/s, output: 5.64 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:32<00:12,  5.63it/s, est. speed input: 5779.39 toks/s, output: 5.64 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:33<00:12,  5.61it/s, est. speed input: 5778.29 toks/s, output: 5.64 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:33<00:11,  5.60it/s, est. speed input: 5777.74 toks/s, output: 5.64 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:34<00:11,  5.60it/s, est. speed input: 5777.24 toks/s, output: 5.64 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:34<00:11,  5.61it/s, est. speed input: 5777.34 toks/s, output: 5.64 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:34<00:10,  5.64it/s, est. speed input: 5777.78 toks/s, output: 5.64 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:35<00:10,  5.62it/s, est. speed input: 5777.14 toks/s, output: 5.64 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:35<00:09,  5.63it/s, est. speed input: 5777.33 toks/s, output: 5.64 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:35<00:08,  6.36it/s, est. speed input: 5799.22 toks/s, output: 5.66 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:36<00:08,  6.10it/s, est. speed input: 5798.34 toks/s, output: 5.66 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:36<00:08,  5.97it/s, est. speed input: 5798.54 toks/s, output: 5.66 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:36<00:08,  5.88it/s, est. speed input: 5798.55 toks/s, output: 5.66 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:37<00:07,  5.79it/s, est. speed input: 5797.82 toks/s, output: 5.66 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:37<00:07,  5.75it/s, est. speed input: 5797.82 toks/s, output: 5.66 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:37<00:07,  5.74it/s, est. speed input: 5798.22 toks/s, output: 5.66 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:38<00:07,  5.69it/s, est. speed input: 5797.43 toks/s, output: 5.66 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:38<00:06,  5.68it/s, est. speed input: 5797.43 toks/s, output: 5.66 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:38<00:06,  5.68it/s, est. speed input: 5797.45 toks/s, output: 5.66 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:39<00:06,  5.64it/s, est. speed input: 5796.47 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:39<00:05,  5.64it/s, est. speed input: 5796.31 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:39<00:05,  5.64it/s, est. speed input: 5796.10 toks/s, output: 5.66 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:40<00:04,  5.63it/s, est. speed input: 5795.60 toks/s, output: 5.66 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:40<00:04,  5.64it/s, est. speed input: 5795.58 toks/s, output: 5.66 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:40<00:04,  5.65it/s, est. speed input: 5795.87 toks/s, output: 5.66 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:41<00:03,  5.63it/s, est. speed input: 5795.20 toks/s, output: 5.66 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:41<00:03,  5.63it/s, est. speed input: 5794.88 toks/s, output: 5.66 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:42<00:03,  5.63it/s, est. speed input: 5794.71 toks/s, output: 5.66 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:42<00:02,  5.62it/s, est. speed input: 5794.16 toks/s, output: 5.66 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:42<00:02,  5.63it/s, est. speed input: 5794.07 toks/s, output: 5.66 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:43<00:02,  5.63it/s, est. speed input: 5793.89 toks/s, output: 5.66 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:43<00:01,  5.61it/s, est. speed input: 5793.13 toks/s, output: 5.66 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:43<00:01,  5.63it/s, est. speed input: 5793.32 toks/s, output: 5.66 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:44<00:01,  5.64it/s, est. speed input: 5793.31 toks/s, output: 5.66 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:44<00:00,  5.63it/s, est. speed input: 5792.86 toks/s, output: 5.66 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:44<00:00,  5.64it/s, est. speed input: 5793.06 toks/s, output: 5.66 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:45<00:00,  6.64it/s, est. speed input: 5815.68 toks/s, output: 5.68 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:45<00:00,  6.64it/s, est. speed input: 5815.68 toks/s, output: 5.68 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:45<00:00,  5.68it/s, est. speed input: 5815.68 toks/s, output: 5.68 toks/s]
[rank0]:[W126 19:58:04.711062121 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 135.5s

测试结果:
  Requests/s:   5.60
  Tokens/s:     5738.76
  Total Reqs:   256
  Elapsed:      45.72s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     5733.16

============================================================
[4/8] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 19:58:14 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 19:58:14 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1678161) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1678161) WARNING 01-26 19:59:37 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.46 requests/s, 5593.37 total tokens/s, 5.46 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-26 19:58:14] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:58:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:58:14] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:58:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:58:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:58:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:58:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:58:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 19:58:18] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 19:58:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:58:18] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 19:58:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 19:58:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 19:58:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 19:58:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 19:58:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 19:58:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1678161) [2026-01-26 19:58:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1678161) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1678161) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.25s/it]
(EngineCore_DP0 pid=1678161) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.80s/it]
(EngineCore_DP0 pid=1678161) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.97s/it]
(EngineCore_DP0 pid=1678161) 
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1678161) [2026-01-26 19:59:28] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1678161) 2026-01-26 19:59:35,813 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1678161) 2026-01-26 19:59:36,020 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:   0%|          | 1/512 [00:01<10:08,  1.19s/it]
Adding requests:   0%|          | 2/512 [00:01<05:43,  1.49it/s]
Adding requests:   1%|          | 3/512 [00:01<03:42,  2.29it/s]
Adding requests:   1%|          | 4/512 [00:01<02:34,  3.28it/s]
Adding requests:   1%|          | 6/512 [00:01<01:34,  5.35it/s]
Adding requests:   2%|▏         | 8/512 [00:02<01:04,  7.77it/s]
Adding requests:   2%|▏         | 11/512 [00:02<00:42, 11.80it/s]
Adding requests:   3%|▎         | 14/512 [00:02<00:33, 14.75it/s]
Adding requests:   5%|▍         | 24/512 [00:02<00:14, 33.47it/s]
Adding requests:   8%|▊         | 39/512 [00:02<00:07, 60.59it/s]
Adding requests:  11%|█         | 57/512 [00:02<00:05, 89.44it/s]
Adding requests:  15%|█▍        | 75/512 [00:02<00:03, 112.65it/s]
Adding requests:  19%|█▉        | 99/512 [00:02<00:02, 147.03it/s]
Adding requests:  25%|██▌       | 128/512 [00:02<00:02, 184.95it/s]
Adding requests:  32%|███▏      | 163/512 [00:02<00:01, 230.96it/s]
Adding requests:  38%|███▊      | 196/512 [00:03<00:01, 259.13it/s]
Adding requests:  45%|████▍     | 229/512 [00:03<00:01, 278.80it/s]
Adding requests:  54%|█████▍    | 276/512 [00:03<00:00, 329.49it/s]
Adding requests:  62%|██████▏   | 316/512 [00:03<00:00, 348.41it/s]
Adding requests:  69%|██████▉   | 355/512 [00:03<00:00, 360.52it/s]
Adding requests:  77%|███████▋  | 394/512 [00:03<00:00, 367.15it/s]
Adding requests:  85%|████████▍ | 435/512 [00:03<00:00, 379.60it/s]
Adding requests:  93%|█████████▎| 478/512 [00:03<00:00, 392.28it/s]
Adding requests: 100%|██████████| 512/512 [00:03<00:00, 132.02it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 12/512 [00:00<00:10, 49.15it/s, est. speed input: 50331.06 toks/s, output: 49.15 toks/s]
Processed prompts:   3%|▎         | 17/512 [00:00<00:32, 15.12it/s, est. speed input: 18139.40 toks/s, output: 17.71 toks/s]
Processed prompts:   4%|▍         | 20/512 [00:01<00:53,  9.23it/s, est. speed input: 12190.54 toks/s, output: 11.90 toks/s]
Processed prompts:   5%|▍         | 24/512 [00:02<01:04,  7.62it/s, est. speed input: 10228.67 toks/s, output: 9.99 toks/s] 
Processed prompts:   5%|▌         | 28/512 [00:03<01:10,  6.85it/s, est. speed input: 9196.51 toks/s, output: 8.98 toks/s] 
Processed prompts:   6%|▋         | 32/512 [00:03<01:15,  6.39it/s, est. speed input: 8537.21 toks/s, output: 8.34 toks/s]
Processed prompts:   7%|▋         | 36/512 [00:04<01:17,  6.10it/s, est. speed input: 8083.50 toks/s, output: 7.89 toks/s]
Processed prompts:   8%|▊         | 40/512 [00:05<01:19,  5.94it/s, est. speed input: 7762.21 toks/s, output: 7.58 toks/s]
Processed prompts:   9%|▊         | 44/512 [00:05<01:20,  5.81it/s, est. speed input: 7511.95 toks/s, output: 7.34 toks/s]
Processed prompts:   9%|▉         | 48/512 [00:06<01:20,  5.73it/s, est. speed input: 7315.51 toks/s, output: 7.14 toks/s]
Processed prompts:  10%|█         | 52/512 [00:07<01:20,  5.68it/s, est. speed input: 7159.93 toks/s, output: 6.99 toks/s]
Processed prompts:  11%|█         | 56/512 [00:08<01:20,  5.63it/s, est. speed input: 7026.07 toks/s, output: 6.86 toks/s]
Processed prompts:  12%|█▏        | 60/512 [00:08<01:20,  5.61it/s, est. speed input: 6916.67 toks/s, output: 6.75 toks/s]
Processed prompts:  12%|█▎        | 64/512 [00:09<01:20,  5.60it/s, est. speed input: 6826.97 toks/s, output: 6.67 toks/s]
Processed prompts:  13%|█▎        | 68/512 [00:10<01:19,  5.58it/s, est. speed input: 6746.14 toks/s, output: 6.59 toks/s]
Processed prompts:  14%|█▍        | 72/512 [00:11<01:19,  5.56it/s, est. speed input: 6673.29 toks/s, output: 6.52 toks/s]
Processed prompts:  15%|█▍        | 76/512 [00:11<01:18,  5.56it/s, est. speed input: 6614.15 toks/s, output: 6.46 toks/s]
Processed prompts:  16%|█▌        | 80/512 [00:12<01:17,  5.55it/s, est. speed input: 6557.59 toks/s, output: 6.40 toks/s]
Processed prompts:  16%|█▋        | 84/512 [00:13<01:17,  5.54it/s, est. speed input: 6508.52 toks/s, output: 6.36 toks/s]
Processed prompts:  17%|█▋        | 88/512 [00:13<01:16,  5.55it/s, est. speed input: 6466.20 toks/s, output: 6.31 toks/s]
Processed prompts:  18%|█▊        | 92/512 [00:14<01:15,  5.54it/s, est. speed input: 6426.15 toks/s, output: 6.28 toks/s]
Processed prompts:  19%|█▉        | 96/512 [00:15<01:15,  5.54it/s, est. speed input: 6390.30 toks/s, output: 6.24 toks/s]
Processed prompts:  20%|█▉        | 100/512 [00:16<01:14,  5.54it/s, est. speed input: 6358.27 toks/s, output: 6.21 toks/s]
Processed prompts:  20%|██        | 104/512 [00:16<01:13,  5.55it/s, est. speed input: 6330.04 toks/s, output: 6.18 toks/s]
Processed prompts:  21%|██        | 108/512 [00:17<01:12,  5.54it/s, est. speed input: 6302.41 toks/s, output: 6.15 toks/s]
Processed prompts:  22%|██▏       | 112/512 [00:18<01:12,  5.52it/s, est. speed input: 6275.14 toks/s, output: 6.13 toks/s]
Processed prompts:  23%|██▎       | 116/512 [00:18<01:11,  5.54it/s, est. speed input: 6253.13 toks/s, output: 6.11 toks/s]
Processed prompts:  23%|██▎       | 120/512 [00:19<01:10,  5.53it/s, est. speed input: 6231.23 toks/s, output: 6.09 toks/s]
Processed prompts:  24%|██▍       | 124/512 [00:20<01:10,  5.52it/s, est. speed input: 6209.55 toks/s, output: 6.06 toks/s]
Processed prompts:  25%|██▌       | 128/512 [00:21<01:09,  5.53it/s, est. speed input: 6191.98 toks/s, output: 6.05 toks/s]
Processed prompts:  26%|██▌       | 132/512 [00:21<01:08,  5.53it/s, est. speed input: 6174.35 toks/s, output: 6.03 toks/s]
Processed prompts:  27%|██▋       | 136/512 [00:22<01:08,  5.53it/s, est. speed input: 6157.64 toks/s, output: 6.01 toks/s]
Processed prompts:  27%|██▋       | 140/512 [00:23<01:07,  5.53it/s, est. speed input: 6142.48 toks/s, output: 6.00 toks/s]
Processed prompts:  28%|██▊       | 144/512 [00:24<01:06,  5.52it/s, est. speed input: 6126.67 toks/s, output: 5.98 toks/s]
Processed prompts:  29%|██▉       | 148/512 [00:24<01:06,  5.51it/s, est. speed input: 6112.24 toks/s, output: 5.97 toks/s]
Processed prompts:  30%|██▉       | 152/512 [00:25<01:05,  5.52it/s, est. speed input: 6099.91 toks/s, output: 5.96 toks/s]
Processed prompts:  30%|███       | 156/512 [00:26<01:04,  5.53it/s, est. speed input: 6088.08 toks/s, output: 5.95 toks/s]
Processed prompts:  31%|███▏      | 160/512 [00:26<01:03,  5.52it/s, est. speed input: 6075.91 toks/s, output: 5.93 toks/s]
Processed prompts:  32%|███▏      | 164/512 [00:27<01:02,  5.53it/s, est. speed input: 6065.63 toks/s, output: 5.92 toks/s]
Processed prompts:  33%|███▎      | 168/512 [00:28<01:02,  5.53it/s, est. speed input: 6055.57 toks/s, output: 5.91 toks/s]
Processed prompts:  34%|███▎      | 172/512 [00:29<01:01,  5.53it/s, est. speed input: 6045.58 toks/s, output: 5.90 toks/s]
Processed prompts:  34%|███▍      | 176/512 [00:29<01:00,  5.53it/s, est. speed input: 6036.42 toks/s, output: 5.89 toks/s]
Processed prompts:  35%|███▌      | 180/512 [00:30<01:00,  5.53it/s, est. speed input: 6027.23 toks/s, output: 5.89 toks/s]
Processed prompts:  36%|███▌      | 184/512 [00:31<00:59,  5.52it/s, est. speed input: 6018.39 toks/s, output: 5.88 toks/s]
Processed prompts:  37%|███▋      | 188/512 [00:32<00:58,  5.49it/s, est. speed input: 6007.83 toks/s, output: 5.87 toks/s]
Processed prompts:  38%|███▊      | 192/512 [00:32<00:58,  5.51it/s, est. speed input: 6000.92 toks/s, output: 5.86 toks/s]
Processed prompts:  38%|███▊      | 196/512 [00:33<00:57,  5.52it/s, est. speed input: 5993.41 toks/s, output: 5.85 toks/s]
Processed prompts:  39%|███▉      | 200/512 [00:34<00:52,  5.91it/s, est. speed input: 6014.36 toks/s, output: 5.87 toks/s]
Processed prompts:  40%|███▉      | 204/512 [00:34<00:53,  5.78it/s, est. speed input: 6006.69 toks/s, output: 5.87 toks/s]
Processed prompts:  41%|████      | 208/512 [00:35<00:53,  5.69it/s, est. speed input: 5998.60 toks/s, output: 5.86 toks/s]
Processed prompts:  41%|████▏     | 212/512 [00:36<00:53,  5.65it/s, est. speed input: 5992.57 toks/s, output: 5.85 toks/s]
Processed prompts:  42%|████▏     | 216/512 [00:36<00:52,  5.61it/s, est. speed input: 5985.54 toks/s, output: 5.85 toks/s]
Processed prompts:  43%|████▎     | 220/512 [00:37<00:52,  5.58it/s, est. speed input: 5978.81 toks/s, output: 5.84 toks/s]
Processed prompts:  44%|████▍     | 224/512 [00:38<00:51,  5.57it/s, est. speed input: 5973.18 toks/s, output: 5.83 toks/s]
Processed prompts:  45%|████▍     | 228/512 [00:39<00:51,  5.55it/s, est. speed input: 5967.04 toks/s, output: 5.83 toks/s]
Processed prompts:  45%|████▌     | 232/512 [00:39<00:50,  5.52it/s, est. speed input: 5959.92 toks/s, output: 5.82 toks/s]
Processed prompts:  46%|████▌     | 236/512 [00:40<00:50,  5.51it/s, est. speed input: 5953.68 toks/s, output: 5.81 toks/s]
Processed prompts:  47%|████▋     | 240/512 [00:41<00:49,  5.52it/s, est. speed input: 5948.63 toks/s, output: 5.81 toks/s]
Processed prompts:  48%|████▊     | 244/512 [00:42<00:48,  5.50it/s, est. speed input: 5942.71 toks/s, output: 5.80 toks/s]
Processed prompts:  48%|████▊     | 248/512 [00:42<00:47,  5.50it/s, est. speed input: 5937.54 toks/s, output: 5.80 toks/s]
Processed prompts:  49%|████▉     | 252/512 [00:43<00:47,  5.51it/s, est. speed input: 5932.99 toks/s, output: 5.79 toks/s]
Processed prompts:  50%|█████     | 256/512 [00:44<00:46,  5.51it/s, est. speed input: 5928.24 toks/s, output: 5.79 toks/s]
Processed prompts:  51%|█████     | 260/512 [00:44<00:45,  5.51it/s, est. speed input: 5923.36 toks/s, output: 5.78 toks/s]
Processed prompts:  52%|█████▏    | 264/512 [00:45<00:44,  5.52it/s, est. speed input: 5919.49 toks/s, output: 5.78 toks/s]
Processed prompts:  52%|█████▏    | 268/512 [00:46<00:44,  5.51it/s, est. speed input: 5914.88 toks/s, output: 5.78 toks/s]
Processed prompts:  53%|█████▎    | 272/512 [00:47<00:43,  5.51it/s, est. speed input: 5910.52 toks/s, output: 5.77 toks/s]
Processed prompts:  54%|█████▍    | 276/512 [00:47<00:42,  5.52it/s, est. speed input: 5907.19 toks/s, output: 5.77 toks/s]
Processed prompts:  55%|█████▍    | 280/512 [00:48<00:42,  5.52it/s, est. speed input: 5903.11 toks/s, output: 5.76 toks/s]
Processed prompts:  55%|█████▌    | 284/512 [00:49<00:41,  5.51it/s, est. speed input: 5899.11 toks/s, output: 5.76 toks/s]
Processed prompts:  56%|█████▋    | 288/512 [00:50<00:40,  5.51it/s, est. speed input: 5895.38 toks/s, output: 5.76 toks/s]
Processed prompts:  57%|█████▋    | 292/512 [00:50<00:39,  5.51it/s, est. speed input: 5891.56 toks/s, output: 5.75 toks/s]
Processed prompts:  58%|█████▊    | 296/512 [00:51<00:39,  5.50it/s, est. speed input: 5887.85 toks/s, output: 5.75 toks/s]
Processed prompts:  59%|█████▊    | 300/512 [00:52<00:38,  5.51it/s, est. speed input: 5884.81 toks/s, output: 5.75 toks/s]
Processed prompts:  59%|█████▉    | 304/512 [00:52<00:35,  5.93it/s, est. speed input: 5900.50 toks/s, output: 5.76 toks/s]
Processed prompts:  60%|██████    | 308/512 [00:53<00:35,  5.80it/s, est. speed input: 5896.87 toks/s, output: 5.76 toks/s]
Processed prompts:  61%|██████    | 312/512 [00:54<00:35,  5.71it/s, est. speed input: 5893.74 toks/s, output: 5.76 toks/s]
Processed prompts:  62%|██████▏   | 316/512 [00:54<00:34,  5.64it/s, est. speed input: 5890.15 toks/s, output: 5.75 toks/s]
Processed prompts:  62%|██████▎   | 320/512 [00:55<00:34,  5.60it/s, est. speed input: 5886.61 toks/s, output: 5.75 toks/s]
Processed prompts:  63%|██████▎   | 324/512 [00:56<00:33,  5.58it/s, est. speed input: 5884.11 toks/s, output: 5.75 toks/s]
Processed prompts:  64%|██████▍   | 328/512 [00:57<00:33,  5.55it/s, est. speed input: 5880.70 toks/s, output: 5.74 toks/s]
Processed prompts:  65%|██████▍   | 332/512 [00:57<00:32,  5.54it/s, est. speed input: 5877.55 toks/s, output: 5.74 toks/s]
Processed prompts:  66%|██████▌   | 336/512 [00:58<00:31,  5.53it/s, est. speed input: 5874.73 toks/s, output: 5.74 toks/s]
Processed prompts:  66%|██████▋   | 340/512 [00:59<00:31,  5.52it/s, est. speed input: 5871.84 toks/s, output: 5.73 toks/s]
Processed prompts:  67%|██████▋   | 344/512 [01:00<00:30,  5.51it/s, est. speed input: 5868.81 toks/s, output: 5.73 toks/s]
Processed prompts:  68%|██████▊   | 348/512 [01:00<00:29,  5.52it/s, est. speed input: 5866.45 toks/s, output: 5.73 toks/s]
Processed prompts:  69%|██████▉   | 352/512 [01:01<00:29,  5.51it/s, est. speed input: 5863.52 toks/s, output: 5.73 toks/s]
Processed prompts:  70%|██████▉   | 356/512 [01:02<00:28,  5.50it/s, est. speed input: 5860.58 toks/s, output: 5.72 toks/s]
Processed prompts:  70%|███████   | 360/512 [01:02<00:27,  5.50it/s, est. speed input: 5857.94 toks/s, output: 5.72 toks/s]
Processed prompts:  71%|███████   | 364/512 [01:03<00:26,  5.51it/s, est. speed input: 5855.67 toks/s, output: 5.72 toks/s]
Processed prompts:  72%|███████▏  | 368/512 [01:04<00:26,  5.50it/s, est. speed input: 5852.92 toks/s, output: 5.72 toks/s]
Processed prompts:  73%|███████▎  | 372/512 [01:05<00:25,  5.50it/s, est. speed input: 5850.36 toks/s, output: 5.71 toks/s]
Processed prompts:  73%|███████▎  | 376/512 [01:05<00:24,  5.50it/s, est. speed input: 5848.10 toks/s, output: 5.71 toks/s]
Processed prompts:  74%|███████▍  | 380/512 [01:06<00:24,  5.50it/s, est. speed input: 5845.66 toks/s, output: 5.71 toks/s]
Processed prompts:  75%|███████▌  | 384/512 [01:07<00:23,  5.50it/s, est. speed input: 5843.18 toks/s, output: 5.71 toks/s]
Processed prompts:  76%|███████▌  | 388/512 [01:08<00:22,  5.51it/s, est. speed input: 5841.54 toks/s, output: 5.70 toks/s]
Processed prompts:  77%|███████▋  | 392/512 [01:08<00:21,  5.50it/s, est. speed input: 5839.11 toks/s, output: 5.70 toks/s]
Processed prompts:  77%|███████▋  | 396/512 [01:09<00:21,  5.49it/s, est. speed input: 5836.48 toks/s, output: 5.70 toks/s]
Processed prompts:  78%|███████▊  | 400/512 [01:10<00:20,  5.51it/s, est. speed input: 5834.91 toks/s, output: 5.70 toks/s]
Processed prompts:  79%|███████▉  | 404/512 [01:10<00:19,  5.49it/s, est. speed input: 5832.38 toks/s, output: 5.70 toks/s]
Processed prompts:  80%|███████▉  | 408/512 [01:11<00:18,  5.50it/s, est. speed input: 5830.54 toks/s, output: 5.69 toks/s]
Processed prompts:  80%|████████  | 412/512 [01:12<00:18,  5.51it/s, est. speed input: 5828.72 toks/s, output: 5.69 toks/s]
Processed prompts:  81%|████████▏ | 416/512 [01:13<00:17,  5.50it/s, est. speed input: 5826.62 toks/s, output: 5.69 toks/s]
Processed prompts:  82%|████████▏ | 420/512 [01:13<00:16,  5.49it/s, est. speed input: 5824.53 toks/s, output: 5.69 toks/s]
Processed prompts:  83%|████████▎ | 424/512 [01:14<00:15,  5.51it/s, est. speed input: 5823.11 toks/s, output: 5.69 toks/s]
Processed prompts:  84%|████████▎ | 428/512 [01:15<00:15,  5.51it/s, est. speed input: 5821.23 toks/s, output: 5.68 toks/s]
Processed prompts:  84%|████████▍ | 432/512 [01:16<00:14,  5.50it/s, est. speed input: 5819.25 toks/s, output: 5.68 toks/s]
Processed prompts:  85%|████████▌ | 436/512 [01:16<00:12,  5.94it/s, est. speed input: 5831.18 toks/s, output: 5.69 toks/s]
Processed prompts:  86%|████████▌ | 440/512 [01:17<00:12,  5.79it/s, est. speed input: 5828.95 toks/s, output: 5.69 toks/s]
Processed prompts:  87%|████████▋ | 444/512 [01:18<00:11,  5.69it/s, est. speed input: 5826.71 toks/s, output: 5.69 toks/s]
Processed prompts:  88%|████████▊ | 448/512 [01:18<00:11,  5.63it/s, est. speed input: 5824.96 toks/s, output: 5.69 toks/s]
Processed prompts:  88%|████████▊ | 452/512 [01:19<00:10,  5.58it/s, est. speed input: 5822.75 toks/s, output: 5.69 toks/s]
Processed prompts:  89%|████████▉ | 456/512 [01:20<00:10,  5.55it/s, est. speed input: 5821.06 toks/s, output: 5.68 toks/s]
Processed prompts:  90%|████████▉ | 460/512 [01:20<00:09,  5.54it/s, est. speed input: 5819.40 toks/s, output: 5.68 toks/s]
Processed prompts:  91%|█████████ | 464/512 [01:21<00:08,  5.53it/s, est. speed input: 5817.67 toks/s, output: 5.68 toks/s]
Processed prompts:  91%|█████████▏| 468/512 [01:22<00:07,  5.51it/s, est. speed input: 5815.91 toks/s, output: 5.68 toks/s]
Processed prompts:  92%|█████████▏| 472/512 [01:23<00:07,  5.51it/s, est. speed input: 5814.38 toks/s, output: 5.68 toks/s]
Processed prompts:  93%|█████████▎| 476/512 [01:23<00:06,  5.51it/s, est. speed input: 5812.76 toks/s, output: 5.68 toks/s]
Processed prompts:  94%|█████████▍| 480/512 [01:24<00:05,  5.50it/s, est. speed input: 5811.07 toks/s, output: 5.67 toks/s]
Processed prompts:  95%|█████████▍| 484/512 [01:25<00:05,  5.50it/s, est. speed input: 5809.58 toks/s, output: 5.67 toks/s]
Processed prompts:  95%|█████████▌| 488/512 [01:26<00:04,  5.51it/s, est. speed input: 5808.30 toks/s, output: 5.67 toks/s]
Processed prompts:  96%|█████████▌| 492/512 [01:26<00:03,  5.51it/s, est. speed input: 5806.81 toks/s, output: 5.67 toks/s]
Processed prompts:  97%|█████████▋| 496/512 [01:27<00:02,  5.50it/s, est. speed input: 5805.29 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 500/512 [01:28<00:02,  5.51it/s, est. speed input: 5804.01 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 504/512 [01:28<00:01,  5.50it/s, est. speed input: 5802.60 toks/s, output: 5.67 toks/s]
Processed prompts:  99%|█████████▉| 508/512 [01:29<00:00,  5.50it/s, est. speed input: 5801.13 toks/s, output: 5.67 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:29<00:00,  7.10it/s, est. speed input: 5834.97 toks/s, output: 5.70 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:29<00:00,  7.10it/s, est. speed input: 5834.97 toks/s, output: 5.70 toks/s]
Processed prompts: 100%|██████████| 512/512 [01:29<00:00,  5.70it/s, est. speed input: 5834.97 toks/s, output: 5.70 toks/s]
[rank0]:[W126 20:01:11.025078347 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 196.8s

测试结果:
  Requests/s:   5.46
  Tokens/s:     5593.37
  Total Reqs:   512
  Elapsed:      93.83s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     5587.92

============================================================
[5/8] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:01:31 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:01:31 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1681062) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1681062) WARNING 01-26 20:02:54 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.62 requests/s, 5758.16 total tokens/s, 5.62 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-26 20:01:31] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:01:31] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:01:31] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:31] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:01:31] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:01:31] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:01:31] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:01:31] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:01:31] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:01:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:01:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:01:34] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:01:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:01:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:01:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:01:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:01:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:01:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1681062) [2026-01-26 20:01:35] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1681062) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1681062) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.17s/it]
(EngineCore_DP0 pid=1681062) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.73s/it]
(EngineCore_DP0 pid=1681062) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.90s/it]
(EngineCore_DP0 pid=1681062) 
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1681062) [2026-01-26 20:02:44] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1681062) 2026-01-26 20:02:51,578 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1681062) 2026-01-26 20:02:52,093 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   4%|▍         | 44/1024 [00:00<00:02, 436.32it/s]
Adding requests:   9%|▊         | 88/1024 [00:00<00:02, 376.71it/s]
Adding requests:  13%|█▎        | 129/1024 [00:00<00:02, 390.30it/s]
Adding requests:  17%|█▋        | 169/1024 [00:00<00:02, 388.12it/s]
Adding requests:  21%|██        | 214/1024 [00:00<00:01, 409.10it/s]
Adding requests:  25%|██▌       | 256/1024 [00:00<00:01, 411.60it/s]
Adding requests:  29%|██▉       | 301/1024 [00:00<00:01, 422.41it/s]
Adding requests:  34%|███▍      | 346/1024 [00:00<00:01, 429.46it/s]
Adding requests:  38%|███▊      | 392/1024 [00:00<00:01, 438.60it/s]
Adding requests:  43%|████▎     | 437/1024 [00:01<00:01, 440.55it/s]
Adding requests:  47%|████▋     | 482/1024 [00:01<00:01, 428.46it/s]
Adding requests:  52%|█████▏    | 528/1024 [00:01<00:01, 437.51it/s]
Adding requests:  56%|█████▌    | 572/1024 [00:01<00:01, 413.68it/s]
Adding requests:  60%|█████▉    | 614/1024 [00:01<00:01, 408.66it/s]
Adding requests:  64%|██████▍   | 656/1024 [00:01<00:00, 399.02it/s]
Adding requests:  68%|██████▊   | 699/1024 [00:01<00:00, 406.35it/s]
Adding requests:  72%|███████▏  | 740/1024 [00:01<00:00, 403.00it/s]
Adding requests:  76%|███████▋  | 781/1024 [00:01<00:00, 398.06it/s]
Adding requests:  80%|████████  | 823/1024 [00:01<00:00, 402.03it/s]
Adding requests:  84%|████████▍ | 864/1024 [00:02<00:00, 397.04it/s]
Adding requests:  89%|████████▊ | 907/1024 [00:02<00:00, 402.49it/s]
Adding requests:  93%|█████████▎| 948/1024 [00:02<00:00, 398.57it/s]
Adding requests:  97%|█████████▋| 990/1024 [00:02<00:00, 404.69it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 410.31it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 10/1024 [00:00<01:03, 15.92it/s, est. speed input: 16304.17 toks/s, output: 15.92 toks/s]
Processed prompts:   2%|▏         | 18/1024 [00:02<02:04,  8.11it/s, est. speed input: 9039.95 toks/s, output: 8.83 toks/s]  
Processed prompts:   3%|▎         | 26/1024 [00:03<02:26,  6.83it/s, est. speed input: 7716.48 toks/s, output: 7.54 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:04<02:36,  6.33it/s, est. speed input: 7152.63 toks/s, output: 6.98 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:06<02:41,  6.07it/s, est. speed input: 6847.44 toks/s, output: 6.69 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:07<02:44,  5.93it/s, est. speed input: 6656.04 toks/s, output: 6.50 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:09<02:45,  5.84it/s, est. speed input: 6520.67 toks/s, output: 6.37 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:10<02:45,  5.78it/s, est. speed input: 6424.04 toks/s, output: 6.27 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:11<02:45,  5.74it/s, est. speed input: 6349.97 toks/s, output: 6.20 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:13<02:45,  5.71it/s, est. speed input: 6287.67 toks/s, output: 6.14 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:14<02:44,  5.69it/s, est. speed input: 6240.58 toks/s, output: 6.09 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:16<02:42,  5.69it/s, est. speed input: 6202.45 toks/s, output: 6.06 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:17<02:41,  5.68it/s, est. speed input: 6169.42 toks/s, output: 6.02 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:19<02:40,  5.67it/s, est. speed input: 6141.68 toks/s, output: 6.00 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:20<02:39,  5.66it/s, est. speed input: 6116.95 toks/s, output: 5.97 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:21<02:38,  5.65it/s, est. speed input: 6093.92 toks/s, output: 5.95 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:23<02:36,  5.65it/s, est. speed input: 6075.59 toks/s, output: 5.93 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:24<02:35,  5.64it/s, est. speed input: 6056.68 toks/s, output: 5.91 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:26<02:34,  5.62it/s, est. speed input: 6037.33 toks/s, output: 5.90 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:27<02:33,  5.62it/s, est. speed input: 6022.84 toks/s, output: 5.88 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:28<02:31,  5.63it/s, est. speed input: 6010.59 toks/s, output: 5.87 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:30<02:32,  5.54it/s, est. speed input: 5984.04 toks/s, output: 5.84 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:31<02:30,  5.56it/s, est. speed input: 5973.84 toks/s, output: 5.83 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:33<02:28,  5.58it/s, est. speed input: 5964.58 toks/s, output: 5.82 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:34<02:22,  5.76it/s, est. speed input: 5980.30 toks/s, output: 5.84 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:36<02:22,  5.72it/s, est. speed input: 5971.68 toks/s, output: 5.83 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:37<02:21,  5.69it/s, est. speed input: 5963.78 toks/s, output: 5.82 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:38<02:20,  5.66it/s, est. speed input: 5955.06 toks/s, output: 5.82 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:40<02:19,  5.65it/s, est. speed input: 5948.37 toks/s, output: 5.81 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:41<02:18,  5.64it/s, est. speed input: 5941.89 toks/s, output: 5.80 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:43<02:17,  5.63it/s, est. speed input: 5934.88 toks/s, output: 5.80 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:44<02:16,  5.62it/s, est. speed input: 5928.79 toks/s, output: 5.79 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:45<02:14,  5.62it/s, est. speed input: 5923.08 toks/s, output: 5.78 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:47<02:13,  5.61it/s, est. speed input: 5917.26 toks/s, output: 5.78 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:48<02:12,  5.61it/s, est. speed input: 5912.04 toks/s, output: 5.77 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:50<02:10,  5.61it/s, est. speed input: 5907.35 toks/s, output: 5.77 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:51<02:09,  5.61it/s, est. speed input: 5902.36 toks/s, output: 5.76 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:52<02:04,  5.79it/s, est. speed input: 5914.53 toks/s, output: 5.78 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:54<02:03,  5.73it/s, est. speed input: 5910.25 toks/s, output: 5.77 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:55<02:03,  5.69it/s, est. speed input: 5905.38 toks/s, output: 5.77 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:57<02:02,  5.67it/s, est. speed input: 5901.53 toks/s, output: 5.76 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:58<02:01,  5.65it/s, est. speed input: 5897.63 toks/s, output: 5.76 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [01:00<02:00,  5.63it/s, est. speed input: 5893.31 toks/s, output: 5.76 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [01:01<01:59,  5.62it/s, est. speed input: 5889.99 toks/s, output: 5.75 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [01:02<01:58,  5.61it/s, est. speed input: 5885.75 toks/s, output: 5.75 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [01:04<01:56,  5.60it/s, est. speed input: 5882.03 toks/s, output: 5.74 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [01:05<01:55,  5.61it/s, est. speed input: 5879.48 toks/s, output: 5.74 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [01:07<01:53,  5.61it/s, est. speed input: 5876.39 toks/s, output: 5.74 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [01:08<01:52,  5.60it/s, est. speed input: 5873.16 toks/s, output: 5.74 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [01:10<01:50,  5.60it/s, est. speed input: 5870.56 toks/s, output: 5.73 toks/s]
Processed prompts:  40%|████      | 410/1024 [01:11<01:49,  5.60it/s, est. speed input: 5867.98 toks/s, output: 5.73 toks/s]
Processed prompts:  41%|████      | 418/1024 [01:12<01:48,  5.60it/s, est. speed input: 5865.27 toks/s, output: 5.73 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [01:14<01:46,  5.60it/s, est. speed input: 5862.81 toks/s, output: 5.73 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [01:15<01:41,  5.79it/s, est. speed input: 5872.57 toks/s, output: 5.73 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [01:17<01:41,  5.73it/s, est. speed input: 5869.63 toks/s, output: 5.73 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [01:18<01:40,  5.69it/s, est. speed input: 5867.29 toks/s, output: 5.73 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [01:19<01:39,  5.67it/s, est. speed input: 5865.04 toks/s, output: 5.73 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [01:21<01:38,  5.64it/s, est. speed input: 5862.64 toks/s, output: 5.73 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [01:22<01:37,  5.64it/s, est. speed input: 5860.79 toks/s, output: 5.72 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [01:24<01:36,  5.62it/s, est. speed input: 5858.58 toks/s, output: 5.72 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [01:25<01:35,  5.61it/s, est. speed input: 5856.26 toks/s, output: 5.72 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [01:27<01:33,  5.61it/s, est. speed input: 5854.30 toks/s, output: 5.72 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [01:28<01:32,  5.61it/s, est. speed input: 5852.49 toks/s, output: 5.72 toks/s]
Processed prompts:  50%|█████     | 514/1024 [01:29<01:30,  5.61it/s, est. speed input: 5850.61 toks/s, output: 5.71 toks/s]
Processed prompts:  51%|█████     | 522/1024 [01:31<01:29,  5.60it/s, est. speed input: 5848.76 toks/s, output: 5.71 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [01:32<01:28,  5.60it/s, est. speed input: 5847.11 toks/s, output: 5.71 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [01:34<01:26,  5.60it/s, est. speed input: 5845.01 toks/s, output: 5.71 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [01:35<01:25,  5.59it/s, est. speed input: 5842.75 toks/s, output: 5.71 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [01:37<01:24,  5.59it/s, est. speed input: 5841.04 toks/s, output: 5.70 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [01:38<01:22,  5.59it/s, est. speed input: 5839.43 toks/s, output: 5.70 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [01:39<01:21,  5.59it/s, est. speed input: 5837.96 toks/s, output: 5.70 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [01:41<01:19,  5.59it/s, est. speed input: 5836.31 toks/s, output: 5.70 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [01:42<01:18,  5.60it/s, est. speed input: 5834.95 toks/s, output: 5.70 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [01:44<01:16,  5.60it/s, est. speed input: 5833.57 toks/s, output: 5.70 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [01:45<01:15,  5.59it/s, est. speed input: 5832.07 toks/s, output: 5.70 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [01:47<01:13,  5.60it/s, est. speed input: 5830.75 toks/s, output: 5.69 toks/s]
Processed prompts:  60%|██████    | 618/1024 [01:48<01:12,  5.60it/s, est. speed input: 5829.47 toks/s, output: 5.69 toks/s]
Processed prompts:  61%|██████    | 626/1024 [01:49<01:11,  5.59it/s, est. speed input: 5828.07 toks/s, output: 5.69 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [01:51<01:09,  5.59it/s, est. speed input: 5826.79 toks/s, output: 5.69 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [01:52<01:08,  5.60it/s, est. speed input: 5825.75 toks/s, output: 5.69 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [01:54<01:06,  5.60it/s, est. speed input: 5824.60 toks/s, output: 5.69 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [01:55<01:05,  5.60it/s, est. speed input: 5823.53 toks/s, output: 5.69 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [01:57<01:03,  5.60it/s, est. speed input: 5822.41 toks/s, output: 5.69 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [01:58<01:02,  5.60it/s, est. speed input: 5821.27 toks/s, output: 5.68 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [01:59<01:01,  5.60it/s, est. speed input: 5820.23 toks/s, output: 5.68 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [02:01<00:59,  5.60it/s, est. speed input: 5819.24 toks/s, output: 5.68 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [02:02<00:58,  5.59it/s, est. speed input: 5817.99 toks/s, output: 5.68 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [02:04<00:56,  5.60it/s, est. speed input: 5817.09 toks/s, output: 5.68 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [02:05<00:55,  5.60it/s, est. speed input: 5816.14 toks/s, output: 5.68 toks/s]
Processed prompts:  71%|███████   | 722/1024 [02:07<00:54,  5.58it/s, est. speed input: 5814.70 toks/s, output: 5.68 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [02:08<00:52,  5.59it/s, est. speed input: 5813.72 toks/s, output: 5.68 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [02:10<00:51,  5.59it/s, est. speed input: 5812.83 toks/s, output: 5.68 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [02:11<00:49,  5.59it/s, est. speed input: 5811.84 toks/s, output: 5.68 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [02:12<00:48,  5.59it/s, est. speed input: 5811.05 toks/s, output: 5.67 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [02:14<00:46,  5.60it/s, est. speed input: 5810.30 toks/s, output: 5.67 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [02:15<00:45,  5.59it/s, est. speed input: 5809.22 toks/s, output: 5.67 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [02:17<00:43,  5.60it/s, est. speed input: 5808.51 toks/s, output: 5.67 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [02:18<00:41,  5.79it/s, est. speed input: 5814.26 toks/s, output: 5.68 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [02:19<00:40,  5.72it/s, est. speed input: 5813.08 toks/s, output: 5.68 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [02:21<00:39,  5.68it/s, est. speed input: 5812.36 toks/s, output: 5.68 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [02:22<00:37,  5.66it/s, est. speed input: 5811.50 toks/s, output: 5.68 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [02:24<00:36,  5.63it/s, est. speed input: 5810.45 toks/s, output: 5.67 toks/s]
Processed prompts:  81%|████████  | 826/1024 [02:25<00:35,  5.62it/s, est. speed input: 5809.55 toks/s, output: 5.67 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [02:27<00:33,  5.61it/s, est. speed input: 5808.83 toks/s, output: 5.67 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [02:28<00:32,  5.60it/s, est. speed input: 5807.90 toks/s, output: 5.67 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [02:29<00:31,  5.60it/s, est. speed input: 5807.07 toks/s, output: 5.67 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [02:31<00:29,  5.59it/s, est. speed input: 5806.25 toks/s, output: 5.67 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [02:32<00:28,  5.59it/s, est. speed input: 5805.34 toks/s, output: 5.67 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [02:34<00:26,  5.59it/s, est. speed input: 5804.63 toks/s, output: 5.67 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [02:35<00:25,  5.59it/s, est. speed input: 5803.87 toks/s, output: 5.67 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [02:37<00:23,  5.59it/s, est. speed input: 5803.15 toks/s, output: 5.67 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [02:38<00:22,  5.59it/s, est. speed input: 5802.41 toks/s, output: 5.67 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [02:39<00:21,  5.58it/s, est. speed input: 5801.46 toks/s, output: 5.67 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [02:41<00:19,  5.59it/s, est. speed input: 5800.83 toks/s, output: 5.66 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [02:42<00:18,  5.59it/s, est. speed input: 5800.29 toks/s, output: 5.66 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [02:44<00:16,  5.59it/s, est. speed input: 5799.56 toks/s, output: 5.66 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [02:45<00:15,  5.59it/s, est. speed input: 5798.95 toks/s, output: 5.66 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [02:47<00:13,  5.59it/s, est. speed input: 5798.28 toks/s, output: 5.66 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [02:48<00:12,  5.59it/s, est. speed input: 5797.59 toks/s, output: 5.66 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [02:49<00:11,  5.59it/s, est. speed input: 5796.96 toks/s, output: 5.66 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [02:51<00:09,  5.59it/s, est. speed input: 5796.37 toks/s, output: 5.66 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [02:52<00:08,  5.59it/s, est. speed input: 5795.67 toks/s, output: 5.66 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [02:54<00:06,  5.58it/s, est. speed input: 5795.02 toks/s, output: 5.66 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [02:55<00:05,  5.59it/s, est. speed input: 5794.46 toks/s, output: 5.66 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [02:57<00:03,  5.59it/s, est. speed input: 5793.81 toks/s, output: 5.66 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [02:58<00:02,  5.59it/s, est. speed input: 5793.32 toks/s, output: 5.66 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [02:59<00:01,  5.80it/s, est. speed input: 5798.29 toks/s, output: 5.66 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:59<00:00,  5.80it/s, est. speed input: 5832.46 toks/s, output: 5.70 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [02:59<00:00,  5.70it/s, est. speed input: 5832.46 toks/s, output: 5.70 toks/s]
[rank0]:[W126 20:05:57.650075174 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 276.4s

测试结果:
  Requests/s:   5.62
  Tokens/s:     5758.16
  Total Reqs:   1024
  Elapsed:      182.28s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     5752.54

============================================================
[6/8] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:06:13 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:06:13 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1685129) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1685129) WARNING 01-26 20:07:40 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.61 requests/s, 5748.03 total tokens/s, 5.61 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-26 20:06:13] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:06:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:06:13] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:06:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:06:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:06:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:06:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:06:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:06:17] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:06:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:06:17] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:06:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:06:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:06:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:06:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:06:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:06:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1685129) [2026-01-26 20:06:18] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1685129) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1685129) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.57s/it]
(EngineCore_DP0 pid=1685129) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:08<00:00, 34.85s/it]
(EngineCore_DP0 pid=1685129) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:08<00:00, 34.06s/it]
(EngineCore_DP0 pid=1685129) 
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1685129) [2026-01-26 20:07:27] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1685129) 2026-01-26 20:07:36,064 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1685129) 2026-01-26 20:07:36,640 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 33/2048 [00:00<00:06, 325.83it/s]
Adding requests:   3%|▎         | 67/2048 [00:00<00:05, 331.07it/s]
Adding requests:   5%|▌         | 110/2048 [00:00<00:05, 373.48it/s]
Adding requests:   7%|▋         | 148/2048 [00:00<00:05, 375.26it/s]
Adding requests:   9%|▉         | 191/2048 [00:00<00:04, 393.33it/s]
Adding requests:  11%|█▏        | 234/2048 [00:00<00:04, 404.33it/s]
Adding requests:  13%|█▎        | 276/2048 [00:00<00:04, 408.45it/s]
Adding requests:  16%|█▌        | 322/2048 [00:00<00:04, 422.68it/s]
Adding requests:  18%|█▊        | 369/2048 [00:00<00:03, 434.27it/s]
Adding requests:  20%|██        | 413/2048 [00:01<00:03, 435.01it/s]
Adding requests:  22%|██▏       | 457/2048 [00:01<00:03, 427.89it/s]
Adding requests:  25%|██▍       | 502/2048 [00:01<00:03, 433.67it/s]
Adding requests:  27%|██▋       | 550/2048 [00:01<00:03, 445.19it/s]
Adding requests:  29%|██▉       | 595/2048 [00:01<00:03, 438.00it/s]
Adding requests:  31%|███       | 639/2048 [00:01<00:03, 431.97it/s]
Adding requests:  33%|███▎      | 683/2048 [00:01<00:03, 423.33it/s]
Adding requests:  35%|███▌      | 726/2048 [00:01<00:03, 425.14it/s]
Adding requests:  38%|███▊      | 769/2048 [00:01<00:03, 425.27it/s]
Adding requests:  40%|███▉      | 813/2048 [00:01<00:02, 426.04it/s]
Adding requests:  42%|████▏     | 856/2048 [00:02<00:02, 423.47it/s]
Adding requests:  44%|████▍     | 899/2048 [00:02<00:02, 423.99it/s]
Adding requests:  46%|████▌     | 942/2048 [00:02<00:02, 417.48it/s]
Adding requests:  48%|████▊     | 984/2048 [00:02<00:06, 152.88it/s]
Adding requests:  50%|█████     | 1024/2048 [00:03<00:05, 185.03it/s]
Adding requests:  52%|█████▏    | 1063/2048 [00:03<00:04, 216.87it/s]
Adding requests:  54%|█████▍    | 1103/2048 [00:03<00:03, 249.71it/s]
Adding requests:  56%|█████▌    | 1146/2048 [00:03<00:03, 285.88it/s]
Adding requests:  58%|█████▊    | 1188/2048 [00:03<00:02, 316.15it/s]
Adding requests:  60%|██████    | 1232/2048 [00:03<00:02, 345.35it/s]
Adding requests:  62%|██████▏   | 1274/2048 [00:03<00:02, 362.49it/s]
Adding requests:  64%|██████▍   | 1318/2048 [00:03<00:01, 382.49it/s]
Adding requests:  67%|██████▋   | 1363/2048 [00:03<00:01, 398.39it/s]
Adding requests:  69%|██████▊   | 1406/2048 [00:03<00:01, 405.59it/s]
Adding requests:  71%|███████   | 1449/2048 [00:04<00:01, 411.94it/s]
Adding requests:  73%|███████▎  | 1495/2048 [00:04<00:01, 424.64it/s]
Adding requests:  75%|███████▌  | 1539/2048 [00:04<00:01, 417.60it/s]
Adding requests:  77%|███████▋  | 1582/2048 [00:04<00:01, 414.49it/s]
Adding requests:  79%|███████▉  | 1624/2048 [00:04<00:01, 412.67it/s]
Adding requests:  81%|████████▏ | 1666/2048 [00:04<00:00, 402.44it/s]
Adding requests:  84%|████████▎ | 1711/2048 [00:04<00:00, 415.32it/s]
Adding requests:  86%|████████▌ | 1754/2048 [00:04<00:00, 417.92it/s]
Adding requests:  88%|████████▊ | 1798/2048 [00:04<00:00, 423.07it/s]
Adding requests:  90%|████████▉ | 1842/2048 [00:05<00:00, 425.11it/s]
Adding requests:  92%|█████████▏| 1887/2048 [00:05<00:00, 431.23it/s]
Adding requests:  94%|█████████▍| 1931/2048 [00:05<00:00, 432.38it/s]
Adding requests:  96%|█████████▋| 1975/2048 [00:05<00:00, 423.69it/s]
Adding requests:  99%|█████████▊| 2018/2048 [00:05<00:00, 418.82it/s]
Adding requests: 100%|██████████| 2048/2048 [00:05<00:00, 372.90it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 18/2048 [00:00<01:01, 33.25it/s, est. speed input: 34053.95 toks/s, output: 33.25 toks/s]
Processed prompts:   2%|▏         | 34/2048 [00:03<03:47,  8.87it/s, est. speed input: 10276.41 toks/s, output: 10.04 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:06<04:43,  7.06it/s, est. speed input: 8213.42 toks/s, output: 8.02 toks/s]  
Processed prompts:   3%|▎         | 66/2048 [00:09<05:09,  6.41it/s, est. speed input: 7435.61 toks/s, output: 7.26 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:11<05:22,  6.10it/s, est. speed input: 7028.36 toks/s, output: 6.86 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:14<05:29,  5.92it/s, est. speed input: 6779.91 toks/s, output: 6.62 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:17<05:33,  5.81it/s, est. speed input: 6607.67 toks/s, output: 6.45 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:20<05:34,  5.73it/s, est. speed input: 6482.64 toks/s, output: 6.33 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:23<05:34,  5.68it/s, est. speed input: 6387.63 toks/s, output: 6.24 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:26<05:33,  5.65it/s, est. speed input: 6314.31 toks/s, output: 6.17 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:29<05:32,  5.63it/s, est. speed input: 6255.01 toks/s, output: 6.11 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:31<05:24,  5.71it/s, est. speed input: 6238.38 toks/s, output: 6.09 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:34<05:24,  5.67it/s, est. speed input: 6194.38 toks/s, output: 6.05 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:37<05:23,  5.63it/s, est. speed input: 6155.70 toks/s, output: 6.01 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:40<05:21,  5.61it/s, est. speed input: 6122.22 toks/s, output: 5.98 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:43<05:20,  5.59it/s, est. speed input: 6093.35 toks/s, output: 5.95 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:46<05:17,  5.58it/s, est. speed input: 6067.48 toks/s, output: 5.93 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:49<05:16,  5.56it/s, est. speed input: 6042.94 toks/s, output: 5.90 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:51<05:07,  5.66it/s, est. speed input: 6042.61 toks/s, output: 5.90 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:54<05:07,  5.61it/s, est. speed input: 6021.59 toks/s, output: 5.88 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:57<05:05,  5.59it/s, est. speed input: 6004.73 toks/s, output: 5.86 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [01:00<05:03,  5.58it/s, est. speed input: 5989.33 toks/s, output: 5.85 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [01:03<05:01,  5.57it/s, est. speed input: 5974.48 toks/s, output: 5.83 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [01:06<04:58,  5.56it/s, est. speed input: 5961.72 toks/s, output: 5.82 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [01:09<04:56,  5.56it/s, est. speed input: 5950.23 toks/s, output: 5.81 toks/s]
Processed prompts:  20%|██        | 418/2048 [01:12<04:53,  5.55it/s, est. speed input: 5939.38 toks/s, output: 5.80 toks/s]
Processed prompts:  21%|██        | 434/2048 [01:14<04:44,  5.67it/s, est. speed input: 5944.69 toks/s, output: 5.81 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [01:17<04:43,  5.63it/s, est. speed input: 5935.08 toks/s, output: 5.80 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [01:20<04:42,  5.61it/s, est. speed input: 5926.42 toks/s, output: 5.79 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [01:23<04:40,  5.59it/s, est. speed input: 5917.65 toks/s, output: 5.78 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [01:26<04:37,  5.58it/s, est. speed input: 5909.68 toks/s, output: 5.77 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [01:29<04:35,  5.57it/s, est. speed input: 5902.24 toks/s, output: 5.76 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [01:32<04:32,  5.56it/s, est. speed input: 5895.29 toks/s, output: 5.76 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [01:34<04:30,  5.56it/s, est. speed input: 5888.79 toks/s, output: 5.75 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [01:37<04:27,  5.55it/s, est. speed input: 5882.59 toks/s, output: 5.74 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [01:40<04:24,  5.55it/s, est. speed input: 5876.80 toks/s, output: 5.74 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [01:43<04:22,  5.55it/s, est. speed input: 5871.22 toks/s, output: 5.73 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [01:46<04:19,  5.55it/s, est. speed input: 5865.85 toks/s, output: 5.73 toks/s]
Processed prompts:  31%|███       | 626/2048 [01:49<04:16,  5.54it/s, est. speed input: 5860.79 toks/s, output: 5.72 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [01:52<04:13,  5.54it/s, est. speed input: 5855.92 toks/s, output: 5.72 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [01:55<04:10,  5.54it/s, est. speed input: 5851.52 toks/s, output: 5.71 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [01:58<04:07,  5.54it/s, est. speed input: 5847.08 toks/s, output: 5.71 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [02:00<04:04,  5.55it/s, est. speed input: 5843.35 toks/s, output: 5.71 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [02:03<04:01,  5.55it/s, est. speed input: 5839.58 toks/s, output: 5.70 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [02:06<03:59,  5.55it/s, est. speed input: 5835.96 toks/s, output: 5.70 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [02:09<03:56,  5.55it/s, est. speed input: 5832.62 toks/s, output: 5.70 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [02:12<03:53,  5.55it/s, est. speed input: 5829.49 toks/s, output: 5.69 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [02:15<03:50,  5.55it/s, est. speed input: 5826.23 toks/s, output: 5.69 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [02:18<03:42,  5.67it/s, est. speed input: 5831.58 toks/s, output: 5.69 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [02:20<03:41,  5.63it/s, est. speed input: 5828.72 toks/s, output: 5.69 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [02:23<03:39,  5.61it/s, est. speed input: 5825.95 toks/s, output: 5.69 toks/s]
Processed prompts:  41%|████      | 834/2048 [02:26<03:37,  5.59it/s, est. speed input: 5823.25 toks/s, output: 5.69 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [02:29<03:34,  5.58it/s, est. speed input: 5820.61 toks/s, output: 5.68 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [02:32<03:32,  5.57it/s, est. speed input: 5817.86 toks/s, output: 5.68 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [02:35<03:29,  5.57it/s, est. speed input: 5815.55 toks/s, output: 5.68 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [02:38<03:26,  5.56it/s, est. speed input: 5813.05 toks/s, output: 5.68 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [02:41<03:23,  5.56it/s, est. speed input: 5810.94 toks/s, output: 5.67 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [02:43<03:21,  5.56it/s, est. speed input: 5808.83 toks/s, output: 5.67 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [02:46<03:18,  5.56it/s, est. speed input: 5806.73 toks/s, output: 5.67 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [02:49<03:15,  5.56it/s, est. speed input: 5804.94 toks/s, output: 5.67 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [02:52<03:12,  5.56it/s, est. speed input: 5803.03 toks/s, output: 5.67 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [02:55<03:09,  5.56it/s, est. speed input: 5801.09 toks/s, output: 5.67 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [02:58<03:06,  5.56it/s, est. speed input: 5799.34 toks/s, output: 5.66 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [03:01<03:03,  5.56it/s, est. speed input: 5797.68 toks/s, output: 5.66 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [03:04<03:00,  5.56it/s, est. speed input: 5796.11 toks/s, output: 5.66 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [03:06<02:58,  5.56it/s, est. speed input: 5794.51 toks/s, output: 5.66 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [03:09<02:55,  5.56it/s, est. speed input: 5793.02 toks/s, output: 5.66 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [03:12<02:52,  5.56it/s, est. speed input: 5791.48 toks/s, output: 5.66 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [03:15<02:49,  5.56it/s, est. speed input: 5789.94 toks/s, output: 5.65 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [03:18<02:46,  5.56it/s, est. speed input: 5788.54 toks/s, output: 5.65 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [03:21<02:43,  5.56it/s, est. speed input: 5787.21 toks/s, output: 5.65 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [03:24<02:40,  5.56it/s, est. speed input: 5785.81 toks/s, output: 5.65 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [03:27<02:37,  5.56it/s, est. speed input: 5784.47 toks/s, output: 5.65 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [03:29<02:35,  5.56it/s, est. speed input: 5783.32 toks/s, output: 5.65 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [03:32<02:29,  5.68it/s, est. speed input: 5787.42 toks/s, output: 5.65 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [03:35<02:27,  5.64it/s, est. speed input: 5786.27 toks/s, output: 5.65 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [03:38<02:21,  5.74it/s, est. speed input: 5790.36 toks/s, output: 5.65 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [03:41<02:20,  5.68it/s, est. speed input: 5789.07 toks/s, output: 5.65 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [03:43<02:18,  5.65it/s, est. speed input: 5787.88 toks/s, output: 5.65 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [03:46<02:16,  5.62it/s, est. speed input: 5786.77 toks/s, output: 5.65 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [03:49<02:13,  5.60it/s, est. speed input: 5785.56 toks/s, output: 5.65 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [03:52<02:11,  5.59it/s, est. speed input: 5784.30 toks/s, output: 5.65 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [03:55<02:06,  5.70it/s, est. speed input: 5788.11 toks/s, output: 5.65 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [03:58<02:04,  5.66it/s, est. speed input: 5786.95 toks/s, output: 5.65 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [04:01<02:01,  5.63it/s, est. speed input: 5785.81 toks/s, output: 5.65 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [04:03<01:59,  5.61it/s, est. speed input: 5784.82 toks/s, output: 5.65 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [04:06<01:56,  5.59it/s, est. speed input: 5783.63 toks/s, output: 5.65 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [04:09<01:54,  5.58it/s, est. speed input: 5782.67 toks/s, output: 5.65 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [04:12<01:51,  5.58it/s, est. speed input: 5781.67 toks/s, output: 5.65 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [04:15<01:46,  5.69it/s, est. speed input: 5785.07 toks/s, output: 5.65 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [04:17<01:42,  5.77it/s, est. speed input: 5788.50 toks/s, output: 5.65 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [04:20<01:40,  5.71it/s, est. speed input: 5787.54 toks/s, output: 5.65 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [04:23<01:38,  5.67it/s, est. speed input: 5786.64 toks/s, output: 5.65 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [04:26<01:36,  5.64it/s, est. speed input: 5785.69 toks/s, output: 5.65 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [04:29<01:31,  5.73it/s, est. speed input: 5789.02 toks/s, output: 5.65 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [04:32<01:29,  5.68it/s, est. speed input: 5788.03 toks/s, output: 5.65 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [04:34<01:25,  5.77it/s, est. speed input: 5791.28 toks/s, output: 5.66 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [04:37<01:23,  5.71it/s, est. speed input: 5790.32 toks/s, output: 5.65 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [04:40<01:21,  5.66it/s, est. speed input: 5789.27 toks/s, output: 5.65 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [04:43<01:19,  5.63it/s, est. speed input: 5788.31 toks/s, output: 5.65 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [04:46<01:15,  5.73it/s, est. speed input: 5791.43 toks/s, output: 5.66 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [04:48<01:12,  5.68it/s, est. speed input: 5790.39 toks/s, output: 5.65 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [04:51<01:10,  5.64it/s, est. speed input: 5789.50 toks/s, output: 5.65 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [04:54<01:07,  5.62it/s, est. speed input: 5788.69 toks/s, output: 5.65 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [04:57<01:05,  5.60it/s, est. speed input: 5787.71 toks/s, output: 5.65 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [05:00<01:02,  5.59it/s, est. speed input: 5786.81 toks/s, output: 5.65 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [05:03<00:59,  5.58it/s, est. speed input: 5785.99 toks/s, output: 5.65 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [05:06<00:55,  5.69it/s, est. speed input: 5788.83 toks/s, output: 5.65 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [05:08<00:51,  5.87it/s, est. speed input: 5794.47 toks/s, output: 5.66 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [05:11<00:49,  5.77it/s, est. speed input: 5793.59 toks/s, output: 5.66 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [05:14<00:47,  5.71it/s, est. speed input: 5792.69 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [05:17<00:44,  5.66it/s, est. speed input: 5791.84 toks/s, output: 5.66 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [05:20<00:42,  5.63it/s, est. speed input: 5791.01 toks/s, output: 5.66 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [05:22<00:39,  5.61it/s, est. speed input: 5790.11 toks/s, output: 5.65 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [05:25<00:36,  5.60it/s, est. speed input: 5789.33 toks/s, output: 5.65 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [05:28<00:34,  5.59it/s, est. speed input: 5788.51 toks/s, output: 5.65 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [05:31<00:31,  5.58it/s, est. speed input: 5787.69 toks/s, output: 5.65 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [05:34<00:27,  5.69it/s, est. speed input: 5790.39 toks/s, output: 5.65 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [05:37<00:25,  5.65it/s, est. speed input: 5789.58 toks/s, output: 5.65 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [05:39<00:22,  5.63it/s, est. speed input: 5788.78 toks/s, output: 5.65 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [05:42<00:19,  5.61it/s, est. speed input: 5788.02 toks/s, output: 5.65 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [05:45<00:16,  5.60it/s, est. speed input: 5787.32 toks/s, output: 5.65 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [05:48<00:13,  5.59it/s, est. speed input: 5786.57 toks/s, output: 5.65 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [05:51<00:10,  5.69it/s, est. speed input: 5789.02 toks/s, output: 5.65 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [05:54<00:08,  5.66it/s, est. speed input: 5788.32 toks/s, output: 5.65 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [05:57<00:05,  5.63it/s, est. speed input: 5787.57 toks/s, output: 5.65 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [05:59<00:02,  5.74it/s, est. speed input: 5790.27 toks/s, output: 5.65 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:59<00:00,  5.74it/s, est. speed input: 5830.12 toks/s, output: 5.69 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [05:59<00:00,  5.69it/s, est. speed input: 5830.12 toks/s, output: 5.69 toks/s]
[rank0]:[W126 20:13:46.183753696 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 468.1s

测试结果:
  Requests/s:   5.61
  Tokens/s:     5748.03
  Total Reqs:   2048
  Elapsed:      365.20s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     5742.42

============================================================
[7/8] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:14:08 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:14:08 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1691885) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1691885) WARNING 01-26 20:15:39 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 5.63 requests/s, 5772.71 total tokens/s, 5.63 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-26 20:14:08] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:14:08] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:14:08] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:08] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:14:08] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:14:08] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:14:08] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:14:08] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:14:08] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:14:12] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:14:12] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:14:12] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:14:12] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:14:12] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:14:12] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:14:12] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:14:12] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:14:12] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1691885) [2026-01-26 20:14:13] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1691885) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1691885) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:28<00:28, 28.87s/it]
(EngineCore_DP0 pid=1691885) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.38s/it]
(EngineCore_DP0 pid=1691885) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.55s/it]
(EngineCore_DP0 pid=1691885) 
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1691885) [2026-01-26 20:15:21] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1691885) 2026-01-26 20:15:32,465 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=1691885) 2026-01-26 20:15:33,637 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   0%|          | 17/4096 [00:00<00:24, 167.10it/s]
Adding requests:   1%|▏         | 53/4096 [00:00<00:14, 275.70it/s]
Adding requests:   2%|▏         | 92/4096 [00:00<00:12, 325.99it/s]
Adding requests:   3%|▎         | 131/4096 [00:00<00:11, 351.01it/s]
Adding requests:   4%|▍         | 169/4096 [00:00<00:10, 361.21it/s]
Adding requests:   5%|▌         | 214/4096 [00:00<00:09, 389.43it/s]
Adding requests:   6%|▌         | 253/4096 [00:00<00:09, 388.76it/s]
Adding requests:   7%|▋         | 295/4096 [00:00<00:09, 396.43it/s]
Adding requests:   8%|▊         | 335/4096 [00:00<00:09, 395.13it/s]
Adding requests:   9%|▉         | 378/4096 [00:01<00:09, 404.85it/s]
Adding requests:  10%|█         | 419/4096 [00:01<00:09, 405.83it/s]
Adding requests:  11%|█▏        | 462/4096 [00:01<00:08, 411.28it/s]
Adding requests:  12%|█▏        | 506/4096 [00:01<00:08, 419.31it/s]
Adding requests:  13%|█▎        | 552/4096 [00:01<00:08, 430.99it/s]
Adding requests:  15%|█▍        | 596/4096 [00:01<00:08, 423.36it/s]
Adding requests:  16%|█▌        | 639/4096 [00:01<00:08, 425.28it/s]
Adding requests:  17%|█▋        | 682/4096 [00:01<00:08, 414.48it/s]
Adding requests:  18%|█▊        | 726/4096 [00:01<00:08, 419.77it/s]
Adding requests:  19%|█▉        | 769/4096 [00:01<00:08, 403.92it/s]
Adding requests:  20%|█▉        | 815/4096 [00:02<00:07, 417.75it/s]
Adding requests:  21%|██        | 857/4096 [00:02<00:07, 408.49it/s]
Adding requests:  22%|██▏       | 905/4096 [00:02<00:07, 426.84it/s]
Adding requests:  23%|██▎       | 948/4096 [00:02<00:07, 405.13it/s]
Adding requests:  24%|██▍       | 993/4096 [00:02<00:07, 414.67it/s]
Adding requests:  25%|██▌       | 1035/4096 [00:02<00:07, 404.12it/s]
Adding requests:  26%|██▋       | 1078/4096 [00:02<00:07, 409.45it/s]
Adding requests:  27%|██▋       | 1120/4096 [00:02<00:07, 401.42it/s]
Adding requests:  28%|██▊       | 1163/4096 [00:02<00:07, 408.80it/s]
Adding requests:  29%|██▉       | 1205/4096 [00:03<00:07, 390.92it/s]
Adding requests:  30%|███       | 1246/4096 [00:03<00:07, 393.70it/s]
Adding requests:  31%|███▏      | 1287/4096 [00:03<00:07, 397.28it/s]
Adding requests:  32%|███▏      | 1329/4096 [00:03<00:06, 402.15it/s]
Adding requests:  33%|███▎      | 1372/4096 [00:03<00:06, 408.53it/s]
Adding requests:  34%|███▍      | 1413/4096 [00:03<00:06, 406.78it/s]
Adding requests:  36%|███▌      | 1456/4096 [00:03<00:06, 411.62it/s]
Adding requests:  37%|███▋      | 1498/4096 [00:03<00:06, 410.28it/s]
Adding requests:  38%|███▊      | 1540/4096 [00:03<00:06, 406.93it/s]
Adding requests:  39%|███▊      | 1581/4096 [00:03<00:06, 404.23it/s]
Adding requests:  40%|███▉      | 1622/4096 [00:04<00:06, 396.07it/s]
Adding requests:  41%|████      | 1662/4096 [00:04<00:06, 393.38it/s]
Adding requests:  42%|████▏     | 1705/4096 [00:04<00:05, 403.68it/s]
Adding requests:  43%|████▎     | 1747/4096 [00:04<00:05, 407.31it/s]
Adding requests:  44%|████▎     | 1791/4096 [00:04<00:05, 416.43it/s]
Adding requests:  45%|████▍     | 1833/4096 [00:04<00:05, 413.41it/s]
Adding requests:  46%|████▌     | 1876/4096 [00:04<00:05, 418.14it/s]
Adding requests:  47%|████▋     | 1918/4096 [00:04<00:05, 416.53it/s]
Adding requests:  48%|████▊     | 1962/4096 [00:04<00:05, 423.26it/s]
Adding requests:  49%|████▉     | 2005/4096 [00:04<00:05, 401.94it/s]
Adding requests:  50%|████▉     | 2047/4096 [00:05<00:05, 405.80it/s]
Adding requests:  51%|█████     | 2088/4096 [00:05<00:05, 388.88it/s]
Adding requests:  52%|█████▏    | 2135/4096 [00:05<00:04, 410.27it/s]
Adding requests:  53%|█████▎    | 2177/4096 [00:05<00:04, 396.71it/s]
Adding requests:  54%|█████▍    | 2222/4096 [00:05<00:04, 410.29it/s]
Adding requests:  55%|█████▌    | 2264/4096 [00:05<00:04, 397.61it/s]
Adding requests:  56%|█████▋    | 2310/4096 [00:05<00:04, 411.93it/s]
Adding requests:  57%|█████▋    | 2352/4096 [00:05<00:04, 412.67it/s]
Adding requests:  59%|█████▊    | 2398/4096 [00:05<00:04, 421.73it/s]
Adding requests:  60%|█████▉    | 2441/4096 [00:06<00:04, 387.62it/s]
Adding requests:  61%|██████    | 2482/4096 [00:06<00:04, 393.38it/s]
Adding requests:  62%|██████▏   | 2523/4096 [00:06<00:03, 396.75it/s]
Adding requests:  63%|██████▎   | 2571/4096 [00:06<00:03, 420.55it/s]
Adding requests:  64%|██████▍   | 2614/4096 [00:06<00:03, 412.27it/s]
Adding requests:  65%|██████▍   | 2658/4096 [00:06<00:03, 418.16it/s]
Adding requests:  66%|██████▌   | 2701/4096 [00:06<00:03, 411.08it/s]
Adding requests:  67%|██████▋   | 2745/4096 [00:06<00:03, 419.19it/s]
Adding requests:  68%|██████▊   | 2788/4096 [00:06<00:03, 419.40it/s]
Adding requests:  69%|██████▉   | 2833/4096 [00:06<00:02, 427.15it/s]
Adding requests:  70%|███████   | 2876/4096 [00:07<00:02, 415.94it/s]
Adding requests:  71%|███████   | 2918/4096 [00:07<00:02, 413.17it/s]
Adding requests:  72%|███████▏  | 2962/4096 [00:07<00:02, 419.61it/s]
Adding requests:  73%|███████▎  | 3006/4096 [00:07<00:02, 423.17it/s]
Adding requests:  74%|███████▍  | 3049/4096 [00:07<00:02, 419.51it/s]
Adding requests:  76%|███████▌  | 3094/4096 [00:07<00:02, 426.43it/s]
Adding requests:  77%|███████▋  | 3138/4096 [00:07<00:02, 429.98it/s]
Adding requests:  78%|███████▊  | 3182/4096 [00:07<00:02, 421.02it/s]
Adding requests:  79%|███████▉  | 3226/4096 [00:07<00:02, 426.34it/s]
Adding requests:  80%|███████▉  | 3269/4096 [00:08<00:01, 416.11it/s]
Adding requests:  81%|████████  | 3311/4096 [00:08<00:01, 404.97it/s]
Adding requests:  82%|████████▏ | 3352/4096 [00:08<00:01, 398.73it/s]
Adding requests:  83%|████████▎ | 3397/4096 [00:08<00:01, 411.48it/s]
Adding requests:  84%|████████▍ | 3439/4096 [00:08<00:01, 409.57it/s]
Adding requests:  85%|████████▌ | 3485/4096 [00:08<00:01, 421.09it/s]
Adding requests:  86%|████████▌ | 3528/4096 [00:08<00:01, 419.62it/s]
Adding requests:  87%|████████▋ | 3575/4096 [00:08<00:01, 433.58it/s]
Adding requests:  88%|████████▊ | 3619/4096 [00:08<00:01, 418.55it/s]
Adding requests:  90%|████████▉ | 3666/4096 [00:08<00:00, 433.10it/s]
Adding requests:  91%|█████████ | 3710/4096 [00:09<00:00, 410.26it/s]
Adding requests:  92%|█████████▏| 3754/4096 [00:09<00:00, 418.10it/s]
Adding requests:  93%|█████████▎| 3797/4096 [00:09<00:00, 406.94it/s]
Adding requests:  94%|█████████▎| 3838/4096 [00:09<00:00, 397.16it/s]
Adding requests:  95%|█████████▍| 3879/4096 [00:09<00:00, 399.37it/s]
Adding requests:  96%|█████████▌| 3921/4096 [00:09<00:00, 405.14it/s]
Adding requests:  97%|█████████▋| 3962/4096 [00:09<00:00, 406.09it/s]
Adding requests:  98%|█████████▊| 4006/4096 [00:09<00:00, 413.76it/s]
Adding requests:  99%|█████████▉| 4048/4096 [00:09<00:00, 404.85it/s]
Adding requests: 100%|█████████▉| 4092/4096 [00:10<00:00, 414.21it/s]
Adding requests: 100%|██████████| 4096/4096 [00:10<00:00, 407.60it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 34/4096 [00:01<03:20, 20.22it/s, est. speed input: 20706.25 toks/s, output: 20.22 toks/s]
Processed prompts:   2%|▏         | 66/4096 [00:07<08:15,  8.13it/s, est. speed input: 9168.49 toks/s, output: 8.95 toks/s]  
Processed prompts:   2%|▏         | 98/4096 [00:13<09:50,  6.77it/s, est. speed input: 7685.10 toks/s, output: 7.50 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:18<10:32,  6.27it/s, est. speed input: 7098.43 toks/s, output: 6.93 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:24<10:54,  6.01it/s, est. speed input: 6782.06 toks/s, output: 6.62 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:30<10:58,  5.93it/s, est. speed input: 6618.54 toks/s, output: 6.46 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:35<11:05,  5.81it/s, est. speed input: 6476.16 toks/s, output: 6.32 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:41<11:08,  5.74it/s, est. speed input: 6372.07 toks/s, output: 6.22 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:47<11:02,  5.75it/s, est. speed input: 6315.93 toks/s, output: 6.17 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:52<11:02,  5.70it/s, est. speed input: 6251.69 toks/s, output: 6.11 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:58<11:00,  5.66it/s, est. speed input: 6200.44 toks/s, output: 6.06 toks/s]
Processed prompts:   9%|▉         | 386/4096 [01:04<10:57,  5.64it/s, est. speed input: 6157.65 toks/s, output: 6.01 toks/s]
Processed prompts:  10%|█         | 418/4096 [01:09<10:48,  5.68it/s, est. speed input: 6136.62 toks/s, output: 5.99 toks/s]
Processed prompts:  11%|█         | 450/4096 [01:15<10:45,  5.65it/s, est. speed input: 6105.40 toks/s, output: 5.96 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [01:21<10:42,  5.63it/s, est. speed input: 6077.50 toks/s, output: 5.94 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [01:26<10:38,  5.61it/s, est. speed input: 6053.32 toks/s, output: 5.91 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [01:32<10:33,  5.60it/s, est. speed input: 6032.24 toks/s, output: 5.89 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [01:38<10:28,  5.60it/s, est. speed input: 6013.62 toks/s, output: 5.87 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [01:44<10:23,  5.59it/s, est. speed input: 5997.09 toks/s, output: 5.86 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [01:49<10:17,  5.59it/s, est. speed input: 5982.67 toks/s, output: 5.84 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [01:55<10:12,  5.59it/s, est. speed input: 5969.62 toks/s, output: 5.83 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [02:01<10:06,  5.59it/s, est. speed input: 5957.47 toks/s, output: 5.82 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [02:07<10:01,  5.58it/s, est. speed input: 5946.07 toks/s, output: 5.81 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [02:12<09:50,  5.63it/s, est. speed input: 5943.22 toks/s, output: 5.80 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [02:18<09:46,  5.61it/s, est. speed input: 5933.77 toks/s, output: 5.79 toks/s]
Processed prompts:  20%|██        | 834/4096 [02:24<09:42,  5.60it/s, est. speed input: 5925.09 toks/s, output: 5.79 toks/s]
Processed prompts:  21%|██        | 866/4096 [02:29<09:37,  5.60it/s, est. speed input: 5916.92 toks/s, output: 5.78 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [02:35<09:32,  5.59it/s, est. speed input: 5909.26 toks/s, output: 5.77 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [02:41<09:26,  5.58it/s, est. speed input: 5902.01 toks/s, output: 5.76 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [02:47<09:21,  5.58it/s, est. speed input: 5895.45 toks/s, output: 5.76 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [02:52<09:15,  5.58it/s, est. speed input: 5889.50 toks/s, output: 5.75 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [02:58<09:09,  5.58it/s, est. speed input: 5883.98 toks/s, output: 5.75 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [03:04<09:04,  5.58it/s, est. speed input: 5878.55 toks/s, output: 5.74 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [03:10<08:58,  5.58it/s, est. speed input: 5873.49 toks/s, output: 5.74 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [03:15<08:53,  5.58it/s, est. speed input: 5868.59 toks/s, output: 5.73 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [03:21<08:47,  5.58it/s, est. speed input: 5863.99 toks/s, output: 5.73 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [03:27<08:37,  5.63it/s, est. speed input: 5864.44 toks/s, output: 5.73 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [03:32<08:28,  5.66it/s, est. speed input: 5864.99 toks/s, output: 5.73 toks/s]
Processed prompts:  31%|███       | 1250/4096 [03:38<08:25,  5.63it/s, est. speed input: 5860.84 toks/s, output: 5.72 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [03:44<08:21,  5.62it/s, est. speed input: 5856.95 toks/s, output: 5.72 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [03:49<08:12,  5.65it/s, est. speed input: 5857.43 toks/s, output: 5.72 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [03:55<08:08,  5.63it/s, est. speed input: 5853.58 toks/s, output: 5.72 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [04:01<08:04,  5.61it/s, est. speed input: 5849.97 toks/s, output: 5.71 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [04:06<07:59,  5.60it/s, est. speed input: 5846.63 toks/s, output: 5.71 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [04:12<07:48,  5.66it/s, est. speed input: 5849.04 toks/s, output: 5.71 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [04:18<07:45,  5.63it/s, est. speed input: 5845.59 toks/s, output: 5.71 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [04:23<07:37,  5.66it/s, est. speed input: 5846.16 toks/s, output: 5.71 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [04:29<07:30,  5.68it/s, est. speed input: 5846.35 toks/s, output: 5.71 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [04:35<07:27,  5.64it/s, est. speed input: 5843.12 toks/s, output: 5.71 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [04:40<07:19,  5.67it/s, est. speed input: 5843.62 toks/s, output: 5.71 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [04:46<07:16,  5.64it/s, est. speed input: 5840.61 toks/s, output: 5.70 toks/s]
Processed prompts:  41%|████      | 1666/4096 [04:52<07:12,  5.62it/s, est. speed input: 5837.98 toks/s, output: 5.70 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [04:57<07:07,  5.60it/s, est. speed input: 5835.45 toks/s, output: 5.70 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [05:03<06:51,  5.75it/s, est. speed input: 5842.99 toks/s, output: 5.71 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [05:08<06:49,  5.70it/s, est. speed input: 5840.48 toks/s, output: 5.70 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [05:14<06:46,  5.66it/s, est. speed input: 5838.20 toks/s, output: 5.70 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [05:20<06:42,  5.64it/s, est. speed input: 5835.99 toks/s, output: 5.70 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [05:26<06:38,  5.62it/s, est. speed input: 5833.95 toks/s, output: 5.70 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [05:31<06:29,  5.66it/s, est. speed input: 5834.83 toks/s, output: 5.70 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [05:37<06:25,  5.64it/s, est. speed input: 5832.92 toks/s, output: 5.70 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [05:43<06:20,  5.62it/s, est. speed input: 5831.04 toks/s, output: 5.69 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [05:48<06:12,  5.66it/s, est. speed input: 5831.92 toks/s, output: 5.70 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [05:54<06:08,  5.64it/s, est. speed input: 5830.10 toks/s, output: 5.69 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [06:00<06:00,  5.67it/s, est. speed input: 5831.04 toks/s, output: 5.69 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [06:05<05:56,  5.64it/s, est. speed input: 5829.19 toks/s, output: 5.69 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [06:11<05:52,  5.63it/s, est. speed input: 5827.53 toks/s, output: 5.69 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [06:17<05:47,  5.61it/s, est. speed input: 5825.81 toks/s, output: 5.69 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [06:22<05:39,  5.65it/s, est. speed input: 5826.79 toks/s, output: 5.69 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [06:28<05:34,  5.64it/s, est. speed input: 5825.31 toks/s, output: 5.69 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [06:34<05:29,  5.62it/s, est. speed input: 5823.71 toks/s, output: 5.69 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [06:39<05:24,  5.61it/s, est. speed input: 5822.29 toks/s, output: 5.69 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [06:45<05:19,  5.61it/s, est. speed input: 5820.97 toks/s, output: 5.68 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [06:51<05:11,  5.65it/s, est. speed input: 5821.97 toks/s, output: 5.69 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [06:56<05:06,  5.63it/s, est. speed input: 5820.69 toks/s, output: 5.68 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [07:02<05:01,  5.62it/s, est. speed input: 5819.28 toks/s, output: 5.68 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [07:08<04:56,  5.61it/s, est. speed input: 5817.96 toks/s, output: 5.68 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [07:14<04:50,  5.60it/s, est. speed input: 5816.71 toks/s, output: 5.68 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [07:19<04:45,  5.60it/s, est. speed input: 5815.47 toks/s, output: 5.68 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [07:25<04:37,  5.65it/s, est. speed input: 5816.50 toks/s, output: 5.68 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [07:31<04:32,  5.63it/s, est. speed input: 5815.28 toks/s, output: 5.68 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [07:36<04:25,  5.66it/s, est. speed input: 5816.17 toks/s, output: 5.68 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [07:42<04:20,  5.64it/s, est. speed input: 5814.96 toks/s, output: 5.68 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [07:47<04:13,  5.68it/s, est. speed input: 5815.94 toks/s, output: 5.68 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [07:53<04:08,  5.65it/s, est. speed input: 5814.73 toks/s, output: 5.68 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [07:59<04:01,  5.68it/s, est. speed input: 5815.72 toks/s, output: 5.68 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [08:04<03:57,  5.65it/s, est. speed input: 5814.70 toks/s, output: 5.68 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [08:10<03:52,  5.64it/s, est. speed input: 5813.72 toks/s, output: 5.68 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [08:16<03:47,  5.62it/s, est. speed input: 5812.73 toks/s, output: 5.68 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [08:22<03:41,  5.61it/s, est. speed input: 5811.68 toks/s, output: 5.68 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [08:27<03:33,  5.69it/s, est. speed input: 5813.75 toks/s, output: 5.68 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [08:33<03:27,  5.71it/s, est. speed input: 5814.61 toks/s, output: 5.68 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [08:38<03:22,  5.67it/s, est. speed input: 5813.61 toks/s, output: 5.68 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [08:44<03:16,  5.70it/s, est. speed input: 5814.57 toks/s, output: 5.68 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [08:50<03:11,  5.67it/s, est. speed input: 5813.59 toks/s, output: 5.68 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [08:55<03:06,  5.64it/s, est. speed input: 5812.65 toks/s, output: 5.68 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [09:01<03:01,  5.63it/s, est. speed input: 5811.72 toks/s, output: 5.68 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [09:07<02:56,  5.62it/s, est. speed input: 5810.91 toks/s, output: 5.67 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [09:13<02:50,  5.61it/s, est. speed input: 5810.03 toks/s, output: 5.67 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [09:18<02:43,  5.66it/s, est. speed input: 5810.92 toks/s, output: 5.67 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [09:24<02:38,  5.63it/s, est. speed input: 5810.00 toks/s, output: 5.67 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [09:30<02:33,  5.62it/s, est. speed input: 5809.11 toks/s, output: 5.67 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [09:35<02:27,  5.61it/s, est. speed input: 5808.29 toks/s, output: 5.67 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [09:41<02:22,  5.60it/s, est. speed input: 5807.42 toks/s, output: 5.67 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [09:47<02:16,  5.60it/s, est. speed input: 5806.64 toks/s, output: 5.67 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [09:52<02:11,  5.60it/s, est. speed input: 5805.83 toks/s, output: 5.67 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [09:58<02:04,  5.65it/s, est. speed input: 5806.72 toks/s, output: 5.67 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [10:04<01:58,  5.63it/s, est. speed input: 5806.05 toks/s, output: 5.67 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [10:09<01:53,  5.62it/s, est. speed input: 5805.29 toks/s, output: 5.67 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [10:15<01:48,  5.61it/s, est. speed input: 5804.53 toks/s, output: 5.67 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [10:21<01:42,  5.60it/s, est. speed input: 5803.80 toks/s, output: 5.67 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [10:26<01:35,  5.65it/s, est. speed input: 5804.60 toks/s, output: 5.67 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [10:32<01:30,  5.63it/s, est. speed input: 5803.86 toks/s, output: 5.67 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [10:38<01:24,  5.67it/s, est. speed input: 5804.67 toks/s, output: 5.67 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [10:43<01:19,  5.64it/s, est. speed input: 5803.91 toks/s, output: 5.67 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [10:49<01:12,  5.71it/s, est. speed input: 5805.52 toks/s, output: 5.67 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [10:55<01:07,  5.67it/s, est. speed input: 5804.74 toks/s, output: 5.67 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [11:00<01:02,  5.64it/s, est. speed input: 5804.01 toks/s, output: 5.67 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [11:06<00:56,  5.63it/s, est. speed input: 5803.39 toks/s, output: 5.67 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [11:12<00:50,  5.62it/s, est. speed input: 5802.72 toks/s, output: 5.67 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [11:18<00:45,  5.61it/s, est. speed input: 5801.99 toks/s, output: 5.67 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [11:23<00:39,  5.60it/s, est. speed input: 5801.35 toks/s, output: 5.67 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [11:29<00:33,  5.65it/s, est. speed input: 5802.13 toks/s, output: 5.67 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [11:34<00:27,  5.68it/s, est. speed input: 5802.81 toks/s, output: 5.67 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [11:40<00:22,  5.65it/s, est. speed input: 5802.21 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [11:46<00:16,  5.68it/s, est. speed input: 5802.96 toks/s, output: 5.67 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [11:51<00:10,  5.70it/s, est. speed input: 5803.64 toks/s, output: 5.67 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [11:57<00:05,  5.75it/s, est. speed input: 5805.08 toks/s, output: 5.67 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:57<00:00,  5.75it/s, est. speed input: 5847.91 toks/s, output: 5.71 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [11:57<00:00,  5.71it/s, est. speed input: 5847.91 toks/s, output: 5.71 toks/s]
[rank0]:[W126 20:27:50.858829905 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 846.4s

测试结果:
  Requests/s:   5.63
  Tokens/s:     5772.71
  Total Reqs:   4096
  Elapsed:      727.28s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     5767.08

============================================================
[8/8] 测试 M=65536
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     Qwen2.5-7B-FP8                                  │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 65536
│   M_prefill     = 65536 (= 64 x 1024)
│   M_decode      = 64
│   batched_tokens = 65536 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 8192
│   --max-num-seqs           = 64
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 65536
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-26 20:28:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-26 20:28:27 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=1703877) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] EngineCore failed to start.
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] Traceback (most recent call last):
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     super().__init__(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     self.model_runner.profile_run()
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     outputs = self.model(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]               ^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     hidden_states = self.model(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._linear_fn(
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     return fn(input, L)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1703877) ERROR 01-26 20:29:42 [core.py:866] 


─── STDERR ───
[2026-01-26 20:28:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:28:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:28:27] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:28:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:28:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:28:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:28:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:28:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-26 20:28:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-26 20:28:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:28:30] INFO kernels.py:109: Loaded tuned kernel for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO kernels.py:224: FP8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO kernels.py:348: INT8 quant kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: Qwen2.5-7B-FP8
[2026-01-26 20:28:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'Qwen2.5-7B-FP8'
[2026-01-26 20:28:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-26 20:28:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-26 20:28:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-26 20:28:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-26 20:28:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: Qwen2.5-7B-FP8
(EngineCore_DP0 pid=1703877) [2026-01-26 20:28:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=1703877) 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
(EngineCore_DP0 pid=1703877) 
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:29<00:29, 29.24s/it]
(EngineCore_DP0 pid=1703877) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 34.76s/it]
(EngineCore_DP0 pid=1703877) 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:07<00:00, 33.93s/it]
(EngineCore_DP0 pid=1703877) 
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [4608, 5760] -> 1D uint8
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 5760] -> 1D uint8
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 12902400 bytes
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [37888, 5760] -> 1D uint8
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 136396800 bytes
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3584, 30336] -> 1D uint8
(EngineCore_DP0 pid=1703877) [2026-01-26 20:29:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 67952640 bytes
(EngineCore_DP0 pid=1703877) Process EngineCore_DP0:
(EngineCore_DP0 pid=1703877) Traceback (most recent call last):
(EngineCore_DP0 pid=1703877)   File "/usr/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
(EngineCore_DP0 pid=1703877)     self.run()
(EngineCore_DP0 pid=1703877)   File "/usr/lib/python3.12/multiprocessing/process.py", line 108, in run
(EngineCore_DP0 pid=1703877)     self._target(*self._args, **self._kwargs)
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/engine/core.py", line 870, in run_engine_core
(EngineCore_DP0 pid=1703877)     raise e
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/engine/core.py", line 857, in run_engine_core
(EngineCore_DP0 pid=1703877)     engine_core = EngineCoreProc(*args, **kwargs)
(EngineCore_DP0 pid=1703877)                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/engine/core.py", line 637, in __init__
(EngineCore_DP0 pid=1703877)     super().__init__(
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/engine/core.py", line 109, in __init__
(EngineCore_DP0 pid=1703877)     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
(EngineCore_DP0 pid=1703877)                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/engine/core.py", line 240, in _initialize_kv_caches
(EngineCore_DP0 pid=1703877)     available_gpu_memory = self.model_executor.determine_available_memory()
(EngineCore_DP0 pid=1703877)                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
(EngineCore_DP0 pid=1703877)     return self.collective_rpc("determine_available_memory")
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
(EngineCore_DP0 pid=1703877)     result = run_method(self.driver_worker, method, args, kwargs)
(EngineCore_DP0 pid=1703877)              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/serial_utils.py", line 461, in run_method
(EngineCore_DP0 pid=1703877)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1703877)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/worker/gpu_worker.py", line 340, in determine_available_memory
(EngineCore_DP0 pid=1703877)     self.model_runner.profile_run()
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4474, in profile_run
(EngineCore_DP0 pid=1703877)     hidden_states, last_hidden_states = self._dummy_run(
(EngineCore_DP0 pid=1703877)                                         ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py", line 120, in decorate_context
(EngineCore_DP0 pid=1703877)     return func(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/v1/worker/gpu_model_runner.py", line 4198, in _dummy_run
(EngineCore_DP0 pid=1703877)     outputs = self.model(
(EngineCore_DP0 pid=1703877)               ^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 583, in forward
(EngineCore_DP0 pid=1703877)     hidden_states = self.model(
(EngineCore_DP0 pid=1703877)                     ^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/compilation/decorators.py", line 372, in __call__
(EngineCore_DP0 pid=1703877)     return self.forward(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 442, in forward
(EngineCore_DP0 pid=1703877)     hidden_states, residual = layer(positions, hidden_states, residual)
(EngineCore_DP0 pid=1703877)                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 303, in forward
(EngineCore_DP0 pid=1703877)     hidden_states = self.mlp(hidden_states)
(EngineCore_DP0 pid=1703877)                     ^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/models/qwen2.py", line 108, in forward
(EngineCore_DP0 pid=1703877)     x, _ = self.down_proj(x)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
(EngineCore_DP0 pid=1703877)     return self._call_impl(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py", line 1786, in _call_impl
(EngineCore_DP0 pid=1703877)     return forward_call(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/layers/linear.py", line 1405, in forward
(EngineCore_DP0 pid=1703877)     output_parallel = self.quant_method.apply(self, input_parallel, bias_)
(EngineCore_DP0 pid=1703877)                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/vllm/model_executor/layers/quantization/compressed_tensors/compressed_tensors.py", line 957, in apply
(EngineCore_DP0 pid=1703877)     return scheme.apply_weights(layer, x, bias=bias)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 685, in apply_weights
(EngineCore_DP0 pid=1703877)     return self.slidesparse_fp8_linear.apply(
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 471, in apply
(EngineCore_DP0 pid=1703877)     return self._linear_fn(
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/core/SlideSparseLinearMethod_FP8.py", line 256, in cuSPARSELt_FP8_linear
(EngineCore_DP0 pid=1703877)     qinput, scale_a_pad = quant_slide_fp8_kernel(input, model_name, L)
(EngineCore_DP0 pid=1703877)                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/core/kernels.py", line 309, in quant_slide_fp8_kernel
(EngineCore_DP0 pid=1703877)     return torch.ops.slidesparse.quant_slide_fp8(input, model_name, L)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/usr/local/lib/python3.12/dist-packages/torch/_ops.py", line 1255, in __call__
(EngineCore_DP0 pid=1703877)     return self._op(*args, **kwargs)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/core/kernels.py", line 521, in _quant_slide_fp8_impl
(EngineCore_DP0 pid=1703877)     return fn(input, L)
(EngineCore_DP0 pid=1703877)            ^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877)   File "/root/vllmbench/slidesparse/csrc/fused_quant_slide_triton/build/GB10_cc121_py312_cu129_aarch64/quant_slide_tuned_Qwen2.5-7B.py", line 243, in quant_slide_fp8_triton
(EngineCore_DP0 pid=1703877)     out = torch.zeros(M_padded, K_out_padded, dtype=torch.float8_e4m3fn, device=x.device)
(EngineCore_DP0 pid=1703877)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
(EngineCore_DP0 pid=1703877) torch.AcceleratorError: CUDA error: an illegal memory access was encountered
(EngineCore_DP0 pid=1703877) Search for `cudaErrorIllegalAddress' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
(EngineCore_DP0 pid=1703877) CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
(EngineCore_DP0 pid=1703877) For debugging consider passing CUDA_LAUNCH_BLOCKING=1
(EngineCore_DP0 pid=1703877) Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
(EngineCore_DP0 pid=1703877) 
[rank0]:[W126 20:29:42.764946913 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "/usr/local/bin/vllm", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/root/vllmbench/vllm/entrypoints/cli/main.py", line 73, in main
    args.dispatch_function(args)
  File "/root/vllmbench/vllm/entrypoints/cli/benchmark/throughput.py", line 21, in cmd
    main(args)
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 730, in main
    elapsed_time, request_outputs = run_vllm(
                                    ^^^^^^^^^
  File "/root/vllmbench/vllm/benchmarks/throughput.py", line 51, in run_vllm
    llm = LLM(**dataclasses.asdict(engine_args))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/entrypoints/llm.py", line 351, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 183, in from_engine_args
    return cls(
           ^^^^
  File "/root/vllmbench/vllm/v1/engine/llm_engine.py", line 109, in __init__
    self.engine_core = EngineCoreClient.make_client(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 93, in make_client
    return SyncMPClient(vllm_config, executor_class, log_stats)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 648, in __init__
    super().__init__(
  File "/root/vllmbench/vllm/v1/engine/core_client.py", line 477, in __init__
    with launch_core_engines(vllm_config, executor_class, log_stats) as (
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 903, in launch_core_engines
    wait_for_engine_startup(
  File "/root/vllmbench/vllm/v1/engine/utils.py", line 960, in wait_for_engine_startup
    raise RuntimeError(
RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}

[ERROR] 测试失败: M=65536 (exit code: 1)


------------------------------------------------------------
  生成 CSV: Qwen2.5-7B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_10/Qwen2.5-7B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,10.1951,5230.0740,12.5551
1024,1024,1,128,128,5.6246,5765.2118,22.7572
2048,1024,2,256,128,5.5988,5738.7573,45.7242
4096,1024,4,512,128,5.4570,5593.3748,93.8253
8192,1024,8,1024,128,5.6177,5758.1614,182.2804
16384,1024,16,2048,128,5.6078,5748.0314,365.2033
32768,1024,32,4096,128,5.6319,5772.7132,727.2837
65536,1024,64,8192,128,-1.0000,-1.0000,-1.0000

------------------------------------------------------------

[INFO] 完成: 7 成功, 1 失败


============================================================
  Benchmark 完成!
============================================================


总计: 35 成功, 5 失败
============================================================
