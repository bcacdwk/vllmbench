======================================================================
SlideSparse vLLM Throughput Benchmark Log
Created: 2026-01-28 08:39:17
======================================================================

原始命令:
  /root/vllmbench/slidesparse/tools/throughput_benchmark.py --model bitnet1.58-2b-fp8 --backend cublaslt,cusparselt --stage prefill --sparsity 2_4,2_6,2_8,2_10 --M 512,1024,2048,4096,8192,16384,32768

命令行参数:
  --model: bitnet1.58-2b-fp8
  --backend: cublaslt,cusparselt
  --sparsity: 2_4,2_6,2_8,2_10
  --stage: prefill
  --M: 512,1024,2048,4096,8192,16384,32768
  --N: None
  --inner-32: False
  --eager: False
  --gpu-id: 0
  --gpu-mem: 0.8
  --dry-run: False
  --list-models: False

硬件信息:
  GPU: GB10
  Compute Capability: cc121
  VRAM: 119.7 GB
  CUDA: 12.9
  Python: py312

Backend 环境变量 (初始状态):
  DISABLE_SLIDESPARSE: 未设置
  USE_CUBLASLT: 未设置
  USE_CUSPARSELT: 未设置
  SPARSITY: 未设置
  INNER_DTYPE_32: 未设置

======================================================================


============================================================
  BitNet-2B-FP8 | cuBLASLt | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints/BitNet-2B-FP8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cublaslt

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:39:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:39:21 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3701590) WARNING 01-28 08:39:44 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 27.20 requests/s, 13952.68 total tokens/s, 27.20 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 08:39:21] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:39:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:39:21] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:39:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:39:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:39:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:39:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:39:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:39:24] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:39:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:39:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:39:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:39:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:39:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:39:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:39:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3701590) [2026-01-28 08:39:25] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3701590) [2026-01-28 08:39:25] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3701590) [2026-01-28 08:39:25] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3701590) [2026-01-28 08:39:25] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3701590) [2026-01-28 08:39:25] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3701590) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3701590) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:12<00:00, 12.21s/it]
(EngineCore_DP0 pid=3701590) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:12<00:00, 12.21s/it]
(EngineCore_DP0 pid=3701590) 
(EngineCore_DP0 pid=3701590) 2026-01-28 08:39:44,183 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3701590) 2026-01-28 08:39:44,200 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  87%|████████▋ | 111/128 [00:00<00:00, 1103.28it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1107.60it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 14.32it/s, est. speed input: 7332.14 toks/s, output: 14.32 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 16.50it/s, est. speed input: 8258.28 toks/s, output: 16.13 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:06, 18.99it/s, est. speed input: 9261.05 toks/s, output: 18.09 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 20.00it/s, est. speed input: 9714.44 toks/s, output: 18.97 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:05, 22.50it/s, est. speed input: 10496.67 toks/s, output: 20.50 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:04, 25.16it/s, est. speed input: 11339.97 toks/s, output: 22.15 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:04, 26.41it/s, est. speed input: 11785.95 toks/s, output: 23.02 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:00<00:03, 27.30it/s, est. speed input: 12135.05 toks/s, output: 23.70 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:03, 26.02it/s, est. speed input: 12124.31 toks/s, output: 23.68 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:04, 24.40it/s, est. speed input: 11989.80 toks/s, output: 23.42 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:01<00:03, 25.71it/s, est. speed input: 12220.89 toks/s, output: 23.87 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:03, 26.78it/s, est. speed input: 12427.64 toks/s, output: 24.27 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:01<00:03, 27.55it/s, est. speed input: 12605.02 toks/s, output: 24.62 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:01<00:03, 27.57it/s, est. speed input: 12706.39 toks/s, output: 24.82 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:01<00:02, 28.16it/s, est. speed input: 12847.87 toks/s, output: 25.09 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:02, 28.53it/s, est. speed input: 12969.71 toks/s, output: 25.33 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:01<00:02, 28.68it/s, est. speed input: 13070.22 toks/s, output: 25.53 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:02<00:02, 28.99it/s, est. speed input: 13175.67 toks/s, output: 25.73 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:02<00:02, 29.23it/s, est. speed input: 13272.75 toks/s, output: 25.92 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:02, 29.45it/s, est. speed input: 13364.52 toks/s, output: 26.10 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:02<00:02, 29.59it/s, est. speed input: 13447.48 toks/s, output: 26.26 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:02<00:02, 29.42it/s, est. speed input: 13507.24 toks/s, output: 26.38 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:01, 29.67it/s, est. speed input: 13604.96 toks/s, output: 26.57 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:01, 29.19it/s, est. speed input: 13634.29 toks/s, output: 26.63 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 29.57it/s, est. speed input: 13722.31 toks/s, output: 26.80 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:02<00:01, 29.66it/s, est. speed input: 13776.57 toks/s, output: 26.91 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:01, 29.69it/s, est. speed input: 13824.80 toks/s, output: 27.00 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:01, 29.70it/s, est. speed input: 13869.93 toks/s, output: 27.09 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:03<00:01, 29.77it/s, est. speed input: 13915.12 toks/s, output: 27.18 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:03<00:01, 29.74it/s, est. speed input: 13953.78 toks/s, output: 27.25 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:03<00:01, 29.73it/s, est. speed input: 13990.38 toks/s, output: 27.32 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:03<00:01, 29.65it/s, est. speed input: 14021.82 toks/s, output: 27.39 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:03<00:00, 29.71it/s, est. speed input: 14056.66 toks/s, output: 27.45 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:03<00:00, 29.29it/s, est. speed input: 14069.42 toks/s, output: 27.48 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:03<00:00, 29.37it/s, est. speed input: 14097.58 toks/s, output: 27.53 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:03<00:00, 29.60it/s, est. speed input: 14140.25 toks/s, output: 27.62 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:04<00:00, 29.54it/s, est. speed input: 14162.67 toks/s, output: 27.66 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:04<00:00, 29.41it/s, est. speed input: 14180.55 toks/s, output: 27.70 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:04<00:00, 29.76it/s, est. speed input: 14223.22 toks/s, output: 27.78 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:04<00:00, 29.75it/s, est. speed input: 14246.03 toks/s, output: 27.82 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:04<00:00, 29.73it/s, est. speed input: 14267.31 toks/s, output: 27.87 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 29.73it/s, est. speed input: 14278.95 toks/s, output: 27.89 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 27.89it/s, est. speed input: 14278.95 toks/s, output: 27.89 toks/s]
[rank0]:[W128 08:39:49.700412765 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 34.5s

测试结果:
  Requests/s:   27.20
  Tokens/s:     13952.68
  Total Reqs:   128
  Elapsed:      4.71s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     13925.48

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:39:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:39:56 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3702266) WARNING 01-28 08:40:18 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.70 requests/s, 16089.84 total tokens/s, 15.70 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 08:39:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:39:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:39:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:39:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:39:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:39:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:39:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:39:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:39:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:39:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:39:59] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:39:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:39:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:39:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:39:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:39:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:39:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3702266) [2026-01-28 08:40:00] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3702266) [2026-01-28 08:40:00] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3702266) [2026-01-28 08:40:00] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3702266) [2026-01-28 08:40:00] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3702266) [2026-01-28 08:40:00] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3702266) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3702266) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.78s/it]
(EngineCore_DP0 pid=3702266) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.78s/it]
(EngineCore_DP0 pid=3702266) 
(EngineCore_DP0 pid=3702266) 2026-01-28 08:40:18,276 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3702266) 2026-01-28 08:40:18,304 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  48%|████▊     | 61/128 [00:00<00:00, 599.05it/s]
Adding requests:  95%|█████████▍| 121/128 [00:00<00:00, 580.00it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 585.51it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:03, 39.72it/s, est. speed input: 40677.34 toks/s, output: 39.72 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 21.49it/s, est. speed input: 23637.10 toks/s, output: 23.08 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 16.29it/s, est. speed input: 18732.34 toks/s, output: 18.29 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 16.16it/s, est. speed input: 18285.66 toks/s, output: 17.86 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:06, 16.20it/s, est. speed input: 18058.97 toks/s, output: 17.64 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:06, 16.11it/s, est. speed input: 17829.28 toks/s, output: 17.41 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:06, 15.80it/s, est. speed input: 17543.17 toks/s, output: 17.13 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 15.80it/s, est. speed input: 17404.42 toks/s, output: 17.00 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 15.80it/s, est. speed input: 17289.29 toks/s, output: 16.88 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.84it/s, est. speed input: 17207.70 toks/s, output: 16.80 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.92it/s, est. speed input: 17153.72 toks/s, output: 16.75 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:06, 15.93it/s, est. speed input: 17095.57 toks/s, output: 16.69 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:06, 15.90it/s, est. speed input: 17034.18 toks/s, output: 16.63 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:05, 15.92it/s, est. speed input: 16991.56 toks/s, output: 16.59 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:05, 15.78it/s, est. speed input: 16919.66 toks/s, output: 16.52 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 15.96it/s, est. speed input: 16913.37 toks/s, output: 16.52 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 16.04it/s, est. speed input: 16897.84 toks/s, output: 16.50 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 16.04it/s, est. speed input: 16875.14 toks/s, output: 16.48 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 16.11it/s, est. speed input: 16865.45 toks/s, output: 16.47 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 16.08it/s, est. speed input: 16843.09 toks/s, output: 16.45 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:02<00:05, 16.00it/s, est. speed input: 16815.37 toks/s, output: 16.42 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:02<00:04, 16.00it/s, est. speed input: 16796.98 toks/s, output: 16.40 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 16.10it/s, est. speed input: 16794.06 toks/s, output: 16.40 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.80it/s, est. speed input: 16742.09 toks/s, output: 16.35 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.93it/s, est. speed input: 16737.70 toks/s, output: 16.35 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.88it/s, est. speed input: 16715.97 toks/s, output: 16.32 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.93it/s, est. speed input: 16706.09 toks/s, output: 16.31 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 16.05it/s, est. speed input: 16707.53 toks/s, output: 16.32 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:03<00:04, 15.97it/s, est. speed input: 16689.61 toks/s, output: 16.30 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:03<00:03, 15.97it/s, est. speed input: 16679.45 toks/s, output: 16.29 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 16.02it/s, est. speed input: 16674.88 toks/s, output: 16.28 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.77it/s, est. speed input: 16640.82 toks/s, output: 16.25 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.76it/s, est. speed input: 16625.18 toks/s, output: 16.24 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.75it/s, est. speed input: 16610.97 toks/s, output: 16.22 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 15.95it/s, est. speed input: 16616.17 toks/s, output: 16.23 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:04<00:03, 15.90it/s, est. speed input: 16604.72 toks/s, output: 16.22 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:04<00:03, 15.98it/s, est. speed input: 16602.88 toks/s, output: 16.21 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:04<00:02, 15.93it/s, est. speed input: 16593.12 toks/s, output: 16.20 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.93it/s, est. speed input: 16585.93 toks/s, output: 16.20 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.82it/s, est. speed input: 16569.92 toks/s, output: 16.18 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.99it/s, est. speed input: 16575.26 toks/s, output: 16.19 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 15.95it/s, est. speed input: 16567.40 toks/s, output: 16.18 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 16.00it/s, est. speed input: 16565.74 toks/s, output: 16.18 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:05<00:02, 15.98it/s, est. speed input: 16560.44 toks/s, output: 16.17 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:05<00:02, 16.03it/s, est. speed input: 16560.04 toks/s, output: 16.17 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:05<00:01, 16.09it/s, est. speed input: 16561.64 toks/s, output: 16.17 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 16.12it/s, est. speed input: 16561.81 toks/s, output: 16.17 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 16.14it/s, est. speed input: 16561.89 toks/s, output: 16.17 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 15.88it/s, est. speed input: 16543.42 toks/s, output: 16.16 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 15.82it/s, est. speed input: 16533.87 toks/s, output: 16.15 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 15.86it/s, est. speed input: 16530.26 toks/s, output: 16.14 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:06<00:01, 15.91it/s, est. speed input: 16527.97 toks/s, output: 16.14 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:06<00:01, 16.04it/s, est. speed input: 16532.13 toks/s, output: 16.14 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:06<00:00, 16.05it/s, est. speed input: 16530.56 toks/s, output: 16.14 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 16.06it/s, est. speed input: 16529.42 toks/s, output: 16.14 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 16.07it/s, est. speed input: 16528.56 toks/s, output: 16.14 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.91it/s, est. speed input: 16518.09 toks/s, output: 16.13 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 15.92it/s, est. speed input: 16514.64 toks/s, output: 16.13 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 16.06it/s, est. speed input: 16519.18 toks/s, output: 16.13 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:07<00:00, 16.04it/s, est. speed input: 16516.64 toks/s, output: 16.13 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:07<00:00, 16.02it/s, est. speed input: 16514.44 toks/s, output: 16.13 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.02it/s, est. speed input: 16519.61 toks/s, output: 16.13 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 16.13it/s, est. speed input: 16519.61 toks/s, output: 16.13 toks/s]
[rank0]:[W128 08:40:27.182358423 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 37.2s

测试结果:
  Requests/s:   15.70
  Tokens/s:     16089.84
  Total Reqs:   128
  Elapsed:      8.15s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     16074.14

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:40:33 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:40:33 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3702973) WARNING 01-28 08:40:56 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.64 requests/s, 17060.67 total tokens/s, 16.64 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 08:40:33] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:40:33] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:40:33] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:33] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:40:33] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:40:33] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:40:33] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:40:33] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:40:33] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:40:36] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:40:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:40:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:40:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:40:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:40:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:40:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:40:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:40:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3702973) [2026-01-28 08:40:37] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3702973) [2026-01-28 08:40:37] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3702973) [2026-01-28 08:40:37] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3702973) [2026-01-28 08:40:37] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3702973) [2026-01-28 08:40:37] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3702973) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3702973) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.65s/it]
(EngineCore_DP0 pid=3702973) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.65s/it]
(EngineCore_DP0 pid=3702973) 
(EngineCore_DP0 pid=3702973) 2026-01-28 08:40:55,388 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3702973) 2026-01-28 08:40:55,420 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  22%|██▏       | 57/256 [00:00<00:00, 566.72it/s]
Adding requests:  45%|████▍     | 114/256 [00:00<00:00, 559.13it/s]
Adding requests:  66%|██████▋   | 170/256 [00:00<00:00, 521.33it/s]
Adding requests:  88%|████████▊ | 226/256 [00:00<00:00, 532.58it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 541.55it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:00<00:06, 38.44it/s, est. speed input: 39372.67 toks/s, output: 38.44 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:09, 24.61it/s, est. speed input: 27155.37 toks/s, output: 26.52 toks/s]
Processed prompts:   6%|▌         | 15/256 [00:00<00:09, 24.87it/s, est. speed input: 26933.60 toks/s, output: 26.30 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:12, 19.28it/s, est. speed input: 22892.76 toks/s, output: 22.36 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:11, 20.79it/s, est. speed input: 23282.45 toks/s, output: 22.74 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:13, 17.38it/s, est. speed input: 21162.15 toks/s, output: 20.67 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:13, 17.28it/s, est. speed input: 20807.07 toks/s, output: 20.32 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:13, 17.15it/s, est. speed input: 20496.02 toks/s, output: 20.02 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:13, 16.94it/s, est. speed input: 20197.64 toks/s, output: 19.72 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:13, 16.91it/s, est. speed input: 19983.19 toks/s, output: 19.51 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:13, 16.89it/s, est. speed input: 19797.46 toks/s, output: 19.33 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:12, 16.95it/s, est. speed input: 19653.67 toks/s, output: 19.19 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:01<00:12, 16.85it/s, est. speed input: 19495.66 toks/s, output: 19.04 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:12, 16.80it/s, est. speed input: 19357.83 toks/s, output: 18.90 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:12, 16.89it/s, est. speed input: 19261.96 toks/s, output: 18.81 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:12, 16.98it/s, est. speed input: 19180.31 toks/s, output: 18.73 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:12, 16.95it/s, est. speed input: 19088.30 toks/s, output: 18.64 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:12, 16.68it/s, est. speed input: 18962.49 toks/s, output: 18.52 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:12, 16.83it/s, est. speed input: 18903.85 toks/s, output: 18.46 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:12, 16.94it/s, est. speed input: 18851.47 toks/s, output: 18.41 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:11, 16.95it/s, est. speed input: 18792.12 toks/s, output: 18.35 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:11, 16.97it/s, est. speed input: 18740.18 toks/s, output: 18.30 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:11, 16.95it/s, est. speed input: 18686.45 toks/s, output: 18.25 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:11, 16.99it/s, est. speed input: 18644.36 toks/s, output: 18.21 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:11, 16.96it/s, est. speed input: 18597.53 toks/s, output: 18.16 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:11, 16.80it/s, est. speed input: 18536.58 toks/s, output: 18.10 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:11, 16.71it/s, est. speed input: 18483.07 toks/s, output: 18.05 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:11, 16.83it/s, est. speed input: 18452.84 toks/s, output: 18.02 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:10, 16.93it/s, est. speed input: 18426.80 toks/s, output: 17.99 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:10, 16.96it/s, est. speed input: 18398.24 toks/s, output: 17.97 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:10, 16.87it/s, est. speed input: 18359.44 toks/s, output: 17.93 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:10, 16.97it/s, est. speed input: 18339.28 toks/s, output: 17.91 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:10, 17.06it/s, est. speed input: 18321.42 toks/s, output: 17.89 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:04<00:10, 16.92it/s, est. speed input: 18285.86 toks/s, output: 17.86 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:10, 16.68it/s, est. speed input: 18238.86 toks/s, output: 17.81 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:10, 16.71it/s, est. speed input: 18211.98 toks/s, output: 17.79 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:10, 16.76it/s, est. speed input: 18189.69 toks/s, output: 17.76 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:09, 16.89it/s, est. speed input: 18176.37 toks/s, output: 17.75 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:09, 16.91it/s, est. speed input: 18157.07 toks/s, output: 17.73 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:05<00:09, 16.89it/s, est. speed input: 18136.32 toks/s, output: 17.71 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:05<00:09, 16.95it/s, est. speed input: 18122.69 toks/s, output: 17.70 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:09, 16.99it/s, est. speed input: 18109.17 toks/s, output: 17.68 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:09, 16.95it/s, est. speed input: 18090.53 toks/s, output: 17.67 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:09, 16.69it/s, est. speed input: 18056.33 toks/s, output: 17.63 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:09, 16.69it/s, est. speed input: 18036.10 toks/s, output: 17.61 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:09, 16.75it/s, est. speed input: 18021.19 toks/s, output: 17.60 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:06<00:08, 16.76it/s, est. speed input: 18004.90 toks/s, output: 17.58 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:08, 16.87it/s, est. speed input: 17995.72 toks/s, output: 17.57 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:08, 16.82it/s, est. speed input: 17979.04 toks/s, output: 17.56 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:08, 16.85it/s, est. speed input: 17966.62 toks/s, output: 17.55 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:08, 16.87it/s, est. speed input: 17954.83 toks/s, output: 17.53 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:08, 16.82it/s, est. speed input: 17939.76 toks/s, output: 17.52 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:08, 16.63it/s, est. speed input: 17914.82 toks/s, output: 17.49 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:08, 16.63it/s, est. speed input: 17899.49 toks/s, output: 17.48 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:06<00:07, 16.79it/s, est. speed input: 17894.32 toks/s, output: 17.47 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:07, 16.79it/s, est. speed input: 17882.67 toks/s, output: 17.46 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:07, 16.84it/s, est. speed input: 17874.32 toks/s, output: 17.46 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:07, 16.89it/s, est. speed input: 17866.61 toks/s, output: 17.45 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:07<00:07, 16.83it/s, est. speed input: 17854.16 toks/s, output: 17.44 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:07, 16.80it/s, est. speed input: 17842.92 toks/s, output: 17.42 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:07, 16.95it/s, est. speed input: 17841.05 toks/s, output: 17.42 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:07, 16.63it/s, est. speed input: 17816.48 toks/s, output: 17.40 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:07<00:07, 16.65it/s, est. speed input: 17805.47 toks/s, output: 17.39 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:06, 16.70it/s, est. speed input: 17796.72 toks/s, output: 17.38 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:06, 16.80it/s, est. speed input: 17791.70 toks/s, output: 17.37 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:08<00:06, 16.89it/s, est. speed input: 17788.03 toks/s, output: 17.37 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:08<00:06, 16.86it/s, est. speed input: 17779.63 toks/s, output: 17.36 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:08<00:06, 16.93it/s, est. speed input: 17775.90 toks/s, output: 17.36 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:08<00:06, 16.99it/s, est. speed input: 17772.60 toks/s, output: 17.36 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:08<00:06, 16.98it/s, est. speed input: 17767.16 toks/s, output: 17.35 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:08<00:06, 16.68it/s, est. speed input: 17747.80 toks/s, output: 17.33 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:05, 16.73it/s, est. speed input: 17741.21 toks/s, output: 17.33 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:05, 16.66it/s, est. speed input: 17730.20 toks/s, output: 17.31 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:09<00:05, 16.84it/s, est. speed input: 17729.49 toks/s, output: 17.31 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:09<00:05, 16.81it/s, est. speed input: 17722.28 toks/s, output: 17.31 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:09<00:05, 16.81it/s, est. speed input: 17715.70 toks/s, output: 17.30 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:09<00:05, 16.81it/s, est. speed input: 17709.45 toks/s, output: 17.29 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:09<00:05, 16.87it/s, est. speed input: 17705.98 toks/s, output: 17.29 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:09<00:05, 16.71it/s, est. speed input: 17694.10 toks/s, output: 17.28 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:09<00:05, 16.60it/s, est. speed input: 17682.28 toks/s, output: 17.27 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:04, 16.68it/s, est. speed input: 17677.57 toks/s, output: 17.26 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:10<00:04, 16.79it/s, est. speed input: 17674.90 toks/s, output: 17.26 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:10<00:04, 16.81it/s, est. speed input: 17670.34 toks/s, output: 17.26 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:10<00:04, 16.77it/s, est. speed input: 17663.38 toks/s, output: 17.25 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:10<00:04, 16.78it/s, est. speed input: 17658.41 toks/s, output: 17.24 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:10<00:04, 16.81it/s, est. speed input: 17654.09 toks/s, output: 17.24 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:10<00:04, 16.81it/s, est. speed input: 17649.23 toks/s, output: 17.24 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:10<00:04, 16.65it/s, est. speed input: 17638.29 toks/s, output: 17.22 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:11<00:03, 16.62it/s, est. speed input: 17630.66 toks/s, output: 17.22 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:11<00:03, 16.72it/s, est. speed input: 17627.86 toks/s, output: 17.21 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:11<00:03, 16.78it/s, est. speed input: 17624.92 toks/s, output: 17.21 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:11<00:03, 16.87it/s, est. speed input: 17623.35 toks/s, output: 17.21 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:11<00:03, 16.93it/s, est. speed input: 17622.10 toks/s, output: 17.21 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:11<00:03, 16.84it/s, est. speed input: 17615.94 toks/s, output: 17.20 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:11<00:03, 16.81it/s, est. speed input: 17611.27 toks/s, output: 17.20 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:11<00:03, 16.87it/s, est. speed input: 17609.28 toks/s, output: 17.20 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:11<00:02, 16.68it/s, est. speed input: 17599.52 toks/s, output: 17.19 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:12<00:02, 16.73it/s, est. speed input: 17595.93 toks/s, output: 17.18 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:12<00:02, 16.77it/s, est. speed input: 17592.76 toks/s, output: 17.18 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:12<00:02, 16.74it/s, est. speed input: 17587.85 toks/s, output: 17.18 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:12<00:02, 16.82it/s, est. speed input: 17585.99 toks/s, output: 17.17 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:12<00:02, 16.81it/s, est. speed input: 17582.44 toks/s, output: 17.17 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:12<00:02, 16.83it/s, est. speed input: 17579.55 toks/s, output: 17.17 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:12<00:02, 16.78it/s, est. speed input: 17574.64 toks/s, output: 17.16 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:12<00:02, 16.81it/s, est. speed input: 17571.97 toks/s, output: 17.16 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:13<00:01, 16.64it/s, est. speed input: 17563.43 toks/s, output: 17.15 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:13<00:01, 16.69it/s, est. speed input: 17560.17 toks/s, output: 17.15 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:13<00:01, 16.84it/s, est. speed input: 17560.57 toks/s, output: 17.15 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:13<00:01, 16.88it/s, est. speed input: 17559.08 toks/s, output: 17.15 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:13<00:01, 16.89it/s, est. speed input: 17556.86 toks/s, output: 17.15 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:13<00:01, 16.93it/s, est. speed input: 17555.84 toks/s, output: 17.14 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:13<00:01, 16.96it/s, est. speed input: 17554.71 toks/s, output: 17.14 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:13<00:01, 16.91it/s, est. speed input: 17551.66 toks/s, output: 17.14 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:14<00:00, 16.80it/s, est. speed input: 17546.55 toks/s, output: 17.14 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:14<00:00, 16.51it/s, est. speed input: 17534.88 toks/s, output: 17.12 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:14<00:00, 16.55it/s, est. speed input: 17530.77 toks/s, output: 17.12 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:14<00:00, 16.70it/s, est. speed input: 17530.43 toks/s, output: 17.12 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:14<00:00, 16.72it/s, est. speed input: 17527.43 toks/s, output: 17.12 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:14<00:00, 16.70it/s, est. speed input: 17523.56 toks/s, output: 17.11 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:14<00:00, 16.77it/s, est. speed input: 17522.02 toks/s, output: 17.11 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:14<00:00, 16.85it/s, est. speed input: 17521.59 toks/s, output: 17.11 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:14<00:00, 16.85it/s, est. speed input: 17585.68 toks/s, output: 17.17 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:14<00:00, 17.17it/s, est. speed input: 17585.68 toks/s, output: 17.17 toks/s]
[rank0]:[W128 08:41:11.616965541 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 44.4s

测试结果:
  Requests/s:   16.64
  Tokens/s:     17060.67
  Total Reqs:   256
  Elapsed:      15.38s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     17044.02

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:41:18 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:41:18 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3703788) WARNING 01-28 08:41:41 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.17 requests/s, 16570.28 total tokens/s, 16.17 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 08:41:18] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:41:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:41:18] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:41:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:41:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:41:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:41:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:41:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:41:22] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:41:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:41:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:41:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:41:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:41:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:41:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:41:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:41:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3703788) [2026-01-28 08:41:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3703788) [2026-01-28 08:41:23] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3703788) [2026-01-28 08:41:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3703788) [2026-01-28 08:41:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3703788) [2026-01-28 08:41:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3703788) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3703788) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.55s/it]
(EngineCore_DP0 pid=3703788) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.55s/it]
(EngineCore_DP0 pid=3703788) 
(EngineCore_DP0 pid=3703788) 2026-01-28 08:41:40,714 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3703788) 2026-01-28 08:41:40,756 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  12%|█▏        | 60/512 [00:00<00:00, 593.72it/s]
Adding requests:  23%|██▎       | 120/512 [00:00<00:00, 556.74it/s]
Adding requests:  34%|███▍      | 176/512 [00:00<00:00, 531.52it/s]
Adding requests:  45%|████▍     | 230/512 [00:00<00:00, 532.45it/s]
Adding requests:  55%|█████▌    | 284/512 [00:00<00:00, 528.17it/s]
Adding requests:  66%|██████▌   | 338/512 [00:00<00:00, 529.72it/s]
Adding requests:  77%|███████▋  | 392/512 [00:00<00:00, 525.20it/s]
Adding requests:  87%|████████▋ | 445/512 [00:00<00:00, 524.65it/s]
Adding requests:  97%|█████████▋| 498/512 [00:00<00:00, 522.82it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 529.95it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:00<00:06, 77.27it/s, est. speed input: 79130.94 toks/s, output: 77.27 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:17, 28.51it/s, est. speed input: 33196.98 toks/s, output: 32.42 toks/s]
Processed prompts:   5%|▌         | 27/512 [00:00<00:19, 25.50it/s, est. speed input: 29849.62 toks/s, output: 29.15 toks/s]
Processed prompts:   6%|▌         | 31/512 [00:01<00:21, 22.31it/s, est. speed input: 27035.38 toks/s, output: 26.40 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:01<00:25, 19.00it/s, est. speed input: 24509.59 toks/s, output: 23.93 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:01<00:26, 18.08it/s, est. speed input: 23315.85 toks/s, output: 22.77 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:01<00:26, 17.43it/s, est. speed input: 22415.61 toks/s, output: 21.89 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:27, 16.99it/s, est. speed input: 21723.24 toks/s, output: 21.21 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:27, 16.84it/s, est. speed input: 21238.05 toks/s, output: 20.74 toks/s]
Processed prompts:  11%|█         | 54/512 [00:02<00:27, 16.67it/s, est. speed input: 20813.20 toks/s, output: 20.33 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:02<00:27, 16.42it/s, est. speed input: 20417.86 toks/s, output: 19.94 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:27, 16.35it/s, est. speed input: 20117.27 toks/s, output: 19.65 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:27, 16.38it/s, est. speed input: 19882.88 toks/s, output: 19.42 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:27, 16.36it/s, est. speed input: 19669.96 toks/s, output: 19.21 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:03<00:26, 16.23it/s, est. speed input: 19453.36 toks/s, output: 19.00 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:26, 16.25it/s, est. speed input: 19288.30 toks/s, output: 18.84 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:26, 16.25it/s, est. speed input: 19139.68 toks/s, output: 18.69 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:26, 16.24it/s, est. speed input: 19005.84 toks/s, output: 18.56 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:04<00:26, 16.17it/s, est. speed input: 18871.20 toks/s, output: 18.43 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:25, 16.16it/s, est. speed input: 18757.76 toks/s, output: 18.32 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:25, 16.20it/s, est. speed input: 18662.77 toks/s, output: 18.23 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:05<00:25, 16.19it/s, est. speed input: 18569.77 toks/s, output: 18.13 toks/s]
Processed prompts:  21%|██        | 106/512 [00:05<00:25, 16.23it/s, est. speed input: 18492.17 toks/s, output: 18.06 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:24, 16.10it/s, est. speed input: 18396.72 toks/s, output: 17.97 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:06<00:24, 16.11it/s, est. speed input: 18324.69 toks/s, output: 17.90 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:06<00:24, 16.16it/s, est. speed input: 18263.28 toks/s, output: 17.84 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:06<00:24, 16.23it/s, est. speed input: 18209.84 toks/s, output: 17.78 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:07<00:24, 16.08it/s, est. speed input: 18135.85 toks/s, output: 17.71 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:07<00:23, 16.17it/s, est. speed input: 18090.45 toks/s, output: 17.67 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:07<00:23, 16.14it/s, est. speed input: 18037.62 toks/s, output: 17.61 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:07<00:23, 16.18it/s, est. speed input: 17993.90 toks/s, output: 17.57 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:08<00:23, 16.06it/s, est. speed input: 17936.67 toks/s, output: 17.52 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:08<00:22, 16.12it/s, est. speed input: 17899.11 toks/s, output: 17.48 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:08<00:22, 16.18it/s, est. speed input: 17864.93 toks/s, output: 17.45 toks/s]
Processed prompts:  30%|███       | 154/512 [00:08<00:22, 16.23it/s, est. speed input: 17833.96 toks/s, output: 17.42 toks/s]
Processed prompts:  31%|███       | 158/512 [00:09<00:21, 16.10it/s, est. speed input: 17787.77 toks/s, output: 17.37 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:09<00:21, 16.17it/s, est. speed input: 17759.97 toks/s, output: 17.34 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:09<00:21, 16.25it/s, est. speed input: 17737.05 toks/s, output: 17.32 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:09<00:21, 16.23it/s, est. speed input: 17707.38 toks/s, output: 17.29 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:10<00:20, 16.24it/s, est. speed input: 17681.43 toks/s, output: 17.27 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:10<00:20, 16.13it/s, est. speed input: 17646.78 toks/s, output: 17.23 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:10<00:20, 16.16it/s, est. speed input: 17623.06 toks/s, output: 17.21 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:10<00:20, 16.22it/s, est. speed input: 17603.38 toks/s, output: 17.19 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:11<00:19, 16.19it/s, est. speed input: 17579.21 toks/s, output: 17.17 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:11<00:19, 16.11it/s, est. speed input: 17550.96 toks/s, output: 17.14 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:11<00:19, 16.13it/s, est. speed input: 17529.67 toks/s, output: 17.12 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:11<00:19, 16.13it/s, est. speed input: 17508.41 toks/s, output: 17.10 toks/s]
Processed prompts:  40%|████      | 206/512 [00:12<00:18, 16.17it/s, est. speed input: 17491.19 toks/s, output: 17.08 toks/s]
Processed prompts:  41%|████      | 210/512 [00:12<00:18, 16.11it/s, est. speed input: 17468.06 toks/s, output: 17.06 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:12<00:18, 16.10it/s, est. speed input: 17448.09 toks/s, output: 17.04 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:12<00:18, 16.15it/s, est. speed input: 17432.73 toks/s, output: 17.02 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:13<00:17, 16.24it/s, est. speed input: 17422.21 toks/s, output: 17.01 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:13<00:17, 16.20it/s, est. speed input: 17404.53 toks/s, output: 17.00 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:13<00:17, 16.15it/s, est. speed input: 17386.17 toks/s, output: 16.98 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:13<00:17, 16.16it/s, est. speed input: 17372.12 toks/s, output: 16.96 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:14<00:16, 16.13it/s, est. speed input: 17355.47 toks/s, output: 16.95 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:14<00:16, 16.19it/s, est. speed input: 17344.73 toks/s, output: 16.94 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:14<00:16, 16.09it/s, est. speed input: 17325.47 toks/s, output: 16.92 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:14<00:16, 16.17it/s, est. speed input: 17315.87 toks/s, output: 16.91 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:15<00:15, 16.14it/s, est. speed input: 17301.50 toks/s, output: 16.90 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:15<00:15, 16.18it/s, est. speed input: 17291.25 toks/s, output: 16.89 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:15<00:15, 16.05it/s, est. speed input: 17272.41 toks/s, output: 16.87 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:15<00:15, 16.09it/s, est. speed input: 17261.67 toks/s, output: 16.86 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:16<00:15, 16.10it/s, est. speed input: 17250.07 toks/s, output: 16.85 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:16<00:14, 16.14it/s, est. speed input: 17240.54 toks/s, output: 16.84 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:16<00:14, 16.11it/s, est. speed input: 17228.18 toks/s, output: 16.82 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:16<00:14, 16.12it/s, est. speed input: 17218.11 toks/s, output: 16.81 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:17<00:14, 16.14it/s, est. speed input: 17208.44 toks/s, output: 16.81 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:17<00:13, 16.15it/s, est. speed input: 17199.57 toks/s, output: 16.80 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:17<00:13, 16.17it/s, est. speed input: 17190.80 toks/s, output: 16.79 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:17<00:13, 16.07it/s, est. speed input: 17177.26 toks/s, output: 16.77 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:18<00:13, 16.11it/s, est. speed input: 17169.30 toks/s, output: 16.77 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:18<00:12, 16.13it/s, est. speed input: 17161.27 toks/s, output: 16.76 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:18<00:12, 16.19it/s, est. speed input: 17155.32 toks/s, output: 16.75 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:18<00:12, 16.10it/s, est. speed input: 17143.74 toks/s, output: 16.74 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:19<00:12, 16.14it/s, est. speed input: 17136.82 toks/s, output: 16.74 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:19<00:11, 16.18it/s, est. speed input: 17130.97 toks/s, output: 16.73 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:19<00:11, 16.20it/s, est. speed input: 17124.56 toks/s, output: 16.72 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:19<00:11, 16.08it/s, est. speed input: 17112.76 toks/s, output: 16.71 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:19<00:11, 16.14it/s, est. speed input: 17107.26 toks/s, output: 16.71 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:20<00:10, 16.22it/s, est. speed input: 17103.62 toks/s, output: 16.70 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:20<00:09, 17.36it/s, est. speed input: 17142.85 toks/s, output: 16.74 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:20<00:09, 17.03it/s, est. speed input: 17137.63 toks/s, output: 16.74 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:20<00:09, 16.68it/s, est. speed input: 17127.40 toks/s, output: 16.73 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:21<00:09, 16.57it/s, est. speed input: 17122.69 toks/s, output: 16.72 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:21<00:09, 16.47it/s, est. speed input: 17117.05 toks/s, output: 16.72 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:21<00:09, 16.38it/s, est. speed input: 17110.64 toks/s, output: 16.71 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:21<00:08, 16.23it/s, est. speed input: 17100.97 toks/s, output: 16.70 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:22<00:08, 16.25it/s, est. speed input: 17096.53 toks/s, output: 16.70 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:22<00:08, 16.21it/s, est. speed input: 17089.82 toks/s, output: 16.69 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:22<00:08, 16.19it/s, est. speed input: 17083.69 toks/s, output: 16.68 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:22<00:08, 16.05it/s, est. speed input: 17072.75 toks/s, output: 16.67 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:23<00:07, 16.10it/s, est. speed input: 17067.82 toks/s, output: 16.67 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:23<00:07, 16.13it/s, est. speed input: 17062.73 toks/s, output: 16.66 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:23<00:07, 16.16it/s, est. speed input: 17058.09 toks/s, output: 16.66 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:23<00:07, 16.07it/s, est. speed input: 17049.71 toks/s, output: 16.65 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:24<00:06, 16.10it/s, est. speed input: 17044.64 toks/s, output: 16.65 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:24<00:06, 16.15it/s, est. speed input: 17040.60 toks/s, output: 16.64 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:24<00:06, 16.12it/s, est. speed input: 17034.54 toks/s, output: 16.64 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:24<00:06, 16.13it/s, est. speed input: 17029.60 toks/s, output: 16.63 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:25<00:05, 16.04it/s, est. speed input: 17021.46 toks/s, output: 16.62 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:25<00:05, 16.14it/s, est. speed input: 17018.96 toks/s, output: 16.62 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:25<00:05, 16.17it/s, est. speed input: 17015.26 toks/s, output: 16.62 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:25<00:05, 16.18it/s, est. speed input: 17011.33 toks/s, output: 16.61 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:26<00:04, 16.04it/s, est. speed input: 17002.27 toks/s, output: 16.60 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:26<00:04, 16.09it/s, est. speed input: 16998.61 toks/s, output: 16.60 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:26<00:04, 16.16it/s, est. speed input: 16996.10 toks/s, output: 16.60 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:26<00:04, 16.16it/s, est. speed input: 16992.03 toks/s, output: 16.59 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:27<00:03, 17.44it/s, est. speed input: 17025.86 toks/s, output: 16.63 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:27<00:03, 17.05it/s, est. speed input: 17021.87 toks/s, output: 16.62 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:27<00:03, 16.76it/s, est. speed input: 17017.37 toks/s, output: 16.62 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:27<00:03, 16.57it/s, est. speed input: 17012.94 toks/s, output: 16.61 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:28<00:02, 16.50it/s, est. speed input: 17010.38 toks/s, output: 16.61 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:28<00:02, 16.31it/s, est. speed input: 17003.80 toks/s, output: 16.61 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:28<00:02, 16.31it/s, est. speed input: 17001.33 toks/s, output: 16.60 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:28<00:02, 16.32it/s, est. speed input: 16999.09 toks/s, output: 16.60 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:29<00:01, 16.33it/s, est. speed input: 16996.82 toks/s, output: 16.60 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:29<00:01, 16.25it/s, est. speed input: 16992.31 toks/s, output: 16.59 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:29<00:01, 16.24it/s, est. speed input: 16989.06 toks/s, output: 16.59 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:29<00:01, 16.24it/s, est. speed input: 16985.93 toks/s, output: 16.59 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:30<00:00, 16.31it/s, est. speed input: 16984.98 toks/s, output: 16.59 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:30<00:00, 16.17it/s, est. speed input: 16978.90 toks/s, output: 16.58 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:30<00:00, 16.17it/s, est. speed input: 16975.39 toks/s, output: 16.58 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:30<00:00, 17.59it/s, est. speed input: 17008.90 toks/s, output: 16.61 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:30<00:00, 17.59it/s, est. speed input: 17075.55 toks/s, output: 16.68 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:30<00:00, 16.68it/s, est. speed input: 17075.55 toks/s, output: 16.68 toks/s]
[rank0]:[W128 08:42:13.445482125 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 61.9s

测试结果:
  Requests/s:   16.17
  Tokens/s:     16570.28
  Total Reqs:   512
  Elapsed:      31.67s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     16554.12

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:42:21 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:42:22 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3704861) WARNING 01-28 08:42:45 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.75 requests/s, 16148.67 total tokens/s, 15.75 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 08:42:21] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:42:21] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:42:21] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:21] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:42:21] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:42:21] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:42:21] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:42:21] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:42:21] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:42:25] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:42:25] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:42:25] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:42:25] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:42:25] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:42:25] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:42:25] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:42:25] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:42:25] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3704861) [2026-01-28 08:42:26] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3704861) [2026-01-28 08:42:26] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3704861) [2026-01-28 08:42:26] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3704861) [2026-01-28 08:42:26] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3704861) [2026-01-28 08:42:26] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3704861) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3704861) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.66s/it]
(EngineCore_DP0 pid=3704861) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.66s/it]
(EngineCore_DP0 pid=3704861) 
(EngineCore_DP0 pid=3704861) 2026-01-28 08:42:44,170 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3704861) 2026-01-28 08:42:44,226 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 63/1024 [00:00<00:01, 627.94it/s]
Adding requests:  12%|█▏        | 126/1024 [00:00<00:01, 617.68it/s]
Adding requests:  18%|█▊        | 188/1024 [00:00<00:01, 557.55it/s]
Adding requests:  24%|██▍       | 245/1024 [00:00<00:01, 542.74it/s]
Adding requests:  29%|██▉       | 300/1024 [00:00<00:01, 526.04it/s]
Adding requests:  34%|███▍      | 353/1024 [00:00<00:01, 524.73it/s]
Adding requests:  40%|███▉      | 406/1024 [00:00<00:01, 513.08it/s]
Adding requests:  45%|████▍     | 458/1024 [00:00<00:01, 512.54it/s]
Adding requests:  50%|████▉     | 510/1024 [00:00<00:01, 508.30it/s]
Adding requests:  55%|█████▍    | 561/1024 [00:01<00:00, 489.10it/s]
Adding requests:  60%|█████▉    | 612/1024 [00:01<00:00, 493.52it/s]
Adding requests:  65%|██████▍   | 662/1024 [00:01<00:00, 486.19it/s]
Adding requests:  70%|██████▉   | 715/1024 [00:01<00:00, 498.01it/s]
Adding requests:  75%|███████▍  | 766/1024 [00:01<00:00, 499.24it/s]
Adding requests:  80%|███████▉  | 816/1024 [00:01<00:00, 495.51it/s]
Adding requests:  85%|████████▍ | 867/1024 [00:01<00:00, 497.89it/s]
Adding requests:  90%|████████▉ | 918/1024 [00:01<00:00, 499.83it/s]
Adding requests:  95%|█████████▍| 969/1024 [00:01<00:00, 501.66it/s]
Adding requests: 100%|█████████▉| 1022/1024 [00:01<00:00, 507.91it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 512.39it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:00<00:07, 138.75it/s, est. speed input: 142104.89 toks/s, output: 138.76 toks/s]
Processed prompts:   4%|▍         | 40/1024 [00:00<00:19, 50.48it/s, est. speed input: 59013.66 toks/s, output: 57.63 toks/s]   
Processed prompts:   5%|▍         | 48/1024 [00:01<00:30, 32.18it/s, est. speed input: 41079.16 toks/s, output: 40.12 toks/s]
Processed prompts:   5%|▌         | 53/1024 [00:01<00:43, 22.48it/s, est. speed input: 31820.96 toks/s, output: 31.08 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:02<00:54, 17.70it/s, est. speed input: 26873.70 toks/s, output: 26.24 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:02<00:56, 17.02it/s, est. speed input: 24872.89 toks/s, output: 24.29 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:03<00:57, 16.63it/s, est. speed input: 23519.33 toks/s, output: 22.97 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:03<00:57, 16.31it/s, est. speed input: 22492.78 toks/s, output: 21.97 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:04<00:57, 16.15it/s, est. speed input: 21738.97 toks/s, output: 21.23 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:57, 16.03it/s, est. speed input: 21142.07 toks/s, output: 20.65 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:05<00:57, 15.97it/s, est. speed input: 20669.45 toks/s, output: 20.18 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<00:56, 15.97it/s, est. speed input: 20294.10 toks/s, output: 19.82 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<00:56, 15.91it/s, est. speed input: 19957.45 toks/s, output: 19.49 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<00:56, 15.90it/s, est. speed input: 19682.99 toks/s, output: 19.22 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<00:55, 15.84it/s, est. speed input: 19430.95 toks/s, output: 18.98 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:07<00:55, 15.85it/s, est. speed input: 19224.09 toks/s, output: 18.77 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<00:55, 15.80it/s, est. speed input: 19030.43 toks/s, output: 18.58 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:08<00:54, 15.84it/s, est. speed input: 18874.21 toks/s, output: 18.43 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:09<00:54, 15.78it/s, est. speed input: 18716.71 toks/s, output: 18.28 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:09<00:53, 15.82it/s, est. speed input: 18592.12 toks/s, output: 18.16 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:10<00:53, 15.80it/s, est. speed input: 18471.90 toks/s, output: 18.04 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:10<00:52, 15.83it/s, est. speed input: 18369.65 toks/s, output: 17.94 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:11<00:52, 15.80it/s, est. speed input: 18268.42 toks/s, output: 17.84 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:11<00:51, 15.82it/s, est. speed input: 18182.59 toks/s, output: 17.76 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:12<00:51, 15.77it/s, est. speed input: 18093.25 toks/s, output: 17.67 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:12<00:50, 15.81it/s, est. speed input: 18022.67 toks/s, output: 17.60 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:13<00:50, 15.80it/s, est. speed input: 17951.15 toks/s, output: 17.53 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:13<00:49, 15.81it/s, est. speed input: 17888.61 toks/s, output: 17.47 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:14<00:49, 15.78it/s, est. speed input: 17824.08 toks/s, output: 17.41 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:14<00:48, 15.79it/s, est. speed input: 17768.60 toks/s, output: 17.35 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:15<00:48, 15.76it/s, est. speed input: 17712.27 toks/s, output: 17.30 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:15<00:47, 15.77it/s, est. speed input: 17663.20 toks/s, output: 17.25 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:16<00:47, 15.73it/s, est. speed input: 17611.99 toks/s, output: 17.20 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:16<00:46, 15.74it/s, est. speed input: 17567.90 toks/s, output: 17.16 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:17<00:46, 15.76it/s, est. speed input: 17527.41 toks/s, output: 17.12 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:17<00:45, 15.72it/s, est. speed input: 17483.88 toks/s, output: 17.07 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:18<00:45, 15.74it/s, est. speed input: 17447.71 toks/s, output: 17.04 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:18<00:44, 15.71it/s, est. speed input: 17408.56 toks/s, output: 17.00 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:19<00:44, 15.74it/s, est. speed input: 17377.41 toks/s, output: 16.97 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:19<00:42, 16.24it/s, est. speed input: 17391.05 toks/s, output: 16.98 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:20<00:42, 16.12it/s, est. speed input: 17362.37 toks/s, output: 16.96 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:20<00:41, 15.98it/s, est. speed input: 17330.14 toks/s, output: 16.92 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:21<00:41, 15.94it/s, est. speed input: 17303.59 toks/s, output: 16.90 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:21<00:41, 15.87it/s, est. speed input: 17275.16 toks/s, output: 16.87 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:22<00:40, 15.85it/s, est. speed input: 17250.41 toks/s, output: 16.85 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:22<00:40, 15.78it/s, est. speed input: 17223.01 toks/s, output: 16.82 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:23<00:39, 15.80it/s, est. speed input: 17201.22 toks/s, output: 16.80 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:23<00:39, 15.76it/s, est. speed input: 17176.65 toks/s, output: 16.77 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:24<00:38, 15.76it/s, est. speed input: 17155.31 toks/s, output: 16.75 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:24<00:38, 15.77it/s, est. speed input: 17135.02 toks/s, output: 16.73 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:25<00:37, 15.78it/s, est. speed input: 17116.45 toks/s, output: 16.72 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:25<00:37, 15.74it/s, est. speed input: 17094.53 toks/s, output: 16.69 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:26<00:36, 15.76it/s, est. speed input: 17077.25 toks/s, output: 16.68 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:26<00:35, 16.36it/s, est. speed input: 17099.11 toks/s, output: 16.70 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:27<00:35, 16.14it/s, est. speed input: 17078.82 toks/s, output: 16.68 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:27<00:34, 16.05it/s, est. speed input: 17063.61 toks/s, output: 16.66 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:28<00:34, 15.97it/s, est. speed input: 17047.43 toks/s, output: 16.65 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:28<00:34, 15.92it/s, est. speed input: 17032.73 toks/s, output: 16.63 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:29<00:33, 15.87it/s, est. speed input: 17017.24 toks/s, output: 16.62 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:30<00:33, 15.60it/s, est. speed input: 16987.51 toks/s, output: 16.59 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:30<00:35, 14.50it/s, est. speed input: 16899.13 toks/s, output: 16.50 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:31<00:34, 14.87it/s, est. speed input: 16887.72 toks/s, output: 16.49 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:31<00:33, 15.10it/s, est. speed input: 16874.15 toks/s, output: 16.48 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:32<00:32, 15.35it/s, est. speed input: 16865.73 toks/s, output: 16.47 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:32<00:31, 15.44it/s, est. speed input: 16852.69 toks/s, output: 16.46 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:33<00:30, 15.55it/s, est. speed input: 16842.59 toks/s, output: 16.45 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:33<00:30, 15.58it/s, est. speed input: 16830.39 toks/s, output: 16.44 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:34<00:29, 15.66it/s, est. speed input: 16821.50 toks/s, output: 16.43 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:34<00:28, 15.66it/s, est. speed input: 16809.66 toks/s, output: 16.42 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:35<00:28, 15.72it/s, est. speed input: 16801.85 toks/s, output: 16.41 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:35<00:27, 15.70it/s, est. speed input: 16790.49 toks/s, output: 16.40 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:36<00:27, 15.76it/s, est. speed input: 16783.53 toks/s, output: 16.39 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:36<00:26, 15.73it/s, est. speed input: 16773.11 toks/s, output: 16.38 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:37<00:26, 15.75it/s, est. speed input: 16765.03 toks/s, output: 16.37 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:37<00:25, 15.76it/s, est. speed input: 16756.93 toks/s, output: 16.36 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:38<00:25, 15.76it/s, est. speed input: 16748.74 toks/s, output: 16.36 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:38<00:24, 15.73it/s, est. speed input: 16739.45 toks/s, output: 16.35 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:39<00:24, 15.75it/s, est. speed input: 16732.11 toks/s, output: 16.34 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:39<00:23, 15.72it/s, est. speed input: 16722.87 toks/s, output: 16.33 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:40<00:23, 15.75it/s, est. speed input: 16716.64 toks/s, output: 16.32 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:40<00:22, 15.74it/s, est. speed input: 16708.56 toks/s, output: 16.32 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:41<00:22, 15.72it/s, est. speed input: 16700.68 toks/s, output: 16.31 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:41<00:21, 15.75it/s, est. speed input: 16694.63 toks/s, output: 16.30 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:42<00:21, 15.72it/s, est. speed input: 16686.30 toks/s, output: 16.30 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:42<00:20, 15.74it/s, est. speed input: 16680.17 toks/s, output: 16.29 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:43<00:20, 15.71it/s, est. speed input: 16672.38 toks/s, output: 16.28 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:43<00:19, 15.75it/s, est. speed input: 16667.28 toks/s, output: 16.28 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:44<00:19, 15.69it/s, est. speed input: 16658.75 toks/s, output: 16.27 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:44<00:18, 15.74it/s, est. speed input: 16653.93 toks/s, output: 16.26 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:45<00:18, 15.70it/s, est. speed input: 16646.54 toks/s, output: 16.26 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:45<00:17, 15.73it/s, est. speed input: 16641.38 toks/s, output: 16.25 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:46<00:17, 15.73it/s, est. speed input: 16635.25 toks/s, output: 16.25 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:46<00:16, 15.79it/s, est. speed input: 16631.98 toks/s, output: 16.24 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:47<00:16, 15.74it/s, est. speed input: 16625.04 toks/s, output: 16.24 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:47<00:15, 15.78it/s, est. speed input: 16621.19 toks/s, output: 16.23 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:48<00:15, 15.72it/s, est. speed input: 16614.27 toks/s, output: 16.22 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:48<00:14, 15.76it/s, est. speed input: 16610.24 toks/s, output: 16.22 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:49<00:14, 15.76it/s, est. speed input: 16605.33 toks/s, output: 16.22 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:49<00:13, 15.77it/s, est. speed input: 16601.16 toks/s, output: 16.21 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:50<00:13, 15.72it/s, est. speed input: 16594.75 toks/s, output: 16.21 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:50<00:12, 15.76it/s, est. speed input: 16591.04 toks/s, output: 16.20 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:51<00:12, 15.74it/s, est. speed input: 16585.96 toks/s, output: 16.20 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:51<00:11, 15.73it/s, est. speed input: 16581.21 toks/s, output: 16.19 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:52<00:11, 15.77it/s, est. speed input: 16577.71 toks/s, output: 16.19 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:53<00:10, 15.74it/s, est. speed input: 16572.83 toks/s, output: 16.18 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:53<00:10, 15.78it/s, est. speed input: 16569.66 toks/s, output: 16.18 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:54<00:09, 15.76it/s, est. speed input: 16565.12 toks/s, output: 16.18 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:54<00:08, 15.79it/s, est. speed input: 16562.13 toks/s, output: 16.17 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:55<00:08, 15.74it/s, est. speed input: 16556.81 toks/s, output: 16.17 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:55<00:07, 15.76it/s, est. speed input: 16553.43 toks/s, output: 16.17 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:56<00:07, 15.73it/s, est. speed input: 16548.70 toks/s, output: 16.16 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:56<00:06, 15.76it/s, est. speed input: 16545.59 toks/s, output: 16.16 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:57<00:06, 15.70it/s, est. speed input: 16540.22 toks/s, output: 16.15 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:57<00:05, 15.74it/s, est. speed input: 16537.46 toks/s, output: 16.15 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:58<00:05, 16.28it/s, est. speed input: 16549.60 toks/s, output: 16.16 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:58<00:04, 16.12it/s, est. speed input: 16546.05 toks/s, output: 16.16 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:59<00:04, 15.96it/s, est. speed input: 16541.17 toks/s, output: 16.15 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:59<00:03, 15.93it/s, est. speed input: 16538.45 toks/s, output: 16.15 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:00<00:03, 15.83it/s, est. speed input: 16533.86 toks/s, output: 16.15 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:00<00:02, 15.82it/s, est. speed input: 16530.76 toks/s, output: 16.14 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:01<00:02, 16.41it/s, est. speed input: 16544.55 toks/s, output: 16.16 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:01<00:01, 16.18it/s, est. speed input: 16540.28 toks/s, output: 16.15 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:02<00:01, 16.06it/s, est. speed input: 16537.30 toks/s, output: 16.15 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:02<00:00, 15.94it/s, est. speed input: 16533.12 toks/s, output: 16.15 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:02<00:00, 16.55it/s, est. speed input: 16547.65 toks/s, output: 16.16 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:02<00:00, 16.55it/s, est. speed input: 16645.15 toks/s, output: 16.26 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:02<00:00, 16.26it/s, est. speed input: 16645.15 toks/s, output: 16.26 toks/s]
[rank0]:[W128 08:43:50.361432478 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 96.9s

测试结果:
  Requests/s:   15.75
  Tokens/s:     16148.67
  Total Reqs:   1024
  Elapsed:      65.00s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     16132.92

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:44:01 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:44:01 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3706435) WARNING 01-28 08:44:26 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.86 requests/s, 16260.24 total tokens/s, 15.86 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 08:44:01] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:44:01] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:44:01] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:01] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:44:01] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:44:01] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:44:01] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:44:01] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:44:01] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:44:05] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:44:05] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:44:05] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:44:05] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:44:05] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:44:05] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:44:05] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:44:05] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:44:05] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3706435) [2026-01-28 08:44:06] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3706435) [2026-01-28 08:44:06] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3706435) [2026-01-28 08:44:06] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3706435) [2026-01-28 08:44:06] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3706435) [2026-01-28 08:44:06] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3706435) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3706435) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.70s/it]
(EngineCore_DP0 pid=3706435) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.70s/it]
(EngineCore_DP0 pid=3706435) 
(EngineCore_DP0 pid=3706435) 2026-01-28 08:44:24,563 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3706435) 2026-01-28 08:44:24,647 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 59/2048 [00:00<00:03, 584.54it/s]
Adding requests:   6%|▌         | 118/2048 [00:00<00:03, 551.33it/s]
Adding requests:   8%|▊         | 174/2048 [00:00<00:03, 506.98it/s]
Adding requests:  11%|█         | 226/2048 [00:00<00:03, 500.40it/s]
Adding requests:  14%|█▎        | 277/2048 [00:00<00:03, 498.24it/s]
Adding requests:  16%|█▌        | 327/2048 [00:00<00:03, 494.01it/s]
Adding requests:  18%|█▊        | 378/2048 [00:00<00:03, 496.99it/s]
Adding requests:  21%|██        | 428/2048 [00:00<00:03, 494.97it/s]
Adding requests:  23%|██▎       | 478/2048 [00:00<00:03, 484.85it/s]
Adding requests:  26%|██▌       | 527/2048 [00:01<00:03, 474.74it/s]
Adding requests:  28%|██▊       | 579/2048 [00:01<00:03, 483.78it/s]
Adding requests:  31%|███       | 628/2048 [00:01<00:02, 480.05it/s]
Adding requests:  33%|███▎      | 678/2048 [00:01<00:02, 485.78it/s]
Adding requests:  36%|███▌      | 729/2048 [00:01<00:02, 492.21it/s]
Adding requests:  38%|███▊      | 779/2048 [00:01<00:02, 465.87it/s]
Adding requests:  40%|████      | 826/2048 [00:01<00:02, 462.15it/s]
Adding requests:  43%|████▎     | 873/2048 [00:02<00:07, 167.74it/s]
Adding requests:  45%|████▍     | 921/2048 [00:02<00:05, 207.83it/s]
Adding requests:  47%|████▋     | 971/2048 [00:02<00:04, 252.74it/s]
Adding requests:  50%|████▉     | 1022/2048 [00:02<00:03, 298.63it/s]
Adding requests:  52%|█████▏    | 1070/2048 [00:02<00:02, 334.95it/s]
Adding requests:  55%|█████▍    | 1119/2048 [00:02<00:02, 368.74it/s]
Adding requests:  57%|█████▋    | 1169/2048 [00:03<00:02, 400.27it/s]
Adding requests:  60%|█████▉    | 1221/2048 [00:03<00:01, 430.28it/s]
Adding requests:  62%|██████▏   | 1270/2048 [00:03<00:01, 436.46it/s]
Adding requests:  64%|██████▍   | 1318/2048 [00:03<00:01, 446.59it/s]
Adding requests:  67%|██████▋   | 1366/2048 [00:03<00:01, 453.66it/s]
Adding requests:  69%|██████▉   | 1415/2048 [00:03<00:01, 461.82it/s]
Adding requests:  71%|███████▏  | 1463/2048 [00:03<00:01, 465.37it/s]
Adding requests:  74%|███████▍  | 1512/2048 [00:03<00:01, 470.15it/s]
Adding requests:  76%|███████▌  | 1561/2048 [00:03<00:01, 473.23it/s]
Adding requests:  79%|███████▊  | 1611/2048 [00:03<00:00, 478.55it/s]
Adding requests:  81%|████████  | 1660/2048 [00:04<00:00, 481.71it/s]
Adding requests:  83%|████████▎ | 1710/2048 [00:04<00:00, 486.48it/s]
Adding requests:  86%|████████▌ | 1759/2048 [00:04<00:00, 484.23it/s]
Adding requests:  88%|████████▊ | 1808/2048 [00:04<00:00, 482.50it/s]
Adding requests:  91%|█████████ | 1857/2048 [00:04<00:00, 483.80it/s]
Adding requests:  93%|█████████▎| 1906/2048 [00:04<00:00, 485.38it/s]
Adding requests:  95%|█████████▌| 1955/2048 [00:04<00:00, 480.83it/s]
Adding requests:  98%|█████████▊| 2007/2048 [00:04<00:00, 489.14it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 421.80it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:00<00:10, 187.55it/s, est. speed input: 192090.82 toks/s, output: 187.56 toks/s]
Processed prompts:   4%|▍         | 85/2048 [00:01<00:37, 51.93it/s, est. speed input: 63952.54 toks/s, output: 62.45 toks/s]   
Processed prompts:   5%|▍         | 98/2048 [00:02<01:02, 31.06it/s, est. speed input: 42335.33 toks/s, output: 41.34 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:03<01:18, 24.48it/s, est. speed input: 34549.31 toks/s, output: 33.74 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:04<01:30, 21.18it/s, est. speed input: 30331.60 toks/s, output: 29.62 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:05<01:38, 19.29it/s, est. speed input: 27693.19 toks/s, output: 27.04 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:06<01:43, 18.17it/s, est. speed input: 25905.00 toks/s, output: 25.30 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:07<01:47, 17.43it/s, est. speed input: 24594.39 toks/s, output: 24.02 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:08<01:49, 16.95it/s, est. speed input: 23605.83 toks/s, output: 23.05 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:09<01:50, 16.63it/s, est. speed input: 22824.83 toks/s, output: 22.29 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:10<01:51, 16.39it/s, est. speed input: 22187.43 toks/s, output: 21.67 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:11<01:51, 16.22it/s, est. speed input: 21659.80 toks/s, output: 21.15 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:12<01:51, 16.10it/s, est. speed input: 21218.49 toks/s, output: 20.72 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:13<01:50, 16.03it/s, est. speed input: 20843.73 toks/s, output: 20.36 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:14<01:50, 15.97it/s, est. speed input: 20521.09 toks/s, output: 20.04 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:15<01:49, 15.96it/s, est. speed input: 20247.96 toks/s, output: 19.77 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:16<01:48, 15.96it/s, est. speed input: 20011.26 toks/s, output: 19.54 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:17<01:45, 16.23it/s, est. speed input: 19863.55 toks/s, output: 19.40 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:18<01:45, 16.09it/s, est. speed input: 19659.64 toks/s, output: 19.20 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:19<01:44, 16.00it/s, est. speed input: 19478.30 toks/s, output: 19.02 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:20<01:44, 15.97it/s, est. speed input: 19319.97 toks/s, output: 18.87 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:21<01:43, 15.91it/s, est. speed input: 19171.44 toks/s, output: 18.72 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:22<01:42, 15.90it/s, est. speed input: 19040.60 toks/s, output: 18.59 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:23<01:41, 15.87it/s, est. speed input: 18916.84 toks/s, output: 18.47 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:24<01:38, 16.17it/s, est. speed input: 18855.20 toks/s, output: 18.41 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:25<01:38, 16.06it/s, est. speed input: 18749.58 toks/s, output: 18.31 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:26<01:37, 16.00it/s, est. speed input: 18653.13 toks/s, output: 18.22 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:27<01:42, 15.08it/s, est. speed input: 18435.11 toks/s, output: 18.00 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:28<01:40, 15.30it/s, est. speed input: 18357.11 toks/s, output: 17.93 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:29<01:38, 15.46it/s, est. speed input: 18284.73 toks/s, output: 17.86 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:30<01:36, 15.56it/s, est. speed input: 18215.33 toks/s, output: 17.79 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:31<01:34, 15.65it/s, est. speed input: 18152.78 toks/s, output: 17.73 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:32<01:33, 15.70it/s, est. speed input: 18091.62 toks/s, output: 17.67 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:33<01:32, 15.73it/s, est. speed input: 18034.65 toks/s, output: 17.61 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:34<01:31, 15.76it/s, est. speed input: 17981.46 toks/s, output: 17.56 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:35<01:30, 15.77it/s, est. speed input: 17930.70 toks/s, output: 17.51 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:36<01:29, 15.79it/s, est. speed input: 17883.09 toks/s, output: 17.46 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:37<01:27, 15.82it/s, est. speed input: 17840.65 toks/s, output: 17.42 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:38<01:26, 15.84it/s, est. speed input: 17799.61 toks/s, output: 17.38 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:39<01:25, 15.84it/s, est. speed input: 17759.44 toks/s, output: 17.34 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:40<01:24, 15.82it/s, est. speed input: 17719.75 toks/s, output: 17.30 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:41<01:23, 15.84it/s, est. speed input: 17684.68 toks/s, output: 17.27 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:42<01:22, 15.83it/s, est. speed input: 17649.48 toks/s, output: 17.24 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:43<01:21, 15.84it/s, est. speed input: 17616.96 toks/s, output: 17.20 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:44<01:20, 15.84it/s, est. speed input: 17585.22 toks/s, output: 17.17 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:45<01:19, 15.82it/s, est. speed input: 17553.89 toks/s, output: 17.14 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:46<01:18, 15.83it/s, est. speed input: 17525.07 toks/s, output: 17.11 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:47<01:17, 15.81it/s, est. speed input: 17496.09 toks/s, output: 17.09 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:48<01:16, 15.83it/s, est. speed input: 17470.21 toks/s, output: 17.06 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:49<01:15, 15.83it/s, est. speed input: 17444.87 toks/s, output: 17.04 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:50<01:14, 15.82it/s, est. speed input: 17419.38 toks/s, output: 17.01 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:51<01:13, 15.82it/s, est. speed input: 17395.99 toks/s, output: 16.99 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:52<01:12, 15.83it/s, est. speed input: 17373.63 toks/s, output: 16.97 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:53<01:11, 15.84it/s, est. speed input: 17352.52 toks/s, output: 16.95 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:54<01:09, 16.15it/s, est. speed input: 17352.27 toks/s, output: 16.95 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:55<01:08, 16.09it/s, est. speed input: 17334.19 toks/s, output: 16.93 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:56<01:07, 16.00it/s, est. speed input: 17313.41 toks/s, output: 16.91 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:57<01:05, 16.29it/s, est. speed input: 17314.76 toks/s, output: 16.91 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:58<01:05, 16.16it/s, est. speed input: 17296.72 toks/s, output: 16.89 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:59<01:06, 15.53it/s, est. speed input: 17245.97 toks/s, output: 16.84 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:00<01:05, 15.61it/s, est. speed input: 17228.17 toks/s, output: 16.82 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:01<01:04, 15.68it/s, est. speed input: 17211.83 toks/s, output: 16.81 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:03<01:02, 15.73it/s, est. speed input: 17196.14 toks/s, output: 16.79 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:04<01:01, 15.75it/s, est. speed input: 17180.20 toks/s, output: 16.78 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:05<01:00, 15.77it/s, est. speed input: 17164.77 toks/s, output: 16.76 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:06<00:59, 15.78it/s, est. speed input: 17149.78 toks/s, output: 16.75 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:07<00:58, 15.79it/s, est. speed input: 17135.17 toks/s, output: 16.73 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:08<00:57, 15.79it/s, est. speed input: 17121.06 toks/s, output: 16.72 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:09<00:55, 16.13it/s, est. speed input: 17124.38 toks/s, output: 16.72 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:10<00:54, 16.01it/s, est. speed input: 17109.90 toks/s, output: 16.71 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:11<00:53, 15.97it/s, est. speed input: 17097.65 toks/s, output: 16.70 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:12<00:53, 15.92it/s, est. speed input: 17084.91 toks/s, output: 16.68 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:13<00:52, 15.90it/s, est. speed input: 17073.40 toks/s, output: 16.67 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:14<00:51, 15.90it/s, est. speed input: 17062.66 toks/s, output: 16.66 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:15<00:50, 15.88it/s, est. speed input: 17051.16 toks/s, output: 16.65 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:16<00:48, 16.17it/s, est. speed input: 17054.00 toks/s, output: 16.65 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:17<00:47, 16.06it/s, est. speed input: 17042.68 toks/s, output: 16.64 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:17<00:45, 16.32it/s, est. speed input: 17046.85 toks/s, output: 16.65 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:18<00:45, 16.18it/s, est. speed input: 17036.56 toks/s, output: 16.64 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:19<00:44, 16.07it/s, est. speed input: 17025.89 toks/s, output: 16.63 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:21<00:43, 15.99it/s, est. speed input: 17015.20 toks/s, output: 16.62 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:22<00:43, 15.93it/s, est. speed input: 17005.05 toks/s, output: 16.61 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:23<00:42, 15.88it/s, est. speed input: 16994.48 toks/s, output: 16.60 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:24<00:41, 15.85it/s, est. speed input: 16984.57 toks/s, output: 16.59 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:25<00:40, 15.83it/s, est. speed input: 16974.79 toks/s, output: 16.58 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:26<00:39, 15.84it/s, est. speed input: 16965.95 toks/s, output: 16.57 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:27<00:38, 15.81it/s, est. speed input: 16955.98 toks/s, output: 16.56 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:28<00:37, 15.83it/s, est. speed input: 16948.03 toks/s, output: 16.55 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:29<00:36, 15.82it/s, est. speed input: 16939.18 toks/s, output: 16.54 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:30<00:35, 15.80it/s, est. speed input: 16930.37 toks/s, output: 16.53 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:31<00:34, 15.81it/s, est. speed input: 16922.45 toks/s, output: 16.53 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:32<00:34, 15.26it/s, est. speed input: 16892.04 toks/s, output: 16.50 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:33<00:33, 15.42it/s, est. speed input: 16884.22 toks/s, output: 16.49 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:34<00:31, 15.55it/s, est. speed input: 16877.49 toks/s, output: 16.48 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:35<00:30, 15.65it/s, est. speed input: 16870.99 toks/s, output: 16.48 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:36<00:28, 16.00it/s, est. speed input: 16875.29 toks/s, output: 16.48 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:37<00:27, 15.94it/s, est. speed input: 16867.91 toks/s, output: 16.47 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:38<00:27, 15.91it/s, est. speed input: 16861.10 toks/s, output: 16.47 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:39<00:26, 15.87it/s, est. speed input: 16854.00 toks/s, output: 16.46 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:40<00:24, 16.15it/s, est. speed input: 16857.60 toks/s, output: 16.46 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:41<00:23, 16.03it/s, est. speed input: 16850.53 toks/s, output: 16.46 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:42<00:22, 15.97it/s, est. speed input: 16844.29 toks/s, output: 16.45 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:43<00:21, 15.92it/s, est. speed input: 16837.78 toks/s, output: 16.44 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:44<00:21, 15.87it/s, est. speed input: 16830.95 toks/s, output: 16.44 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:45<00:20, 15.87it/s, est. speed input: 16825.41 toks/s, output: 16.43 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:46<00:19, 15.84it/s, est. speed input: 16819.01 toks/s, output: 16.42 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:47<00:18, 15.84it/s, est. speed input: 16813.14 toks/s, output: 16.42 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:48<00:17, 15.82it/s, est. speed input: 16807.24 toks/s, output: 16.41 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:49<00:16, 15.83it/s, est. speed input: 16801.85 toks/s, output: 16.41 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:50<00:15, 15.82it/s, est. speed input: 16796.12 toks/s, output: 16.40 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:51<00:14, 15.83it/s, est. speed input: 16790.86 toks/s, output: 16.40 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:52<00:13, 15.82it/s, est. speed input: 16785.53 toks/s, output: 16.39 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:53<00:11, 15.84it/s, est. speed input: 16780.90 toks/s, output: 16.39 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:54<00:10, 16.15it/s, est. speed input: 16785.47 toks/s, output: 16.39 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:55<00:09, 16.05it/s, est. speed input: 16780.43 toks/s, output: 16.39 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:56<00:08, 15.99it/s, est. speed input: 16775.53 toks/s, output: 16.38 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:57<00:07, 15.93it/s, est. speed input: 16770.37 toks/s, output: 16.38 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:58<00:06, 15.89it/s, est. speed input: 16765.25 toks/s, output: 16.37 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:59<00:05, 16.19it/s, est. speed input: 16769.89 toks/s, output: 16.38 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:00<00:04, 16.06it/s, est. speed input: 16764.51 toks/s, output: 16.37 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:01<00:03, 16.30it/s, est. speed input: 16768.70 toks/s, output: 16.38 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:02<00:02, 16.14it/s, est. speed input: 16763.48 toks/s, output: 16.37 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:03<00:01, 16.06it/s, est. speed input: 16759.34 toks/s, output: 16.37 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:04<00:00, 16.32it/s, est. speed input: 16764.03 toks/s, output: 16.37 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:04<00:00, 16.32it/s, est. speed input: 16879.39 toks/s, output: 16.48 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:04<00:00, 16.48it/s, est. speed input: 16879.39 toks/s, output: 16.48 toks/s]
[rank0]:[W128 08:46:35.422479112 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 165.0s

测试结果:
  Requests/s:   15.86
  Tokens/s:     16260.24
  Total Reqs:   2048
  Elapsed:      129.10s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     16244.37

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuBLASLt                                        │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:46:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:46:52 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3708956) WARNING 01-28 08:47:18 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.98 requests/s, 16378.41 total tokens/s, 15.98 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 08:46:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:46:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:46:52] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:46:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:46:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:46:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:46:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:46:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:46:55] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:46:55] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:46:55] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:46:55] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:46:55] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:46:55] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:46:55] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:46:55] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:46:55] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3708956) [2026-01-28 08:46:56] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuBLASLt)
(EngineCore_DP0 pid=3708956) [2026-01-28 08:46:56] INFO gemm_wrapper.py:870: cublaslt GEMM extension loaded: cublaslt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3708956) [2026-01-28 08:46:56] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuBLASLt)
(EngineCore_DP0 pid=3708956) [2026-01-28 08:46:56] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3708956) [2026-01-28 08:46:56] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuBLASLt
(EngineCore_DP0 pid=3708956) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3708956) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.52s/it]
(EngineCore_DP0 pid=3708956) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.52s/it]
(EngineCore_DP0 pid=3708956) 
(EngineCore_DP0 pid=3708956) 2026-01-28 08:47:16,053 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3708956) 2026-01-28 08:47:16,200 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   1%|▏         | 61/4096 [00:00<00:06, 607.96it/s]
Adding requests:   3%|▎         | 122/4096 [00:00<00:07, 556.28it/s]
Adding requests:   4%|▍         | 178/4096 [00:00<00:07, 524.95it/s]
Adding requests:   6%|▌         | 231/4096 [00:00<00:07, 516.43it/s]
Adding requests:   7%|▋         | 283/4096 [00:00<00:07, 500.64it/s]
Adding requests:   8%|▊         | 334/4096 [00:00<00:07, 491.97it/s]
Adding requests:   9%|▉         | 386/4096 [00:00<00:07, 498.24it/s]
Adding requests:  11%|█         | 436/4096 [00:00<00:07, 498.44it/s]
Adding requests:  12%|█▏        | 487/4096 [00:00<00:07, 499.48it/s]
Adding requests:  13%|█▎        | 537/4096 [00:01<00:07, 489.46it/s]
Adding requests:  14%|█▍        | 589/4096 [00:01<00:07, 498.42it/s]
Adding requests:  16%|█▌        | 639/4096 [00:01<00:06, 494.69it/s]
Adding requests:  17%|█▋        | 690/4096 [00:01<00:06, 498.83it/s]
Adding requests:  18%|█▊        | 740/4096 [00:01<00:06, 496.25it/s]
Adding requests:  19%|█▉        | 791/4096 [00:01<00:06, 498.31it/s]
Adding requests:  21%|██        | 841/4096 [00:01<00:06, 485.19it/s]
Adding requests:  22%|██▏       | 894/4096 [00:01<00:06, 496.23it/s]
Adding requests:  23%|██▎       | 944/4096 [00:01<00:06, 491.86it/s]
Adding requests:  24%|██▍       | 995/4096 [00:01<00:06, 496.91it/s]
Adding requests:  26%|██▌       | 1046/4096 [00:02<00:06, 500.54it/s]
Adding requests:  27%|██▋       | 1097/4096 [00:02<00:06, 494.35it/s]
Adding requests:  28%|██▊       | 1147/4096 [00:02<00:06, 479.50it/s]
Adding requests:  29%|██▉       | 1198/4096 [00:02<00:05, 486.81it/s]
Adding requests:  30%|███       | 1247/4096 [00:02<00:05, 487.31it/s]
Adding requests:  32%|███▏      | 1296/4096 [00:02<00:05, 472.05it/s]
Adding requests:  33%|███▎      | 1346/4096 [00:02<00:05, 478.45it/s]
Adding requests:  34%|███▍      | 1397/4096 [00:02<00:05, 486.65it/s]
Adding requests:  35%|███▌      | 1447/4096 [00:02<00:05, 489.76it/s]
Adding requests:  37%|███▋      | 1500/4096 [00:03<00:05, 500.80it/s]
Adding requests:  38%|███▊      | 1552/4096 [00:03<00:05, 505.49it/s]
Adding requests:  39%|███▉      | 1604/4096 [00:03<00:04, 508.75it/s]
Adding requests:  40%|████      | 1655/4096 [00:03<00:04, 506.87it/s]
Adding requests:  42%|████▏     | 1706/4096 [00:03<00:04, 500.75it/s]
Adding requests:  43%|████▎     | 1757/4096 [00:03<00:04, 496.04it/s]
Adding requests:  44%|████▍     | 1807/4096 [00:03<00:04, 495.54it/s]
Adding requests:  45%|████▌     | 1857/4096 [00:03<00:04, 493.80it/s]
Adding requests:  47%|████▋     | 1907/4096 [00:03<00:04, 487.61it/s]
Adding requests:  48%|████▊     | 1956/4096 [00:03<00:04, 485.42it/s]
Adding requests:  49%|████▉     | 2005/4096 [00:04<00:04, 484.63it/s]
Adding requests:  50%|█████     | 2054/4096 [00:04<00:04, 475.54it/s]
Adding requests:  51%|█████▏    | 2103/4096 [00:04<00:04, 479.30it/s]
Adding requests:  53%|█████▎    | 2151/4096 [00:04<00:04, 468.57it/s]
Adding requests:  54%|█████▎    | 2198/4096 [00:04<00:04, 465.60it/s]
Adding requests:  55%|█████▍    | 2248/4096 [00:04<00:03, 474.94it/s]
Adding requests:  56%|█████▌    | 2297/4096 [00:04<00:03, 479.21it/s]
Adding requests:  57%|█████▋    | 2347/4096 [00:04<00:03, 482.73it/s]
Adding requests:  58%|█████▊    | 2396/4096 [00:04<00:03, 484.86it/s]
Adding requests:  60%|█████▉    | 2445/4096 [00:04<00:03, 483.78it/s]
Adding requests:  61%|██████    | 2494/4096 [00:05<00:03, 481.28it/s]
Adding requests:  62%|██████▏   | 2543/4096 [00:05<00:03, 455.99it/s]
Adding requests:  63%|██████▎   | 2591/4096 [00:05<00:03, 460.91it/s]
Adding requests:  64%|██████▍   | 2641/4096 [00:05<00:03, 470.04it/s]
Adding requests:  66%|██████▌   | 2689/4096 [00:05<00:02, 469.76it/s]
Adding requests:  67%|██████▋   | 2738/4096 [00:05<00:02, 474.78it/s]
Adding requests:  68%|██████▊   | 2786/4096 [00:05<00:02, 469.37it/s]
Adding requests:  69%|██████▉   | 2836/4096 [00:05<00:02, 477.72it/s]
Adding requests:  70%|███████   | 2886/4096 [00:05<00:02, 481.70it/s]
Adding requests:  72%|███████▏  | 2935/4096 [00:06<00:02, 472.23it/s]
Adding requests:  73%|███████▎  | 2985/4096 [00:06<00:02, 477.31it/s]
Adding requests:  74%|███████▍  | 3033/4096 [00:06<00:02, 476.62it/s]
Adding requests:  75%|███████▌  | 3081/4096 [00:06<00:02, 474.97it/s]
Adding requests:  76%|███████▋  | 3129/4096 [00:06<00:02, 472.79it/s]
Adding requests:  78%|███████▊  | 3178/4096 [00:06<00:01, 476.68it/s]
Adding requests:  79%|███████▉  | 3227/4096 [00:06<00:01, 478.13it/s]
Adding requests:  80%|████████  | 3277/4096 [00:06<00:01, 484.44it/s]
Adding requests:  81%|████████  | 3326/4096 [00:06<00:01, 485.75it/s]
Adding requests:  82%|████████▏ | 3375/4096 [00:06<00:01, 483.04it/s]
Adding requests:  84%|████████▎ | 3426/4096 [00:07<00:01, 488.56it/s]
Adding requests:  85%|████████▍ | 3475/4096 [00:07<00:01, 475.75it/s]
Adding requests:  86%|████████▌ | 3525/4096 [00:07<00:01, 482.64it/s]
Adding requests:  87%|████████▋ | 3574/4096 [00:07<00:01, 483.23it/s]
Adding requests:  88%|████████▊ | 3624/4096 [00:07<00:00, 486.49it/s]
Adding requests:  90%|████████▉ | 3676/4096 [00:07<00:00, 495.72it/s]
Adding requests:  91%|█████████ | 3726/4096 [00:07<00:00, 486.29it/s]
Adding requests:  92%|█████████▏| 3776/4096 [00:07<00:00, 488.94it/s]
Adding requests:  93%|█████████▎| 3825/4096 [00:07<00:00, 475.59it/s]
Adding requests:  95%|█████████▍| 3878/4096 [00:07<00:00, 489.48it/s]
Adding requests:  96%|█████████▌| 3928/4096 [00:08<00:00, 461.27it/s]
Adding requests:  97%|█████████▋| 3978/4096 [00:08<00:00, 472.04it/s]
Adding requests:  98%|█████████▊| 4026/4096 [00:08<00:00, 473.05it/s]
Adding requests:  99%|█████████▉| 4074/4096 [00:08<00:00, 469.08it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 485.71it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:01<00:56, 70.54it/s, est. speed input: 72235.67 toks/s, output: 70.54 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:03<01:45, 37.21it/s, est. speed input: 42992.92 toks/s, output: 41.98 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:05<02:22, 27.31it/s, est. speed input: 33848.82 toks/s, output: 33.06 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:07<02:50, 22.73it/s, est. speed input: 29346.24 toks/s, output: 28.66 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:09<03:09, 20.24it/s, est. speed input: 26681.53 toks/s, output: 26.06 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:11<03:23, 18.74it/s, est. speed input: 24915.50 toks/s, output: 24.33 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:13<03:29, 17.98it/s, est. speed input: 23766.56 toks/s, output: 23.21 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:15<03:36, 17.32it/s, est. speed input: 22821.84 toks/s, output: 22.29 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:17<03:39, 16.87it/s, est. speed input: 22082.69 toks/s, output: 21.57 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:19<03:42, 16.55it/s, est. speed input: 21488.55 toks/s, output: 20.98 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:21<03:41, 16.43it/s, est. speed input: 21040.99 toks/s, output: 20.55 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:23<03:42, 16.25it/s, est. speed input: 20633.58 toks/s, output: 20.15 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:25<03:42, 16.13it/s, est. speed input: 20292.42 toks/s, output: 19.82 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:27<03:41, 16.05it/s, est. speed input: 19999.64 toks/s, output: 19.53 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:29<03:40, 15.98it/s, est. speed input: 19742.60 toks/s, output: 19.28 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:31<03:38, 15.95it/s, est. speed input: 19524.94 toks/s, output: 19.07 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:34<03:37, 15.91it/s, est. speed input: 19327.42 toks/s, output: 18.87 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:36<03:35, 15.89it/s, est. speed input: 19153.86 toks/s, output: 18.70 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:38<03:33, 15.87it/s, est. speed input: 18997.32 toks/s, output: 18.55 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:40<03:31, 15.88it/s, est. speed input: 18859.60 toks/s, output: 18.42 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:42<03:29, 15.87it/s, est. speed input: 18733.86 toks/s, output: 18.29 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:44<03:27, 15.86it/s, est. speed input: 18619.30 toks/s, output: 18.18 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:46<03:25, 15.86it/s, est. speed input: 18513.96 toks/s, output: 18.08 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:48<03:23, 15.85it/s, est. speed input: 18417.69 toks/s, output: 17.99 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:50<03:21, 15.84it/s, est. speed input: 18328.30 toks/s, output: 17.90 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:52<03:17, 15.99it/s, est. speed input: 18269.08 toks/s, output: 17.84 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:54<03:14, 16.08it/s, est. speed input: 18211.57 toks/s, output: 17.78 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:56<03:13, 16.03it/s, est. speed input: 18142.52 toks/s, output: 17.72 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:58<03:12, 15.98it/s, est. speed input: 18076.79 toks/s, output: 17.65 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:00<03:10, 15.94it/s, est. speed input: 18014.57 toks/s, output: 17.59 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:02<03:08, 15.91it/s, est. speed input: 17956.24 toks/s, output: 17.54 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [01:04<03:07, 15.89it/s, est. speed input: 17902.11 toks/s, output: 17.48 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [01:06<03:03, 16.04it/s, est. speed input: 17869.70 toks/s, output: 17.45 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [01:08<03:02, 15.98it/s, est. speed input: 17820.01 toks/s, output: 17.40 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:10<03:00, 15.94it/s, est. speed input: 17774.31 toks/s, output: 17.36 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:12<02:57, 16.06it/s, est. speed input: 17746.71 toks/s, output: 17.33 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:14<02:53, 16.21it/s, est. speed input: 17726.40 toks/s, output: 17.31 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:16<02:52, 16.09it/s, est. speed input: 17685.65 toks/s, output: 17.27 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:18<02:51, 16.01it/s, est. speed input: 17647.46 toks/s, output: 17.23 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:20<02:50, 15.94it/s, est. speed input: 17609.71 toks/s, output: 17.20 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:22<02:48, 15.92it/s, est. speed input: 17576.05 toks/s, output: 17.16 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:24<02:47, 15.89it/s, est. speed input: 17543.06 toks/s, output: 17.13 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:26<02:45, 15.88it/s, est. speed input: 17512.25 toks/s, output: 17.10 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:28<02:43, 15.87it/s, est. speed input: 17483.46 toks/s, output: 17.07 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:30<02:41, 15.87it/s, est. speed input: 17455.93 toks/s, output: 17.05 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:32<02:37, 16.01it/s, est. speed input: 17440.72 toks/s, output: 17.03 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:34<02:36, 15.97it/s, est. speed input: 17415.06 toks/s, output: 17.01 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:36<02:32, 16.10it/s, est. speed input: 17402.70 toks/s, output: 16.99 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:38<02:31, 16.02it/s, est. speed input: 17378.67 toks/s, output: 16.97 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:40<02:30, 15.97it/s, est. speed input: 17355.45 toks/s, output: 16.95 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:42<02:28, 15.93it/s, est. speed input: 17333.15 toks/s, output: 16.93 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:44<02:26, 15.90it/s, est. speed input: 17311.42 toks/s, output: 16.91 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:46<02:24, 15.90it/s, est. speed input: 17291.58 toks/s, output: 16.89 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:48<02:22, 15.88it/s, est. speed input: 17271.85 toks/s, output: 16.87 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [01:50<02:19, 16.01it/s, est. speed input: 17261.56 toks/s, output: 16.86 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [01:52<02:18, 15.94it/s, est. speed input: 17242.06 toks/s, output: 16.84 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [01:54<02:16, 15.91it/s, est. speed input: 17223.75 toks/s, output: 16.82 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [01:56<02:13, 16.07it/s, est. speed input: 17217.59 toks/s, output: 16.81 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [01:58<02:10, 16.15it/s, est. speed input: 17209.42 toks/s, output: 16.81 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [02:00<02:09, 16.05it/s, est. speed input: 17192.74 toks/s, output: 16.79 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [02:02<02:07, 16.00it/s, est. speed input: 17177.18 toks/s, output: 16.77 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [02:04<02:06, 15.95it/s, est. speed input: 17161.78 toks/s, output: 16.76 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [02:06<02:04, 15.91it/s, est. speed input: 17145.92 toks/s, output: 16.74 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [02:08<02:02, 15.90it/s, est. speed input: 17132.13 toks/s, output: 16.73 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [02:10<02:00, 15.88it/s, est. speed input: 17117.82 toks/s, output: 16.72 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:12<01:56, 16.17it/s, est. speed input: 17120.60 toks/s, output: 16.72 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:14<01:55, 16.07it/s, est. speed input: 17107.07 toks/s, output: 16.71 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:16<01:52, 16.14it/s, est. speed input: 17101.29 toks/s, output: 16.70 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:18<01:51, 16.05it/s, est. speed input: 17088.29 toks/s, output: 16.69 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:20<01:48, 16.16it/s, est. speed input: 17084.54 toks/s, output: 16.68 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:22<01:45, 16.39it/s, est. speed input: 17087.96 toks/s, output: 16.69 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:23<01:43, 16.41it/s, est. speed input: 17084.77 toks/s, output: 16.68 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:25<01:42, 16.23it/s, est. speed input: 17072.74 toks/s, output: 16.67 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:28<01:41, 16.12it/s, est. speed input: 17061.26 toks/s, output: 16.66 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:29<01:38, 16.20it/s, est. speed input: 17057.97 toks/s, output: 16.66 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:31<01:37, 16.10it/s, est. speed input: 17046.98 toks/s, output: 16.65 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:33<01:34, 16.18it/s, est. speed input: 17043.72 toks/s, output: 16.64 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:35<01:33, 16.08it/s, est. speed input: 17032.88 toks/s, output: 16.63 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [02:37<01:31, 16.00it/s, est. speed input: 17022.39 toks/s, output: 16.62 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [02:39<01:30, 15.96it/s, est. speed input: 17012.40 toks/s, output: 16.61 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:41<01:27, 16.09it/s, est. speed input: 17010.07 toks/s, output: 16.61 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [02:43<01:25, 16.02it/s, est. speed input: 17000.49 toks/s, output: 16.60 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [02:45<01:24, 15.97it/s, est. speed input: 16991.11 toks/s, output: 16.59 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [02:48<01:22, 15.92it/s, est. speed input: 16981.29 toks/s, output: 16.58 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [02:50<01:20, 15.89it/s, est. speed input: 16972.22 toks/s, output: 16.57 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [02:51<01:17, 16.05it/s, est. speed input: 16970.57 toks/s, output: 16.57 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [02:53<01:15, 15.98it/s, est. speed input: 16961.51 toks/s, output: 16.56 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:56<01:14, 15.94it/s, est. speed input: 16953.16 toks/s, output: 16.56 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [02:58<01:12, 15.90it/s, est. speed input: 16944.48 toks/s, output: 16.55 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [03:00<01:10, 15.89it/s, est. speed input: 16936.64 toks/s, output: 16.54 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [03:02<01:08, 15.89it/s, est. speed input: 16929.17 toks/s, output: 16.53 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [03:04<01:06, 15.85it/s, est. speed input: 16920.59 toks/s, output: 16.52 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [03:06<01:04, 15.84it/s, est. speed input: 16912.61 toks/s, output: 16.52 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [03:08<01:01, 16.12it/s, est. speed input: 16915.70 toks/s, output: 16.52 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [03:09<00:59, 16.19it/s, est. speed input: 16914.07 toks/s, output: 16.52 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [03:11<00:57, 16.09it/s, est. speed input: 16906.90 toks/s, output: 16.51 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:14<00:55, 16.00it/s, est. speed input: 16899.17 toks/s, output: 16.50 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:15<00:53, 16.20it/s, est. speed input: 16901.09 toks/s, output: 16.50 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:17<00:51, 16.09it/s, est. speed input: 16894.24 toks/s, output: 16.50 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:19<00:49, 16.01it/s, est. speed input: 16887.36 toks/s, output: 16.49 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:22<00:48, 15.96it/s, est. speed input: 16880.50 toks/s, output: 16.48 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:24<00:46, 15.91it/s, est. speed input: 16873.57 toks/s, output: 16.48 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:26<00:44, 15.88it/s, est. speed input: 16866.82 toks/s, output: 16.47 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:28<00:41, 16.04it/s, est. speed input: 16866.29 toks/s, output: 16.47 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [03:30<00:39, 15.96it/s, est. speed input: 16859.45 toks/s, output: 16.46 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [03:31<00:37, 16.24it/s, est. speed input: 16863.69 toks/s, output: 16.47 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [03:33<00:35, 16.10it/s, est. speed input: 16856.98 toks/s, output: 16.46 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [03:35<00:33, 16.01it/s, est. speed input: 16850.68 toks/s, output: 16.46 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [03:37<00:31, 15.95it/s, est. speed input: 16844.70 toks/s, output: 16.45 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [03:40<00:30, 15.92it/s, est. speed input: 16838.97 toks/s, output: 16.44 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [03:42<00:28, 15.88it/s, est. speed input: 16832.88 toks/s, output: 16.44 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [03:44<00:26, 15.86it/s, est. speed input: 16827.04 toks/s, output: 16.43 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [03:46<00:23, 16.04it/s, est. speed input: 16827.49 toks/s, output: 16.43 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [03:48<00:21, 15.97it/s, est. speed input: 16821.75 toks/s, output: 16.43 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [03:50<00:19, 15.94it/s, est. speed input: 16816.84 toks/s, output: 16.42 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [03:52<00:17, 15.90it/s, est. speed input: 16811.29 toks/s, output: 16.42 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [03:54<00:15, 16.06it/s, est. speed input: 16811.65 toks/s, output: 16.42 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [03:56<00:13, 16.00it/s, est. speed input: 16806.60 toks/s, output: 16.41 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [03:58<00:11, 15.94it/s, est. speed input: 16801.35 toks/s, output: 16.41 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [04:00<00:09, 15.90it/s, est. speed input: 16796.03 toks/s, output: 16.40 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [04:02<00:07, 15.87it/s, est. speed input: 16790.87 toks/s, output: 16.40 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [04:04<00:05, 15.86it/s, est. speed input: 16786.05 toks/s, output: 16.39 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [04:05<00:03, 16.33it/s, est. speed input: 16794.85 toks/s, output: 16.40 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [04:07<00:01, 16.37it/s, est. speed input: 16795.29 toks/s, output: 16.40 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:07<00:00, 16.37it/s, est. speed input: 16919.19 toks/s, output: 16.52 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:07<00:00, 16.52it/s, est. speed input: 16919.19 toks/s, output: 16.52 toks/s]
[rank0]:[W128 08:51:35.282530820 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 299.9s

测试结果:
  Requests/s:   15.98
  Tokens/s:     16378.41
  Total Reqs:   4096
  Elapsed:      256.34s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     16362.43


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cublaslt/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,27.1982,13952.6792,4.7062
1024,1024,1,128,128,15.6974,16089.8410,8.1542
2048,1024,2,256,128,16.6446,17060.6677,15.3804
4096,1024,4,512,128,16.1661,16570.2824,31.6712
8192,1024,8,1024,128,15.7548,16148.6719,64.9961
16384,1024,16,2048,128,15.8636,16260.2358,129.1002
32768,1024,32,4096,128,15.9789,16378.4127,256.3374

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_4) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_4
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_4

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:51:41 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:51:41 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3713099) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3713099) WARNING 01-28 08:52:04 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 29.26 requests/s, 15009.61 total tokens/s, 29.26 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 08:51:41] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:51:41] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:51:41] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:41] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:51:41] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:51:41] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:51:41] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:51:41] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:51:41] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:51:44] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:51:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:51:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:51:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:51:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:51:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:51:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:51:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:51:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:45] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3713099) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3713099) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:12<00:00, 12.12s/it]
(EngineCore_DP0 pid=3713099) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:12<00:00, 12.12s/it]
(EngineCore_DP0 pid=3713099) 
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3713099) [2026-01-28 08:51:58] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3713099) 2026-01-28 08:52:04,183 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3713099) 2026-01-28 08:52:04,197 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  90%|████████▉ | 115/128 [00:00<00:00, 1142.77it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1159.01it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:09, 13.90it/s, est. speed input: 7119.50 toks/s, output: 13.90 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:06, 18.90it/s, est. speed input: 9276.76 toks/s, output: 18.12 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:05, 20.97it/s, est. speed input: 10164.79 toks/s, output: 19.85 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:05, 21.73it/s, est. speed input: 10549.27 toks/s, output: 20.60 toks/s]
Processed prompts:  11%|█         | 14/128 [00:00<00:05, 22.09it/s, est. speed input: 10764.07 toks/s, output: 21.02 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:00<00:04, 22.36it/s, est. speed input: 10920.34 toks/s, output: 21.33 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:00<00:04, 22.65it/s, est. speed input: 11057.94 toks/s, output: 21.60 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:04, 23.84it/s, est. speed input: 11346.12 toks/s, output: 22.16 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:03, 26.18it/s, est. speed input: 11853.84 toks/s, output: 23.15 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:03, 28.34it/s, est. speed input: 12343.89 toks/s, output: 24.11 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:01<00:03, 29.75it/s, est. speed input: 12736.99 toks/s, output: 24.88 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:02, 30.48it/s, est. speed input: 13038.61 toks/s, output: 25.47 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:02, 28.43it/s, est. speed input: 13006.53 toks/s, output: 25.40 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:01<00:02, 29.82it/s, est. speed input: 13278.47 toks/s, output: 25.93 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:01<00:02, 30.86it/s, est. speed input: 13517.28 toks/s, output: 26.40 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:02, 31.51it/s, est. speed input: 13718.91 toks/s, output: 26.79 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:02<00:02, 31.81it/s, est. speed input: 13884.89 toks/s, output: 27.12 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:02<00:02, 31.97it/s, est. speed input: 14029.21 toks/s, output: 27.40 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:02<00:01, 32.34it/s, est. speed input: 14177.45 toks/s, output: 27.69 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:02<00:01, 32.54it/s, est. speed input: 14307.50 toks/s, output: 27.94 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:02<00:01, 32.81it/s, est. speed input: 14434.17 toks/s, output: 28.19 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:02<00:01, 32.77it/s, est. speed input: 14535.23 toks/s, output: 28.39 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:02<00:01, 33.06it/s, est. speed input: 14647.75 toks/s, output: 28.61 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:03<00:01, 33.15it/s, est. speed input: 14744.15 toks/s, output: 28.80 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:03<00:01, 33.02it/s, est. speed input: 14822.47 toks/s, output: 28.95 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:03<00:01, 32.51it/s, est. speed input: 14870.58 toks/s, output: 29.04 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:03<00:00, 32.47it/s, est. speed input: 14933.05 toks/s, output: 29.17 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:03<00:00, 32.95it/s, est. speed input: 15017.57 toks/s, output: 29.33 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:03<00:00, 33.15it/s, est. speed input: 15089.65 toks/s, output: 29.47 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:03<00:00, 33.25it/s, est. speed input: 15154.89 toks/s, output: 29.60 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:03<00:00, 33.26it/s, est. speed input: 15213.74 toks/s, output: 29.71 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:03<00:00, 33.21it/s, est. speed input: 15266.19 toks/s, output: 29.82 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:04<00:00, 33.35it/s, est. speed input: 15323.20 toks/s, output: 29.93 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:04<00:00, 33.29it/s, est. speed input: 15370.29 toks/s, output: 30.02 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 33.29it/s, est. speed input: 15372.67 toks/s, output: 30.02 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 30.02it/s, est. speed input: 15372.67 toks/s, output: 30.02 toks/s]
[rank0]:[W128 08:52:09.453217295 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 34.1s

测试结果:
  Requests/s:   29.26
  Tokens/s:     15009.61
  Total Reqs:   128
  Elapsed:      4.37s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     14980.35

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:52:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:52:15 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3713780) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3713780) WARNING 01-28 08:52:38 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.78 requests/s, 17196.48 total tokens/s, 16.78 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 08:52:15] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:52:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:52:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:52:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:52:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:52:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:52:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:52:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:52:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:52:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:52:19] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:52:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:52:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:52:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:52:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:52:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:20] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3713780) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3713780) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.67s/it]
(EngineCore_DP0 pid=3713780) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.67s/it]
(EngineCore_DP0 pid=3713780) 
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3713780) [2026-01-28 08:52:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3713780) 2026-01-28 08:52:37,888 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3713780) 2026-01-28 08:52:37,901 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  38%|███▊      | 49/128 [00:00<00:00, 484.12it/s]
Adding requests:  91%|█████████▏| 117/128 [00:00<00:00, 597.41it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 590.76it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 2/128 [00:00<00:08, 15.27it/s, est. speed input: 15639.84 toks/s, output: 15.27 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:09, 13.71it/s, est. speed input: 14258.77 toks/s, output: 13.92 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:09, 13.07it/s, est. speed input: 13689.87 toks/s, output: 13.37 toks/s]
Processed prompts:   6%|▋         | 8/128 [00:00<00:09, 12.86it/s, est. speed input: 13473.28 toks/s, output: 13.16 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:09, 12.70it/s, est. speed input: 13317.86 toks/s, output: 13.01 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:08, 13.16it/s, est. speed input: 13500.44 toks/s, output: 13.18 toks/s]
Processed prompts:  11%|█         | 14/128 [00:01<00:07, 14.39it/s, est. speed input: 14020.27 toks/s, output: 13.69 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:01<00:07, 15.34it/s, est. speed input: 14441.12 toks/s, output: 14.10 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:01<00:06, 16.05it/s, est. speed input: 14787.52 toks/s, output: 14.44 toks/s]
Processed prompts:  16%|█▌        | 20/128 [00:01<00:06, 16.57it/s, est. speed input: 15077.83 toks/s, output: 14.72 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:01<00:06, 16.81it/s, est. speed input: 15290.77 toks/s, output: 14.93 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:01<00:06, 17.13it/s, est. speed input: 15504.18 toks/s, output: 15.14 toks/s]
Processed prompts:  20%|██        | 26/128 [00:01<00:05, 17.30it/s, est. speed input: 15679.76 toks/s, output: 15.31 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:05, 17.40it/s, est. speed input: 15827.94 toks/s, output: 15.46 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:05, 17.55it/s, est. speed input: 15973.92 toks/s, output: 15.60 toks/s]
Processed prompts:  25%|██▌       | 32/128 [00:02<00:05, 17.66it/s, est. speed input: 16103.58 toks/s, output: 15.73 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:02<00:05, 17.80it/s, est. speed input: 16229.88 toks/s, output: 15.85 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:02<00:05, 17.78it/s, est. speed input: 16326.66 toks/s, output: 15.94 toks/s]
Processed prompts:  30%|██▉       | 38/128 [00:02<00:05, 17.82it/s, est. speed input: 16421.81 toks/s, output: 16.04 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:02<00:04, 17.69it/s, est. speed input: 16486.40 toks/s, output: 16.10 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:02<00:04, 17.69it/s, est. speed input: 16556.59 toks/s, output: 16.17 toks/s]
Processed prompts:  34%|███▍      | 44/128 [00:02<00:04, 17.67it/s, est. speed input: 16618.97 toks/s, output: 16.23 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:02<00:04, 17.72it/s, est. speed input: 16684.25 toks/s, output: 16.29 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:02<00:04, 17.89it/s, est. speed input: 16760.70 toks/s, output: 16.37 toks/s]
Processed prompts:  39%|███▉      | 50/128 [00:03<00:04, 17.88it/s, est. speed input: 16817.34 toks/s, output: 16.42 toks/s]
Processed prompts:  41%|████      | 52/128 [00:03<00:04, 17.91it/s, est. speed input: 16873.34 toks/s, output: 16.48 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:03<00:04, 17.94it/s, est. speed input: 16926.70 toks/s, output: 16.53 toks/s]
Processed prompts:  44%|████▍     | 56/128 [00:03<00:03, 18.02it/s, est. speed input: 16983.05 toks/s, output: 16.58 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:03<00:03, 18.01it/s, est. speed input: 17028.30 toks/s, output: 16.63 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:03<00:03, 17.72it/s, est. speed input: 17043.72 toks/s, output: 16.64 toks/s]
Processed prompts:  48%|████▊     | 62/128 [00:03<00:03, 17.69it/s, est. speed input: 17073.83 toks/s, output: 16.67 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:03<00:03, 17.76it/s, est. speed input: 17111.62 toks/s, output: 16.71 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:03<00:03, 17.83it/s, est. speed input: 17148.88 toks/s, output: 16.75 toks/s]
Processed prompts:  53%|█████▎    | 68/128 [00:04<00:03, 17.93it/s, est. speed input: 17188.39 toks/s, output: 16.79 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:04<00:03, 17.91it/s, est. speed input: 17217.90 toks/s, output: 16.81 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:04<00:03, 17.86it/s, est. speed input: 17242.72 toks/s, output: 16.84 toks/s]
Processed prompts:  58%|█████▊    | 74/128 [00:04<00:03, 17.96it/s, est. speed input: 17277.81 toks/s, output: 16.87 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:04<00:02, 17.90it/s, est. speed input: 17300.86 toks/s, output: 16.90 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:04<00:02, 17.68it/s, est. speed input: 17307.81 toks/s, output: 16.90 toks/s]
Processed prompts:  62%|██████▎   | 80/128 [00:04<00:02, 17.63it/s, est. speed input: 17322.91 toks/s, output: 16.92 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:04<00:02, 17.75it/s, est. speed input: 17349.28 toks/s, output: 16.94 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:04<00:02, 17.85it/s, est. speed input: 17375.82 toks/s, output: 16.97 toks/s]
Processed prompts:  67%|██████▋   | 86/128 [00:05<00:02, 17.82it/s, est. speed input: 17393.34 toks/s, output: 16.99 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:05<00:02, 17.84it/s, est. speed input: 17413.64 toks/s, output: 17.01 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:05<00:02, 17.81it/s, est. speed input: 17429.65 toks/s, output: 17.02 toks/s]
Processed prompts:  72%|███████▏  | 92/128 [00:05<00:02, 17.83it/s, est. speed input: 17447.79 toks/s, output: 17.04 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:05<00:01, 17.87it/s, est. speed input: 17466.91 toks/s, output: 17.06 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:05<00:01, 17.89it/s, est. speed input: 17484.93 toks/s, output: 17.08 toks/s]
Processed prompts:  77%|███████▋  | 98/128 [00:05<00:01, 17.71it/s, est. speed input: 17489.53 toks/s, output: 17.08 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:05<00:01, 17.77it/s, est. speed input: 17505.74 toks/s, output: 17.10 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:05<00:01, 17.83it/s, est. speed input: 17522.53 toks/s, output: 17.11 toks/s]
Processed prompts:  81%|████████▏ | 104/128 [00:06<00:01, 17.87it/s, est. speed input: 17538.48 toks/s, output: 17.13 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:06<00:01, 17.95it/s, est. speed input: 17556.91 toks/s, output: 17.15 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:06<00:01, 17.96it/s, est. speed input: 17572.10 toks/s, output: 17.16 toks/s]
Processed prompts:  86%|████████▌ | 110/128 [00:06<00:01, 17.98it/s, est. speed input: 17587.52 toks/s, output: 17.18 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:06<00:00, 18.05it/s, est. speed input: 17605.60 toks/s, output: 17.19 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:06<00:00, 18.06it/s, est. speed input: 17620.74 toks/s, output: 17.21 toks/s]
Processed prompts:  91%|█████████ | 116/128 [00:06<00:00, 17.66it/s, est. speed input: 17613.21 toks/s, output: 17.20 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:06<00:00, 17.79it/s, est. speed input: 17628.18 toks/s, output: 17.21 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:06<00:00, 17.76it/s, est. speed input: 17636.17 toks/s, output: 17.22 toks/s]
Processed prompts:  95%|█████████▌| 122/128 [00:07<00:00, 17.80it/s, est. speed input: 17647.17 toks/s, output: 17.23 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:07<00:00, 17.91it/s, est. speed input: 17661.54 toks/s, output: 17.25 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:07<00:00, 17.93it/s, est. speed input: 17673.22 toks/s, output: 17.26 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.95it/s, est. speed input: 17684.27 toks/s, output: 17.27 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.95it/s, est. speed input: 17684.27 toks/s, output: 17.27 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:07<00:00, 17.27it/s, est. speed input: 17684.27 toks/s, output: 17.27 toks/s]
[rank0]:[W128 08:52:46.283354445 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 36.8s

测试结果:
  Requests/s:   16.78
  Tokens/s:     17196.48
  Total Reqs:   128
  Elapsed:      7.63s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     17179.70

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:52:52 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:52:52 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3714475) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3714475) WARNING 01-28 08:53:15 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 17.87 requests/s, 18317.49 total tokens/s, 17.87 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 08:52:52] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:52:52] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:52:52] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:52] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:52:52] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:52:52] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:52:52] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:52:52] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:52:52] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:52:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:52:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:52:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:52:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:52:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:52:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:52:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:52:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:52:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3714475) [2026-01-28 08:52:56] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3714475) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3714475) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.49s/it]
(EngineCore_DP0 pid=3714475) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.49s/it]
(EngineCore_DP0 pid=3714475) 
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3714475) [2026-01-28 08:53:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3714475) 2026-01-28 08:53:14,627 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3714475) 2026-01-28 08:53:14,638 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  27%|██▋       | 68/256 [00:00<00:00, 667.76it/s]
Adding requests:  53%|█████▎    | 135/256 [00:00<00:00, 625.08it/s]
Adding requests:  77%|███████▋  | 198/256 [00:00<00:00, 584.88it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 594.60it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 8/256 [00:00<00:06, 39.27it/s, est. speed input: 40217.92 toks/s, output: 39.27 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:09, 26.28it/s, est. speed input: 28819.13 toks/s, output: 28.14 toks/s]
Processed prompts:   6%|▌         | 15/256 [00:00<00:09, 26.33it/s, est. speed input: 28450.05 toks/s, output: 27.78 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:11, 20.49it/s, est. speed input: 24257.91 toks/s, output: 23.69 toks/s]
Processed prompts:   8%|▊         | 21/256 [00:00<00:10, 22.16it/s, est. speed input: 24715.00 toks/s, output: 24.14 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:12, 18.56it/s, est. speed input: 22504.54 toks/s, output: 21.98 toks/s]
Processed prompts:  11%|█         | 27/256 [00:01<00:11, 20.46it/s, est. speed input: 22963.12 toks/s, output: 22.42 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:12, 17.62it/s, est. speed input: 21497.10 toks/s, output: 20.99 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:12, 17.72it/s, est. speed input: 21282.52 toks/s, output: 20.78 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:12, 17.81it/s, est. speed input: 21097.29 toks/s, output: 20.60 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:01<00:12, 17.94it/s, est. speed input: 20953.34 toks/s, output: 20.46 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:01<00:12, 18.00it/s, est. speed input: 20813.77 toks/s, output: 20.33 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:01<00:11, 18.03it/s, est. speed input: 20688.81 toks/s, output: 20.20 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:11, 18.06it/s, est. speed input: 20577.41 toks/s, output: 20.10 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:11, 18.07it/s, est. speed input: 20474.87 toks/s, output: 19.99 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:11, 18.00it/s, est. speed input: 20366.64 toks/s, output: 19.89 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:11, 18.12it/s, est. speed input: 20299.02 toks/s, output: 19.82 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:11, 18.08it/s, est. speed input: 20216.55 toks/s, output: 19.74 toks/s]
Processed prompts:  20%|██        | 52/256 [00:02<00:11, 18.05it/s, est. speed input: 20140.06 toks/s, output: 19.67 toks/s]
Processed prompts:  21%|██        | 54/256 [00:02<00:11, 18.08it/s, est. speed input: 20078.63 toks/s, output: 19.61 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:02<00:11, 18.10it/s, est. speed input: 20020.92 toks/s, output: 19.55 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:02<00:10, 18.21it/s, est. speed input: 19980.68 toks/s, output: 19.51 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:10, 18.21it/s, est. speed input: 19933.60 toks/s, output: 19.47 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:10, 18.14it/s, est. speed input: 19880.45 toks/s, output: 19.41 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:10, 18.22it/s, est. speed input: 19846.68 toks/s, output: 19.38 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:03<00:10, 17.97it/s, est. speed input: 19778.72 toks/s, output: 19.32 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:03<00:10, 18.14it/s, est. speed input: 19754.66 toks/s, output: 19.29 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:03<00:10, 18.11it/s, est. speed input: 19716.04 toks/s, output: 19.25 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:03<00:10, 18.07it/s, est. speed input: 19676.75 toks/s, output: 19.22 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:03<00:10, 18.20it/s, est. speed input: 19656.56 toks/s, output: 19.20 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:03<00:09, 18.18it/s, est. speed input: 19625.85 toks/s, output: 19.17 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:09, 18.17it/s, est. speed input: 19597.60 toks/s, output: 19.14 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:04<00:09, 18.11it/s, est. speed input: 19566.05 toks/s, output: 19.11 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:04<00:09, 18.08it/s, est. speed input: 19537.30 toks/s, output: 19.08 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:04<00:09, 17.82it/s, est. speed input: 19487.71 toks/s, output: 19.03 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:04<00:09, 17.93it/s, est. speed input: 19466.91 toks/s, output: 19.01 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:04<00:09, 17.97it/s, est. speed input: 19443.45 toks/s, output: 18.99 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:04<00:09, 18.12it/s, est. speed input: 19431.64 toks/s, output: 18.98 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:04<00:09, 18.21it/s, est. speed input: 19418.99 toks/s, output: 18.96 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:04<00:08, 18.16it/s, est. speed input: 19398.33 toks/s, output: 18.94 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:08, 18.24it/s, est. speed input: 19386.46 toks/s, output: 18.93 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:05<00:08, 18.24it/s, est. speed input: 19371.95 toks/s, output: 18.92 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:05<00:08, 18.14it/s, est. speed input: 19349.82 toks/s, output: 18.90 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:05<00:08, 18.14it/s, est. speed input: 19333.97 toks/s, output: 18.88 toks/s]
Processed prompts:  41%|████      | 104/256 [00:05<00:08, 17.92it/s, est. speed input: 19303.43 toks/s, output: 18.85 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:05<00:08, 18.07it/s, est. speed input: 19294.68 toks/s, output: 18.84 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:05<00:08, 18.08it/s, est. speed input: 19280.44 toks/s, output: 18.83 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:05<00:08, 18.13it/s, est. speed input: 19269.32 toks/s, output: 18.82 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:05<00:07, 18.22it/s, est. speed input: 19261.78 toks/s, output: 18.81 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:06<00:07, 18.16it/s, est. speed input: 19247.45 toks/s, output: 18.80 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:06<00:07, 18.10it/s, est. speed input: 19231.86 toks/s, output: 18.78 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:06<00:07, 18.16it/s, est. speed input: 19223.31 toks/s, output: 18.77 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:06<00:07, 18.15it/s, est. speed input: 19212.15 toks/s, output: 18.76 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:06<00:07, 17.98it/s, est. speed input: 19191.41 toks/s, output: 18.74 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:06<00:07, 18.00it/s, est. speed input: 19179.20 toks/s, output: 18.73 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:06<00:07, 18.08it/s, est. speed input: 19171.40 toks/s, output: 18.72 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:06<00:07, 18.06it/s, est. speed input: 19159.61 toks/s, output: 18.71 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:06<00:06, 18.12it/s, est. speed input: 19152.18 toks/s, output: 18.70 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:07<00:06, 18.09it/s, est. speed input: 19141.72 toks/s, output: 18.69 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:07<00:06, 18.18it/s, est. speed input: 19136.90 toks/s, output: 18.69 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:07<00:06, 18.15it/s, est. speed input: 19127.67 toks/s, output: 18.68 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:07<00:06, 18.23it/s, est. speed input: 19123.60 toks/s, output: 18.68 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:07<00:06, 18.06it/s, est. speed input: 19108.24 toks/s, output: 18.66 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:07<00:06, 17.79it/s, est. speed input: 19085.15 toks/s, output: 18.64 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:07<00:06, 17.84it/s, est. speed input: 19075.17 toks/s, output: 18.63 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:07<00:06, 17.98it/s, est. speed input: 19070.82 toks/s, output: 18.62 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:07<00:05, 18.16it/s, est. speed input: 19070.21 toks/s, output: 18.62 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:08<00:05, 18.06it/s, est. speed input: 19058.91 toks/s, output: 18.61 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:08<00:05, 18.11it/s, est. speed input: 19053.81 toks/s, output: 18.61 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:08<00:05, 18.17it/s, est. speed input: 19049.78 toks/s, output: 18.60 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:08<00:05, 18.25it/s, est. speed input: 19047.72 toks/s, output: 18.60 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:08<00:05, 18.15it/s, est. speed input: 19038.69 toks/s, output: 18.59 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:08<00:05, 17.90it/s, est. speed input: 19021.29 toks/s, output: 18.58 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:08<00:05, 17.88it/s, est. speed input: 19011.55 toks/s, output: 18.57 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:08<00:05, 18.08it/s, est. speed input: 19011.39 toks/s, output: 18.57 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:08<00:04, 18.09it/s, est. speed input: 19005.71 toks/s, output: 18.56 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:09<00:04, 18.09it/s, est. speed input: 18999.86 toks/s, output: 18.55 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:09<00:04, 18.06it/s, est. speed input: 18992.70 toks/s, output: 18.55 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:09<00:04, 18.12it/s, est. speed input: 18989.36 toks/s, output: 18.54 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:09<00:04, 18.14it/s, est. speed input: 18985.13 toks/s, output: 18.54 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:09<00:04, 18.05it/s, est. speed input: 18976.61 toks/s, output: 18.53 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:09<00:04, 18.13it/s, est. speed input: 18974.33 toks/s, output: 18.53 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:09<00:04, 17.76it/s, est. speed input: 18954.72 toks/s, output: 18.51 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:09<00:04, 17.90it/s, est. speed input: 18951.50 toks/s, output: 18.51 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:09<00:04, 17.99it/s, est. speed input: 18947.95 toks/s, output: 18.50 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:10<00:03, 18.03it/s, est. speed input: 18943.87 toks/s, output: 18.50 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:10<00:03, 17.98it/s, est. speed input: 18936.73 toks/s, output: 18.49 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:10<00:03, 17.98it/s, est. speed input: 18930.90 toks/s, output: 18.49 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:10<00:03, 17.95it/s, est. speed input: 18924.29 toks/s, output: 18.48 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:10<00:03, 18.01it/s, est. speed input: 18920.69 toks/s, output: 18.48 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:10<00:03, 17.93it/s, est. speed input: 18912.96 toks/s, output: 18.47 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:10<00:03, 17.75it/s, est. speed input: 18900.36 toks/s, output: 18.46 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:10<00:03, 17.78it/s, est. speed input: 18894.00 toks/s, output: 18.45 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:10<00:03, 17.91it/s, est. speed input: 18891.74 toks/s, output: 18.45 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:11<00:02, 17.99it/s, est. speed input: 18888.94 toks/s, output: 18.45 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:11<00:02, 18.03it/s, est. speed input: 18885.69 toks/s, output: 18.44 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:11<00:02, 17.99it/s, est. speed input: 18880.26 toks/s, output: 18.44 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:11<00:02, 17.99it/s, est. speed input: 18875.72 toks/s, output: 18.43 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:11<00:02, 18.01it/s, est. speed input: 18872.15 toks/s, output: 18.43 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:11<00:02, 18.05it/s, est. speed input: 18869.10 toks/s, output: 18.43 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:11<00:02, 18.07it/s, est. speed input: 18866.25 toks/s, output: 18.42 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:11<00:02, 17.85it/s, est. speed input: 18855.63 toks/s, output: 18.41 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:11<00:02, 17.96it/s, est. speed input: 18853.83 toks/s, output: 18.41 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:12<00:01, 17.96it/s, est. speed input: 18849.39 toks/s, output: 18.41 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:12<00:01, 18.01it/s, est. speed input: 18846.73 toks/s, output: 18.40 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:12<00:01, 18.05it/s, est. speed input: 18844.38 toks/s, output: 18.40 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:12<00:01, 18.05it/s, est. speed input: 18841.15 toks/s, output: 18.40 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:12<00:01, 18.04it/s, est. speed input: 18837.74 toks/s, output: 18.40 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:12<00:01, 18.01it/s, est. speed input: 18833.71 toks/s, output: 18.39 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:12<00:01, 18.03it/s, est. speed input: 18830.79 toks/s, output: 18.39 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:12<00:01, 17.92it/s, est. speed input: 18824.19 toks/s, output: 18.38 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:12<00:01, 17.97it/s, est. speed input: 18821.63 toks/s, output: 18.38 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:13<00:00, 18.02it/s, est. speed input: 18819.50 toks/s, output: 18.38 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:13<00:00, 18.02it/s, est. speed input: 18816.50 toks/s, output: 18.38 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:13<00:00, 18.12it/s, est. speed input: 18816.30 toks/s, output: 18.38 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:13<00:00, 18.13it/s, est. speed input: 18814.47 toks/s, output: 18.37 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:13<00:00, 18.10it/s, est. speed input: 18811.57 toks/s, output: 18.37 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:13<00:00, 18.10it/s, est. speed input: 18809.45 toks/s, output: 18.37 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:13<00:00, 17.96it/s, est. speed input: 18803.29 toks/s, output: 18.36 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:13<00:00, 18.05it/s, est. speed input: 18802.43 toks/s, output: 18.36 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 18.05it/s, est. speed input: 18868.20 toks/s, output: 18.43 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:13<00:00, 18.43it/s, est. speed input: 18868.20 toks/s, output: 18.43 toks/s]
[rank0]:[W128 08:53:29.831889182 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 43.6s

测试结果:
  Requests/s:   17.87
  Tokens/s:     18317.49
  Total Reqs:   256
  Elapsed:      14.33s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     18299.62

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:53:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:53:37 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3715279) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3715279) WARNING 01-28 08:53:59 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.65 requests/s, 17061.26 total tokens/s, 16.65 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 08:53:36] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:53:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:53:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:53:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:53:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:53:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:53:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:53:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:53:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:53:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:53:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:53:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:53:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:53:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:53:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:53:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:53:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:41] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3715279) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3715279) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.40s/it]
(EngineCore_DP0 pid=3715279) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.40s/it]
(EngineCore_DP0 pid=3715279) 
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3715279) [2026-01-28 08:53:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3715279) 2026-01-28 08:53:58,851 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3715279) 2026-01-28 08:53:58,867 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  13%|█▎        | 65/512 [00:00<00:00, 642.26it/s]
Adding requests:  25%|██▌       | 130/512 [00:00<00:00, 614.60it/s]
Adding requests:  38%|███▊      | 192/512 [00:00<00:00, 572.07it/s]
Adding requests:  49%|████▉     | 250/512 [00:00<00:00, 574.63it/s]
Adding requests:  60%|██████    | 308/512 [00:00<00:00, 558.52it/s]
Adding requests:  71%|███████▏  | 365/512 [00:00<00:00, 560.18it/s]
Adding requests:  82%|████████▏ | 422/512 [00:00<00:00, 548.65it/s]
Adding requests:  93%|█████████▎| 477/512 [00:00<00:00, 548.92it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 562.11it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:00<00:08, 59.82it/s, est. speed input: 61260.60 toks/s, output: 59.82 toks/s]
Processed prompts:   4%|▍         | 20/512 [00:00<00:12, 39.17it/s, est. speed input: 43248.93 toks/s, output: 42.24 toks/s]
Processed prompts:   5%|▍         | 24/512 [00:00<00:16, 28.90it/s, est. speed input: 34500.55 toks/s, output: 33.69 toks/s]
Processed prompts:   5%|▌         | 27/512 [00:00<00:21, 22.51it/s, est. speed input: 29129.02 toks/s, output: 28.45 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:01<00:25, 18.84it/s, est. speed input: 25808.29 toks/s, output: 25.20 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:01<00:26, 18.12it/s, est. speed input: 24355.12 toks/s, output: 23.78 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:01<00:26, 17.74it/s, est. speed input: 23360.61 toks/s, output: 22.81 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:01<00:26, 17.48it/s, est. speed input: 22609.59 toks/s, output: 22.08 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:27, 17.16it/s, est. speed input: 21959.59 toks/s, output: 21.44 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:27, 17.05it/s, est. speed input: 21485.19 toks/s, output: 20.98 toks/s]
Processed prompts:  11%|█         | 54/512 [00:02<00:26, 16.96it/s, est. speed input: 21092.65 toks/s, output: 20.60 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:02<00:26, 16.89it/s, est. speed input: 20759.82 toks/s, output: 20.27 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:26, 16.83it/s, est. speed input: 20476.44 toks/s, output: 20.00 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:26, 16.74it/s, est. speed input: 20220.66 toks/s, output: 19.75 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:03<00:26, 16.71it/s, est. speed input: 20008.26 toks/s, output: 19.54 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:03<00:26, 16.73it/s, est. speed input: 19830.39 toks/s, output: 19.37 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:25, 16.70it/s, est. speed input: 19664.22 toks/s, output: 19.20 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:25, 16.71it/s, est. speed input: 19525.26 toks/s, output: 19.07 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:04<00:25, 16.72it/s, est. speed input: 19398.93 toks/s, output: 18.94 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:04<00:25, 16.76it/s, est. speed input: 19292.56 toks/s, output: 18.84 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:24, 16.77it/s, est. speed input: 19193.68 toks/s, output: 18.74 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:05<00:24, 16.79it/s, est. speed input: 19105.11 toks/s, output: 18.66 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:05<00:24, 16.70it/s, est. speed input: 19006.95 toks/s, output: 18.56 toks/s]
Processed prompts:  21%|██        | 106/512 [00:05<00:24, 16.77it/s, est. speed input: 18938.11 toks/s, output: 18.49 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:05<00:23, 16.78it/s, est. speed input: 18869.16 toks/s, output: 18.43 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:06<00:23, 16.77it/s, est. speed input: 18803.66 toks/s, output: 18.36 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:06<00:23, 16.67it/s, est. speed input: 18729.14 toks/s, output: 18.29 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:06<00:23, 16.70it/s, est. speed input: 18674.02 toks/s, output: 18.24 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:06<00:23, 16.71it/s, est. speed input: 18621.26 toks/s, output: 18.18 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:07<00:22, 16.78it/s, est. speed input: 18578.50 toks/s, output: 18.14 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:07<00:22, 16.72it/s, est. speed input: 18527.03 toks/s, output: 18.09 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:07<00:22, 16.71it/s, est. speed input: 18481.82 toks/s, output: 18.05 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:07<00:22, 16.70it/s, est. speed input: 18439.08 toks/s, output: 18.01 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:08<00:21, 16.73it/s, est. speed input: 18403.38 toks/s, output: 17.97 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:08<00:21, 16.71it/s, est. speed input: 18364.96 toks/s, output: 17.93 toks/s]
Processed prompts:  30%|███       | 154/512 [00:08<00:21, 16.64it/s, est. speed input: 18322.51 toks/s, output: 17.89 toks/s]
Processed prompts:  31%|███       | 158/512 [00:08<00:21, 16.64it/s, est. speed input: 18287.91 toks/s, output: 17.86 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:09<00:20, 16.68it/s, est. speed input: 18258.68 toks/s, output: 17.83 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:09<00:20, 16.73it/s, est. speed input: 18232.76 toks/s, output: 17.81 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:09<00:20, 16.64it/s, est. speed input: 18197.02 toks/s, output: 17.77 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:09<00:20, 16.67it/s, est. speed input: 18171.17 toks/s, output: 17.75 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:10<00:19, 16.72it/s, est. speed input: 18149.55 toks/s, output: 17.72 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:10<00:19, 16.74it/s, est. speed input: 18127.03 toks/s, output: 17.70 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:10<00:19, 16.73it/s, est. speed input: 18103.99 toks/s, output: 17.68 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:10<00:19, 16.62it/s, est. speed input: 18073.87 toks/s, output: 17.65 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:11<00:19, 16.64it/s, est. speed input: 18052.12 toks/s, output: 17.63 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:11<00:18, 16.68it/s, est. speed input: 18033.40 toks/s, output: 17.61 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:11<00:18, 16.72it/s, est. speed input: 18016.52 toks/s, output: 17.59 toks/s]
Processed prompts:  40%|████      | 206/512 [00:11<00:18, 16.63it/s, est. speed input: 17991.67 toks/s, output: 17.57 toks/s]
Processed prompts:  41%|████      | 210/512 [00:11<00:18, 16.63it/s, est. speed input: 17972.60 toks/s, output: 17.55 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:12<00:17, 16.66it/s, est. speed input: 17955.76 toks/s, output: 17.53 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:12<00:17, 16.67it/s, est. speed input: 17939.05 toks/s, output: 17.52 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:12<00:17, 16.71it/s, est. speed input: 17925.19 toks/s, output: 17.51 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:12<00:17, 16.56it/s, est. speed input: 17900.30 toks/s, output: 17.48 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:13<00:16, 16.65it/s, est. speed input: 17888.84 toks/s, output: 17.47 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:13<00:16, 16.67it/s, est. speed input: 17874.84 toks/s, output: 17.46 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:13<00:16, 16.70it/s, est. speed input: 17862.74 toks/s, output: 17.44 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:13<00:16, 16.57it/s, est. speed input: 17841.82 toks/s, output: 17.42 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:14<00:16, 16.62it/s, est. speed input: 17829.75 toks/s, output: 17.41 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:14<00:15, 16.64it/s, est. speed input: 17817.20 toks/s, output: 17.40 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:14<00:15, 16.68it/s, est. speed input: 17806.80 toks/s, output: 17.39 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:14<00:15, 16.65it/s, est. speed input: 17793.66 toks/s, output: 17.38 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:15<00:15, 16.61it/s, est. speed input: 17779.50 toks/s, output: 17.36 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:15<00:14, 16.66it/s, est. speed input: 17770.13 toks/s, output: 17.35 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:15<00:14, 16.65it/s, est. speed input: 17758.69 toks/s, output: 17.34 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:15<00:14, 16.73it/s, est. speed input: 17751.97 toks/s, output: 17.34 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:16<00:14, 16.60it/s, est. speed input: 17735.93 toks/s, output: 17.32 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:16<00:13, 16.64it/s, est. speed input: 17727.38 toks/s, output: 17.31 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:16<00:13, 16.73it/s, est. speed input: 17721.76 toks/s, output: 17.31 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:16<00:13, 16.81it/s, est. speed input: 17717.19 toks/s, output: 17.30 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:17<00:13, 16.74it/s, est. speed input: 17707.02 toks/s, output: 17.29 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:17<00:12, 16.67it/s, est. speed input: 17695.66 toks/s, output: 17.28 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:17<00:12, 16.72it/s, est. speed input: 17689.64 toks/s, output: 17.28 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:17<00:12, 16.71it/s, est. speed input: 17681.42 toks/s, output: 17.27 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:17<00:12, 16.75it/s, est. speed input: 17675.74 toks/s, output: 17.26 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:18<00:11, 16.64it/s, est. speed input: 17663.49 toks/s, output: 17.25 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:18<00:11, 16.68it/s, est. speed input: 17657.19 toks/s, output: 17.24 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:18<00:11, 16.70it/s, est. speed input: 17650.98 toks/s, output: 17.24 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:18<00:11, 16.70it/s, est. speed input: 17644.03 toks/s, output: 17.23 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:19<00:10, 16.63it/s, est. speed input: 17634.19 toks/s, output: 17.22 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:19<00:10, 16.65it/s, est. speed input: 17627.28 toks/s, output: 17.21 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:19<00:10, 16.76it/s, est. speed input: 17624.90 toks/s, output: 17.21 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:19<00:09, 17.40it/s, est. speed input: 17645.45 toks/s, output: 17.23 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:20<00:09, 17.19it/s, est. speed input: 17639.11 toks/s, output: 17.23 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:20<00:09, 16.96it/s, est. speed input: 17629.64 toks/s, output: 17.22 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:20<00:09, 16.87it/s, est. speed input: 17623.13 toks/s, output: 17.21 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:20<00:09, 16.87it/s, est. speed input: 17619.22 toks/s, output: 17.21 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:21<00:08, 16.82it/s, est. speed input: 17613.25 toks/s, output: 17.20 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:21<00:08, 16.70it/s, est. speed input: 17604.09 toks/s, output: 17.19 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:21<00:08, 16.65it/s, est. speed input: 17596.45 toks/s, output: 17.18 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:21<00:08, 16.71it/s, est. speed input: 17592.89 toks/s, output: 17.18 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:22<00:08, 16.66it/s, est. speed input: 17585.72 toks/s, output: 17.17 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:22<00:07, 16.68it/s, est. speed input: 17580.62 toks/s, output: 17.17 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:22<00:07, 16.60it/s, est. speed input: 17572.42 toks/s, output: 17.16 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:22<00:07, 16.66it/s, est. speed input: 17568.48 toks/s, output: 17.16 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:22<00:07, 16.65it/s, est. speed input: 17562.92 toks/s, output: 17.15 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:23<00:06, 16.66it/s, est. speed input: 17557.99 toks/s, output: 17.15 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:23<00:06, 16.57it/s, est. speed input: 17549.57 toks/s, output: 17.14 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:23<00:06, 16.63it/s, est. speed input: 17545.72 toks/s, output: 17.13 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:23<00:06, 16.69it/s, est. speed input: 17542.64 toks/s, output: 17.13 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:24<00:05, 16.65it/s, est. speed input: 17536.73 toks/s, output: 17.13 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:24<00:05, 16.68it/s, est. speed input: 17533.18 toks/s, output: 17.12 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:24<00:05, 16.62it/s, est. speed input: 17526.49 toks/s, output: 17.12 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:24<00:05, 16.66it/s, est. speed input: 17522.99 toks/s, output: 17.11 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:25<00:04, 16.71it/s, est. speed input: 17520.14 toks/s, output: 17.11 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:25<00:04, 16.78it/s, est. speed input: 17518.59 toks/s, output: 17.11 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:25<00:04, 16.68it/s, est. speed input: 17512.10 toks/s, output: 17.10 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:25<00:04, 16.65it/s, est. speed input: 17507.29 toks/s, output: 17.10 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:26<00:03, 16.69it/s, est. speed input: 17504.37 toks/s, output: 17.09 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:26<00:03, 17.62it/s, est. speed input: 17528.73 toks/s, output: 17.12 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:26<00:03, 17.28it/s, est. speed input: 17523.28 toks/s, output: 17.11 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:26<00:03, 17.05it/s, est. speed input: 17517.85 toks/s, output: 17.11 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:27<00:02, 16.92it/s, est. speed input: 17513.47 toks/s, output: 17.10 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:27<00:02, 16.91it/s, est. speed input: 17511.52 toks/s, output: 17.10 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:27<00:02, 16.84it/s, est. speed input: 17507.86 toks/s, output: 17.10 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:27<00:02, 16.75it/s, est. speed input: 17502.83 toks/s, output: 17.09 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:27<00:02, 16.70it/s, est. speed input: 17498.25 toks/s, output: 17.09 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:28<00:01, 16.73it/s, est. speed input: 17495.83 toks/s, output: 17.09 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:28<00:01, 16.77it/s, est. speed input: 17493.83 toks/s, output: 17.08 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:28<00:01, 16.72it/s, est. speed input: 17489.77 toks/s, output: 17.08 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:28<00:01, 16.62it/s, est. speed input: 17483.90 toks/s, output: 17.07 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:29<00:00, 16.67it/s, est. speed input: 17481.54 toks/s, output: 17.07 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:29<00:00, 16.71it/s, est. speed input: 17479.30 toks/s, output: 17.07 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:29<00:00, 16.70it/s, est. speed input: 17476.13 toks/s, output: 17.07 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:29<00:00, 17.60it/s, est. speed input: 17497.00 toks/s, output: 17.09 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:29<00:00, 17.60it/s, est. speed input: 17565.55 toks/s, output: 17.15 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:29<00:00, 17.15it/s, est. speed input: 17565.55 toks/s, output: 17.15 toks/s]
[rank0]:[W128 08:54:30.551155912 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 60.7s

测试结果:
  Requests/s:   16.65
  Tokens/s:     17061.26
  Total Reqs:   512
  Elapsed:      30.76s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     17044.61

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:54:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:54:39 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3716334) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3716334) WARNING 01-28 08:55:02 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.86 requests/s, 17285.40 total tokens/s, 16.86 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 08:54:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:54:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:54:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:54:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:54:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:54:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:54:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:54:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:54:42] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:54:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:54:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:54:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:54:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:54:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:54:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:54:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:54:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:43] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3716334) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3716334) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.48s/it]
(EngineCore_DP0 pid=3716334) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.48s/it]
(EngineCore_DP0 pid=3716334) 
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3716334) [2026-01-28 08:54:55] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3716334) 2026-01-28 08:55:01,692 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3716334) 2026-01-28 08:55:01,746 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 58/1024 [00:00<00:01, 573.63it/s]
Adding requests:  11%|█▏        | 116/1024 [00:00<00:01, 558.84it/s]
Adding requests:  17%|█▋        | 172/1024 [00:00<00:01, 514.67it/s]
Adding requests:  22%|██▏       | 224/1024 [00:00<00:01, 504.81it/s]
Adding requests:  27%|██▋       | 276/1024 [00:00<00:01, 508.19it/s]
Adding requests:  32%|███▏      | 327/1024 [00:00<00:01, 507.01it/s]
Adding requests:  37%|███▋      | 378/1024 [00:00<00:01, 500.72it/s]
Adding requests:  42%|████▏     | 429/1024 [00:00<00:01, 499.34it/s]
Adding requests:  47%|████▋     | 479/1024 [00:00<00:01, 498.81it/s]
Adding requests:  52%|█████▏    | 529/1024 [00:01<00:01, 491.11it/s]
Adding requests:  57%|█████▋    | 581/1024 [00:01<00:00, 496.35it/s]
Adding requests:  62%|██████▏   | 631/1024 [00:01<00:00, 482.59it/s]
Adding requests:  67%|██████▋   | 682/1024 [00:01<00:00, 489.07it/s]
Adding requests:  72%|███████▏  | 735/1024 [00:01<00:00, 498.80it/s]
Adding requests:  77%|███████▋  | 785/1024 [00:01<00:00, 493.39it/s]
Adding requests:  82%|████████▏ | 835/1024 [00:01<00:00, 479.77it/s]
Adding requests:  86%|████████▋ | 885/1024 [00:01<00:00, 484.48it/s]
Adding requests:  91%|█████████▏| 936/1024 [00:01<00:00, 490.15it/s]
Adding requests:  96%|█████████▋| 986/1024 [00:01<00:00, 492.14it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 498.04it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:00<00:14, 67.78it/s, est. speed input: 69409.36 toks/s, output: 67.78 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:00<00:25, 38.64it/s, est. speed input: 44182.74 toks/s, output: 43.15 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:01<00:33, 28.74it/s, est. speed input: 35301.47 toks/s, output: 34.47 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:01<00:40, 24.14it/s, est. speed input: 30901.65 toks/s, output: 30.18 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:02<00:44, 21.56it/s, est. speed input: 28227.11 toks/s, output: 27.57 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:02<00:47, 19.97it/s, est. speed input: 26419.00 toks/s, output: 25.80 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:03<00:49, 19.01it/s, est. speed input: 25150.58 toks/s, output: 24.56 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:03<00:50, 18.32it/s, est. speed input: 24164.75 toks/s, output: 23.60 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:04<00:51, 17.88it/s, est. speed input: 23409.94 toks/s, output: 22.86 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:04<00:52, 17.53it/s, est. speed input: 22784.33 toks/s, output: 22.25 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:05<00:52, 17.34it/s, est. speed input: 22288.89 toks/s, output: 21.77 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:05<00:52, 17.16it/s, est. speed input: 21859.32 toks/s, output: 21.35 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:06<00:52, 17.08it/s, est. speed input: 21511.89 toks/s, output: 21.01 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:06<00:51, 17.05it/s, est. speed input: 21220.41 toks/s, output: 20.72 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:07<00:51, 16.96it/s, est. speed input: 20946.82 toks/s, output: 20.46 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:07<00:51, 16.95it/s, est. speed input: 20722.08 toks/s, output: 20.24 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:08<00:51, 16.90it/s, est. speed input: 20513.74 toks/s, output: 20.03 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:08<00:50, 16.90it/s, est. speed input: 20336.73 toks/s, output: 19.86 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:09<00:50, 16.85it/s, est. speed input: 20167.07 toks/s, output: 19.69 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:09<00:49, 16.88it/s, est. speed input: 20027.48 toks/s, output: 19.56 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:09<00:49, 16.85it/s, est. speed input: 19891.68 toks/s, output: 19.43 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:10<00:48, 16.86it/s, est. speed input: 19773.95 toks/s, output: 19.31 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:10<00:48, 16.88it/s, est. speed input: 19668.82 toks/s, output: 19.21 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:11<00:47, 16.86it/s, est. speed input: 19566.23 toks/s, output: 19.11 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:11<00:47, 16.91it/s, est. speed input: 19482.37 toks/s, output: 19.03 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:12<00:46, 16.87it/s, est. speed input: 19393.17 toks/s, output: 18.94 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:12<00:46, 16.88it/s, est. speed input: 19315.66 toks/s, output: 18.86 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:13<00:45, 16.84it/s, est. speed input: 19238.37 toks/s, output: 18.79 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:13<00:45, 16.87it/s, est. speed input: 19173.18 toks/s, output: 18.72 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:14<00:45, 16.83it/s, est. speed input: 19104.84 toks/s, output: 18.66 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:14<00:44, 16.86it/s, est. speed input: 19048.51 toks/s, output: 18.60 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:15<00:43, 16.88it/s, est. speed input: 18995.24 toks/s, output: 18.55 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:15<00:43, 16.84it/s, est. speed input: 18939.28 toks/s, output: 18.50 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:16<00:43, 16.87it/s, est. speed input: 18892.30 toks/s, output: 18.45 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:16<00:42, 16.81it/s, est. speed input: 18840.39 toks/s, output: 18.40 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:17<00:42, 16.88it/s, est. speed input: 18802.55 toks/s, output: 18.36 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:17<00:41, 16.83it/s, est. speed input: 18755.75 toks/s, output: 18.32 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:18<00:41, 16.85it/s, est. speed input: 18718.24 toks/s, output: 18.28 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:18<00:39, 17.16it/s, est. speed input: 18709.46 toks/s, output: 18.27 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:18<00:39, 17.09it/s, est. speed input: 18674.82 toks/s, output: 18.24 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:19<00:39, 17.05it/s, est. speed input: 18643.39 toks/s, output: 18.21 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:19<00:39, 16.94it/s, est. speed input: 18606.28 toks/s, output: 18.17 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:20<00:38, 16.94it/s, est. speed input: 18577.12 toks/s, output: 18.14 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:20<00:38, 16.88it/s, est. speed input: 18544.17 toks/s, output: 18.11 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:21<00:37, 16.90it/s, est. speed input: 18518.01 toks/s, output: 18.08 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:21<00:37, 16.85it/s, est. speed input: 18487.84 toks/s, output: 18.05 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:22<00:36, 16.87it/s, est. speed input: 18462.61 toks/s, output: 18.03 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:22<00:36, 16.84it/s, est. speed input: 18435.96 toks/s, output: 18.00 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:23<00:35, 16.86it/s, est. speed input: 18412.66 toks/s, output: 17.98 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:23<00:35, 16.88it/s, est. speed input: 18391.28 toks/s, output: 17.96 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:24<00:34, 16.87it/s, est. speed input: 18368.64 toks/s, output: 17.94 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:24<00:34, 16.88it/s, est. speed input: 18348.47 toks/s, output: 17.92 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:25<00:33, 17.22it/s, est. speed input: 18351.37 toks/s, output: 17.92 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:25<00:33, 17.13it/s, est. speed input: 18332.20 toks/s, output: 17.90 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:26<00:32, 17.02it/s, est. speed input: 18311.00 toks/s, output: 17.88 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:26<00:32, 16.99it/s, est. speed input: 18293.33 toks/s, output: 17.86 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:27<00:32, 16.93it/s, est. speed input: 18274.01 toks/s, output: 17.85 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:27<00:31, 16.92it/s, est. speed input: 18257.57 toks/s, output: 17.83 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:27<00:31, 16.91it/s, est. speed input: 18241.07 toks/s, output: 17.81 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:28<00:30, 16.86it/s, est. speed input: 18222.64 toks/s, output: 17.80 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:28<00:30, 16.87it/s, est. speed input: 18207.47 toks/s, output: 17.78 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:29<00:29, 16.85it/s, est. speed input: 18191.45 toks/s, output: 17.77 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:29<00:29, 16.87it/s, est. speed input: 18177.81 toks/s, output: 17.75 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:30<00:28, 16.83it/s, est. speed input: 18161.52 toks/s, output: 17.74 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:30<00:28, 16.86it/s, est. speed input: 18148.92 toks/s, output: 17.72 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:31<00:27, 16.83it/s, est. speed input: 18133.56 toks/s, output: 17.71 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:31<00:27, 16.84it/s, est. speed input: 18120.97 toks/s, output: 17.70 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:32<00:26, 16.86it/s, est. speed input: 18109.07 toks/s, output: 17.68 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:32<00:26, 16.84it/s, est. speed input: 18095.51 toks/s, output: 17.67 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:33<00:25, 16.87it/s, est. speed input: 18085.21 toks/s, output: 17.66 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:33<00:25, 16.82it/s, est. speed input: 18071.33 toks/s, output: 17.65 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:34<00:25, 16.87it/s, est. speed input: 18061.78 toks/s, output: 17.64 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:34<00:24, 16.83it/s, est. speed input: 18048.96 toks/s, output: 17.63 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:35<00:24, 16.86it/s, est. speed input: 18039.60 toks/s, output: 17.62 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:35<00:23, 16.85it/s, est. speed input: 18028.76 toks/s, output: 17.61 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:36<00:23, 16.89it/s, est. speed input: 18020.58 toks/s, output: 17.60 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:36<00:22, 16.90it/s, est. speed input: 18011.64 toks/s, output: 17.59 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:36<00:22, 16.86it/s, est. speed input: 18000.66 toks/s, output: 17.58 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:37<00:21, 16.89it/s, est. speed input: 17992.79 toks/s, output: 17.57 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:37<00:21, 16.84it/s, est. speed input: 17981.84 toks/s, output: 17.56 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:38<00:20, 16.87it/s, est. speed input: 17973.81 toks/s, output: 17.55 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:38<00:20, 16.83it/s, est. speed input: 17963.67 toks/s, output: 17.54 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:39<00:19, 16.86it/s, est. speed input: 17956.13 toks/s, output: 17.54 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:39<00:19, 16.82it/s, est. speed input: 17946.02 toks/s, output: 17.53 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:40<00:18, 16.86it/s, est. speed input: 17939.24 toks/s, output: 17.52 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:40<00:18, 16.88it/s, est. speed input: 17932.21 toks/s, output: 17.51 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:41<00:17, 16.82it/s, est. speed input: 17922.55 toks/s, output: 17.50 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:41<00:17, 16.87it/s, est. speed input: 17916.53 toks/s, output: 17.50 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:42<00:16, 16.83it/s, est. speed input: 17907.72 toks/s, output: 17.49 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:42<00:16, 16.87it/s, est. speed input: 17901.95 toks/s, output: 17.48 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:43<00:16, 16.84it/s, est. speed input: 17893.67 toks/s, output: 17.47 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:43<00:15, 16.85it/s, est. speed input: 17887.12 toks/s, output: 17.47 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:44<00:15, 16.81it/s, est. speed input: 17878.72 toks/s, output: 17.46 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:44<00:14, 16.85it/s, est. speed input: 17873.22 toks/s, output: 17.45 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:45<00:14, 16.88it/s, est. speed input: 17867.85 toks/s, output: 17.45 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:45<00:13, 16.87it/s, est. speed input: 17861.25 toks/s, output: 17.44 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:45<00:13, 16.87it/s, est. speed input: 17855.32 toks/s, output: 17.44 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:46<00:12, 16.88it/s, est. speed input: 17849.80 toks/s, output: 17.43 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:46<00:12, 16.88it/s, est. speed input: 17844.12 toks/s, output: 17.43 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:47<00:11, 16.84it/s, est. speed input: 17837.07 toks/s, output: 17.42 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:47<00:11, 16.86it/s, est. speed input: 17831.90 toks/s, output: 17.41 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:48<00:10, 16.83it/s, est. speed input: 17825.37 toks/s, output: 17.41 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:48<00:10, 16.86it/s, est. speed input: 17820.48 toks/s, output: 17.40 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:49<00:09, 16.88it/s, est. speed input: 17815.77 toks/s, output: 17.40 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:49<00:09, 16.83it/s, est. speed input: 17809.07 toks/s, output: 17.39 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:50<00:08, 16.88it/s, est. speed input: 17805.18 toks/s, output: 17.39 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:50<00:08, 16.84it/s, est. speed input: 17799.18 toks/s, output: 17.38 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:51<00:07, 16.86it/s, est. speed input: 17794.47 toks/s, output: 17.38 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:51<00:07, 16.82it/s, est. speed input: 17788.54 toks/s, output: 17.37 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [00:52<00:07, 16.85it/s, est. speed input: 17784.37 toks/s, output: 17.37 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [00:52<00:06, 16.82it/s, est. speed input: 17778.61 toks/s, output: 17.36 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [00:53<00:06, 16.86it/s, est. speed input: 17774.83 toks/s, output: 17.36 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [00:53<00:05, 16.88it/s, est. speed input: 17771.00 toks/s, output: 17.35 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [00:54<00:04, 17.42it/s, est. speed input: 17782.84 toks/s, output: 17.37 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [00:54<00:04, 17.25it/s, est. speed input: 17778.43 toks/s, output: 17.36 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [00:54<00:04, 17.09it/s, est. speed input: 17772.83 toks/s, output: 17.36 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [00:55<00:03, 17.05it/s, est. speed input: 17769.37 toks/s, output: 17.35 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [00:55<00:03, 16.95it/s, est. speed input: 17763.65 toks/s, output: 17.35 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [00:56<00:02, 16.96it/s, est. speed input: 17760.64 toks/s, output: 17.34 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [00:56<00:02, 17.58it/s, est. speed input: 17774.59 toks/s, output: 17.36 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [00:57<00:01, 17.31it/s, est. speed input: 17769.20 toks/s, output: 17.35 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [00:57<00:01, 17.20it/s, est. speed input: 17765.82 toks/s, output: 17.35 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [00:58<00:00, 17.08it/s, est. speed input: 17761.21 toks/s, output: 17.34 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [00:58<00:00, 17.47it/s, est. speed input: 17769.56 toks/s, output: 17.35 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:58<00:00, 17.47it/s, est. speed input: 17874.25 toks/s, output: 17.46 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [00:58<00:00, 17.46it/s, est. speed input: 17874.25 toks/s, output: 17.46 toks/s]
[rank0]:[W128 08:56:03.594419514 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 93.0s

测试结果:
  Requests/s:   16.86
  Tokens/s:     17285.40
  Total Reqs:   1024
  Elapsed:      60.72s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     17268.54

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:56:15 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:56:15 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3717843) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3717843) WARNING 01-28 08:56:39 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 17.11 requests/s, 17540.62 total tokens/s, 17.11 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 08:56:15] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:56:15] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:56:15] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:15] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:56:15] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:56:15] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:56:15] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:56:15] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:56:15] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:56:18] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:56:18] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:56:18] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:56:18] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:56:18] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:56:18] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:56:18] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:56:18] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:56:18] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:19] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3717843) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3717843) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.50s/it]
(EngineCore_DP0 pid=3717843) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.50s/it]
(EngineCore_DP0 pid=3717843) 
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3717843) [2026-01-28 08:56:31] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3717843) 2026-01-28 08:56:37,943 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3717843) 2026-01-28 08:56:38,045 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 66/2048 [00:00<00:03, 653.18it/s]
Adding requests:   6%|▋         | 132/2048 [00:00<00:03, 611.12it/s]
Adding requests:   9%|▉         | 194/2048 [00:00<00:03, 546.62it/s]
Adding requests:  12%|█▏        | 250/2048 [00:00<00:03, 541.64it/s]
Adding requests:  15%|█▍        | 305/2048 [00:00<00:03, 530.02it/s]
Adding requests:  18%|█▊        | 359/2048 [00:00<00:03, 532.71it/s]
Adding requests:  20%|██        | 413/2048 [00:00<00:03, 527.84it/s]
Adding requests:  23%|██▎       | 467/2048 [00:00<00:02, 529.81it/s]
Adding requests:  25%|██▌       | 521/2048 [00:00<00:02, 513.18it/s]
Adding requests:  28%|██▊       | 573/2048 [00:01<00:02, 513.26it/s]
Adding requests:  31%|███       | 626/2048 [00:01<00:02, 513.94it/s]
Adding requests:  33%|███▎      | 678/2048 [00:01<00:02, 510.81it/s]
Adding requests:  36%|███▌      | 733/2048 [00:01<00:02, 519.37it/s]
Adding requests:  38%|███▊      | 785/2048 [00:01<00:02, 494.27it/s]
Adding requests:  41%|████      | 835/2048 [00:01<00:02, 491.44it/s]
Adding requests:  43%|████▎     | 885/2048 [00:02<00:06, 175.66it/s]
Adding requests:  46%|████▌     | 935/2048 [00:02<00:05, 217.03it/s]
Adding requests:  48%|████▊     | 984/2048 [00:02<00:04, 259.12it/s]
Adding requests:  51%|█████     | 1037/2048 [00:02<00:03, 307.01it/s]
Adding requests:  53%|█████▎    | 1088/2048 [00:02<00:02, 347.84it/s]
Adding requests:  56%|█████▌    | 1139/2048 [00:02<00:02, 382.80it/s]
Adding requests:  58%|█████▊    | 1195/2048 [00:02<00:02, 424.49it/s]
Adding requests:  61%|██████    | 1247/2048 [00:03<00:01, 448.17it/s]
Adding requests:  63%|██████▎   | 1298/2048 [00:03<00:01, 455.86it/s]
Adding requests:  66%|██████▌   | 1348/2048 [00:03<00:01, 463.69it/s]
Adding requests:  68%|██████▊   | 1399/2048 [00:03<00:01, 475.84it/s]
Adding requests:  71%|███████   | 1449/2048 [00:03<00:01, 481.92it/s]
Adding requests:  73%|███████▎  | 1502/2048 [00:03<00:01, 494.31it/s]
Adding requests:  76%|███████▌  | 1553/2048 [00:03<00:01, 494.22it/s]
Adding requests:  78%|███████▊  | 1607/2048 [00:03<00:00, 506.22it/s]
Adding requests:  81%|████████  | 1659/2048 [00:03<00:00, 502.17it/s]
Adding requests:  83%|████████▎ | 1710/2048 [00:03<00:00, 501.67it/s]
Adding requests:  86%|████████▌ | 1761/2048 [00:04<00:00, 500.18it/s]
Adding requests:  89%|████████▊ | 1813/2048 [00:04<00:00, 505.55it/s]
Adding requests:  91%|█████████ | 1864/2048 [00:04<00:00, 501.96it/s]
Adding requests:  94%|█████████▎| 1915/2048 [00:04<00:00, 504.19it/s]
Adding requests:  96%|█████████▌| 1966/2048 [00:04<00:00, 498.00it/s]
Adding requests:  98%|█████████▊| 2016/2048 [00:04<00:00, 485.33it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 440.50it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:00<00:07, 276.94it/s, est. speed input: 283620.43 toks/s, output: 276.95 toks/s]
Processed prompts:   5%|▍         | 94/2048 [00:01<00:29, 67.23it/s, est. speed input: 81907.29 toks/s, output: 79.99 toks/s]   
Processed prompts:   5%|▌         | 108/2048 [00:02<00:50, 38.61it/s, est. speed input: 52397.59 toks/s, output: 51.17 toks/s]
Processed prompts:   6%|▌         | 116/2048 [00:03<01:15, 25.43it/s, est. speed input: 39015.13 toks/s, output: 38.10 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:03<01:29, 21.38it/s, est. speed input: 33429.52 toks/s, output: 32.65 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:04<01:35, 19.87it/s, est. speed input: 30410.05 toks/s, output: 29.70 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:05<01:39, 18.93it/s, est. speed input: 28345.18 toks/s, output: 27.68 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:06<01:41, 18.37it/s, est. speed input: 26870.41 toks/s, output: 26.24 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:07<01:43, 17.95it/s, est. speed input: 25728.82 toks/s, output: 25.13 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:08<01:44, 17.66it/s, est. speed input: 24826.60 toks/s, output: 24.24 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:09<01:44, 17.49it/s, est. speed input: 24113.47 toks/s, output: 23.55 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:10<01:44, 17.36it/s, est. speed input: 23522.75 toks/s, output: 22.97 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:11<01:43, 17.28it/s, est. speed input: 23032.32 toks/s, output: 22.49 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:12<01:43, 17.21it/s, est. speed input: 22611.37 toks/s, output: 22.08 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:13<01:42, 17.19it/s, est. speed input: 22257.65 toks/s, output: 21.74 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:14<01:41, 17.21it/s, est. speed input: 21959.67 toks/s, output: 21.44 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:15<01:40, 17.16it/s, est. speed input: 21681.17 toks/s, output: 21.17 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:16<01:39, 17.27it/s, est. speed input: 21470.37 toks/s, output: 20.97 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:17<01:38, 17.22it/s, est. speed input: 21253.47 toks/s, output: 20.76 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:17<01:37, 17.18it/s, est. speed input: 21057.66 toks/s, output: 20.56 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:18<01:36, 17.16it/s, est. speed input: 20884.04 toks/s, output: 20.39 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:19<01:36, 17.14it/s, est. speed input: 20723.41 toks/s, output: 20.24 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:20<01:35, 17.12it/s, est. speed input: 20577.29 toks/s, output: 20.09 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:21<01:34, 17.11it/s, est. speed input: 20444.51 toks/s, output: 19.97 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:22<01:32, 17.21it/s, est. speed input: 20340.10 toks/s, output: 19.86 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:23<01:32, 17.20it/s, est. speed input: 20231.04 toks/s, output: 19.76 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:24<01:31, 17.17it/s, est. speed input: 20126.98 toks/s, output: 19.66 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:25<01:30, 17.15it/s, est. speed input: 20031.36 toks/s, output: 19.56 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:26<01:29, 17.14it/s, est. speed input: 19942.53 toks/s, output: 19.48 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:27<01:28, 17.12it/s, est. speed input: 19858.68 toks/s, output: 19.39 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:28<01:27, 17.10it/s, est. speed input: 19778.76 toks/s, output: 19.32 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:29<01:26, 17.12it/s, est. speed input: 19708.89 toks/s, output: 19.25 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:30<01:26, 17.08it/s, est. speed input: 19636.39 toks/s, output: 19.18 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:31<01:25, 17.08it/s, est. speed input: 19571.28 toks/s, output: 19.11 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:32<01:24, 17.08it/s, est. speed input: 19511.00 toks/s, output: 19.05 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:32<01:23, 17.05it/s, est. speed input: 19450.41 toks/s, output: 18.99 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:33<01:22, 17.07it/s, est. speed input: 19397.62 toks/s, output: 18.94 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:34<01:21, 17.08it/s, est. speed input: 19347.07 toks/s, output: 18.89 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:35<01:20, 17.09it/s, est. speed input: 19298.88 toks/s, output: 18.85 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:36<01:19, 17.09it/s, est. speed input: 19253.40 toks/s, output: 18.80 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:37<01:18, 17.05it/s, est. speed input: 19206.14 toks/s, output: 18.76 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:38<01:17, 17.06it/s, est. speed input: 19164.05 toks/s, output: 18.71 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:39<01:16, 17.04it/s, est. speed input: 19122.44 toks/s, output: 18.67 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:40<01:15, 17.05it/s, est. speed input: 19084.37 toks/s, output: 18.64 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:41<01:14, 17.08it/s, est. speed input: 19049.99 toks/s, output: 18.60 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:42<01:13, 17.08it/s, est. speed input: 19015.37 toks/s, output: 18.57 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:43<01:13, 17.06it/s, est. speed input: 18981.10 toks/s, output: 18.54 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:44<01:12, 17.07it/s, est. speed input: 18949.37 toks/s, output: 18.51 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:45<01:11, 17.03it/s, est. speed input: 18916.15 toks/s, output: 18.47 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:46<01:10, 17.05it/s, est. speed input: 18887.66 toks/s, output: 18.44 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:47<01:09, 17.05it/s, est. speed input: 18858.92 toks/s, output: 18.42 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:47<01:08, 17.08it/s, est. speed input: 18833.52 toks/s, output: 18.39 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:48<01:07, 17.03it/s, est. speed input: 18804.43 toks/s, output: 18.36 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:49<01:06, 17.05it/s, est. speed input: 18779.80 toks/s, output: 18.34 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:50<01:04, 17.36it/s, est. speed input: 18776.33 toks/s, output: 18.34 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [00:51<01:03, 17.25it/s, est. speed input: 18751.54 toks/s, output: 18.31 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [00:52<01:03, 17.18it/s, est. speed input: 18728.01 toks/s, output: 18.29 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [00:53<01:01, 17.43it/s, est. speed input: 18723.42 toks/s, output: 18.28 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [00:54<01:00, 17.32it/s, est. speed input: 18702.24 toks/s, output: 18.26 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [00:55<01:00, 17.25it/s, est. speed input: 18681.63 toks/s, output: 18.24 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [00:56<00:59, 17.21it/s, est. speed input: 18662.37 toks/s, output: 18.22 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [00:57<00:58, 17.14it/s, est. speed input: 18641.61 toks/s, output: 18.20 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [00:58<00:57, 17.11it/s, est. speed input: 18622.38 toks/s, output: 18.19 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [00:59<00:57, 17.09it/s, est. speed input: 18603.50 toks/s, output: 18.17 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:00<00:56, 17.07it/s, est. speed input: 18585.44 toks/s, output: 18.15 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:00<00:55, 17.09it/s, est. speed input: 18569.23 toks/s, output: 18.13 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:01<00:54, 17.06it/s, est. speed input: 18551.43 toks/s, output: 18.12 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:02<00:53, 17.06it/s, est. speed input: 18535.55 toks/s, output: 18.10 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:03<00:51, 17.36it/s, est. speed input: 18535.38 toks/s, output: 18.10 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:04<00:50, 17.25it/s, est. speed input: 18519.13 toks/s, output: 18.09 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:05<00:50, 17.20it/s, est. speed input: 18504.30 toks/s, output: 18.07 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:06<00:49, 17.17it/s, est. speed input: 18490.63 toks/s, output: 18.06 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:07<00:48, 17.12it/s, est. speed input: 18475.60 toks/s, output: 18.04 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:08<00:47, 17.10it/s, est. speed input: 18461.54 toks/s, output: 18.03 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:09<00:46, 17.09it/s, est. speed input: 18448.12 toks/s, output: 18.02 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:10<00:44, 17.38it/s, est. speed input: 18449.22 toks/s, output: 18.02 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:11<00:44, 17.26it/s, est. speed input: 18435.20 toks/s, output: 18.00 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:12<00:42, 17.47it/s, est. speed input: 18434.93 toks/s, output: 18.00 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:13<00:42, 17.35it/s, est. speed input: 18422.67 toks/s, output: 17.99 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:13<00:41, 17.23it/s, est. speed input: 18409.06 toks/s, output: 17.98 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:14<00:40, 17.13it/s, est. speed input: 18395.43 toks/s, output: 17.96 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:15<00:40, 17.12it/s, est. speed input: 18384.47 toks/s, output: 17.95 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:16<00:39, 17.07it/s, est. speed input: 18371.61 toks/s, output: 17.94 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:17<00:38, 17.02it/s, est. speed input: 18358.96 toks/s, output: 17.93 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:18<00:37, 17.04it/s, est. speed input: 18348.59 toks/s, output: 17.92 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:19<00:36, 17.04it/s, est. speed input: 18338.14 toks/s, output: 17.91 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:20<00:35, 17.02it/s, est. speed input: 18326.93 toks/s, output: 17.90 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:21<00:34, 17.02it/s, est. speed input: 18316.67 toks/s, output: 17.89 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:22<00:33, 17.05it/s, est. speed input: 18307.73 toks/s, output: 17.88 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:23<00:32, 17.04it/s, est. speed input: 18297.82 toks/s, output: 17.87 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:24<00:31, 17.03it/s, est. speed input: 18287.79 toks/s, output: 17.86 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:25<00:30, 16.99it/s, est. speed input: 18277.04 toks/s, output: 17.85 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:26<00:30, 16.99it/s, est. speed input: 18267.40 toks/s, output: 17.84 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:27<00:29, 17.02it/s, est. speed input: 18258.99 toks/s, output: 17.83 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:28<00:28, 16.98it/s, est. speed input: 18248.78 toks/s, output: 17.82 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:28<00:26, 17.30it/s, est. speed input: 18251.55 toks/s, output: 17.82 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:29<00:25, 17.21it/s, est. speed input: 18242.84 toks/s, output: 17.82 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:30<00:25, 17.18it/s, est. speed input: 18235.31 toks/s, output: 17.81 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:31<00:24, 17.11it/s, est. speed input: 18226.37 toks/s, output: 17.80 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:32<00:22, 17.38it/s, est. speed input: 18228.80 toks/s, output: 17.80 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:33<00:22, 17.29it/s, est. speed input: 18221.50 toks/s, output: 17.79 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:34<00:21, 17.22it/s, est. speed input: 18213.97 toks/s, output: 17.79 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:35<00:20, 17.18it/s, est. speed input: 18206.90 toks/s, output: 17.78 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:36<00:19, 17.13it/s, est. speed input: 18199.27 toks/s, output: 17.77 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:37<00:18, 17.10it/s, est. speed input: 18192.07 toks/s, output: 17.77 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:38<00:17, 17.09it/s, est. speed input: 18185.14 toks/s, output: 17.76 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:39<00:16, 17.09it/s, est. speed input: 18178.80 toks/s, output: 17.75 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:40<00:15, 17.10it/s, est. speed input: 18172.81 toks/s, output: 17.75 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:41<00:14, 17.09it/s, est. speed input: 18166.43 toks/s, output: 17.74 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:42<00:13, 17.05it/s, est. speed input: 18158.94 toks/s, output: 17.73 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:43<00:13, 17.05it/s, est. speed input: 18152.54 toks/s, output: 17.73 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:43<00:12, 17.05it/s, est. speed input: 18146.36 toks/s, output: 17.72 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [01:44<00:11, 17.02it/s, est. speed input: 18139.28 toks/s, output: 17.71 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [01:45<00:10, 17.31it/s, est. speed input: 18141.88 toks/s, output: 17.72 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [01:46<00:09, 17.22it/s, est. speed input: 18135.64 toks/s, output: 17.71 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [01:47<00:08, 17.16it/s, est. speed input: 18129.50 toks/s, output: 17.70 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [01:48<00:07, 17.10it/s, est. speed input: 18122.99 toks/s, output: 17.70 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [01:49<00:06, 17.10it/s, est. speed input: 18117.65 toks/s, output: 17.69 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [01:50<00:05, 17.39it/s, est. speed input: 18121.01 toks/s, output: 17.70 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [01:51<00:04, 17.27it/s, est. speed input: 18114.90 toks/s, output: 17.69 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [01:52<00:03, 17.49it/s, est. speed input: 18117.57 toks/s, output: 17.69 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [01:53<00:02, 17.33it/s, est. speed input: 18111.45 toks/s, output: 17.69 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [01:54<00:01, 17.24it/s, est. speed input: 18105.85 toks/s, output: 17.68 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [01:55<00:00, 17.42it/s, est. speed input: 18107.39 toks/s, output: 17.68 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:55<00:00, 17.42it/s, est. speed input: 18231.99 toks/s, output: 17.80 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [01:55<00:00, 17.80it/s, est. speed input: 18231.99 toks/s, output: 17.80 toks/s]
[rank0]:[W128 08:58:39.719190807 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 156.1s

测试结果:
  Requests/s:   17.11
  Tokens/s:     17540.62
  Total Reqs:   2048
  Elapsed:      119.68s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     17523.51

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:4)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 08:58:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 08:58:56 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3720238) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3720238) WARNING 01-28 08:59:22 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 16.81 requests/s, 17225.16 total tokens/s, 16.81 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 08:58:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:58:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:58:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:58:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:58:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:58:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:58:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:58:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 08:58:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 08:58:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 08:58:59] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 08:58:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 08:58:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 08:58:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 08:58:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 08:58:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 08:58:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:4, expand_ratio=2.000
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:00] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3720238) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3720238) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.62s/it]
(EngineCore_DP0 pid=3720238) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:11<00:00, 11.62s/it]
(EngineCore_DP0 pid=3720238) 
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 2560] -> 1D uint8
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 2560] -> 1D uint8
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 4096000 bytes
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 2560] -> 1D uint8
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 22118400 bytes
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 6912] -> 1D uint8
(EngineCore_DP0 pid=3720238) [2026-01-28 08:59:13] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 11059200 bytes
(EngineCore_DP0 pid=3720238) 2026-01-28 08:59:20,375 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3720238) 2026-01-28 08:59:20,500 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 65/4096 [00:00<00:06, 649.14it/s]
Adding requests:   3%|▎         | 130/4096 [00:00<00:06, 625.91it/s]
Adding requests:   5%|▍         | 193/4096 [00:00<00:07, 545.66it/s]
Adding requests:   6%|▌         | 249/4096 [00:00<00:07, 524.86it/s]
Adding requests:   7%|▋         | 303/4096 [00:00<00:07, 512.46it/s]
Adding requests:   9%|▊         | 356/4096 [00:00<00:07, 515.55it/s]
Adding requests:  10%|▉         | 408/4096 [00:00<00:07, 515.82it/s]
Adding requests:  11%|█         | 460/4096 [00:00<00:07, 511.66it/s]
Adding requests:  12%|█▎        | 512/4096 [00:00<00:07, 502.28it/s]
Adding requests:  14%|█▎        | 563/4096 [00:01<00:07, 495.81it/s]
Adding requests:  15%|█▍        | 613/4096 [00:01<00:07, 491.23it/s]
Adding requests:  16%|█▌        | 663/4096 [00:01<00:06, 492.79it/s]
Adding requests:  17%|█▋        | 713/4096 [00:01<00:06, 488.52it/s]
Adding requests:  19%|█▊        | 762/4096 [00:01<00:06, 476.79it/s]
Adding requests:  20%|█▉        | 810/4096 [00:01<00:06, 476.06it/s]
Adding requests:  21%|██        | 858/4096 [00:01<00:06, 473.30it/s]
Adding requests:  22%|██▏       | 909/4096 [00:01<00:06, 483.94it/s]
Adding requests:  23%|██▎       | 958/4096 [00:01<00:06, 475.28it/s]
Adding requests:  25%|██▍       | 1006/4096 [00:02<00:06, 470.66it/s]
Adding requests:  26%|██▌       | 1055/4096 [00:02<00:06, 474.50it/s]
Adding requests:  27%|██▋       | 1103/4096 [00:02<00:06, 472.96it/s]
Adding requests:  28%|██▊       | 1151/4096 [00:02<00:06, 471.37it/s]
Adding requests:  29%|██▉       | 1200/4096 [00:02<00:06, 474.99it/s]
Adding requests:  30%|███       | 1248/4096 [00:02<00:06, 473.20it/s]
Adding requests:  32%|███▏      | 1296/4096 [00:02<00:06, 444.83it/s]
Adding requests:  33%|███▎      | 1346/4096 [00:02<00:05, 459.33it/s]
Adding requests:  34%|███▍      | 1394/4096 [00:02<00:05, 465.05it/s]
Adding requests:  35%|███▌      | 1441/4096 [00:02<00:05, 463.39it/s]
Adding requests:  36%|███▋      | 1492/4096 [00:03<00:05, 474.53it/s]
Adding requests:  38%|███▊      | 1541/4096 [00:03<00:05, 476.19it/s]
Adding requests:  39%|███▉      | 1591/4096 [00:03<00:05, 481.06it/s]
Adding requests:  40%|████      | 1640/4096 [00:03<00:05, 480.57it/s]
Adding requests:  41%|████      | 1689/4096 [00:03<00:05, 476.55it/s]
Adding requests:  42%|████▏     | 1737/4096 [00:03<00:04, 475.45it/s]
Adding requests:  44%|████▎     | 1785/4096 [00:03<00:04, 471.74it/s]
Adding requests:  45%|████▍     | 1834/4096 [00:03<00:04, 476.66it/s]
Adding requests:  46%|████▌     | 1882/4096 [00:03<00:04, 476.18it/s]
Adding requests:  47%|████▋     | 1930/4096 [00:03<00:04, 470.91it/s]
Adding requests:  48%|████▊     | 1978/4096 [00:04<00:04, 469.27it/s]
Adding requests:  49%|████▉     | 2026/4096 [00:04<00:04, 471.42it/s]
Adding requests:  51%|█████     | 2075/4096 [00:04<00:04, 474.99it/s]
Adding requests:  52%|█████▏    | 2123/4096 [00:04<00:04, 475.32it/s]
Adding requests:  53%|█████▎    | 2171/4096 [00:04<00:04, 472.80it/s]
Adding requests:  54%|█████▍    | 2219/4096 [00:04<00:03, 472.44it/s]
Adding requests:  55%|█████▌    | 2269/4096 [00:04<00:03, 478.37it/s]
Adding requests:  57%|█████▋    | 2319/4096 [00:04<00:03, 482.70it/s]
Adding requests:  58%|█████▊    | 2368/4096 [00:04<00:03, 483.22it/s]
Adding requests:  59%|█████▉    | 2417/4096 [00:04<00:03, 483.00it/s]
Adding requests:  60%|██████    | 2466/4096 [00:05<00:03, 477.87it/s]
Adding requests:  61%|██████▏   | 2516/4096 [00:05<00:03, 481.95it/s]
Adding requests:  63%|██████▎   | 2565/4096 [00:05<00:03, 443.60it/s]
Adding requests:  64%|██████▎   | 2611/4096 [00:05<00:03, 446.75it/s]
Adding requests:  65%|██████▍   | 2661/4096 [00:05<00:03, 461.70it/s]
Adding requests:  66%|██████▌   | 2710/4096 [00:05<00:02, 467.90it/s]
Adding requests:  67%|██████▋   | 2761/4096 [00:05<00:02, 476.80it/s]
Adding requests:  69%|██████▊   | 2811/4096 [00:05<00:02, 481.03it/s]
Adding requests:  70%|██████▉   | 2860/4096 [00:05<00:02, 477.73it/s]
Adding requests:  71%|███████   | 2908/4096 [00:06<00:02, 477.37it/s]
Adding requests:  72%|███████▏  | 2958/4096 [00:06<00:02, 481.83it/s]
Adding requests:  73%|███████▎  | 3007/4096 [00:06<00:02, 483.85it/s]
Adding requests:  75%|███████▍  | 3059/4096 [00:06<00:02, 492.52it/s]
Adding requests:  76%|███████▌  | 3109/4096 [00:06<00:02, 489.41it/s]
Adding requests:  77%|███████▋  | 3158/4096 [00:06<00:01, 486.15it/s]
Adding requests:  78%|███████▊  | 3211/4096 [00:06<00:01, 499.03it/s]
Adding requests:  80%|███████▉  | 3263/4096 [00:06<00:01, 503.14it/s]
Adding requests:  81%|████████  | 3315/4096 [00:06<00:01, 506.05it/s]
Adding requests:  82%|████████▏ | 3367/4096 [00:06<00:01, 507.40it/s]
Adding requests:  83%|████████▎ | 3418/4096 [00:07<00:01, 501.02it/s]
Adding requests:  85%|████████▍ | 3469/4096 [00:07<00:01, 493.27it/s]
Adding requests:  86%|████████▌ | 3519/4096 [00:07<00:01, 486.26it/s]
Adding requests:  87%|████████▋ | 3568/4096 [00:07<00:01, 479.71it/s]
Adding requests:  88%|████████▊ | 3617/4096 [00:07<00:00, 480.01it/s]
Adding requests:  90%|████████▉ | 3668/4096 [00:07<00:00, 486.58it/s]
Adding requests:  91%|█████████ | 3717/4096 [00:07<00:00, 486.49it/s]
Adding requests:  92%|█████████▏| 3771/4096 [00:07<00:00, 500.39it/s]
Adding requests:  93%|█████████▎| 3822/4096 [00:07<00:00, 493.90it/s]
Adding requests:  95%|█████████▍| 3875/4096 [00:07<00:00, 503.84it/s]
Adding requests:  96%|█████████▌| 3926/4096 [00:08<00:00, 467.69it/s]
Adding requests:  97%|█████████▋| 3977/4096 [00:08<00:00, 478.25it/s]
Adding requests:  98%|█████████▊| 4026/4096 [00:08<00:00, 479.16it/s]
Adding requests: 100%|█████████▉| 4077/4096 [00:08<00:00, 486.40it/s]
Adding requests: 100%|██████████| 4096/4096 [00:08<00:00, 483.95it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:01<00:36, 109.37it/s, est. speed input: 111994.54 toks/s, output: 109.37 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:03<01:27, 45.20it/s, est. speed input: 53895.34 toks/s, output: 52.63 toks/s]   
Processed prompts:   5%|▍         | 194/4096 [00:04<02:05, 31.12it/s, est. speed input: 39988.18 toks/s, output: 39.05 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:06<02:33, 25.25it/s, est. speed input: 33768.84 toks/s, output: 32.98 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:08<02:53, 22.13it/s, est. speed input: 30203.52 toks/s, output: 29.50 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:10<03:07, 20.31it/s, est. speed input: 27905.65 toks/s, output: 27.25 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:12<03:16, 19.25it/s, est. speed input: 26348.53 toks/s, output: 25.73 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:14<03:21, 18.53it/s, est. speed input: 25180.86 toks/s, output: 24.59 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:16<03:25, 18.02it/s, est. speed input: 24270.51 toks/s, output: 23.70 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:18<03:28, 17.67it/s, est. speed input: 23543.70 toks/s, output: 22.99 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:20<03:27, 17.54it/s, est. speed input: 22999.27 toks/s, output: 22.46 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:21<03:28, 17.35it/s, est. speed input: 22508.81 toks/s, output: 21.98 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:23<03:28, 17.21it/s, est. speed input: 22093.77 toks/s, output: 21.58 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:25<03:27, 17.09it/s, est. speed input: 21734.29 toks/s, output: 21.22 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:27<03:26, 17.03it/s, est. speed input: 21428.55 toks/s, output: 20.93 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:29<03:25, 16.98it/s, est. speed input: 21161.58 toks/s, output: 20.67 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:31<03:28, 16.58it/s, est. speed input: 20835.46 toks/s, output: 20.35 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:33<03:25, 16.67it/s, est. speed input: 20634.17 toks/s, output: 20.15 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:35<03:22, 16.75it/s, est. speed input: 20459.31 toks/s, output: 19.98 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:37<03:19, 16.80it/s, est. speed input: 20300.08 toks/s, output: 19.82 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:39<03:17, 16.84it/s, est. speed input: 20157.43 toks/s, output: 19.68 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:41<03:15, 16.85it/s, est. speed input: 20024.29 toks/s, output: 19.55 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:42<03:13, 16.89it/s, est. speed input: 19907.50 toks/s, output: 19.44 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:44<03:11, 16.89it/s, est. speed input: 19796.92 toks/s, output: 19.33 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:46<03:09, 16.92it/s, est. speed input: 19700.26 toks/s, output: 19.24 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:48<03:05, 17.05it/s, est. speed input: 19626.87 toks/s, output: 19.17 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:50<03:02, 17.15it/s, est. speed input: 19560.92 toks/s, output: 19.10 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [00:52<03:01, 17.09it/s, est. speed input: 19480.99 toks/s, output: 19.02 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [00:54<03:00, 17.05it/s, est. speed input: 19407.35 toks/s, output: 18.95 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [00:56<02:58, 16.99it/s, est. speed input: 19334.12 toks/s, output: 18.88 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [00:57<02:57, 16.96it/s, est. speed input: 19267.19 toks/s, output: 18.82 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [00:59<02:55, 16.94it/s, est. speed input: 19205.03 toks/s, output: 18.75 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [01:01<02:52, 17.06it/s, est. speed input: 19161.86 toks/s, output: 18.71 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [01:03<02:51, 17.01it/s, est. speed input: 19106.57 toks/s, output: 18.66 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:05<02:51, 16.79it/s, est. speed input: 19034.39 toks/s, output: 18.59 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:07<02:47, 16.94it/s, est. speed input: 18998.06 toks/s, output: 18.55 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:09<02:45, 17.05it/s, est. speed input: 18964.13 toks/s, output: 18.52 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:11<02:43, 17.01it/s, est. speed input: 18920.00 toks/s, output: 18.48 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:13<02:42, 16.97it/s, est. speed input: 18877.52 toks/s, output: 18.44 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:14<02:40, 16.94it/s, est. speed input: 18837.31 toks/s, output: 18.40 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:16<02:38, 16.93it/s, est. speed input: 18799.19 toks/s, output: 18.36 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:18<02:36, 16.94it/s, est. speed input: 18765.36 toks/s, output: 18.33 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:20<02:34, 16.95it/s, est. speed input: 18733.09 toks/s, output: 18.29 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:22<02:32, 16.94it/s, est. speed input: 18700.50 toks/s, output: 18.26 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:24<02:30, 16.94it/s, est. speed input: 18670.48 toks/s, output: 18.23 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:26<02:28, 17.05it/s, est. speed input: 18650.42 toks/s, output: 18.21 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:28<02:26, 17.02it/s, est. speed input: 18622.12 toks/s, output: 18.19 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:29<02:24, 17.09it/s, est. speed input: 18602.60 toks/s, output: 18.17 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:31<02:22, 17.04it/s, est. speed input: 18576.75 toks/s, output: 18.14 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:33<02:21, 17.01it/s, est. speed input: 18551.48 toks/s, output: 18.12 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:35<02:19, 16.99it/s, est. speed input: 18528.27 toks/s, output: 18.09 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:37<02:18, 16.81it/s, est. speed input: 18493.14 toks/s, output: 18.06 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:39<02:16, 16.81it/s, est. speed input: 18468.96 toks/s, output: 18.04 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:41<02:14, 16.83it/s, est. speed input: 18446.56 toks/s, output: 18.01 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [01:43<02:11, 16.98it/s, est. speed input: 18434.30 toks/s, output: 18.00 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [01:45<02:10, 16.95it/s, est. speed input: 18413.56 toks/s, output: 17.98 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [01:47<02:08, 16.93it/s, est. speed input: 18393.59 toks/s, output: 17.96 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [01:48<02:05, 17.03it/s, est. speed input: 18381.77 toks/s, output: 17.95 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [01:50<02:03, 17.11it/s, est. speed input: 18370.44 toks/s, output: 17.94 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [01:52<02:01, 17.06it/s, est. speed input: 18353.33 toks/s, output: 17.92 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [01:54<02:00, 17.02it/s, est. speed input: 18336.29 toks/s, output: 17.91 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [01:56<01:58, 17.00it/s, est. speed input: 18320.33 toks/s, output: 17.89 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [01:58<01:56, 16.99it/s, est. speed input: 18305.21 toks/s, output: 17.88 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [02:00<01:54, 16.98it/s, est. speed input: 18290.74 toks/s, output: 17.86 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [02:02<01:53, 16.95it/s, est. speed input: 18275.24 toks/s, output: 17.85 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:03<01:49, 17.19it/s, est. speed input: 18274.25 toks/s, output: 17.85 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:05<01:48, 17.09it/s, est. speed input: 18258.96 toks/s, output: 17.83 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:07<01:46, 17.17it/s, est. speed input: 18252.19 toks/s, output: 17.82 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:09<01:45, 16.89it/s, est. speed input: 18227.92 toks/s, output: 17.80 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:11<01:43, 17.02it/s, est. speed input: 18221.07 toks/s, output: 17.79 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:13<01:39, 17.27it/s, est. speed input: 18222.17 toks/s, output: 17.80 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:15<01:37, 17.30it/s, est. speed input: 18216.31 toks/s, output: 17.79 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:16<01:36, 17.17it/s, est. speed input: 18203.47 toks/s, output: 17.78 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:18<01:35, 17.08it/s, est. speed input: 18190.68 toks/s, output: 17.76 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:20<01:33, 17.15it/s, est. speed input: 18184.63 toks/s, output: 17.76 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:22<01:31, 17.08it/s, est. speed input: 18173.22 toks/s, output: 17.75 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:24<01:29, 17.16it/s, est. speed input: 18167.90 toks/s, output: 17.74 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:26<01:28, 17.06it/s, est. speed input: 18156.10 toks/s, output: 17.73 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [02:28<01:26, 17.03it/s, est. speed input: 18146.03 toks/s, output: 17.72 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [02:30<01:24, 16.97it/s, est. speed input: 18134.43 toks/s, output: 17.71 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:31<01:22, 17.07it/s, est. speed input: 18129.29 toks/s, output: 17.70 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [02:33<01:20, 17.02it/s, est. speed input: 18119.16 toks/s, output: 17.69 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [02:35<01:19, 16.97it/s, est. speed input: 18108.76 toks/s, output: 17.68 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [02:37<01:17, 16.95it/s, est. speed input: 18099.22 toks/s, output: 17.68 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [02:39<01:15, 16.93it/s, est. speed input: 18089.63 toks/s, output: 17.67 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [02:41<01:13, 17.05it/s, est. speed input: 18085.61 toks/s, output: 17.66 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [02:43<01:11, 16.99it/s, est. speed input: 18076.09 toks/s, output: 17.65 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [02:45<01:09, 16.97it/s, est. speed input: 18067.47 toks/s, output: 17.64 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [02:47<01:07, 16.95it/s, est. speed input: 18059.00 toks/s, output: 17.64 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [02:48<01:05, 16.95it/s, est. speed input: 18051.12 toks/s, output: 17.63 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [02:50<01:04, 16.93it/s, est. speed input: 18042.66 toks/s, output: 17.62 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [02:52<01:02, 16.93it/s, est. speed input: 18034.95 toks/s, output: 17.61 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [02:54<01:00, 16.94it/s, est. speed input: 18027.92 toks/s, output: 17.61 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [02:56<00:57, 17.21it/s, est. speed input: 18030.64 toks/s, output: 17.61 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [02:58<00:55, 17.26it/s, est. speed input: 18028.10 toks/s, output: 17.61 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [03:00<00:53, 17.16it/s, est. speed input: 18020.80 toks/s, output: 17.60 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:02<00:52, 17.06it/s, est. speed input: 18012.70 toks/s, output: 17.59 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:03<00:50, 17.12it/s, est. speed input: 18009.38 toks/s, output: 17.59 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:05<00:48, 17.09it/s, est. speed input: 18003.40 toks/s, output: 17.58 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:07<00:46, 17.04it/s, est. speed input: 17996.71 toks/s, output: 17.57 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:09<00:45, 17.02it/s, est. speed input: 17990.44 toks/s, output: 17.57 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:11<00:43, 16.99it/s, est. speed input: 17983.83 toks/s, output: 17.56 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:13<00:41, 16.86it/s, est. speed input: 17973.65 toks/s, output: 17.55 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:15<00:39, 17.00it/s, est. speed input: 17971.72 toks/s, output: 17.55 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [03:17<00:37, 16.97it/s, est. speed input: 17965.15 toks/s, output: 17.54 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [03:18<00:35, 17.23it/s, est. speed input: 17968.34 toks/s, output: 17.55 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [03:20<00:33, 17.14it/s, est. speed input: 17962.39 toks/s, output: 17.54 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [03:22<00:31, 17.07it/s, est. speed input: 17956.34 toks/s, output: 17.54 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [03:24<00:29, 17.05it/s, est. speed input: 17951.18 toks/s, output: 17.53 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [03:26<00:28, 16.98it/s, est. speed input: 17944.50 toks/s, output: 17.52 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [03:28<00:26, 16.96it/s, est. speed input: 17938.72 toks/s, output: 17.52 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [03:30<00:24, 16.93it/s, est. speed input: 17932.80 toks/s, output: 17.51 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [03:32<00:22, 17.07it/s, est. speed input: 17931.73 toks/s, output: 17.51 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [03:33<00:20, 17.05it/s, est. speed input: 17927.18 toks/s, output: 17.51 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [03:35<00:18, 17.02it/s, est. speed input: 17922.33 toks/s, output: 17.50 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [03:37<00:16, 16.99it/s, est. speed input: 17917.06 toks/s, output: 17.50 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [03:39<00:14, 17.11it/s, est. speed input: 17916.27 toks/s, output: 17.50 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [03:41<00:13, 17.03it/s, est. speed input: 17910.49 toks/s, output: 17.49 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [03:43<00:11, 17.00it/s, est. speed input: 17905.67 toks/s, output: 17.49 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [03:45<00:09, 16.87it/s, est. speed input: 17897.76 toks/s, output: 17.48 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [03:47<00:07, 16.88it/s, est. speed input: 17892.74 toks/s, output: 17.47 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [03:49<00:05, 16.90it/s, est. speed input: 17888.27 toks/s, output: 17.47 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [03:52<00:04, 13.64it/s, est. speed input: 17767.63 toks/s, output: 17.35 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [03:55<00:02, 12.93it/s, est. speed input: 17697.05 toks/s, output: 17.28 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:55<00:00, 12.93it/s, est. speed input: 17827.58 toks/s, output: 17.41 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [03:55<00:00, 17.41it/s, est. speed input: 17827.58 toks/s, output: 17.41 toks/s]
[rank0]:[W128 09:03:26.879465512 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 287.3s

测试结果:
  Requests/s:   16.81
  Tokens/s:     17225.16
  Total Reqs:   4096
  Elapsed:      243.74s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     17208.36


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_4/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,29.2585,15009.6114,4.3748
1024,1024,1,128,128,16.7771,17196.4812,7.6295
2048,1024,2,256,128,17.8707,18317.4884,14.3251
4096,1024,4,512,128,16.6451,17061.2553,30.7598
8192,1024,8,1024,128,16.8638,17285.3993,60.7218
16384,1024,16,2048,128,17.1128,17540.6218,119.6765
32768,1024,32,4096,128,16.8050,17225.1630,243.7364

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_6) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_6
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_6

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:03:32 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:03:33 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3724204) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3724204) WARNING 01-28 09:03:59 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 27.69 requests/s, 14205.57 total tokens/s, 27.69 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:03:32] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:03:32] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:03:32] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:32] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:03:32] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:03:32] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:03:32] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:03:32] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:03:32] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:03:36] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:03:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:03:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:03:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:03:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:03:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:03:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:03:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:03:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:37] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3724204) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3724204) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:15<00:00, 15.27s/it]
(EngineCore_DP0 pid=3724204) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:15<00:00, 15.27s/it]
(EngineCore_DP0 pid=3724204) 
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3724204) [2026-01-28 09:03:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3724204) 2026-01-28 09:03:59,025 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3724204) 2026-01-28 09:03:59,039 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1296.39it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:19,  6.64it/s, est. speed input: 3400.12 toks/s, output: 6.64 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 17.71it/s, est. speed input: 8061.82 toks/s, output: 15.74 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:05, 22.38it/s, est. speed input: 10022.31 toks/s, output: 19.57 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:04, 24.88it/s, est. speed input: 11115.93 toks/s, output: 21.71 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 26.47it/s, est. speed input: 11837.55 toks/s, output: 23.12 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:04, 27.57it/s, est. speed input: 12359.08 toks/s, output: 24.14 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:03, 28.12it/s, est. speed input: 12711.60 toks/s, output: 24.83 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:03, 27.90it/s, est. speed input: 12879.22 toks/s, output: 25.15 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:00<00:03, 28.36it/s, est. speed input: 13106.59 toks/s, output: 25.60 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:03, 28.64it/s, est. speed input: 13285.89 toks/s, output: 25.95 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:03, 28.86it/s, est. speed input: 13436.50 toks/s, output: 26.24 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:03, 28.96it/s, est. speed input: 13557.36 toks/s, output: 26.48 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:03, 28.98it/s, est. speed input: 13654.19 toks/s, output: 26.67 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:03, 29.06it/s, est. speed input: 13744.96 toks/s, output: 26.85 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:02, 29.11it/s, est. speed input: 13823.96 toks/s, output: 27.00 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:01<00:02, 29.14it/s, est. speed input: 13891.92 toks/s, output: 27.13 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 29.25it/s, est. speed input: 13960.94 toks/s, output: 27.27 toks/s]
Processed prompts:  41%|████      | 52/128 [00:01<00:02, 29.01it/s, est. speed input: 13994.88 toks/s, output: 27.33 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:02, 28.81it/s, est. speed input: 14022.21 toks/s, output: 27.39 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:02, 29.03it/s, est. speed input: 14075.43 toks/s, output: 27.49 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:02, 29.03it/s, est. speed input: 14112.52 toks/s, output: 27.56 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:02<00:02, 29.06it/s, est. speed input: 14148.17 toks/s, output: 27.63 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:02<00:02, 29.13it/s, est. speed input: 14184.41 toks/s, output: 27.70 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:02<00:01, 29.21it/s, est. speed input: 14219.59 toks/s, output: 27.77 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:01, 29.28it/s, est. speed input: 14252.66 toks/s, output: 27.84 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 29.29it/s, est. speed input: 14281.14 toks/s, output: 27.89 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:02<00:01, 29.26it/s, est. speed input: 14305.14 toks/s, output: 27.94 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:02<00:01, 29.15it/s, est. speed input: 14322.80 toks/s, output: 27.97 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:01, 28.69it/s, est. speed input: 14316.86 toks/s, output: 27.96 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:03<00:01, 28.71it/s, est. speed input: 14330.56 toks/s, output: 27.99 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:03<00:01, 28.76it/s, est. speed input: 14345.05 toks/s, output: 28.02 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:03<00:01, 28.93it/s, est. speed input: 14365.73 toks/s, output: 28.06 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:03<00:01, 29.05it/s, est. speed input: 14385.02 toks/s, output: 28.10 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:03<00:00, 29.00it/s, est. speed input: 14396.68 toks/s, output: 28.12 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:03<00:00, 28.97it/s, est. speed input: 14408.01 toks/s, output: 28.14 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:03<00:00, 29.09it/s, est. speed input: 14425.11 toks/s, output: 28.17 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:03<00:00, 28.93it/s, est. speed input: 14430.63 toks/s, output: 28.18 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:03<00:00, 29.12it/s, est. speed input: 14448.92 toks/s, output: 28.22 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:04<00:00, 28.65it/s, est. speed input: 14440.32 toks/s, output: 28.20 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:04<00:00, 28.95it/s, est. speed input: 14458.79 toks/s, output: 28.24 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:04<00:00, 29.06it/s, est. speed input: 14472.09 toks/s, output: 28.27 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:04<00:00, 28.87it/s, est. speed input: 14474.06 toks/s, output: 28.27 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:04<00:00, 28.94it/s, est. speed input: 14483.93 toks/s, output: 28.29 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 28.94it/s, est. speed input: 14491.83 toks/s, output: 28.30 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 28.30it/s, est. speed input: 14491.83 toks/s, output: 28.30 toks/s]
[rank0]:[W128 09:04:04.525394958 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 37.5s

测试结果:
  Requests/s:   27.69
  Tokens/s:     14205.57
  Total Reqs:   128
  Elapsed:      4.62s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     14177.88

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:04:10 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:04:10 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3724936) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3724936) WARNING 01-28 09:04:36 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.10 requests/s, 15481.17 total tokens/s, 15.10 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:04:10] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:04:10] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:04:10] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:10] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:04:10] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:04:10] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:04:10] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:04:10] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:04:10] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:04:13] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:04:13] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:04:13] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:13] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:04:13] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:04:13] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:04:13] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:04:13] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:04:13] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:14] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3724936) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3724936) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.53s/it]
(EngineCore_DP0 pid=3724936) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.53s/it]
(EngineCore_DP0 pid=3724936) 
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3724936) [2026-01-28 09:04:30] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3724936) 2026-01-28 09:04:35,690 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3724936) 2026-01-28 09:04:35,704 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  57%|█████▋    | 73/128 [00:00<00:00, 726.14it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 729.11it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:14,  8.63it/s, est. speed input: 8841.73 toks/s, output: 8.63 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:09, 12.86it/s, est. speed input: 12551.33 toks/s, output: 12.26 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:08, 14.12it/s, est. speed input: 13718.66 toks/s, output: 13.40 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.63it/s, est. speed input: 14246.76 toks/s, output: 13.91 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:07, 15.01it/s, est. speed input: 14610.09 toks/s, output: 14.27 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 15.25it/s, est. speed input: 14862.34 toks/s, output: 14.51 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 15.42it/s, est. speed input: 15046.70 toks/s, output: 14.69 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 15.30it/s, est. speed input: 15095.01 toks/s, output: 14.74 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 15.22it/s, est. speed input: 15130.51 toks/s, output: 14.78 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 15.31it/s, est. speed input: 15208.43 toks/s, output: 14.85 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:06, 15.47it/s, est. speed input: 15298.32 toks/s, output: 14.94 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 15.45it/s, est. speed input: 15339.63 toks/s, output: 14.98 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.59it/s, est. speed input: 15411.38 toks/s, output: 15.05 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.71it/s, est. speed input: 15478.34 toks/s, output: 15.12 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:06, 15.60it/s, est. speed input: 15495.86 toks/s, output: 15.13 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 15.57it/s, est. speed input: 15519.80 toks/s, output: 15.16 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 15.34it/s, est. speed input: 15499.84 toks/s, output: 15.14 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 15.49it/s, est. speed input: 15538.46 toks/s, output: 15.17 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:05, 15.43it/s, est. speed input: 15545.70 toks/s, output: 15.18 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 15.51it/s, est. speed input: 15571.67 toks/s, output: 15.21 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 15.64it/s, est. speed input: 15607.34 toks/s, output: 15.24 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 15.63it/s, est. speed input: 15624.09 toks/s, output: 15.26 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:02<00:05, 15.66it/s, est. speed input: 15645.40 toks/s, output: 15.28 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 15.73it/s, est. speed input: 15671.11 toks/s, output: 15.30 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 15.41it/s, est. speed input: 15645.09 toks/s, output: 15.28 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:04, 15.52it/s, est. speed input: 15665.24 toks/s, output: 15.30 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.53it/s, est. speed input: 15674.99 toks/s, output: 15.31 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.60it/s, est. speed input: 15691.53 toks/s, output: 15.32 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.52it/s, est. speed input: 15691.94 toks/s, output: 15.32 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.48it/s, est. speed input: 15694.50 toks/s, output: 15.33 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:03<00:04, 15.58it/s, est. speed input: 15710.83 toks/s, output: 15.34 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.56it/s, est. speed input: 15715.85 toks/s, output: 15.35 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 15.32it/s, est. speed input: 15697.35 toks/s, output: 15.33 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:03, 15.36it/s, est. speed input: 15701.48 toks/s, output: 15.33 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.38it/s, est. speed input: 15704.46 toks/s, output: 15.34 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.50it/s, est. speed input: 15716.90 toks/s, output: 15.35 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.51it/s, est. speed input: 15722.30 toks/s, output: 15.35 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:04<00:03, 15.53it/s, est. speed input: 15728.14 toks/s, output: 15.36 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 15.51it/s, est. speed input: 15730.95 toks/s, output: 15.36 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.51it/s, est. speed input: 15734.58 toks/s, output: 15.37 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 15.42it/s, est. speed input: 15731.02 toks/s, output: 15.36 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.32it/s, est. speed input: 15724.19 toks/s, output: 15.36 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.37it/s, est. speed input: 15726.89 toks/s, output: 15.36 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.52it/s, est. speed input: 15739.28 toks/s, output: 15.37 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 15.61it/s, est. speed input: 15749.60 toks/s, output: 15.38 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:05<00:02, 15.67it/s, est. speed input: 15758.63 toks/s, output: 15.39 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 15.69it/s, est. speed input: 15765.99 toks/s, output: 15.40 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 15.66it/s, est. speed input: 15770.50 toks/s, output: 15.40 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:01, 15.55it/s, est. speed input: 15767.87 toks/s, output: 15.40 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 15.49it/s, est. speed input: 15767.48 toks/s, output: 15.40 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 15.58it/s, est. speed input: 15775.23 toks/s, output: 15.41 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 15.64it/s, est. speed input: 15782.39 toks/s, output: 15.41 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:06<00:01, 15.67it/s, est. speed input: 15788.40 toks/s, output: 15.42 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:06<00:01, 15.51it/s, est. speed input: 15783.45 toks/s, output: 15.41 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 15.45it/s, est. speed input: 15781.44 toks/s, output: 15.41 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 15.59it/s, est. speed input: 15790.89 toks/s, output: 15.42 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:00, 15.35it/s, est. speed input: 15779.51 toks/s, output: 15.41 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 15.38it/s, est. speed input: 15780.10 toks/s, output: 15.41 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 15.46it/s, est. speed input: 15784.20 toks/s, output: 15.41 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.52it/s, est. speed input: 15788.47 toks/s, output: 15.42 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:07<00:00, 15.53it/s, est. speed input: 15790.76 toks/s, output: 15.42 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:07<00:00, 15.60it/s, est. speed input: 15796.25 toks/s, output: 15.43 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 15.48it/s, est. speed input: 15792.48 toks/s, output: 15.42 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 15.44it/s, est. speed input: 15791.66 toks/s, output: 15.42 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.44it/s, est. speed input: 15795.00 toks/s, output: 15.42 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.42it/s, est. speed input: 15795.00 toks/s, output: 15.42 toks/s]
[rank0]:[W128 09:04:44.957443910 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 40.4s

测试结果:
  Requests/s:   15.10
  Tokens/s:     15481.17
  Total Reqs:   128
  Elapsed:      8.47s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     15466.06

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:04:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:04:51 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3725693) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3725693) WARNING 01-28 09:05:16 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 15.44 requests/s, 15828.01 total tokens/s, 15.44 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 09:04:51] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:04:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:04:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:04:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:04:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:04:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:04:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:04:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:04:54] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:04:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:04:54] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:04:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:04:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:04:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:04:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:04:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:04:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3725693) [2026-01-28 09:04:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3725693) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3725693) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.34s/it]
(EngineCore_DP0 pid=3725693) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.34s/it]
(EngineCore_DP0 pid=3725693) 
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3725693) [2026-01-28 09:05:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3725693) 2026-01-28 09:05:16,251 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3725693) 2026-01-28 09:05:16,263 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  26%|██▌       | 67/256 [00:00<00:00, 667.60it/s]
Adding requests:  52%|█████▏    | 134/256 [00:00<00:00, 642.81it/s]
Adding requests:  78%|███████▊  | 199/256 [00:00<00:00, 590.19it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 597.14it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:06, 38.44it/s, est. speed input: 39376.04 toks/s, output: 38.45 toks/s]
Processed prompts:   4%|▍         | 10/256 [00:00<00:11, 21.97it/s, est. speed input: 24380.96 toks/s, output: 23.81 toks/s]
Processed prompts:   5%|▌         | 13/256 [00:00<00:10, 22.37it/s, est. speed input: 24227.35 toks/s, output: 23.66 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:13, 17.26it/s, est. speed input: 20369.88 toks/s, output: 19.89 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:00<00:14, 16.79it/s, est. speed input: 19738.49 toks/s, output: 19.28 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:01<00:14, 16.47it/s, est. speed input: 19284.68 toks/s, output: 18.83 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:01<00:14, 16.23it/s, est. speed input: 18927.31 toks/s, output: 18.48 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:14, 15.90it/s, est. speed input: 18579.49 toks/s, output: 18.14 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:14, 15.74it/s, est. speed input: 18323.63 toks/s, output: 17.89 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:14, 15.75it/s, est. speed input: 18147.96 toks/s, output: 17.72 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:14, 15.70it/s, est. speed input: 17984.64 toks/s, output: 17.56 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:14, 15.74it/s, est. speed input: 17861.17 toks/s, output: 17.44 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:01<00:14, 15.71it/s, est. speed input: 17741.73 toks/s, output: 17.33 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:13, 15.77it/s, est. speed input: 17655.20 toks/s, output: 17.24 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:13, 15.72it/s, est. speed input: 17558.41 toks/s, output: 17.15 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:13, 15.62it/s, est. speed input: 17458.26 toks/s, output: 17.05 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:13, 15.48it/s, est. speed input: 17354.56 toks/s, output: 16.95 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:13, 15.51it/s, est. speed input: 17285.53 toks/s, output: 16.88 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:13, 15.57it/s, est. speed input: 17229.46 toks/s, output: 16.83 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:13, 15.57it/s, est. speed input: 17172.28 toks/s, output: 16.77 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:02<00:13, 15.59it/s, est. speed input: 17123.11 toks/s, output: 16.72 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:13, 15.66it/s, est. speed input: 17085.36 toks/s, output: 16.68 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:12, 15.65it/s, est. speed input: 17042.40 toks/s, output: 16.64 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:12, 15.65it/s, est. speed input: 17003.92 toks/s, output: 16.61 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:12, 15.52it/s, est. speed input: 16951.10 toks/s, output: 16.55 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:12, 15.57it/s, est. speed input: 16920.06 toks/s, output: 16.52 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:12, 15.62it/s, est. speed input: 16892.61 toks/s, output: 16.50 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:03<00:12, 15.62it/s, est. speed input: 16863.34 toks/s, output: 16.47 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:12, 15.55it/s, est. speed input: 16828.01 toks/s, output: 16.43 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:12, 15.62it/s, est. speed input: 16807.69 toks/s, output: 16.41 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:11, 15.61it/s, est. speed input: 16782.54 toks/s, output: 16.39 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:11, 15.58it/s, est. speed input: 16755.82 toks/s, output: 16.36 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:11, 15.44it/s, est. speed input: 16718.55 toks/s, output: 16.33 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:11, 15.54it/s, est. speed input: 16702.99 toks/s, output: 16.31 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:11, 15.63it/s, est. speed input: 16690.64 toks/s, output: 16.30 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:04<00:11, 15.63it/s, est. speed input: 16672.58 toks/s, output: 16.28 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:11, 15.63it/s, est. speed input: 16655.56 toks/s, output: 16.27 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:10, 15.65it/s, est. speed input: 16641.20 toks/s, output: 16.25 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:10, 15.63it/s, est. speed input: 16624.59 toks/s, output: 16.23 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:10, 15.67it/s, est. speed input: 16613.19 toks/s, output: 16.22 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:10, 15.45it/s, est. speed input: 16582.10 toks/s, output: 16.19 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:05<00:10, 15.46it/s, est. speed input: 16565.41 toks/s, output: 16.18 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:05<00:10, 15.55it/s, est. speed input: 16556.55 toks/s, output: 16.17 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:05<00:10, 15.66it/s, est. speed input: 16551.40 toks/s, output: 16.16 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:10, 15.69it/s, est. speed input: 16542.56 toks/s, output: 16.15 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:06<00:09, 15.64it/s, est. speed input: 16529.28 toks/s, output: 16.14 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:06<00:09, 15.70it/s, est. speed input: 16523.39 toks/s, output: 16.14 toks/s]
Processed prompts:  41%|████      | 104/256 [00:06<00:09, 15.66it/s, est. speed input: 16511.58 toks/s, output: 16.12 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:06<00:09, 15.54it/s, est. speed input: 16493.77 toks/s, output: 16.11 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:09, 15.45it/s, est. speed input: 16476.74 toks/s, output: 16.09 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:06<00:09, 15.48it/s, est. speed input: 16466.69 toks/s, output: 16.08 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:06<00:09, 15.47it/s, est. speed input: 16454.11 toks/s, output: 16.07 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:07<00:09, 15.46it/s, est. speed input: 16442.39 toks/s, output: 16.06 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:07<00:09, 15.49it/s, est. speed input: 16433.60 toks/s, output: 16.05 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:07<00:08, 15.56it/s, est. speed input: 16427.92 toks/s, output: 16.04 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:07<00:08, 15.61it/s, est. speed input: 16422.60 toks/s, output: 16.04 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:08, 15.68it/s, est. speed input: 16419.40 toks/s, output: 16.03 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:07<00:08, 15.47it/s, est. speed input: 16401.24 toks/s, output: 16.02 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:07<00:08, 15.47it/s, est. speed input: 16391.69 toks/s, output: 16.01 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:07<00:08, 15.59it/s, est. speed input: 16389.44 toks/s, output: 16.01 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:08<00:08, 15.63it/s, est. speed input: 16385.22 toks/s, output: 16.00 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:08<00:07, 15.69it/s, est. speed input: 16382.64 toks/s, output: 16.00 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:08<00:07, 15.73it/s, est. speed input: 16380.06 toks/s, output: 16.00 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:08<00:07, 15.69it/s, est. speed input: 16373.93 toks/s, output: 15.99 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:07, 15.68it/s, est. speed input: 16368.84 toks/s, output: 15.99 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:08<00:07, 15.50it/s, est. speed input: 16355.11 toks/s, output: 15.97 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:08<00:07, 15.56it/s, est. speed input: 16351.11 toks/s, output: 15.97 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:09<00:07, 15.59it/s, est. speed input: 16346.64 toks/s, output: 15.96 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:09<00:07, 15.62it/s, est. speed input: 16342.76 toks/s, output: 15.96 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:09<00:06, 15.60it/s, est. speed input: 16336.89 toks/s, output: 15.95 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:09<00:06, 15.67it/s, est. speed input: 16335.14 toks/s, output: 15.95 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:09<00:06, 15.62it/s, est. speed input: 16329.14 toks/s, output: 15.95 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:09<00:06, 15.69it/s, est. speed input: 16327.64 toks/s, output: 15.94 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:09<00:06, 15.49it/s, est. speed input: 16315.03 toks/s, output: 15.93 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:09<00:06, 15.52it/s, est. speed input: 16310.79 toks/s, output: 15.93 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:10<00:06, 15.53it/s, est. speed input: 16305.79 toks/s, output: 15.92 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:10<00:06, 15.53it/s, est. speed input: 16300.59 toks/s, output: 15.92 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:10<00:05, 15.61it/s, est. speed input: 16299.13 toks/s, output: 15.92 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:10<00:05, 15.63it/s, est. speed input: 16296.00 toks/s, output: 15.91 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:10<00:05, 15.62it/s, est. speed input: 16292.31 toks/s, output: 15.91 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:10<00:05, 15.67it/s, est. speed input: 16290.87 toks/s, output: 15.91 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:10<00:05, 15.53it/s, est. speed input: 16281.96 toks/s, output: 15.90 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:10<00:05, 15.61it/s, est. speed input: 16280.77 toks/s, output: 15.90 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:11<00:05, 15.55it/s, est. speed input: 16274.79 toks/s, output: 15.89 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:11<00:05, 15.60it/s, est. speed input: 16272.85 toks/s, output: 15.89 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:11<00:04, 15.60it/s, est. speed input: 16269.70 toks/s, output: 15.89 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:11<00:04, 15.68it/s, est. speed input: 16269.24 toks/s, output: 15.89 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:11<00:04, 15.69it/s, est. speed input: 16267.41 toks/s, output: 15.89 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:11<00:04, 15.75it/s, est. speed input: 16267.57 toks/s, output: 15.89 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:11<00:04, 15.66it/s, est. speed input: 16262.47 toks/s, output: 15.88 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:11<00:04, 15.39it/s, est. speed input: 16249.91 toks/s, output: 15.87 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:12<00:04, 15.49it/s, est. speed input: 16248.64 toks/s, output: 15.87 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:12<00:03, 15.58it/s, est. speed input: 16247.88 toks/s, output: 15.87 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:12<00:03, 15.56it/s, est. speed input: 16244.14 toks/s, output: 15.86 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:12<00:03, 15.56it/s, est. speed input: 16240.85 toks/s, output: 15.86 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:12<00:03, 15.64it/s, est. speed input: 16240.48 toks/s, output: 15.86 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:12<00:03, 15.73it/s, est. speed input: 16241.38 toks/s, output: 15.86 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:12<00:03, 15.67it/s, est. speed input: 16237.97 toks/s, output: 15.86 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:12<00:03, 15.40it/s, est. speed input: 16226.68 toks/s, output: 15.85 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:13<00:03, 15.55it/s, est. speed input: 16227.42 toks/s, output: 15.85 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:13<00:02, 15.51it/s, est. speed input: 16223.21 toks/s, output: 15.84 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:13<00:02, 15.57it/s, est. speed input: 16221.85 toks/s, output: 15.84 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:13<00:02, 15.62it/s, est. speed input: 16220.78 toks/s, output: 15.84 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:13<00:02, 15.60it/s, est. speed input: 16217.96 toks/s, output: 15.84 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:13<00:02, 15.63it/s, est. speed input: 16216.78 toks/s, output: 15.84 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:13<00:02, 15.60it/s, est. speed input: 16213.94 toks/s, output: 15.83 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:14<00:02, 15.43it/s, est. speed input: 16206.27 toks/s, output: 15.83 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:14<00:02, 15.49it/s, est. speed input: 16204.42 toks/s, output: 15.82 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:14<00:01, 15.47it/s, est. speed input: 16200.84 toks/s, output: 15.82 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:14<00:01, 15.51it/s, est. speed input: 16198.85 toks/s, output: 15.82 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:14<00:01, 15.58it/s, est. speed input: 16198.05 toks/s, output: 15.82 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:14<00:01, 15.63it/s, est. speed input: 16197.37 toks/s, output: 15.82 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:14<00:01, 15.64it/s, est. speed input: 16196.00 toks/s, output: 15.82 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:14<00:01, 15.70it/s, est. speed input: 16196.19 toks/s, output: 15.82 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:15<00:01, 15.53it/s, est. speed input: 16190.33 toks/s, output: 15.81 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:15<00:01, 15.48it/s, est. speed input: 16186.32 toks/s, output: 15.81 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:15<00:00, 15.56it/s, est. speed input: 16185.74 toks/s, output: 15.81 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:15<00:00, 15.61it/s, est. speed input: 16185.11 toks/s, output: 15.81 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:15<00:00, 15.65it/s, est. speed input: 16184.68 toks/s, output: 15.81 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:15<00:00, 15.59it/s, est. speed input: 16181.56 toks/s, output: 15.80 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:15<00:00, 15.61it/s, est. speed input: 16180.38 toks/s, output: 15.80 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:15<00:00, 15.55it/s, est. speed input: 16177.02 toks/s, output: 15.80 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:16<00:00, 15.59it/s, est. speed input: 16176.31 toks/s, output: 15.80 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:16<00:00, 15.59it/s, est. speed input: 16233.65 toks/s, output: 15.85 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:16<00:00, 15.85it/s, est. speed input: 16233.65 toks/s, output: 15.85 toks/s]
[rank0]:[W128 09:05:33.759401795 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 48.8s

测试结果:
  Requests/s:   15.44
  Tokens/s:     15828.01
  Total Reqs:   256
  Elapsed:      16.58s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     15812.56

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:05:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:05:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3726577) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3726577) WARNING 01-28 09:06:06 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.52 requests/s, 14887.26 total tokens/s, 14.52 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 09:05:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:05:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:05:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:05:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:05:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:05:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:05:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:05:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:05:44] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:05:44] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:05:44] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:05:44] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:05:44] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:05:44] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:05:44] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:05:44] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:05:44] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3726577) [2026-01-28 09:05:45] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3726577) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3726577) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.36s/it]
(EngineCore_DP0 pid=3726577) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.36s/it]
(EngineCore_DP0 pid=3726577) 
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3726577) [2026-01-28 09:06:00] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3726577) 2026-01-28 09:06:05,990 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3726577) 2026-01-28 09:06:06,002 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  12%|█▏        | 62/512 [00:00<00:00, 615.54it/s]
Adding requests:  24%|██▍       | 124/512 [00:00<00:00, 583.27it/s]
Adding requests:  36%|███▌      | 183/512 [00:00<00:00, 558.07it/s]
Adding requests:  47%|████▋     | 241/512 [00:00<00:00, 564.69it/s]
Adding requests:  58%|█████▊    | 298/512 [00:00<00:00, 553.31it/s]
Adding requests:  69%|██████▉   | 355/512 [00:00<00:00, 555.46it/s]
Adding requests:  80%|████████  | 411/512 [00:00<00:00, 553.23it/s]
Adding requests:  91%|█████████ | 467/512 [00:00<00:00, 548.94it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 553.66it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 14/512 [00:00<00:12, 39.99it/s, est. speed input: 40953.09 toks/s, output: 39.99 toks/s]
Processed prompts:   4%|▎         | 18/512 [00:00<00:18, 26.51it/s, est. speed input: 29464.93 toks/s, output: 28.77 toks/s]
Processed prompts:   4%|▍         | 22/512 [00:00<00:22, 21.50it/s, est. speed input: 25124.60 toks/s, output: 24.54 toks/s]
Processed prompts:   5%|▌         | 26/512 [00:01<00:25, 18.96it/s, est. speed input: 22812.71 toks/s, output: 22.28 toks/s]
Processed prompts:   6%|▌         | 30/512 [00:01<00:27, 17.50it/s, est. speed input: 21368.72 toks/s, output: 20.87 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:01<00:29, 16.42it/s, est. speed input: 20279.27 toks/s, output: 19.80 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:01<00:29, 15.83it/s, est. speed input: 19546.67 toks/s, output: 19.09 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:02<00:30, 15.47it/s, est. speed input: 19005.93 toks/s, output: 18.56 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:30, 15.25it/s, est. speed input: 18589.66 toks/s, output: 18.15 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:30, 14.99it/s, est. speed input: 18209.19 toks/s, output: 17.78 toks/s]
Processed prompts:  11%|█         | 54/512 [00:03<00:30, 14.90it/s, est. speed input: 17929.97 toks/s, output: 17.51 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:03<00:30, 14.85it/s, est. speed input: 17702.07 toks/s, output: 17.29 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:30, 14.80it/s, est. speed input: 17499.92 toks/s, output: 17.09 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:03<00:30, 14.68it/s, est. speed input: 17306.15 toks/s, output: 16.90 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:04<00:30, 14.66it/s, est. speed input: 17151.99 toks/s, output: 16.75 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:29, 14.70it/s, est. speed input: 17031.09 toks/s, output: 16.63 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:29, 14.69it/s, est. speed input: 16914.22 toks/s, output: 16.52 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:04<00:29, 14.62it/s, est. speed input: 16797.29 toks/s, output: 16.40 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:05<00:29, 14.64it/s, est. speed input: 16707.59 toks/s, output: 16.32 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:28, 14.69it/s, est. speed input: 16630.92 toks/s, output: 16.24 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:05<00:28, 14.63it/s, est. speed input: 16545.61 toks/s, output: 16.16 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:06<00:28, 14.67it/s, est. speed input: 16482.92 toks/s, output: 16.10 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:27, 14.67it/s, est. speed input: 16419.38 toks/s, output: 16.03 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:27, 14.64it/s, est. speed input: 16357.16 toks/s, output: 15.97 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:06<00:27, 14.58it/s, est. speed input: 16294.66 toks/s, output: 15.91 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:27, 14.59it/s, est. speed input: 16244.26 toks/s, output: 15.86 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:26, 14.66it/s, est. speed input: 16205.39 toks/s, output: 15.83 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:07<00:26, 14.68it/s, est. speed input: 16165.46 toks/s, output: 15.79 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:08<00:26, 14.67it/s, est. speed input: 16125.88 toks/s, output: 15.75 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:26, 14.69it/s, est. speed input: 16091.79 toks/s, output: 15.71 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:25, 14.63it/s, est. speed input: 16051.73 toks/s, output: 15.68 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:08<00:25, 14.65it/s, est. speed input: 16020.67 toks/s, output: 15.65 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:25, 14.57it/s, est. speed input: 15980.90 toks/s, output: 15.61 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:09<00:25, 14.63it/s, est. speed input: 15956.76 toks/s, output: 15.58 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:09<00:24, 14.67it/s, est. speed input: 15932.51 toks/s, output: 15.56 toks/s]
Processed prompts:  30%|███       | 154/512 [00:09<00:24, 14.68it/s, est. speed input: 15908.87 toks/s, output: 15.54 toks/s]
Processed prompts:  31%|███       | 158/512 [00:10<00:24, 14.58it/s, est. speed input: 15875.76 toks/s, output: 15.50 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:10<00:24, 14.58it/s, est. speed input: 15851.16 toks/s, output: 15.48 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:10<00:23, 14.60it/s, est. speed input: 15829.06 toks/s, output: 15.46 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:11<00:23, 14.66it/s, est. speed input: 15812.77 toks/s, output: 15.44 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:11<00:23, 14.60it/s, est. speed input: 15788.55 toks/s, output: 15.42 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:11<00:22, 14.62it/s, est. speed input: 15770.52 toks/s, output: 15.40 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:11<00:22, 14.66it/s, est. speed input: 15755.02 toks/s, output: 15.39 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:12<00:22, 14.61it/s, est. speed input: 15734.25 toks/s, output: 15.37 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:12<00:22, 14.56it/s, est. speed input: 15713.32 toks/s, output: 15.35 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:12<00:21, 14.64it/s, est. speed input: 15702.26 toks/s, output: 15.33 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:12<00:21, 14.68it/s, est. speed input: 15689.70 toks/s, output: 15.32 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:13<00:21, 14.71it/s, est. speed input: 15678.86 toks/s, output: 15.31 toks/s]
Processed prompts:  40%|████      | 206/512 [00:13<00:20, 14.64it/s, est. speed input: 15660.92 toks/s, output: 15.29 toks/s]
Processed prompts:  41%|████      | 210/512 [00:13<00:20, 14.68it/s, est. speed input: 15650.33 toks/s, output: 15.28 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:14<00:20, 14.68it/s, est. speed input: 15638.59 toks/s, output: 15.27 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:14<00:19, 14.72it/s, est. speed input: 15629.57 toks/s, output: 15.26 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:14<00:19, 14.59it/s, est. speed input: 15610.85 toks/s, output: 15.24 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:14<00:19, 14.64it/s, est. speed input: 15601.37 toks/s, output: 15.24 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:15<00:19, 14.61it/s, est. speed input: 15588.73 toks/s, output: 15.22 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:15<00:19, 14.56it/s, est. speed input: 15574.08 toks/s, output: 15.21 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:15<00:18, 14.62it/s, est. speed input: 15566.13 toks/s, output: 15.20 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:15<00:18, 14.67it/s, est. speed input: 15559.04 toks/s, output: 15.19 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:16<00:18, 14.67it/s, est. speed input: 15549.79 toks/s, output: 15.19 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:16<00:17, 14.56it/s, est. speed input: 15534.58 toks/s, output: 15.17 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:16<00:17, 14.60it/s, est. speed input: 15526.47 toks/s, output: 15.16 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:17<00:17, 14.59it/s, est. speed input: 15516.74 toks/s, output: 15.15 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:17<00:17, 14.63it/s, est. speed input: 15510.14 toks/s, output: 15.15 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:17<00:16, 14.54it/s, est. speed input: 15497.03 toks/s, output: 15.13 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:17<00:16, 14.56it/s, est. speed input: 15488.52 toks/s, output: 15.13 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:18<00:16, 14.56it/s, est. speed input: 15479.85 toks/s, output: 15.12 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:18<00:16, 14.62it/s, est. speed input: 15474.67 toks/s, output: 15.11 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:18<00:15, 14.58it/s, est. speed input: 15464.94 toks/s, output: 15.10 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:18<00:15, 14.60it/s, est. speed input: 15458.29 toks/s, output: 15.10 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:19<00:15, 14.63it/s, est. speed input: 15452.35 toks/s, output: 15.09 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:19<00:14, 14.69it/s, est. speed input: 15449.05 toks/s, output: 15.09 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:19<00:14, 14.61it/s, est. speed input: 15439.24 toks/s, output: 15.08 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:20<00:14, 14.62it/s, est. speed input: 15433.06 toks/s, output: 15.07 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:20<00:14, 14.67it/s, est. speed input: 15429.45 toks/s, output: 15.07 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:20<00:13, 14.65it/s, est. speed input: 15423.02 toks/s, output: 15.06 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:20<00:13, 14.60it/s, est. speed input: 15415.15 toks/s, output: 15.05 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:21<00:13, 14.65it/s, est. speed input: 15411.49 toks/s, output: 15.05 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:21<00:12, 14.65it/s, est. speed input: 15406.10 toks/s, output: 15.05 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:21<00:12, 14.65it/s, est. speed input: 15401.26 toks/s, output: 15.04 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:21<00:12, 14.55it/s, est. speed input: 15391.58 toks/s, output: 15.03 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:22<00:12, 14.63it/s, est. speed input: 15389.25 toks/s, output: 15.03 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:22<00:11, 14.62it/s, est. speed input: 15383.70 toks/s, output: 15.02 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:22<00:11, 15.25it/s, est. speed input: 15404.38 toks/s, output: 15.04 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:23<00:11, 14.94it/s, est. speed input: 15394.56 toks/s, output: 15.03 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:23<00:10, 14.89it/s, est. speed input: 15391.34 toks/s, output: 15.03 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:23<00:10, 14.80it/s, est. speed input: 15386.23 toks/s, output: 15.03 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:23<00:10, 14.83it/s, est. speed input: 15384.79 toks/s, output: 15.02 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:24<00:10, 14.69it/s, est. speed input: 15377.05 toks/s, output: 15.02 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:24<00:09, 14.70it/s, est. speed input: 15373.82 toks/s, output: 15.01 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:24<00:09, 14.70it/s, est. speed input: 15370.27 toks/s, output: 15.01 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:24<00:09, 14.61it/s, est. speed input: 15363.38 toks/s, output: 15.00 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:25<00:09, 14.59it/s, est. speed input: 15358.24 toks/s, output: 15.00 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:25<00:08, 14.65it/s, est. speed input: 15355.85 toks/s, output: 15.00 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:25<00:08, 14.67it/s, est. speed input: 15352.73 toks/s, output: 14.99 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:26<00:08, 14.61it/s, est. speed input: 15347.36 toks/s, output: 14.99 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:26<00:08, 14.63it/s, est. speed input: 15343.97 toks/s, output: 14.98 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:26<00:07, 14.60it/s, est. speed input: 15339.12 toks/s, output: 14.98 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:26<00:07, 14.62it/s, est. speed input: 15335.87 toks/s, output: 14.98 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:27<00:07, 14.51it/s, est. speed input: 15328.15 toks/s, output: 14.97 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:27<00:06, 14.60it/s, est. speed input: 15326.66 toks/s, output: 14.97 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:27<00:06, 14.63it/s, est. speed input: 15324.14 toks/s, output: 14.96 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:27<00:06, 14.69it/s, est. speed input: 15322.56 toks/s, output: 14.96 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:28<00:06, 14.56it/s, est. speed input: 15315.70 toks/s, output: 14.96 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:28<00:05, 14.56it/s, est. speed input: 15311.72 toks/s, output: 14.95 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:28<00:05, 14.59it/s, est. speed input: 15308.75 toks/s, output: 14.95 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:29<00:05, 14.59it/s, est. speed input: 15305.49 toks/s, output: 14.95 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:29<00:05, 14.59it/s, est. speed input: 15301.83 toks/s, output: 14.94 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:29<00:04, 14.59it/s, est. speed input: 15298.48 toks/s, output: 14.94 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:29<00:04, 14.62it/s, est. speed input: 15296.07 toks/s, output: 14.94 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:30<00:04, 15.48it/s, est. speed input: 15318.89 toks/s, output: 14.96 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:30<00:03, 15.15it/s, est. speed input: 15313.92 toks/s, output: 14.95 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:30<00:03, 14.98it/s, est. speed input: 15310.72 toks/s, output: 14.95 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:30<00:03, 14.88it/s, est. speed input: 15308.02 toks/s, output: 14.95 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:31<00:03, 14.78it/s, est. speed input: 15304.52 toks/s, output: 14.95 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:31<00:03, 12.91it/s, est. speed input: 15239.68 toks/s, output: 14.88 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:31<00:02, 13.05it/s, est. speed input: 15225.23 toks/s, output: 14.87 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:32<00:02, 13.55it/s, est. speed input: 15225.32 toks/s, output: 14.87 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:32<00:02, 13.33it/s, est. speed input: 15205.43 toks/s, output: 14.85 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:32<00:01, 13.65it/s, est. speed input: 15201.99 toks/s, output: 14.85 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:33<00:01, 13.94it/s, est. speed input: 15200.59 toks/s, output: 14.84 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:33<00:01, 14.15it/s, est. speed input: 15199.01 toks/s, output: 14.84 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:33<00:00, 14.22it/s, est. speed input: 15195.19 toks/s, output: 14.84 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:33<00:00, 14.37it/s, est. speed input: 15194.40 toks/s, output: 14.84 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:34<00:00, 14.43it/s, est. speed input: 15192.12 toks/s, output: 14.84 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:34<00:00, 15.40it/s, est. speed input: 15214.49 toks/s, output: 14.86 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:34<00:00, 15.40it/s, est. speed input: 15274.10 toks/s, output: 14.92 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:34<00:00, 14.92it/s, est. speed input: 15274.10 toks/s, output: 14.92 toks/s]
[rank0]:[W128 09:06:42.274208660 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 68.6s

测试结果:
  Requests/s:   14.52
  Tokens/s:     14887.26
  Total Reqs:   512
  Elapsed:      35.25s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     14872.73

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:06:51 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:06:51 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3727749) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3727749) WARNING 01-28 09:07:17 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.63 requests/s, 14992.23 total tokens/s, 14.63 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 09:06:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:06:51] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:06:51] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:51] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:06:51] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:06:51] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:06:51] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:06:51] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:06:51] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:06:54] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:06:54] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:06:54] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:06:54] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:06:54] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:06:54] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:06:54] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:06:54] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:06:54] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3727749) [2026-01-28 09:06:55] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3727749) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3727749) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.68s/it]
(EngineCore_DP0 pid=3727749) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.68s/it]
(EngineCore_DP0 pid=3727749) 
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3727749) [2026-01-28 09:07:10] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3727749) 2026-01-28 09:07:16,771 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3727749) 2026-01-28 09:07:16,824 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 60/1024 [00:00<00:01, 593.10it/s]
Adding requests:  12%|█▏        | 120/1024 [00:00<00:01, 566.52it/s]
Adding requests:  17%|█▋        | 177/1024 [00:00<00:01, 519.25it/s]
Adding requests:  22%|██▏       | 230/1024 [00:00<00:01, 516.35it/s]
Adding requests:  28%|██▊       | 282/1024 [00:00<00:01, 504.93it/s]
Adding requests:  33%|███▎      | 333/1024 [00:00<00:01, 497.02it/s]
Adding requests:  37%|███▋      | 383/1024 [00:00<00:01, 496.03it/s]
Adding requests:  42%|████▏     | 433/1024 [00:00<00:01, 494.71it/s]
Adding requests:  47%|████▋     | 483/1024 [00:00<00:01, 484.82it/s]
Adding requests:  52%|█████▏    | 532/1024 [00:01<00:01, 465.85it/s]
Adding requests:  57%|█████▋    | 582/1024 [00:01<00:00, 474.90it/s]
Adding requests:  62%|██████▏   | 632/1024 [00:01<00:00, 481.79it/s]
Adding requests:  67%|██████▋   | 683/1024 [00:01<00:00, 487.90it/s]
Adding requests:  72%|███████▏  | 733/1024 [00:01<00:00, 489.94it/s]
Adding requests:  76%|███████▋  | 783/1024 [00:01<00:00, 480.15it/s]
Adding requests:  81%|████████▏ | 832/1024 [00:01<00:00, 467.15it/s]
Adding requests:  86%|████████▋ | 884/1024 [00:01<00:00, 479.77it/s]
Adding requests:  91%|█████████ | 934/1024 [00:01<00:00, 485.45it/s]
Adding requests:  96%|█████████▌| 983/1024 [00:02<00:00, 482.60it/s]
Adding requests: 100%|██████████| 1024/1024 [00:02<00:00, 490.96it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:00<00:10, 94.59it/s, est. speed input: 96865.66 toks/s, output: 94.59 toks/s]
Processed prompts:   4%|▎         | 36/1024 [00:00<00:25, 38.44it/s, est. speed input: 45172.99 toks/s, output: 44.11 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:01<00:40, 24.23it/s, est. speed input: 31512.45 toks/s, output: 30.77 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:01<00:48, 20.23it/s, est. speed input: 26847.82 toks/s, output: 26.22 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:02<00:53, 18.12it/s, est. speed input: 24207.25 toks/s, output: 23.64 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:02<00:56, 16.99it/s, est. speed input: 22590.30 toks/s, output: 22.06 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:03<00:58, 16.19it/s, est. speed input: 21408.83 toks/s, output: 20.91 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:04<00:59, 15.77it/s, est. speed input: 20592.28 toks/s, output: 20.11 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:04<01:00, 15.40it/s, est. speed input: 19927.44 toks/s, output: 19.46 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:05<01:00, 15.20it/s, est. speed input: 19421.48 toks/s, output: 18.97 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:05<01:01, 15.01it/s, est. speed input: 18990.13 toks/s, output: 18.54 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:06<01:01, 14.92it/s, est. speed input: 18648.21 toks/s, output: 18.21 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:06<01:00, 14.82it/s, est. speed input: 18349.62 toks/s, output: 17.92 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:07<01:00, 14.78it/s, est. speed input: 18105.49 toks/s, output: 17.68 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:07<00:59, 14.78it/s, est. speed input: 17902.34 toks/s, output: 17.48 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:08<00:59, 14.77it/s, est. speed input: 17720.70 toks/s, output: 17.31 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:08<00:58, 14.75it/s, est. speed input: 17560.71 toks/s, output: 17.15 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:09<00:58, 14.76it/s, est. speed input: 17422.71 toks/s, output: 17.01 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:10<00:57, 14.73it/s, est. speed input: 17291.34 toks/s, output: 16.89 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:10<00:57, 14.72it/s, est. speed input: 17177.21 toks/s, output: 16.77 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:11<00:57, 14.69it/s, est. speed input: 17068.65 toks/s, output: 16.67 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:11<00:56, 14.74it/s, est. speed input: 16982.48 toks/s, output: 16.58 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<00:55, 14.69it/s, est. speed input: 16890.46 toks/s, output: 16.49 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:12<00:55, 14.68it/s, est. speed input: 16809.81 toks/s, output: 16.42 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:13<00:54, 14.66it/s, est. speed input: 16735.22 toks/s, output: 16.34 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:13<00:54, 14.71it/s, est. speed input: 16674.24 toks/s, output: 16.28 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:14<00:53, 14.69it/s, est. speed input: 16610.84 toks/s, output: 16.22 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:14<00:53, 14.70it/s, est. speed input: 16555.24 toks/s, output: 16.17 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:15<00:52, 14.65it/s, est. speed input: 16495.87 toks/s, output: 16.11 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:16<00:52, 14.67it/s, est. speed input: 16448.12 toks/s, output: 16.06 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:16<00:51, 14.65it/s, est. speed input: 16398.98 toks/s, output: 16.01 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:17<00:51, 14.66it/s, est. speed input: 16355.30 toks/s, output: 15.97 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:17<00:50, 14.65it/s, est. speed input: 16313.33 toks/s, output: 15.93 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:18<00:50, 14.61it/s, est. speed input: 16269.23 toks/s, output: 15.89 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:18<00:49, 14.65it/s, est. speed input: 16235.04 toks/s, output: 15.85 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:19<00:49, 14.65it/s, est. speed input: 16200.76 toks/s, output: 15.82 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:19<00:48, 14.68it/s, est. speed input: 16170.38 toks/s, output: 15.79 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:20<00:47, 14.65it/s, est. speed input: 16137.51 toks/s, output: 15.76 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:20<00:47, 14.66it/s, est. speed input: 16109.19 toks/s, output: 15.73 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:21<00:46, 14.89it/s, est. speed input: 16101.85 toks/s, output: 15.72 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:22<00:45, 14.85it/s, est. speed input: 16077.68 toks/s, output: 15.70 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:22<00:45, 14.77it/s, est. speed input: 16049.70 toks/s, output: 15.67 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:23<00:44, 14.77it/s, est. speed input: 16028.51 toks/s, output: 15.65 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:23<00:44, 14.71it/s, est. speed input: 16002.73 toks/s, output: 15.63 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:24<00:43, 14.72it/s, est. speed input: 15982.44 toks/s, output: 15.61 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:24<00:43, 14.70it/s, est. speed input: 15960.59 toks/s, output: 15.59 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:25<00:42, 14.70it/s, est. speed input: 15941.30 toks/s, output: 15.57 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:25<00:42, 14.67it/s, est. speed input: 15920.45 toks/s, output: 15.55 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:26<00:41, 14.71it/s, est. speed input: 15904.68 toks/s, output: 15.53 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:26<00:41, 14.69it/s, est. speed input: 15886.06 toks/s, output: 15.51 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:27<00:40, 14.70it/s, est. speed input: 15870.08 toks/s, output: 15.50 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:28<00:40, 14.70it/s, est. speed input: 15854.04 toks/s, output: 15.48 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:28<00:39, 14.73it/s, est. speed input: 15840.71 toks/s, output: 15.47 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:29<00:38, 15.08it/s, est. speed input: 15849.38 toks/s, output: 15.48 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:29<00:38, 14.73it/s, est. speed input: 15819.95 toks/s, output: 15.45 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:30<00:41, 13.33it/s, est. speed input: 15707.54 toks/s, output: 15.34 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:30<00:40, 13.70it/s, est. speed input: 15695.47 toks/s, output: 15.33 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:31<00:38, 13.96it/s, est. speed input: 15682.28 toks/s, output: 15.31 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:32<00:37, 14.19it/s, est. speed input: 15672.94 toks/s, output: 15.31 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:32<00:36, 14.27it/s, est. speed input: 15658.29 toks/s, output: 15.29 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:33<00:35, 14.39it/s, est. speed input: 15647.75 toks/s, output: 15.28 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:33<00:35, 14.50it/s, est. speed input: 15639.07 toks/s, output: 15.27 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:34<00:34, 14.52it/s, est. speed input: 15627.35 toks/s, output: 15.26 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:34<00:33, 14.54it/s, est. speed input: 15616.81 toks/s, output: 15.25 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:35<00:33, 14.57it/s, est. speed input: 15607.16 toks/s, output: 15.24 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:35<00:32, 14.60it/s, est. speed input: 15598.20 toks/s, output: 15.23 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:36<00:32, 14.60it/s, est. speed input: 15588.18 toks/s, output: 15.22 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:36<00:31, 14.66it/s, est. speed input: 15581.94 toks/s, output: 15.22 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:37<00:30, 14.65it/s, est. speed input: 15573.30 toks/s, output: 15.21 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:38<00:30, 14.64it/s, est. speed input: 15564.54 toks/s, output: 15.20 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:38<00:29, 14.64it/s, est. speed input: 15556.36 toks/s, output: 15.19 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:39<00:29, 14.67it/s, est. speed input: 15550.20 toks/s, output: 15.19 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:39<00:28, 14.63it/s, est. speed input: 15540.65 toks/s, output: 15.18 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:40<00:28, 14.67it/s, est. speed input: 15534.97 toks/s, output: 15.17 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:40<00:27, 14.69it/s, est. speed input: 15529.04 toks/s, output: 15.17 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:41<00:27, 14.72it/s, est. speed input: 15524.28 toks/s, output: 15.16 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:41<00:26, 14.70it/s, est. speed input: 15517.36 toks/s, output: 15.15 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:42<00:25, 14.73it/s, est. speed input: 15512.57 toks/s, output: 15.15 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:42<00:25, 14.69it/s, est. speed input: 15505.70 toks/s, output: 15.14 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:43<00:24, 14.72it/s, est. speed input: 15501.12 toks/s, output: 15.14 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:44<00:24, 14.67it/s, est. speed input: 15493.44 toks/s, output: 15.13 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:44<00:23, 14.67it/s, est. speed input: 15487.85 toks/s, output: 15.12 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:45<00:23, 14.66it/s, est. speed input: 15481.71 toks/s, output: 15.12 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:45<00:22, 14.66it/s, est. speed input: 15476.12 toks/s, output: 15.11 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:46<00:22, 14.63it/s, est. speed input: 15469.34 toks/s, output: 15.11 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:46<00:21, 14.67it/s, est. speed input: 15465.20 toks/s, output: 15.10 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:47<00:21, 14.62it/s, est. speed input: 15458.25 toks/s, output: 15.10 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:47<00:20, 14.65it/s, est. speed input: 15454.00 toks/s, output: 15.09 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:48<00:20, 14.66it/s, est. speed input: 15449.29 toks/s, output: 15.09 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:48<00:19, 14.70it/s, est. speed input: 15445.87 toks/s, output: 15.08 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:49<00:18, 14.67it/s, est. speed input: 15440.50 toks/s, output: 15.08 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:50<00:18, 14.69it/s, est. speed input: 15436.59 toks/s, output: 15.07 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:50<00:17, 14.66it/s, est. speed input: 15431.23 toks/s, output: 15.07 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:51<00:17, 14.69it/s, est. speed input: 15427.85 toks/s, output: 15.07 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:51<00:16, 14.66it/s, est. speed input: 15422.85 toks/s, output: 15.06 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:52<00:16, 14.67it/s, est. speed input: 15418.70 toks/s, output: 15.06 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:52<00:15, 14.63it/s, est. speed input: 15413.11 toks/s, output: 15.05 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:53<00:15, 14.67it/s, est. speed input: 15410.33 toks/s, output: 15.05 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:53<00:14, 14.66it/s, est. speed input: 15405.94 toks/s, output: 15.04 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:54<00:14, 14.62it/s, est. speed input: 15400.60 toks/s, output: 15.04 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:54<00:13, 14.64it/s, est. speed input: 15396.97 toks/s, output: 15.04 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:55<00:12, 14.63it/s, est. speed input: 15392.65 toks/s, output: 15.03 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:56<00:12, 14.69it/s, est. speed input: 15390.62 toks/s, output: 15.03 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:56<00:11, 14.66it/s, est. speed input: 15386.28 toks/s, output: 15.03 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:57<00:11, 14.70it/s, est. speed input: 15384.09 toks/s, output: 15.02 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:57<00:10, 14.64it/s, est. speed input: 15378.80 toks/s, output: 15.02 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [00:58<00:10, 14.66it/s, est. speed input: 15375.82 toks/s, output: 15.02 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [00:58<00:09, 14.60it/s, est. speed input: 15370.67 toks/s, output: 15.01 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [00:59<00:09, 14.62it/s, est. speed input: 15367.41 toks/s, output: 15.01 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [00:59<00:08, 14.62it/s, est. speed input: 15363.72 toks/s, output: 15.00 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:00<00:08, 14.62it/s, est. speed input: 15360.15 toks/s, output: 15.00 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:00<00:07, 14.60it/s, est. speed input: 15355.92 toks/s, output: 15.00 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:01<00:06, 14.61it/s, est. speed input: 15352.69 toks/s, output: 14.99 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:02<00:06, 14.58it/s, est. speed input: 15348.40 toks/s, output: 14.99 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:02<00:05, 14.87it/s, est. speed input: 15353.48 toks/s, output: 14.99 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:03<00:05, 14.75it/s, est. speed input: 15348.78 toks/s, output: 14.99 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:03<00:04, 14.72it/s, est. speed input: 15345.91 toks/s, output: 14.99 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:04<00:04, 14.68it/s, est. speed input: 15342.21 toks/s, output: 14.98 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:04<00:03, 14.65it/s, est. speed input: 15338.69 toks/s, output: 14.98 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:05<00:03, 14.62it/s, est. speed input: 15335.14 toks/s, output: 14.98 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:05<00:02, 15.15it/s, est. speed input: 15347.07 toks/s, output: 14.99 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:06<00:02, 15.00it/s, est. speed input: 15344.21 toks/s, output: 14.98 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:06<00:01, 14.91it/s, est. speed input: 15341.98 toks/s, output: 14.98 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:07<00:00, 14.82it/s, est. speed input: 15338.92 toks/s, output: 14.98 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:07<00:00, 15.18it/s, est. speed input: 15347.34 toks/s, output: 14.99 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:07<00:00, 15.18it/s, est. speed input: 15437.76 toks/s, output: 15.08 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:07<00:00, 15.08it/s, est. speed input: 15437.76 toks/s, output: 15.08 toks/s]
[rank0]:[W128 09:08:28.160891811 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 105.9s

测试结果:
  Requests/s:   14.63
  Tokens/s:     14992.23
  Total Reqs:   1024
  Elapsed:      70.01s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     14977.61

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:08:39 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:08:39 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3729442) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3729442) WARNING 01-28 09:09:07 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.93 requests/s, 15301.94 total tokens/s, 14.93 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 09:08:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:08:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:08:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:08:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:08:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:08:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:08:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:08:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:08:42] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:08:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:08:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:08:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:08:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:08:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:08:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:08:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:08:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:43] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3729442) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3729442) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.66s/it]
(EngineCore_DP0 pid=3729442) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.66s/it]
(EngineCore_DP0 pid=3729442) 
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3729442) [2026-01-28 09:08:59] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3729442) 2026-01-28 09:09:05,793 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3729442) 2026-01-28 09:09:05,863 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 66/2048 [00:00<00:03, 654.01it/s]
Adding requests:   6%|▋         | 132/2048 [00:00<00:03, 604.79it/s]
Adding requests:   9%|▉         | 193/2048 [00:00<00:03, 543.45it/s]
Adding requests:  12%|█▏        | 248/2048 [00:00<00:03, 540.96it/s]
Adding requests:  15%|█▍        | 303/2048 [00:00<00:03, 527.60it/s]
Adding requests:  17%|█▋        | 357/2048 [00:00<00:03, 529.33it/s]
Adding requests:  20%|██        | 411/2048 [00:00<00:03, 518.15it/s]
Adding requests:  23%|██▎       | 464/2048 [00:00<00:03, 520.36it/s]
Adding requests:  25%|██▌       | 517/2048 [00:00<00:03, 502.76it/s]
Adding requests:  28%|██▊       | 568/2048 [00:01<00:02, 497.78it/s]
Adding requests:  30%|███       | 620/2048 [00:01<00:02, 504.07it/s]
Adding requests:  33%|███▎      | 671/2048 [00:01<00:02, 505.48it/s]
Adding requests:  35%|███▌      | 724/2048 [00:01<00:02, 511.00it/s]
Adding requests:  38%|███▊      | 776/2048 [00:01<00:02, 486.98it/s]
Adding requests:  40%|████      | 825/2048 [00:01<00:02, 481.83it/s]
Adding requests:  43%|████▎     | 874/2048 [00:02<00:06, 195.38it/s]
Adding requests:  45%|████▌     | 925/2048 [00:02<00:04, 239.77it/s]
Adding requests:  48%|████▊     | 975/2048 [00:02<00:03, 282.60it/s]
Adding requests:  50%|█████     | 1028/2048 [00:02<00:03, 330.03it/s]
Adding requests:  53%|█████▎    | 1079/2048 [00:02<00:02, 368.54it/s]
Adding requests:  55%|█████▌    | 1131/2048 [00:02<00:02, 403.90it/s]
Adding requests:  58%|█████▊    | 1184/2048 [00:02<00:01, 435.15it/s]
Adding requests:  60%|██████    | 1235/2048 [00:02<00:01, 453.51it/s]
Adding requests:  63%|██████▎   | 1286/2048 [00:03<00:01, 460.97it/s]
Adding requests:  65%|██████▌   | 1338/2048 [00:03<00:01, 476.51it/s]
Adding requests:  68%|██████▊   | 1391/2048 [00:03<00:01, 490.57it/s]
Adding requests:  70%|███████   | 1442/2048 [00:03<00:01, 492.66it/s]
Adding requests:  73%|███████▎  | 1494/2048 [00:03<00:01, 499.67it/s]
Adding requests:  75%|███████▌  | 1545/2048 [00:03<00:01, 502.58it/s]
Adding requests:  78%|███████▊  | 1600/2048 [00:03<00:00, 514.73it/s]
Adding requests:  81%|████████  | 1653/2048 [00:03<00:00, 517.66it/s]
Adding requests:  83%|████████▎ | 1706/2048 [00:03<00:00, 509.75it/s]
Adding requests:  86%|████████▌ | 1758/2048 [00:03<00:00, 510.82it/s]
Adding requests:  88%|████████▊ | 1812/2048 [00:04<00:00, 517.94it/s]
Adding requests:  91%|█████████ | 1864/2048 [00:04<00:00, 512.67it/s]
Adding requests:  94%|█████████▎| 1917/2048 [00:04<00:00, 516.41it/s]
Adding requests:  96%|█████████▌| 1969/2048 [00:04<00:00, 511.10it/s]
Adding requests:  99%|█████████▊| 2021/2048 [00:04<00:00, 493.73it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 451.92it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 66/2048 [00:01<00:30, 65.11it/s, est. speed input: 66679.76 toks/s, output: 65.11 toks/s]
Processed prompts:   4%|▍         | 82/2048 [00:02<00:56, 34.98it/s, est. speed input: 40325.58 toks/s, output: 39.38 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:03<01:15, 25.69it/s, est. speed input: 31803.04 toks/s, output: 31.06 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:04<01:30, 21.40it/s, est. speed input: 27613.79 toks/s, output: 26.97 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:05<01:40, 19.07it/s, est. speed input: 25129.20 toks/s, output: 24.54 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:06<01:47, 17.68it/s, est. speed input: 23489.42 toks/s, output: 22.94 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:07<01:52, 16.80it/s, est. speed input: 22319.05 toks/s, output: 21.80 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:08<01:55, 16.20it/s, est. speed input: 21429.97 toks/s, output: 20.93 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:09<01:57, 15.81it/s, est. speed input: 20748.18 toks/s, output: 20.26 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:10<01:58, 15.55it/s, est. speed input: 20203.86 toks/s, output: 19.73 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:11<01:58, 15.37it/s, est. speed input: 19757.08 toks/s, output: 19.29 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:12<01:58, 15.25it/s, est. speed input: 19387.76 toks/s, output: 18.93 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:13<01:58, 15.17it/s, est. speed input: 19074.76 toks/s, output: 18.63 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:14<01:57, 15.12it/s, est. speed input: 18810.01 toks/s, output: 18.37 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:15<01:56, 15.06it/s, est. speed input: 18572.88 toks/s, output: 18.14 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:17<01:56, 15.02it/s, est. speed input: 18365.47 toks/s, output: 17.94 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:18<01:55, 14.99it/s, est. speed input: 18183.42 toks/s, output: 17.76 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:19<01:53, 15.10it/s, est. speed input: 18050.45 toks/s, output: 17.63 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:20<01:52, 15.04it/s, est. speed input: 17903.03 toks/s, output: 17.48 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:21<01:51, 15.01it/s, est. speed input: 17771.43 toks/s, output: 17.35 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:22<01:50, 14.98it/s, est. speed input: 17650.91 toks/s, output: 17.24 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:23<01:49, 14.97it/s, est. speed input: 17544.01 toks/s, output: 17.13 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:24<01:49, 14.95it/s, est. speed input: 17444.22 toks/s, output: 17.04 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:25<01:48, 14.94it/s, est. speed input: 17353.60 toks/s, output: 16.95 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:26<01:45, 15.10it/s, est. speed input: 17295.80 toks/s, output: 16.89 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:27<01:51, 14.22it/s, est. speed input: 17090.29 toks/s, output: 16.69 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:28<01:48, 14.43it/s, est. speed input: 17025.09 toks/s, output: 16.63 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:30<01:46, 14.58it/s, est. speed input: 16963.53 toks/s, output: 16.57 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:31<01:44, 14.67it/s, est. speed input: 16904.58 toks/s, output: 16.51 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:32<01:42, 14.75it/s, est. speed input: 16850.33 toks/s, output: 16.46 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:33<01:41, 14.80it/s, est. speed input: 16799.91 toks/s, output: 16.41 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:34<01:40, 14.83it/s, est. speed input: 16751.29 toks/s, output: 16.36 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:35<01:39, 14.84it/s, est. speed input: 16705.31 toks/s, output: 16.31 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:36<01:37, 14.88it/s, est. speed input: 16664.74 toks/s, output: 16.27 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:37<01:36, 14.89it/s, est. speed input: 16625.41 toks/s, output: 16.24 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:38<01:35, 14.91it/s, est. speed input: 16588.44 toks/s, output: 16.20 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:39<01:34, 14.90it/s, est. speed input: 16552.55 toks/s, output: 16.16 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:40<01:33, 14.92it/s, est. speed input: 16519.66 toks/s, output: 16.13 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:41<01:31, 14.94it/s, est. speed input: 16489.78 toks/s, output: 16.10 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:42<01:30, 14.93it/s, est. speed input: 16459.08 toks/s, output: 16.07 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:44<01:29, 14.92it/s, est. speed input: 16429.86 toks/s, output: 16.04 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:45<01:28, 14.91it/s, est. speed input: 16401.64 toks/s, output: 16.02 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:46<01:27, 14.90it/s, est. speed input: 16374.68 toks/s, output: 15.99 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:47<01:26, 14.91it/s, est. speed input: 16349.55 toks/s, output: 15.97 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:48<01:25, 14.92it/s, est. speed input: 16326.56 toks/s, output: 15.94 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:49<01:24, 14.91it/s, est. speed input: 16303.17 toks/s, output: 15.92 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:50<01:23, 14.91it/s, est. speed input: 16280.94 toks/s, output: 15.90 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:51<01:22, 14.93it/s, est. speed input: 16261.57 toks/s, output: 15.88 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:52<01:21, 14.92it/s, est. speed input: 16240.63 toks/s, output: 15.86 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:53<01:20, 14.91it/s, est. speed input: 16221.16 toks/s, output: 15.84 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:54<01:19, 14.92it/s, est. speed input: 16203.24 toks/s, output: 15.82 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:55<01:18, 14.92it/s, est. speed input: 16185.09 toks/s, output: 15.81 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:56<01:17, 14.92it/s, est. speed input: 16168.10 toks/s, output: 15.79 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [00:57<01:16, 14.91it/s, est. speed input: 16150.99 toks/s, output: 15.77 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [00:58<01:13, 15.13it/s, est. speed input: 16149.16 toks/s, output: 15.77 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:00<01:14, 14.76it/s, est. speed input: 16113.65 toks/s, output: 15.74 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:01<01:13, 14.80it/s, est. speed input: 16098.51 toks/s, output: 15.72 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:02<01:11, 15.05it/s, est. speed input: 16097.70 toks/s, output: 15.72 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:03<01:10, 15.01it/s, est. speed input: 16083.70 toks/s, output: 15.71 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:04<01:09, 14.97it/s, est. speed input: 16069.47 toks/s, output: 15.69 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:05<01:08, 14.95it/s, est. speed input: 16056.52 toks/s, output: 15.68 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:06<01:07, 14.94it/s, est. speed input: 16044.02 toks/s, output: 15.67 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:07<01:06, 14.92it/s, est. speed input: 16031.01 toks/s, output: 15.66 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:08<01:05, 14.92it/s, est. speed input: 16019.01 toks/s, output: 15.64 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:09<01:04, 14.91it/s, est. speed input: 16007.08 toks/s, output: 15.63 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:10<01:03, 14.91it/s, est. speed input: 15995.82 toks/s, output: 15.62 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:11<01:02, 14.90it/s, est. speed input: 15984.76 toks/s, output: 15.61 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:12<01:01, 14.90it/s, est. speed input: 15973.86 toks/s, output: 15.60 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:13<00:59, 15.14it/s, est. speed input: 15975.48 toks/s, output: 15.60 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:15<00:58, 15.08it/s, est. speed input: 15965.78 toks/s, output: 15.59 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:16<00:57, 15.02it/s, est. speed input: 15955.61 toks/s, output: 15.58 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:17<00:56, 14.97it/s, est. speed input: 15945.28 toks/s, output: 15.57 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:18<00:55, 14.96it/s, est. speed input: 15936.26 toks/s, output: 15.56 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:19<00:54, 14.94it/s, est. speed input: 15927.17 toks/s, output: 15.55 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:20<00:53, 14.93it/s, est. speed input: 15918.48 toks/s, output: 15.55 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:21<00:51, 15.16it/s, est. speed input: 15920.39 toks/s, output: 15.55 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:22<00:50, 15.07it/s, est. speed input: 15911.53 toks/s, output: 15.54 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:23<00:49, 15.26it/s, est. speed input: 15913.96 toks/s, output: 15.54 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:24<00:48, 15.15it/s, est. speed input: 15905.49 toks/s, output: 15.53 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:25<00:47, 15.07it/s, est. speed input: 15897.28 toks/s, output: 15.52 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:26<00:46, 15.02it/s, est. speed input: 15889.27 toks/s, output: 15.52 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:27<00:45, 14.98it/s, est. speed input: 15881.49 toks/s, output: 15.51 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:28<00:44, 14.95it/s, est. speed input: 15873.60 toks/s, output: 15.50 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:29<00:43, 14.92it/s, est. speed input: 15865.78 toks/s, output: 15.49 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:31<00:42, 14.92it/s, est. speed input: 15858.80 toks/s, output: 15.49 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:32<00:41, 14.83it/s, est. speed input: 15848.27 toks/s, output: 15.48 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:33<00:40, 14.85it/s, est. speed input: 15841.28 toks/s, output: 15.47 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:34<00:39, 14.85it/s, est. speed input: 15834.12 toks/s, output: 15.46 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:35<00:38, 14.87it/s, est. speed input: 15827.91 toks/s, output: 15.46 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:36<00:37, 14.87it/s, est. speed input: 15821.26 toks/s, output: 15.45 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:37<00:36, 14.88it/s, est. speed input: 15814.92 toks/s, output: 15.44 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:38<00:35, 14.89it/s, est. speed input: 15808.95 toks/s, output: 15.44 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:39<00:34, 14.89it/s, est. speed input: 15802.84 toks/s, output: 15.43 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:40<00:33, 14.88it/s, est. speed input: 15796.79 toks/s, output: 15.43 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:41<00:32, 14.89it/s, est. speed input: 15790.97 toks/s, output: 15.42 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:42<00:30, 15.12it/s, est. speed input: 15793.92 toks/s, output: 15.42 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:43<00:29, 15.06it/s, est. speed input: 15788.62 toks/s, output: 15.42 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:44<00:28, 15.01it/s, est. speed input: 15783.16 toks/s, output: 15.41 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:46<00:27, 14.97it/s, est. speed input: 15777.50 toks/s, output: 15.41 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:47<00:26, 15.18it/s, est. speed input: 15780.35 toks/s, output: 15.41 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:48<00:25, 15.08it/s, est. speed input: 15774.72 toks/s, output: 15.40 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:49<00:24, 15.03it/s, est. speed input: 15769.72 toks/s, output: 15.40 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:50<00:23, 14.98it/s, est. speed input: 15764.43 toks/s, output: 15.39 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:51<00:22, 14.96it/s, est. speed input: 15759.49 toks/s, output: 15.39 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:52<00:21, 14.93it/s, est. speed input: 15754.47 toks/s, output: 15.39 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:53<00:20, 14.94it/s, est. speed input: 15750.40 toks/s, output: 15.38 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:54<00:19, 14.93it/s, est. speed input: 15745.88 toks/s, output: 15.38 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [01:55<00:18, 14.93it/s, est. speed input: 15741.52 toks/s, output: 15.37 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [01:56<00:17, 14.92it/s, est. speed input: 15736.96 toks/s, output: 15.37 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [01:57<00:15, 14.91it/s, est. speed input: 15732.65 toks/s, output: 15.36 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [01:58<00:14, 14.91it/s, est. speed input: 15728.50 toks/s, output: 15.36 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [01:59<00:13, 14.90it/s, est. speed input: 15724.12 toks/s, output: 15.36 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:01<00:12, 14.90it/s, est. speed input: 15719.83 toks/s, output: 15.35 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:02<00:11, 15.13it/s, est. speed input: 15722.94 toks/s, output: 15.35 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:03<00:10, 15.06it/s, est. speed input: 15718.78 toks/s, output: 15.35 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:04<00:09, 15.01it/s, est. speed input: 15714.72 toks/s, output: 15.35 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:05<00:08, 14.91it/s, est. speed input: 15708.84 toks/s, output: 15.34 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:06<00:07, 14.90it/s, est. speed input: 15704.66 toks/s, output: 15.34 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:07<00:06, 15.13it/s, est. speed input: 15707.64 toks/s, output: 15.34 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:08<00:05, 15.06it/s, est. speed input: 15703.77 toks/s, output: 15.34 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:09<00:04, 15.27it/s, est. speed input: 15707.35 toks/s, output: 15.34 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:10<00:03, 15.15it/s, est. speed input: 15703.51 toks/s, output: 15.34 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:11<00:01, 15.07it/s, est. speed input: 15699.87 toks/s, output: 15.33 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:12<00:00, 15.21it/s, est. speed input: 15701.45 toks/s, output: 15.33 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:12<00:00, 15.21it/s, est. speed input: 15809.50 toks/s, output: 15.44 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:12<00:00, 15.44it/s, est. speed input: 15809.50 toks/s, output: 15.44 toks/s]
[rank0]:[W128 09:11:25.073991550 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 176.9s

测试结果:
  Requests/s:   14.93
  Tokens/s:     15301.94
  Total Reqs:   2048
  Elapsed:      137.19s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     15287.01

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:6)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:11:42 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:11:42 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3732122) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3732122) WARNING 01-28 09:12:12 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.78 requests/s, 15152.57 total tokens/s, 14.78 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 09:11:41] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:11:42] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:11:42] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:42] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:11:42] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:11:42] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:11:42] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:11:42] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:11:42] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:11:45] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:11:45] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:11:45] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:11:45] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:11:45] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:11:45] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:11:45] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:11:45] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:11:45] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:6, expand_ratio=1.500
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3732122) [2026-01-28 09:11:46] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3732122) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3732122) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.53s/it]
(EngineCore_DP0 pid=3732122) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:14<00:00, 14.53s/it]
(EngineCore_DP0 pid=3732122) 
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3424] -> 1D uint8
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 8232960 bytes
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3424] -> 1D uint8
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 5488640 bytes
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3424] -> 1D uint8
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 29638656 bytes
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 9216] -> 1D uint8
(EngineCore_DP0 pid=3732122) [2026-01-28 09:12:01] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 14745600 bytes
(EngineCore_DP0 pid=3732122) 2026-01-28 09:12:09,373 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3732122) 2026-01-28 09:12:09,686 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 62/4096 [00:00<00:06, 615.13it/s]
Adding requests:   3%|▎         | 124/4096 [00:00<00:07, 558.68it/s]
Adding requests:   4%|▍         | 181/4096 [00:00<00:07, 521.61it/s]
Adding requests:   6%|▌         | 234/4096 [00:00<00:07, 518.51it/s]
Adding requests:   7%|▋         | 287/4096 [00:00<00:07, 513.72it/s]
Adding requests:   8%|▊         | 339/4096 [00:00<00:07, 511.14it/s]
Adding requests:  10%|▉         | 392/4096 [00:00<00:07, 515.53it/s]
Adding requests:  11%|█         | 445/4096 [00:00<00:07, 516.40it/s]
Adding requests:  12%|█▏        | 497/4096 [00:00<00:07, 512.55it/s]
Adding requests:  13%|█▎        | 549/4096 [00:01<00:06, 508.68it/s]
Adding requests:  15%|█▍        | 602/4096 [00:01<00:06, 514.76it/s]
Adding requests:  16%|█▌        | 657/4096 [00:01<00:06, 522.03it/s]
Adding requests:  17%|█▋        | 712/4096 [00:01<00:06, 527.78it/s]
Adding requests:  19%|█▊        | 765/4096 [00:01<00:06, 521.91it/s]
Adding requests:  20%|█▉        | 818/4096 [00:01<00:06, 510.27it/s]
Adding requests:  21%|██        | 870/4096 [00:01<00:06, 504.83it/s]
Adding requests:  23%|██▎       | 923/4096 [00:01<00:06, 510.77it/s]
Adding requests:  24%|██▍       | 976/4096 [00:01<00:06, 514.36it/s]
Adding requests:  25%|██▌       | 1029/4096 [00:01<00:05, 518.81it/s]
Adding requests:  26%|██▋       | 1081/4096 [00:02<00:05, 518.21it/s]
Adding requests:  28%|██▊       | 1133/4096 [00:02<00:05, 510.20it/s]
Adding requests:  29%|██▉       | 1185/4096 [00:02<00:05, 489.22it/s]
Adding requests:  30%|███       | 1235/4096 [00:02<00:05, 484.47it/s]
Adding requests:  31%|███▏      | 1286/4096 [00:02<00:05, 489.90it/s]
Adding requests:  33%|███▎      | 1338/4096 [00:02<00:05, 497.02it/s]
Adding requests:  34%|███▍      | 1391/4096 [00:02<00:05, 506.29it/s]
Adding requests:  35%|███▌      | 1444/4096 [00:02<00:05, 512.38it/s]
Adding requests:  37%|███▋      | 1497/4096 [00:02<00:05, 515.83it/s]
Adding requests:  38%|███▊      | 1550/4096 [00:03<00:04, 519.41it/s]
Adding requests:  39%|███▉      | 1604/4096 [00:03<00:04, 524.09it/s]
Adding requests:  40%|████      | 1657/4096 [00:03<00:04, 525.02it/s]
Adding requests:  42%|████▏     | 1710/4096 [00:03<00:04, 525.80it/s]
Adding requests:  43%|████▎     | 1764/4096 [00:03<00:04, 527.51it/s]
Adding requests:  44%|████▍     | 1819/4096 [00:03<00:04, 532.60it/s]
Adding requests:  46%|████▌     | 1873/4096 [00:03<00:04, 521.12it/s]
Adding requests:  47%|████▋     | 1926/4096 [00:03<00:04, 512.12it/s]
Adding requests:  48%|████▊     | 1978/4096 [00:03<00:04, 507.88it/s]
Adding requests:  50%|████▉     | 2033/4096 [00:03<00:03, 517.62it/s]
Adding requests:  51%|█████     | 2088/4096 [00:04<00:03, 524.14it/s]
Adding requests:  52%|█████▏    | 2141/4096 [00:04<00:03, 521.71it/s]
Adding requests:  54%|█████▎    | 2194/4096 [00:04<00:03, 521.28it/s]
Adding requests:  55%|█████▍    | 2249/4096 [00:04<00:03, 527.02it/s]
Adding requests:  56%|█████▌    | 2302/4096 [00:04<00:03, 519.89it/s]
Adding requests:  57%|█████▋    | 2355/4096 [00:04<00:03, 510.03it/s]
Adding requests:  59%|█████▉    | 2407/4096 [00:04<00:03, 512.10it/s]
Adding requests:  60%|██████    | 2459/4096 [00:04<00:03, 476.15it/s]
Adding requests:  61%|██████▏   | 2511/4096 [00:04<00:03, 487.51it/s]
Adding requests:  63%|██████▎   | 2562/4096 [00:04<00:03, 492.91it/s]
Adding requests:  64%|██████▍   | 2617/4096 [00:05<00:02, 507.32it/s]
Adding requests:  65%|██████▌   | 2672/4096 [00:05<00:02, 519.28it/s]
Adding requests:  67%|██████▋   | 2725/4096 [00:05<00:02, 516.15it/s]
Adding requests:  68%|██████▊   | 2777/4096 [00:05<00:02, 513.27it/s]
Adding requests:  69%|██████▉   | 2829/4096 [00:05<00:02, 512.24it/s]
Adding requests:  70%|███████   | 2884/4096 [00:05<00:02, 520.78it/s]
Adding requests:  72%|███████▏  | 2937/4096 [00:05<00:02, 514.77it/s]
Adding requests:  73%|███████▎  | 2989/4096 [00:05<00:02, 515.16it/s]
Adding requests:  74%|███████▍  | 3041/4096 [00:05<00:02, 502.88it/s]
Adding requests:  76%|███████▌  | 3093/4096 [00:06<00:01, 506.69it/s]
Adding requests:  77%|███████▋  | 3145/4096 [00:06<00:01, 508.19it/s]
Adding requests:  78%|███████▊  | 3199/4096 [00:06<00:01, 516.37it/s]
Adding requests:  79%|███████▉  | 3252/4096 [00:06<00:01, 520.15it/s]
Adding requests:  81%|████████  | 3305/4096 [00:06<00:01, 517.73it/s]
Adding requests:  82%|████████▏ | 3358/4096 [00:06<00:01, 520.37it/s]
Adding requests:  83%|████████▎ | 3412/4096 [00:06<00:01, 524.02it/s]
Adding requests:  85%|████████▍ | 3465/4096 [00:06<00:01, 515.81it/s]
Adding requests:  86%|████████▌ | 3517/4096 [00:06<00:01, 513.67it/s]
Adding requests:  87%|████████▋ | 3569/4096 [00:06<00:01, 509.64it/s]
Adding requests:  88%|████████▊ | 3621/4096 [00:07<00:00, 512.57it/s]
Adding requests:  90%|████████▉ | 3676/4096 [00:07<00:00, 521.24it/s]
Adding requests:  91%|█████████ | 3730/4096 [00:07<00:00, 524.14it/s]
Adding requests:  92%|█████████▏| 3788/4096 [00:07<00:00, 539.87it/s]
Adding requests:  94%|█████████▍| 3843/4096 [00:07<00:00, 494.74it/s]
Adding requests:  95%|█████████▌| 3897/4096 [00:07<00:00, 506.16it/s]
Adding requests:  96%|█████████▋| 3952/4096 [00:07<00:00, 517.01it/s]
Adding requests:  98%|█████████▊| 4007/4096 [00:07<00:00, 524.33it/s]
Adding requests:  99%|█████████▉| 4060/4096 [00:07<00:00, 511.25it/s]
Adding requests: 100%|██████████| 4096/4096 [00:07<00:00, 514.45it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:00<00:35, 112.45it/s, est. speed input: 115157.82 toks/s, output: 112.45 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:03<01:48, 36.39it/s, est. speed input: 43991.39 toks/s, output: 42.96 toks/s]  
Processed prompts:   4%|▍         | 162/4096 [00:05<02:37, 25.02it/s, est. speed input: 31994.71 toks/s, output: 31.24 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:07<03:08, 20.65it/s, est. speed input: 27061.95 toks/s, output: 26.43 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:09<03:30, 18.43it/s, est. speed input: 24356.08 toks/s, output: 23.79 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:11<03:43, 17.16it/s, est. speed input: 22661.60 toks/s, output: 22.13 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:13<03:52, 16.38it/s, est. speed input: 21492.03 toks/s, output: 20.99 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:15<03:56, 15.94it/s, est. speed input: 20671.17 toks/s, output: 20.19 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:18<03:59, 15.59it/s, est. speed input: 20020.94 toks/s, output: 19.55 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:20<04:01, 15.35it/s, est. speed input: 19504.91 toks/s, output: 19.05 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:22<04:02, 15.18it/s, est. speed input: 19085.03 toks/s, output: 18.64 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:25<04:18, 14.09it/s, est. speed input: 18372.50 toks/s, output: 17.94 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:27<04:12, 14.30it/s, est. speed input: 18118.50 toks/s, output: 17.69 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:29<04:07, 14.44it/s, est. speed input: 17900.58 toks/s, output: 17.48 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:31<04:03, 14.56it/s, est. speed input: 17715.86 toks/s, output: 17.30 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:33<04:00, 14.62it/s, est. speed input: 17549.33 toks/s, output: 17.14 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:35<03:57, 14.68it/s, est. speed input: 17406.87 toks/s, output: 17.00 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:38<03:54, 14.73it/s, est. speed input: 17281.91 toks/s, output: 16.88 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:40<03:51, 14.76it/s, est. speed input: 17170.00 toks/s, output: 16.77 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:42<03:49, 14.78it/s, est. speed input: 17068.53 toks/s, output: 16.67 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:44<03:47, 14.79it/s, est. speed input: 16975.84 toks/s, output: 16.58 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:46<03:44, 14.79it/s, est. speed input: 16891.26 toks/s, output: 16.50 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:48<03:42, 14.80it/s, est. speed input: 16814.75 toks/s, output: 16.42 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:50<03:40, 14.80it/s, est. speed input: 16745.66 toks/s, output: 16.35 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:53<03:38, 14.81it/s, est. speed input: 16681.56 toks/s, output: 16.29 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:55<03:36, 14.80it/s, est. speed input: 16621.32 toks/s, output: 16.23 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [00:57<03:39, 14.44it/s, est. speed input: 16514.59 toks/s, output: 16.13 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [00:59<03:34, 14.64it/s, est. speed input: 16477.66 toks/s, output: 16.09 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [01:01<03:31, 14.69it/s, est. speed input: 16432.13 toks/s, output: 16.05 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [01:04<03:28, 14.72it/s, est. speed input: 16388.25 toks/s, output: 16.00 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:06<03:26, 14.74it/s, est. speed input: 16347.77 toks/s, output: 15.96 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:08<03:23, 14.76it/s, est. speed input: 16310.95 toks/s, output: 15.93 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [01:10<03:21, 14.78it/s, est. speed input: 16276.33 toks/s, output: 15.89 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [01:12<03:17, 14.88it/s, est. speed input: 16252.76 toks/s, output: 15.87 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [01:14<03:16, 14.84it/s, est. speed input: 16220.04 toks/s, output: 15.84 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:17<03:14, 14.83it/s, est. speed input: 16190.12 toks/s, output: 15.81 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:19<03:10, 14.91it/s, est. speed input: 16170.42 toks/s, output: 15.79 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:21<03:07, 14.97it/s, est. speed input: 16152.29 toks/s, output: 15.77 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:23<03:06, 14.92it/s, est. speed input: 16126.62 toks/s, output: 15.75 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:25<03:04, 14.89it/s, est. speed input: 16102.39 toks/s, output: 15.72 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:27<03:02, 14.86it/s, est. speed input: 16079.23 toks/s, output: 15.70 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:30<03:06, 14.42it/s, est. speed input: 16019.13 toks/s, output: 15.64 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:32<03:02, 14.53it/s, est. speed input: 15999.22 toks/s, output: 15.62 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:34<02:59, 14.61it/s, est. speed input: 15979.97 toks/s, output: 15.61 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:36<02:56, 14.67it/s, est. speed input: 15961.31 toks/s, output: 15.59 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:38<02:53, 14.71it/s, est. speed input: 15944.28 toks/s, output: 15.57 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:40<02:50, 14.83it/s, est. speed input: 15934.49 toks/s, output: 15.56 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:43<02:48, 14.82it/s, est. speed input: 15917.72 toks/s, output: 15.54 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:45<02:45, 14.90it/s, est. speed input: 15908.44 toks/s, output: 15.54 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:47<02:43, 14.88it/s, est. speed input: 15893.89 toks/s, output: 15.52 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:49<02:41, 14.84it/s, est. speed input: 15878.44 toks/s, output: 15.51 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:51<02:39, 14.83it/s, est. speed input: 15864.40 toks/s, output: 15.49 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [01:53<02:37, 14.83it/s, est. speed input: 15851.27 toks/s, output: 15.48 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [01:55<02:35, 14.81it/s, est. speed input: 15837.58 toks/s, output: 15.47 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [01:58<02:33, 14.81it/s, est. speed input: 15825.50 toks/s, output: 15.45 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [02:00<02:30, 14.90it/s, est. speed input: 15819.11 toks/s, output: 15.45 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [02:02<02:28, 14.87it/s, est. speed input: 15807.58 toks/s, output: 15.44 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [02:04<02:29, 14.51it/s, est. speed input: 15775.14 toks/s, output: 15.41 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [02:06<02:25, 14.68it/s, est. speed input: 15769.85 toks/s, output: 15.40 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [02:08<02:22, 14.81it/s, est. speed input: 15765.02 toks/s, output: 15.40 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [02:11<02:20, 14.81it/s, est. speed input: 15755.19 toks/s, output: 15.39 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [02:13<02:18, 14.82it/s, est. speed input: 15745.93 toks/s, output: 15.38 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [02:15<02:16, 14.81it/s, est. speed input: 15736.21 toks/s, output: 15.37 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [02:17<02:13, 14.81it/s, est. speed input: 15727.51 toks/s, output: 15.36 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [02:19<02:11, 14.81it/s, est. speed input: 15718.67 toks/s, output: 15.35 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [02:21<02:09, 14.80it/s, est. speed input: 15709.65 toks/s, output: 15.34 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:24<02:05, 15.00it/s, est. speed input: 15712.09 toks/s, output: 15.34 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:26<02:04, 14.94it/s, est. speed input: 15703.75 toks/s, output: 15.34 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:28<02:01, 14.99it/s, est. speed input: 15700.37 toks/s, output: 15.33 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:30<01:59, 14.93it/s, est. speed input: 15692.70 toks/s, output: 15.32 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:32<01:57, 14.98it/s, est. speed input: 15689.46 toks/s, output: 15.32 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:34<01:53, 15.15it/s, est. speed input: 15692.70 toks/s, output: 15.32 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:36<01:54, 14.82it/s, est. speed input: 15674.37 toks/s, output: 15.31 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:39<01:52, 14.80it/s, est. speed input: 15666.99 toks/s, output: 15.30 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:41<01:50, 14.80it/s, est. speed input: 15660.07 toks/s, output: 15.29 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:43<01:47, 14.90it/s, est. speed input: 15657.84 toks/s, output: 15.29 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:45<01:45, 14.87it/s, est. speed input: 15651.15 toks/s, output: 15.28 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:47<01:42, 14.93it/s, est. speed input: 15648.56 toks/s, output: 15.28 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:49<01:40, 14.89it/s, est. speed input: 15642.20 toks/s, output: 15.28 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [02:51<01:38, 14.86it/s, est. speed input: 15635.91 toks/s, output: 15.27 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [02:54<01:36, 14.84it/s, est. speed input: 15629.91 toks/s, output: 15.26 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [02:56<01:34, 14.92it/s, est. speed input: 15627.88 toks/s, output: 15.26 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [02:58<01:32, 14.88it/s, est. speed input: 15622.19 toks/s, output: 15.26 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [03:00<01:30, 14.85it/s, est. speed input: 15616.32 toks/s, output: 15.25 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [03:02<01:28, 14.83it/s, est. speed input: 15610.66 toks/s, output: 15.24 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [03:04<01:26, 14.82it/s, est. speed input: 15605.29 toks/s, output: 15.24 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [03:07<01:23, 14.90it/s, est. speed input: 15603.64 toks/s, output: 15.24 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [03:09<01:23, 14.55it/s, est. speed input: 15585.44 toks/s, output: 15.22 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [03:11<01:20, 14.62it/s, est. speed input: 15580.34 toks/s, output: 15.22 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [03:13<01:18, 14.67it/s, est. speed input: 15575.71 toks/s, output: 15.21 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [03:15<01:16, 14.70it/s, est. speed input: 15570.68 toks/s, output: 15.21 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [03:18<01:13, 14.73it/s, est. speed input: 15566.09 toks/s, output: 15.20 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [03:20<01:11, 14.76it/s, est. speed input: 15561.87 toks/s, output: 15.20 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [03:22<01:09, 14.77it/s, est. speed input: 15557.50 toks/s, output: 15.19 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [03:24<01:05, 15.00it/s, est. speed input: 15561.37 toks/s, output: 15.20 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [03:26<01:03, 15.04it/s, est. speed input: 15560.58 toks/s, output: 15.20 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [03:28<01:01, 14.96it/s, est. speed input: 15556.14 toks/s, output: 15.19 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:30<00:59, 14.91it/s, est. speed input: 15552.07 toks/s, output: 15.19 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:32<00:57, 14.96it/s, est. speed input: 15550.94 toks/s, output: 15.19 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:35<00:55, 14.91it/s, est. speed input: 15546.91 toks/s, output: 15.18 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:37<00:53, 14.88it/s, est. speed input: 15542.96 toks/s, output: 15.18 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:39<00:51, 14.85it/s, est. speed input: 15539.07 toks/s, output: 15.17 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:41<00:50, 14.48it/s, est. speed input: 15522.97 toks/s, output: 15.16 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:43<00:48, 14.58it/s, est. speed input: 15519.50 toks/s, output: 15.16 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:46<00:45, 14.73it/s, est. speed input: 15519.04 toks/s, output: 15.16 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [03:48<00:43, 14.75it/s, est. speed input: 15515.49 toks/s, output: 15.15 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [03:50<00:40, 14.99it/s, est. speed input: 15519.53 toks/s, output: 15.16 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [03:52<00:38, 14.93it/s, est. speed input: 15516.09 toks/s, output: 15.15 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [03:54<00:36, 14.90it/s, est. speed input: 15512.96 toks/s, output: 15.15 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [03:56<00:34, 14.87it/s, est. speed input: 15509.77 toks/s, output: 15.15 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [03:58<00:32, 14.84it/s, est. speed input: 15506.28 toks/s, output: 15.14 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [04:01<00:30, 14.83it/s, est. speed input: 15503.18 toks/s, output: 15.14 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [04:03<00:27, 14.83it/s, est. speed input: 15500.32 toks/s, output: 15.14 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [04:05<00:25, 14.90it/s, est. speed input: 15499.79 toks/s, output: 15.14 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [04:07<00:23, 14.87it/s, est. speed input: 15496.61 toks/s, output: 15.13 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [04:09<00:21, 14.84it/s, est. speed input: 15493.41 toks/s, output: 15.13 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [04:11<00:19, 14.83it/s, est. speed input: 15490.67 toks/s, output: 15.13 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [04:14<00:17, 14.51it/s, est. speed input: 15478.41 toks/s, output: 15.12 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [04:16<00:15, 14.60it/s, est. speed input: 15475.68 toks/s, output: 15.11 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [04:18<00:12, 14.66it/s, est. speed input: 15473.14 toks/s, output: 15.11 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [04:20<00:10, 14.70it/s, est. speed input: 15470.43 toks/s, output: 15.11 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [04:22<00:08, 14.73it/s, est. speed input: 15467.85 toks/s, output: 15.11 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [04:24<00:06, 14.75it/s, est. speed input: 15465.15 toks/s, output: 15.10 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [04:26<00:04, 15.09it/s, est. speed input: 15471.65 toks/s, output: 15.11 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [04:29<00:01, 15.09it/s, est. speed input: 15471.65 toks/s, output: 15.11 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:29<00:00, 15.09it/s, est. speed input: 15585.79 toks/s, output: 15.22 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:29<00:00, 15.22it/s, est. speed input: 15585.79 toks/s, output: 15.22 toks/s]
[rank0]:[W128 09:16:50.288392234 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 325.3s

测试结果:
  Requests/s:   14.78
  Tokens/s:     15152.57
  Total Reqs:   4096
  Elapsed:      277.08s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     15137.78


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_6/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,27.6912,14205.5686,4.6224
1024,1024,1,128,128,15.1036,15481.1651,8.4748
2048,1024,2,256,128,15.4420,15828.0058,16.5782
4096,1024,4,512,128,14.5242,14887.2583,35.2516
8192,1024,8,1024,128,14.6266,14992.2344,70.0096
16384,1024,16,2048,128,14.9287,15301.9399,137.1852
32768,1024,32,4096,128,14.7830,15152.5673,277.0752

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_8) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_8
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_8

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:16:56 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:16:56 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3736616) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3736616) WARNING 01-28 09:17:25 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 27.56 requests/s, 14137.71 total tokens/s, 27.56 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:16:56] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:16:56] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:16:56] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:56] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:16:56] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:16:56] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:16:56] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:16:56] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:16:56] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:16:59] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:16:59] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:16:59] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:16:59] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:16:59] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:16:59] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:16:59] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:16:59] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:16:59] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:00] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3736616) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3736616) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.43s/it]
(EngineCore_DP0 pid=3736616) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.43s/it]
(EngineCore_DP0 pid=3736616) 
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3736616) [2026-01-28 09:17:18] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3736616) 2026-01-28 09:17:24,578 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3736616) 2026-01-28 09:17:24,602 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  70%|███████   | 90/128 [00:00<00:00, 895.67it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 979.62it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:04, 26.54it/s, est. speed input: 13589.43 toks/s, output: 26.54 toks/s]
Processed prompts:   5%|▍         | 6/128 [00:00<00:04, 27.44it/s, est. speed input: 13979.22 toks/s, output: 27.30 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:04, 27.87it/s, est. speed input: 14161.01 toks/s, output: 27.66 toks/s]
Processed prompts:   9%|▉         | 12/128 [00:00<00:04, 28.16it/s, est. speed input: 14279.16 toks/s, output: 27.89 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:00<00:03, 28.35it/s, est. speed input: 14360.31 toks/s, output: 28.05 toks/s]
Processed prompts:  14%|█▍        | 18/128 [00:00<00:03, 28.23it/s, est. speed input: 14357.14 toks/s, output: 28.04 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:00<00:03, 28.52it/s, est. speed input: 14434.85 toks/s, output: 28.19 toks/s]
Processed prompts:  19%|█▉        | 24/128 [00:00<00:03, 28.13it/s, est. speed input: 14377.24 toks/s, output: 28.08 toks/s]
Processed prompts:  21%|██        | 27/128 [00:00<00:03, 28.25it/s, est. speed input: 14402.61 toks/s, output: 28.13 toks/s]
Processed prompts:  23%|██▎       | 30/128 [00:01<00:03, 28.39it/s, est. speed input: 14431.67 toks/s, output: 28.19 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:01<00:03, 28.48it/s, est. speed input: 14453.80 toks/s, output: 28.23 toks/s]
Processed prompts:  28%|██▊       | 36/128 [00:01<00:03, 28.53it/s, est. speed input: 14471.91 toks/s, output: 28.26 toks/s]
Processed prompts:  30%|███       | 39/128 [00:01<00:03, 28.39it/s, est. speed input: 14464.02 toks/s, output: 28.25 toks/s]
Processed prompts:  33%|███▎      | 42/128 [00:01<00:03, 28.39it/s, est. speed input: 14469.70 toks/s, output: 28.26 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:01<00:02, 28.46it/s, est. speed input: 14481.04 toks/s, output: 28.28 toks/s]
Processed prompts:  38%|███▊      | 48/128 [00:01<00:02, 28.59it/s, est. speed input: 14500.95 toks/s, output: 28.32 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:01<00:02, 28.44it/s, est. speed input: 14494.30 toks/s, output: 28.31 toks/s]
Processed prompts:  42%|████▏     | 54/128 [00:01<00:02, 28.15it/s, est. speed input: 14470.06 toks/s, output: 28.26 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:02<00:02, 28.18it/s, est. speed input: 14470.19 toks/s, output: 28.26 toks/s]
Processed prompts:  47%|████▋     | 60/128 [00:02<00:02, 28.39it/s, est. speed input: 14485.43 toks/s, output: 28.29 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:02<00:02, 28.44it/s, est. speed input: 14492.19 toks/s, output: 28.30 toks/s]
Processed prompts:  52%|█████▏    | 66/128 [00:02<00:02, 28.45it/s, est. speed input: 14495.82 toks/s, output: 28.31 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:02<00:02, 28.56it/s, est. speed input: 14506.99 toks/s, output: 28.33 toks/s]
Processed prompts:  56%|█████▋    | 72/128 [00:02<00:01, 28.59it/s, est. speed input: 14513.91 toks/s, output: 28.35 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:02<00:01, 28.60it/s, est. speed input: 14519.82 toks/s, output: 28.36 toks/s]
Processed prompts:  61%|██████    | 78/128 [00:02<00:01, 28.63it/s, est. speed input: 14526.19 toks/s, output: 28.37 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:02<00:01, 28.69it/s, est. speed input: 14534.91 toks/s, output: 28.39 toks/s]
Processed prompts:  66%|██████▌   | 84/128 [00:02<00:01, 28.23it/s, est. speed input: 14512.48 toks/s, output: 28.34 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:03<00:01, 28.23it/s, est. speed input: 14510.53 toks/s, output: 28.34 toks/s]
Processed prompts:  70%|███████   | 90/128 [00:03<00:01, 28.26it/s, est. speed input: 14510.17 toks/s, output: 28.34 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:03<00:01, 28.43it/s, est. speed input: 14518.30 toks/s, output: 28.36 toks/s]
Processed prompts:  75%|███████▌  | 96/128 [00:03<00:01, 28.32it/s, est. speed input: 14513.56 toks/s, output: 28.35 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:03<00:01, 28.50it/s, est. speed input: 14522.23 toks/s, output: 28.36 toks/s]
Processed prompts:  80%|███████▉  | 102/128 [00:03<00:00, 28.47it/s, est. speed input: 14522.88 toks/s, output: 28.36 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:03<00:00, 28.54it/s, est. speed input: 14527.86 toks/s, output: 28.37 toks/s]
Processed prompts:  84%|████████▍ | 108/128 [00:03<00:00, 28.50it/s, est. speed input: 14528.40 toks/s, output: 28.38 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:03<00:00, 28.60it/s, est. speed input: 14534.44 toks/s, output: 28.39 toks/s]
Processed prompts:  89%|████████▉ | 114/128 [00:04<00:00, 28.02it/s, est. speed input: 14511.40 toks/s, output: 28.34 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:04<00:00, 28.05it/s, est. speed input: 14508.21 toks/s, output: 28.34 toks/s]
Processed prompts:  94%|█████████▍| 120/128 [00:04<00:00, 28.28it/s, est. speed input: 14514.57 toks/s, output: 28.35 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:04<00:00, 28.34it/s, est. speed input: 14516.27 toks/s, output: 28.35 toks/s]
Processed prompts:  98%|█████████▊| 126/128 [00:04<00:00, 28.28it/s, est. speed input: 14513.44 toks/s, output: 28.35 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 28.28it/s, est. speed input: 14522.95 toks/s, output: 28.37 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 28.36it/s, est. speed input: 14522.95 toks/s, output: 28.37 toks/s]
[rank0]:[W128 09:17:30.117908666 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 39.7s

测试结果:
  Requests/s:   27.56
  Tokens/s:     14137.71
  Total Reqs:   128
  Elapsed:      4.64s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     14110.15

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:17:36 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:17:36 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3737370) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3737370) WARNING 01-28 09:18:04 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.65 requests/s, 15011.83 total tokens/s, 14.65 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:17:36] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:17:36] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:17:36] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:36] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:17:36] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:17:36] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:17:36] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:17:36] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:17:36] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:17:39] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:17:39] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:17:39] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:17:39] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:17:39] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:17:39] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:17:39] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:17:39] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:17:39] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:40] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3737370) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3737370) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.43s/it]
(EngineCore_DP0 pid=3737370) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.43s/it]
(EngineCore_DP0 pid=3737370) 
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3737370) [2026-01-28 09:17:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3737370) 2026-01-28 09:18:03,505 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3737370) 2026-01-28 09:18:03,517 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  51%|█████     | 65/128 [00:00<00:00, 645.08it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 677.49it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:13,  9.12it/s, est. speed input: 9337.76 toks/s, output: 9.12 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:09, 12.87it/s, est. speed input: 12656.68 toks/s, output: 12.36 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:08, 13.84it/s, est. speed input: 13586.63 toks/s, output: 13.27 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 14.42it/s, est. speed input: 14121.96 toks/s, output: 13.79 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 14.75it/s, est. speed input: 14441.79 toks/s, output: 14.10 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:07, 14.82it/s, est. speed input: 14591.18 toks/s, output: 14.25 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:07, 14.78it/s, est. speed input: 14661.85 toks/s, output: 14.32 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 14.85it/s, est. speed input: 14750.60 toks/s, output: 14.40 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 15.03it/s, est. speed input: 14866.01 toks/s, output: 14.52 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 15.05it/s, est. speed input: 14926.70 toks/s, output: 14.58 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 14.99it/s, est. speed input: 14952.75 toks/s, output: 14.60 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:06, 15.10it/s, est. speed input: 15018.71 toks/s, output: 14.67 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:06, 15.10it/s, est. speed input: 15051.87 toks/s, output: 14.70 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 15.03it/s, est. speed input: 15065.90 toks/s, output: 14.71 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:01<00:06, 14.84it/s, est. speed input: 15043.62 toks/s, output: 14.69 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.95it/s, est. speed input: 15077.51 toks/s, output: 14.72 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 15.09it/s, est. speed input: 15119.57 toks/s, output: 14.77 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 15.03it/s, est. speed input: 15127.14 toks/s, output: 14.77 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 15.08it/s, est. speed input: 15149.40 toks/s, output: 14.79 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:05, 15.08it/s, est. speed input: 15164.57 toks/s, output: 14.81 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 15.02it/s, est. speed input: 15168.24 toks/s, output: 14.81 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 14.91it/s, est. speed input: 15160.94 toks/s, output: 14.81 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 14.92it/s, est. speed input: 15167.60 toks/s, output: 14.81 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 14.99it/s, est. speed input: 15182.40 toks/s, output: 14.83 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 14.99it/s, est. speed input: 15188.24 toks/s, output: 14.83 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 15.15it/s, est. speed input: 15215.57 toks/s, output: 14.86 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:04, 15.22it/s, est. speed input: 15235.71 toks/s, output: 14.88 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 15.15it/s, est. speed input: 15238.90 toks/s, output: 14.88 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 15.15it/s, est. speed input: 15249.30 toks/s, output: 14.89 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:03<00:04, 15.04it/s, est. speed input: 15244.93 toks/s, output: 14.89 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 15.04it/s, est. speed input: 15249.83 toks/s, output: 14.89 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 15.08it/s, est. speed input: 15259.45 toks/s, output: 14.90 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 15.07it/s, est. speed input: 15263.69 toks/s, output: 14.91 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:04, 15.12it/s, est. speed input: 15273.57 toks/s, output: 14.92 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:03, 15.17it/s, est. speed input: 15284.76 toks/s, output: 14.93 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 15.10it/s, est. speed input: 15284.57 toks/s, output: 14.93 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:04<00:03, 15.14it/s, est. speed input: 15293.05 toks/s, output: 14.93 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 14.96it/s, est. speed input: 15282.42 toks/s, output: 14.92 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 14.95it/s, est. speed input: 15282.31 toks/s, output: 14.92 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 15.08it/s, est. speed input: 15294.08 toks/s, output: 14.94 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 15.08it/s, est. speed input: 15297.43 toks/s, output: 14.94 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:02, 15.11it/s, est. speed input: 15303.77 toks/s, output: 14.95 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 15.10it/s, est. speed input: 15307.02 toks/s, output: 14.95 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 15.09it/s, est. speed input: 15309.60 toks/s, output: 14.95 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:05<00:02, 15.09it/s, est. speed input: 15313.10 toks/s, output: 14.95 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 14.97it/s, est. speed input: 15306.85 toks/s, output: 14.95 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 15.00it/s, est. speed input: 15309.53 toks/s, output: 14.95 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 15.05it/s, est. speed input: 15314.25 toks/s, output: 14.96 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:02, 15.10it/s, est. speed input: 15319.44 toks/s, output: 14.96 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 15.20it/s, est. speed input: 15328.91 toks/s, output: 14.97 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 15.18it/s, est. speed input: 15332.64 toks/s, output: 14.97 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:06<00:01, 15.09it/s, est. speed input: 15330.53 toks/s, output: 14.97 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 15.16it/s, est. speed input: 15337.55 toks/s, output: 14.98 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 14.88it/s, est. speed input: 15323.19 toks/s, output: 14.96 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 14.94it/s, est. speed input: 15325.06 toks/s, output: 14.97 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 14.98it/s, est. speed input: 15327.12 toks/s, output: 14.97 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.98it/s, est. speed input: 15327.30 toks/s, output: 14.97 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.96it/s, est. speed input: 15326.27 toks/s, output: 14.97 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:07<00:00, 14.97it/s, est. speed input: 15326.59 toks/s, output: 14.97 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:07<00:00, 15.07it/s, est. speed input: 15332.70 toks/s, output: 14.97 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 15.06it/s, est. speed input: 15333.55 toks/s, output: 14.97 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.88it/s, est. speed input: 15324.92 toks/s, output: 14.97 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.84it/s, est. speed input: 15321.62 toks/s, output: 14.96 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 15.03it/s, est. speed input: 15329.50 toks/s, output: 14.97 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 15.03it/s, est. speed input: 15331.48 toks/s, output: 14.97 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.97it/s, est. speed input: 15331.48 toks/s, output: 14.97 toks/s]
[rank0]:[W128 09:18:13.051095293 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 42.9s

测试结果:
  Requests/s:   14.65
  Tokens/s:     15011.83
  Total Reqs:   128
  Elapsed:      8.74s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     14997.18

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:18:19 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:18:19 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3738166) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3738166) WARNING 01-28 09:18:46 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.84 requests/s, 15211.39 total tokens/s, 14.84 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 09:18:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:18:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:18:19] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:18:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:18:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:18:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:18:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:18:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:18:22] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:18:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:18:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:18:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:18:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:18:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:18:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:18:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:18:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3738166) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3738166) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.08s/it]
(EngineCore_DP0 pid=3738166) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.08s/it]
(EngineCore_DP0 pid=3738166) 
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3738166) [2026-01-28 09:18:40] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3738166) 2026-01-28 09:18:46,102 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3738166) 2026-01-28 09:18:46,113 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  24%|██▍       | 62/256 [00:00<00:00, 612.18it/s]
Adding requests:  48%|████▊     | 124/256 [00:00<00:00, 596.94it/s]
Adding requests:  72%|███████▏  | 184/256 [00:00<00:00, 572.39it/s]
Adding requests:  95%|█████████▍| 242/256 [00:00<00:00, 557.14it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 567.05it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:06, 41.35it/s, est. speed input: 42349.51 toks/s, output: 41.35 toks/s]
Processed prompts:   4%|▍         | 11/256 [00:00<00:09, 24.76it/s, est. speed input: 27141.75 toks/s, output: 26.50 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:13, 17.98it/s, est. speed input: 21078.57 toks/s, output: 20.58 toks/s]
Processed prompts:   7%|▋         | 17/256 [00:00<00:12, 18.94it/s, est. speed input: 21234.34 toks/s, output: 20.74 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:01<00:15, 15.65it/s, est. speed input: 18852.42 toks/s, output: 18.41 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:01<00:15, 15.58it/s, est. speed input: 18519.06 toks/s, output: 18.08 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:15, 15.44it/s, est. speed input: 18211.47 toks/s, output: 17.78 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:14, 15.40it/s, est. speed input: 17983.56 toks/s, output: 17.56 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:14, 15.26it/s, est. speed input: 17758.28 toks/s, output: 17.34 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:14, 15.19it/s, est. speed input: 17573.80 toks/s, output: 17.16 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:01<00:14, 15.01it/s, est. speed input: 17382.72 toks/s, output: 16.98 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:02<00:14, 14.99it/s, est. speed input: 17243.80 toks/s, output: 16.84 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:14, 15.07it/s, est. speed input: 17144.75 toks/s, output: 16.74 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:14, 15.14it/s, est. speed input: 17062.50 toks/s, output: 16.66 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:14, 15.16it/s, est. speed input: 16980.93 toks/s, output: 16.58 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:14, 15.19it/s, est. speed input: 16911.17 toks/s, output: 16.51 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:13, 15.25it/s, est. speed input: 16854.53 toks/s, output: 16.46 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:13, 15.17it/s, est. speed input: 16783.72 toks/s, output: 16.39 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:02<00:13, 15.02it/s, est. speed input: 16702.23 toks/s, output: 16.31 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:03<00:13, 15.02it/s, est. speed input: 16645.76 toks/s, output: 16.26 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:13, 15.12it/s, est. speed input: 16607.34 toks/s, output: 16.22 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:13, 15.00it/s, est. speed input: 16546.47 toks/s, output: 16.16 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:13, 15.01it/s, est. speed input: 16501.30 toks/s, output: 16.11 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:13, 15.12it/s, est. speed input: 16474.07 toks/s, output: 16.09 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:13, 15.07it/s, est. speed input: 16433.04 toks/s, output: 16.05 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:03<00:12, 15.05it/s, est. speed input: 16395.86 toks/s, output: 16.01 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:04<00:12, 14.86it/s, est. speed input: 16340.06 toks/s, output: 15.96 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:12, 14.86it/s, est. speed input: 16304.00 toks/s, output: 15.92 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:12, 14.90it/s, est. speed input: 16274.48 toks/s, output: 15.89 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:12, 14.89it/s, est. speed input: 16242.48 toks/s, output: 15.86 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:12, 15.00it/s, est. speed input: 16224.87 toks/s, output: 15.84 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:12, 15.00it/s, est. speed input: 16200.18 toks/s, output: 15.82 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:04<00:11, 15.02it/s, est. speed input: 16179.26 toks/s, output: 15.80 toks/s]
Processed prompts:  30%|███       | 78/256 [00:04<00:11, 15.06it/s, est. speed input: 16161.49 toks/s, output: 15.78 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:11, 14.89it/s, est. speed input: 16126.27 toks/s, output: 15.75 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:11, 14.92it/s, est. speed input: 16106.29 toks/s, output: 15.73 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:11, 14.99it/s, est. speed input: 16091.98 toks/s, output: 15.71 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:11, 15.03it/s, est. speed input: 16077.43 toks/s, output: 15.70 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:11, 15.02it/s, est. speed input: 16060.02 toks/s, output: 15.68 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:11, 15.08it/s, est. speed input: 16049.32 toks/s, output: 15.67 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:05<00:10, 15.15it/s, est. speed input: 16040.93 toks/s, output: 15.66 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:10, 15.13it/s, est. speed input: 16028.33 toks/s, output: 15.65 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:10, 14.88it/s, est. speed input: 15997.50 toks/s, output: 15.62 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:10, 14.88it/s, est. speed input: 15980.99 toks/s, output: 15.61 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:06<00:10, 14.95it/s, est. speed input: 15970.49 toks/s, output: 15.60 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:06<00:10, 14.91it/s, est. speed input: 15954.45 toks/s, output: 15.58 toks/s]
Processed prompts:  41%|████      | 104/256 [00:06<00:10, 15.01it/s, est. speed input: 15947.86 toks/s, output: 15.57 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:06<00:09, 15.07it/s, est. speed input: 15940.31 toks/s, output: 15.57 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:06<00:09, 15.07it/s, est. speed input: 15930.66 toks/s, output: 15.56 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:07<00:09, 14.98it/s, est. speed input: 15915.12 toks/s, output: 15.54 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:07<00:09, 14.76it/s, est. speed input: 15889.85 toks/s, output: 15.52 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:07<00:09, 14.91it/s, est. speed input: 15885.68 toks/s, output: 15.51 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:07<00:09, 14.87it/s, est. speed input: 15871.75 toks/s, output: 15.50 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:07<00:09, 14.93it/s, est. speed input: 15864.44 toks/s, output: 15.49 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:07<00:09, 14.95it/s, est. speed input: 15855.55 toks/s, output: 15.48 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:07<00:08, 14.97it/s, est. speed input: 15847.31 toks/s, output: 15.48 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:08<00:08, 14.94it/s, est. speed input: 15837.26 toks/s, output: 15.47 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:08<00:08, 14.92it/s, est. speed input: 15826.89 toks/s, output: 15.46 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:08<00:08, 14.78it/s, est. speed input: 15810.35 toks/s, output: 15.44 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:08<00:08, 14.87it/s, est. speed input: 15804.20 toks/s, output: 15.43 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:08<00:08, 14.88it/s, est. speed input: 15795.65 toks/s, output: 15.43 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:08<00:08, 14.93it/s, est. speed input: 15789.95 toks/s, output: 15.42 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:08<00:08, 14.92it/s, est. speed input: 15781.77 toks/s, output: 15.41 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:08<00:07, 14.95it/s, est. speed input: 15775.64 toks/s, output: 15.41 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:09<00:07, 15.06it/s, est. speed input: 15774.32 toks/s, output: 15.40 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:09<00:07, 14.83it/s, est. speed input: 15757.66 toks/s, output: 15.39 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:09<00:07, 14.89it/s, est. speed input: 15752.25 toks/s, output: 15.38 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:09<00:07, 14.87it/s, est. speed input: 15744.19 toks/s, output: 15.38 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:09<00:07, 14.89it/s, est. speed input: 15738.07 toks/s, output: 15.37 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:09<00:07, 14.83it/s, est. speed input: 15728.31 toks/s, output: 15.36 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:09<00:06, 14.89it/s, est. speed input: 15723.80 toks/s, output: 15.36 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:10<00:06, 14.91it/s, est. speed input: 15718.17 toks/s, output: 15.35 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:10<00:06, 14.90it/s, est. speed input: 15711.90 toks/s, output: 15.34 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:10<00:06, 14.83it/s, est. speed input: 15702.59 toks/s, output: 15.33 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:10<00:06, 14.87it/s, est. speed input: 15697.69 toks/s, output: 15.33 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:10<00:06, 14.89it/s, est. speed input: 15692.87 toks/s, output: 15.33 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:10<00:06, 14.93it/s, est. speed input: 15688.84 toks/s, output: 15.32 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:10<00:06, 14.98it/s, est. speed input: 15686.22 toks/s, output: 15.32 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:10<00:05, 15.02it/s, est. speed input: 15683.50 toks/s, output: 15.32 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:11<00:05, 14.99it/s, est. speed input: 15678.52 toks/s, output: 15.31 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:11<00:05, 14.98it/s, est. speed input: 15674.38 toks/s, output: 15.31 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:11<00:05, 14.85it/s, est. speed input: 15665.14 toks/s, output: 15.30 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:11<00:05, 14.87it/s, est. speed input: 15660.41 toks/s, output: 15.29 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:11<00:05, 14.96it/s, est. speed input: 15658.92 toks/s, output: 15.29 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:11<00:05, 14.94it/s, est. speed input: 15654.44 toks/s, output: 15.29 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:11<00:04, 15.05it/s, est. speed input: 15654.83 toks/s, output: 15.29 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:12<00:04, 15.07it/s, est. speed input: 15652.72 toks/s, output: 15.29 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:12<00:04, 15.06it/s, est. speed input: 15650.13 toks/s, output: 15.28 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:12<00:04, 15.00it/s, est. speed input: 15645.33 toks/s, output: 15.28 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:12<00:04, 14.86it/s, est. speed input: 15637.19 toks/s, output: 15.27 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:12<00:04, 14.81it/s, est. speed input: 15630.69 toks/s, output: 15.26 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:12<00:04, 14.85it/s, est. speed input: 15627.40 toks/s, output: 15.26 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:12<00:04, 14.89it/s, est. speed input: 15624.22 toks/s, output: 15.26 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:12<00:03, 14.89it/s, est. speed input: 15620.45 toks/s, output: 15.25 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:13<00:03, 14.95it/s, est. speed input: 15618.77 toks/s, output: 15.25 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:13<00:03, 14.95it/s, est. speed input: 15615.78 toks/s, output: 15.25 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:13<00:03, 14.99it/s, est. speed input: 15613.93 toks/s, output: 15.25 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:13<00:03, 14.84it/s, est. speed input: 15606.04 toks/s, output: 15.24 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:13<00:03, 14.92it/s, est. speed input: 15604.69 toks/s, output: 15.24 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:13<00:03, 14.94it/s, est. speed input: 15602.37 toks/s, output: 15.24 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:13<00:02, 14.95it/s, est. speed input: 15599.84 toks/s, output: 15.23 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:14<00:02, 14.93it/s, est. speed input: 15596.48 toks/s, output: 15.23 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:14<00:02, 14.90it/s, est. speed input: 15592.59 toks/s, output: 15.23 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:14<00:02, 14.85it/s, est. speed input: 15587.87 toks/s, output: 15.22 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:14<00:02, 14.89it/s, est. speed input: 15585.66 toks/s, output: 15.22 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:14<00:02, 14.77it/s, est. speed input: 15578.48 toks/s, output: 15.21 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:14<00:02, 14.75it/s, est. speed input: 15573.71 toks/s, output: 15.21 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:14<00:02, 14.81it/s, est. speed input: 15571.31 toks/s, output: 15.21 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:14<00:01, 14.99it/s, est. speed input: 15573.26 toks/s, output: 15.21 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:15<00:01, 14.96it/s, est. speed input: 15570.24 toks/s, output: 15.21 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:15<00:01, 14.94it/s, est. speed input: 15567.56 toks/s, output: 15.20 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:15<00:01, 14.93it/s, est. speed input: 15564.87 toks/s, output: 15.20 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:15<00:01, 14.97it/s, est. speed input: 15563.85 toks/s, output: 15.20 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:15<00:01, 14.82it/s, est. speed input: 15557.25 toks/s, output: 15.19 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:15<00:01, 14.89it/s, est. speed input: 15556.17 toks/s, output: 15.19 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:15<00:00, 14.97it/s, est. speed input: 15555.72 toks/s, output: 15.19 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:16<00:00, 15.03it/s, est. speed input: 15555.75 toks/s, output: 15.19 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:16<00:00, 15.05it/s, est. speed input: 15554.97 toks/s, output: 15.19 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:16<00:00, 14.98it/s, est. speed input: 15551.69 toks/s, output: 15.19 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:16<00:00, 15.05it/s, est. speed input: 15551.95 toks/s, output: 15.19 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:16<00:00, 15.13it/s, est. speed input: 15552.98 toks/s, output: 15.19 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:16<00:00, 14.95it/s, est. speed input: 15547.50 toks/s, output: 15.18 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:16<00:00, 14.95it/s, est. speed input: 15606.08 toks/s, output: 15.24 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:16<00:00, 15.24it/s, est. speed input: 15606.08 toks/s, output: 15.24 toks/s]
[rank0]:[W128 09:19:04.298536020 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 51.3s

测试结果:
  Requests/s:   14.84
  Tokens/s:     15211.39
  Total Reqs:   256
  Elapsed:      17.25s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     15196.55

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:19:11 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:19:11 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3739073) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3739073) WARNING 01-28 09:19:39 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.07 requests/s, 14421.86 total tokens/s, 14.07 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 09:19:11] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:19:11] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:19:11] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:11] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:19:11] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:19:11] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:19:11] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:19:11] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:19:11] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:19:14] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:19:14] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:19:14] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:19:14] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:19:14] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:19:14] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:19:14] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:19:14] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:19:14] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:15] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3739073) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3739073) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.45s/it]
(EngineCore_DP0 pid=3739073) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.45s/it]
(EngineCore_DP0 pid=3739073) 
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3739073) [2026-01-28 09:19:32] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3739073) 2026-01-28 09:19:38,518 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3739073) 2026-01-28 09:19:38,529 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  12%|█▏        | 61/512 [00:00<00:00, 605.00it/s]
Adding requests:  24%|██▍       | 122/512 [00:00<00:00, 592.42it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:00, 562.88it/s]
Adding requests:  47%|████▋     | 239/512 [00:00<00:00, 559.30it/s]
Adding requests:  58%|█████▊    | 296/512 [00:00<00:00, 551.09it/s]
Adding requests:  69%|██████▉   | 353/512 [00:00<00:00, 555.42it/s]
Adding requests:  80%|████████  | 410/512 [00:00<00:00, 558.86it/s]
Adding requests:  91%|█████████ | 466/512 [00:00<00:00, 552.79it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 555.79it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:00<00:05, 95.85it/s, est. speed input: 98166.19 toks/s, output: 95.85 toks/s]
Processed prompts:   4%|▍         | 20/512 [00:00<00:18, 26.51it/s, est. speed input: 30446.89 toks/s, output: 29.73 toks/s]
Processed prompts:   5%|▍         | 25/512 [00:00<00:21, 23.03it/s, est. speed input: 26738.90 toks/s, output: 26.11 toks/s]
Processed prompts:   6%|▌         | 29/512 [00:01<00:24, 19.82it/s, est. speed input: 23902.54 toks/s, output: 23.34 toks/s]
Processed prompts:   6%|▋         | 32/512 [00:01<00:28, 16.63it/s, est. speed input: 21412.96 toks/s, output: 20.91 toks/s]
Processed prompts:   7%|▋         | 35/512 [00:01<00:32, 14.69it/s, est. speed input: 19773.60 toks/s, output: 19.31 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:02<00:35, 13.43it/s, est. speed input: 18587.72 toks/s, output: 18.15 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:02<00:34, 13.66it/s, est. speed input: 18103.38 toks/s, output: 17.68 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:33, 13.75it/s, est. speed input: 17691.42 toks/s, output: 17.28 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:02<00:33, 13.88it/s, est. speed input: 17386.36 toks/s, output: 16.98 toks/s]
Processed prompts:  11%|█         | 54/512 [00:03<00:32, 13.98it/s, est. speed input: 17140.08 toks/s, output: 16.74 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:03<00:32, 14.02it/s, est. speed input: 16922.87 toks/s, output: 16.53 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:32, 14.03it/s, est. speed input: 16731.44 toks/s, output: 16.34 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:04<00:31, 14.10it/s, est. speed input: 16585.77 toks/s, output: 16.20 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:04<00:31, 14.11it/s, est. speed input: 16448.47 toks/s, output: 16.06 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:31, 14.07it/s, est. speed input: 16316.47 toks/s, output: 15.93 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:04<00:30, 14.07it/s, est. speed input: 16206.21 toks/s, output: 15.83 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:05<00:30, 14.12it/s, est. speed input: 16119.47 toks/s, output: 15.74 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:05<00:30, 14.19it/s, est. speed input: 16047.62 toks/s, output: 15.67 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:29, 14.14it/s, est. speed input: 15964.84 toks/s, output: 15.59 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:06<00:29, 14.21it/s, est. speed input: 15906.17 toks/s, output: 15.53 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:06<00:29, 14.26it/s, est. speed input: 15854.20 toks/s, output: 15.48 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:28, 14.21it/s, est. speed input: 15793.93 toks/s, output: 15.42 toks/s]
Processed prompts:  21%|██        | 106/512 [00:06<00:28, 14.12it/s, est. speed input: 15728.72 toks/s, output: 15.36 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:07<00:28, 14.12it/s, est. speed input: 15678.50 toks/s, output: 15.31 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:28, 14.11it/s, est. speed input: 15630.56 toks/s, output: 15.26 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:27, 14.08it/s, est. speed input: 15583.28 toks/s, output: 15.22 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:08<00:27, 14.12it/s, est. speed input: 15547.18 toks/s, output: 15.18 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:08<00:27, 14.13it/s, est. speed input: 15511.76 toks/s, output: 15.15 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:26, 14.16it/s, est. speed input: 15480.79 toks/s, output: 15.12 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:08<00:26, 14.08it/s, est. speed input: 15440.46 toks/s, output: 15.08 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:09<00:26, 14.07it/s, est. speed input: 15408.15 toks/s, output: 15.05 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:26, 14.10it/s, est. speed input: 15380.94 toks/s, output: 15.02 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:09<00:25, 14.10it/s, est. speed input: 15353.32 toks/s, output: 14.99 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:10<00:25, 14.04it/s, est. speed input: 15321.56 toks/s, output: 14.96 toks/s]
Processed prompts:  30%|███       | 154/512 [00:10<00:25, 14.05it/s, est. speed input: 15296.12 toks/s, output: 14.94 toks/s]
Processed prompts:  31%|███       | 158/512 [00:10<00:25, 14.09it/s, est. speed input: 15275.66 toks/s, output: 14.92 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:10<00:24, 14.15it/s, est. speed input: 15258.94 toks/s, output: 14.90 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:11<00:24, 14.12it/s, est. speed input: 15236.92 toks/s, output: 14.88 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:11<00:24, 14.12it/s, est. speed input: 15217.46 toks/s, output: 14.86 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:11<00:23, 14.09it/s, est. speed input: 15196.37 toks/s, output: 14.84 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:12<00:23, 14.01it/s, est. speed input: 15171.83 toks/s, output: 14.82 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:12<00:23, 14.05it/s, est. speed input: 15155.66 toks/s, output: 14.80 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:12<00:23, 14.09it/s, est. speed input: 15142.03 toks/s, output: 14.79 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:12<00:22, 14.10it/s, est. speed input: 15126.76 toks/s, output: 14.77 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:13<00:22, 14.05it/s, est. speed input: 15108.42 toks/s, output: 14.75 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:13<00:22, 14.06it/s, est. speed input: 15093.36 toks/s, output: 14.74 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:13<00:22, 14.05it/s, est. speed input: 15078.34 toks/s, output: 14.72 toks/s]
Processed prompts:  40%|████      | 206/512 [00:13<00:21, 14.13it/s, est. speed input: 15069.72 toks/s, output: 14.72 toks/s]
Processed prompts:  41%|████      | 210/512 [00:14<00:21, 14.05it/s, est. speed input: 15052.38 toks/s, output: 14.70 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:14<00:21, 14.08it/s, est. speed input: 15041.80 toks/s, output: 14.69 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:14<00:20, 14.09it/s, est. speed input: 15030.39 toks/s, output: 14.68 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:15<00:20, 14.12it/s, est. speed input: 15020.73 toks/s, output: 14.67 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:15<00:20, 14.05it/s, est. speed input: 15005.84 toks/s, output: 14.65 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:15<00:20, 14.08it/s, est. speed input: 14996.95 toks/s, output: 14.65 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:15<00:19, 14.11it/s, est. speed input: 14988.51 toks/s, output: 14.64 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:16<00:19, 14.05it/s, est. speed input: 14975.03 toks/s, output: 14.62 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:16<00:19, 14.13it/s, est. speed input: 14969.90 toks/s, output: 14.62 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:16<00:18, 14.13it/s, est. speed input: 14961.27 toks/s, output: 14.61 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:17<00:18, 14.12it/s, est. speed input: 14952.67 toks/s, output: 14.60 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:17<00:18, 14.05it/s, est. speed input: 14940.69 toks/s, output: 14.59 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:17<00:18, 14.10it/s, est. speed input: 14934.51 toks/s, output: 14.58 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:17<00:17, 14.11it/s, est. speed input: 14927.27 toks/s, output: 14.58 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:18<00:17, 14.07it/s, est. speed input: 14917.56 toks/s, output: 14.57 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:18<00:17, 14.00it/s, est. speed input: 14905.95 toks/s, output: 14.56 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:18<00:17, 13.99it/s, est. speed input: 14896.53 toks/s, output: 14.55 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:19<00:16, 14.02it/s, est. speed input: 14889.97 toks/s, output: 14.54 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:19<00:16, 14.02it/s, est. speed input: 14882.08 toks/s, output: 14.53 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:19<00:16, 14.09it/s, est. speed input: 14877.99 toks/s, output: 14.53 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:19<00:15, 14.17it/s, est. speed input: 14875.52 toks/s, output: 14.53 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:20<00:15, 14.18it/s, est. speed input: 14870.81 toks/s, output: 14.52 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:20<00:15, 14.08it/s, est. speed input: 14861.27 toks/s, output: 14.51 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:20<00:14, 14.08it/s, est. speed input: 14855.20 toks/s, output: 14.51 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:21<00:14, 14.10it/s, est. speed input: 14850.18 toks/s, output: 14.50 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:21<00:14, 14.08it/s, est. speed input: 14844.05 toks/s, output: 14.50 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:21<00:14, 14.02it/s, est. speed input: 14835.36 toks/s, output: 14.49 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:21<00:13, 14.06it/s, est. speed input: 14830.90 toks/s, output: 14.48 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:22<00:13, 14.06it/s, est. speed input: 14825.39 toks/s, output: 14.48 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:22<00:13, 14.09it/s, est. speed input: 14821.38 toks/s, output: 14.47 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:22<00:12, 14.04it/s, est. speed input: 14814.29 toks/s, output: 14.47 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:23<00:12, 14.13it/s, est. speed input: 14812.64 toks/s, output: 14.47 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:23<00:12, 14.11it/s, est. speed input: 14807.87 toks/s, output: 14.46 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:23<00:11, 14.68it/s, est. speed input: 14826.30 toks/s, output: 14.48 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:23<00:11, 14.39it/s, est. speed input: 14817.37 toks/s, output: 14.47 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:24<00:11, 14.29it/s, est. speed input: 14812.49 toks/s, output: 14.47 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:24<00:11, 14.28it/s, est. speed input: 14809.97 toks/s, output: 14.46 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:24<00:10, 14.15it/s, est. speed input: 14802.85 toks/s, output: 14.46 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:25<00:10, 14.17it/s, est. speed input: 14799.92 toks/s, output: 14.45 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:25<00:10, 14.17it/s, est. speed input: 14796.87 toks/s, output: 14.45 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:25<00:10, 14.18it/s, est. speed input: 14793.88 toks/s, output: 14.45 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:25<00:09, 14.10it/s, est. speed input: 14787.92 toks/s, output: 14.44 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:26<00:09, 14.11it/s, est. speed input: 14784.63 toks/s, output: 14.44 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:26<00:09, 14.13it/s, est. speed input: 14781.53 toks/s, output: 14.44 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:26<00:08, 14.10it/s, est. speed input: 14777.39 toks/s, output: 14.43 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:27<00:08, 13.99it/s, est. speed input: 14769.74 toks/s, output: 14.42 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:27<00:08, 14.04it/s, est. speed input: 14766.78 toks/s, output: 14.42 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:27<00:08, 14.06it/s, est. speed input: 14763.60 toks/s, output: 14.42 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:27<00:07, 13.98it/s, est. speed input: 14756.92 toks/s, output: 14.41 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:28<00:07, 14.03it/s, est. speed input: 14754.43 toks/s, output: 14.41 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:28<00:07, 14.05it/s, est. speed input: 14751.16 toks/s, output: 14.41 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:28<00:06, 14.03it/s, est. speed input: 14747.00 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:29<00:06, 13.96it/s, est. speed input: 14740.62 toks/s, output: 14.40 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:29<00:06, 13.97it/s, est. speed input: 14736.82 toks/s, output: 14.39 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:29<00:06, 14.03it/s, est. speed input: 14734.55 toks/s, output: 14.39 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:29<00:05, 14.06it/s, est. speed input: 14732.20 toks/s, output: 14.39 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:30<00:05, 14.02it/s, est. speed input: 14727.59 toks/s, output: 14.38 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:30<00:05, 14.05it/s, est. speed input: 14725.10 toks/s, output: 14.38 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:30<00:04, 14.08it/s, est. speed input: 14723.05 toks/s, output: 14.38 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:31<00:04, 14.13it/s, est. speed input: 14721.78 toks/s, output: 14.38 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:31<00:04, 14.87it/s, est. speed input: 14741.50 toks/s, output: 14.40 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:31<00:03, 14.63it/s, est. speed input: 14738.76 toks/s, output: 14.39 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:31<00:03, 14.51it/s, est. speed input: 14737.48 toks/s, output: 14.39 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:32<00:03, 14.40it/s, est. speed input: 14735.31 toks/s, output: 14.39 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:32<00:03, 14.26it/s, est. speed input: 14731.16 toks/s, output: 14.39 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:32<00:02, 14.21it/s, est. speed input: 14728.57 toks/s, output: 14.38 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:32<00:02, 14.16it/s, est. speed input: 14725.74 toks/s, output: 14.38 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:33<00:02, 14.08it/s, est. speed input: 14721.25 toks/s, output: 14.38 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:33<00:02, 14.09it/s, est. speed input: 14718.99 toks/s, output: 14.37 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:33<00:01, 14.09it/s, est. speed input: 14716.46 toks/s, output: 14.37 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:34<00:01, 14.09it/s, est. speed input: 14714.05 toks/s, output: 14.37 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:34<00:01, 14.04it/s, est. speed input: 14710.25 toks/s, output: 14.37 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:34<00:00, 14.13it/s, est. speed input: 14710.01 toks/s, output: 14.37 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:34<00:00, 14.15it/s, est. speed input: 14708.79 toks/s, output: 14.36 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 14.16it/s, est. speed input: 14707.20 toks/s, output: 14.36 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:35<00:00, 14.90it/s, est. speed input: 14724.93 toks/s, output: 14.38 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.90it/s, est. speed input: 14782.59 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:35<00:00, 14.44it/s, est. speed input: 14782.59 toks/s, output: 14.44 toks/s]
[rank0]:[W128 09:20:16.020525345 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 71.8s

测试结果:
  Requests/s:   14.07
  Tokens/s:     14421.86
  Total Reqs:   512
  Elapsed:      36.39s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     14407.79

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:20:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:20:24 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3740281) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3740281) WARNING 01-28 09:20:53 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.14 requests/s, 14489.86 total tokens/s, 14.14 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 09:20:24] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:20:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:20:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:20:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:20:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:20:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:20:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:20:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:20:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:20:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:20:28] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:20:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:20:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:20:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:20:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:20:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:20:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:28] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3740281) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3740281) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.43s/it]
(EngineCore_DP0 pid=3740281) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.43s/it]
(EngineCore_DP0 pid=3740281) 
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3740281) [2026-01-28 09:20:46] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3740281) 2026-01-28 09:20:52,040 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3740281) 2026-01-28 09:20:52,093 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 60/1024 [00:00<00:01, 592.64it/s]
Adding requests:  12%|█▏        | 120/1024 [00:00<00:01, 581.66it/s]
Adding requests:  17%|█▋        | 179/1024 [00:00<00:01, 543.33it/s]
Adding requests:  23%|██▎       | 235/1024 [00:00<00:01, 549.54it/s]
Adding requests:  28%|██▊       | 291/1024 [00:00<00:01, 540.97it/s]
Adding requests:  34%|███▍      | 346/1024 [00:00<00:01, 538.50it/s]
Adding requests:  39%|███▉      | 402/1024 [00:00<00:01, 544.86it/s]
Adding requests:  45%|████▍     | 457/1024 [00:00<00:01, 535.42it/s]
Adding requests:  50%|████▉     | 511/1024 [00:00<00:00, 529.91it/s]
Adding requests:  55%|█████▌    | 565/1024 [00:01<00:00, 512.34it/s]
Adding requests:  60%|██████    | 618/1024 [00:01<00:00, 516.56it/s]
Adding requests:  66%|██████▌   | 672/1024 [00:01<00:00, 522.23it/s]
Adding requests:  71%|███████   | 726/1024 [00:01<00:00, 526.01it/s]
Adding requests:  76%|███████▌  | 779/1024 [00:01<00:00, 520.75it/s]
Adding requests:  81%|████████▏ | 832/1024 [00:01<00:00, 517.57it/s]
Adding requests:  87%|████████▋ | 888/1024 [00:01<00:00, 527.87it/s]
Adding requests:  92%|█████████▏| 942/1024 [00:01<00:00, 530.25it/s]
Adding requests:  97%|█████████▋| 996/1024 [00:01<00:00, 531.42it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 532.12it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:00<00:19, 50.57it/s, est. speed input: 51789.26 toks/s, output: 50.57 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:01<00:34, 28.34it/s, est. speed input: 32278.10 toks/s, output: 31.52 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:01<00:45, 21.75it/s, est. speed input: 26184.14 toks/s, output: 25.57 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:02<00:52, 18.72it/s, est. speed input: 23198.49 toks/s, output: 22.65 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:02<00:56, 17.03it/s, est. speed input: 21405.68 toks/s, output: 20.90 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:03<00:59, 16.08it/s, est. speed input: 20256.40 toks/s, output: 19.78 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:03<01:01, 15.45it/s, est. speed input: 19423.94 toks/s, output: 18.97 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:04<01:02, 15.06it/s, est. speed input: 18811.02 toks/s, output: 18.37 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:05<01:03, 14.76it/s, est. speed input: 18318.86 toks/s, output: 17.89 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:05<01:03, 14.59it/s, est. speed input: 17938.38 toks/s, output: 17.52 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:06<01:03, 14.45it/s, est. speed input: 17621.85 toks/s, output: 17.21 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:06<01:03, 14.41it/s, est. speed input: 17374.58 toks/s, output: 16.97 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:07<01:02, 14.34it/s, est. speed input: 17152.73 toks/s, output: 16.75 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:07<01:02, 14.32it/s, est. speed input: 16971.17 toks/s, output: 16.57 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:08<01:02, 14.26it/s, est. speed input: 16801.93 toks/s, output: 16.41 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:08<01:01, 14.23it/s, est. speed input: 16658.14 toks/s, output: 16.27 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:09<01:01, 14.21it/s, est. speed input: 16529.86 toks/s, output: 16.14 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:10<01:00, 14.20it/s, est. speed input: 16418.22 toks/s, output: 16.03 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:10<01:00, 14.19it/s, est. speed input: 16316.14 toks/s, output: 15.93 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:11<00:59, 14.18it/s, est. speed input: 16224.73 toks/s, output: 15.84 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:11<00:58, 14.21it/s, est. speed input: 16149.05 toks/s, output: 15.77 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:12<00:58, 14.18it/s, est. speed input: 16070.84 toks/s, output: 15.69 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:12<00:57, 14.19it/s, est. speed input: 16004.24 toks/s, output: 15.63 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:13<00:57, 14.18it/s, est. speed input: 15941.81 toks/s, output: 15.57 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:14<00:56, 14.19it/s, est. speed input: 15886.03 toks/s, output: 15.51 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:14<00:56, 14.17it/s, est. speed input: 15831.39 toks/s, output: 15.46 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:15<00:55, 14.20it/s, est. speed input: 15785.80 toks/s, output: 15.42 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:15<00:55, 14.19it/s, est. speed input: 15740.57 toks/s, output: 15.37 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:16<00:54, 14.21it/s, est. speed input: 15701.21 toks/s, output: 15.33 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:16<00:54, 14.18it/s, est. speed input: 15659.37 toks/s, output: 15.29 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:17<00:53, 14.19it/s, est. speed input: 15623.63 toks/s, output: 15.26 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:18<00:52, 14.16it/s, est. speed input: 15586.06 toks/s, output: 15.22 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:18<00:52, 14.17it/s, est. speed input: 15553.54 toks/s, output: 15.19 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:19<00:51, 14.15it/s, est. speed input: 15520.44 toks/s, output: 15.16 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:19<00:51, 14.15it/s, est. speed input: 15490.94 toks/s, output: 15.13 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:20<00:50, 14.20it/s, est. speed input: 15468.04 toks/s, output: 15.11 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:20<00:50, 14.17it/s, est. speed input: 15440.55 toks/s, output: 15.08 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:21<00:49, 14.19it/s, est. speed input: 15417.82 toks/s, output: 15.06 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:21<00:48, 14.17it/s, est. speed input: 15393.40 toks/s, output: 15.03 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:22<00:47, 14.36it/s, est. speed input: 15388.11 toks/s, output: 15.03 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:23<00:47, 14.29it/s, est. speed input: 15365.24 toks/s, output: 15.01 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:23<00:46, 14.27it/s, est. speed input: 15346.26 toks/s, output: 14.99 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:24<00:46, 14.21it/s, est. speed input: 15324.57 toks/s, output: 14.97 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:24<00:46, 14.22it/s, est. speed input: 15307.23 toks/s, output: 14.95 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:25<00:45, 14.19it/s, est. speed input: 15288.65 toks/s, output: 14.93 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:25<00:44, 14.20it/s, est. speed input: 15272.69 toks/s, output: 14.91 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:26<00:44, 14.17it/s, est. speed input: 15254.83 toks/s, output: 14.90 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:27<00:43, 14.20it/s, est. speed input: 15241.44 toks/s, output: 14.88 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:27<00:43, 14.17it/s, est. speed input: 15224.77 toks/s, output: 14.87 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:28<00:42, 14.15it/s, est. speed input: 15208.86 toks/s, output: 14.85 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:28<00:42, 14.15it/s, est. speed input: 15194.56 toks/s, output: 14.84 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:29<00:41, 14.14it/s, est. speed input: 15180.56 toks/s, output: 14.82 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:29<00:41, 14.16it/s, est. speed input: 15168.30 toks/s, output: 14.81 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:30<00:41, 13.68it/s, est. speed input: 15123.01 toks/s, output: 14.77 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:31<00:40, 13.82it/s, est. speed input: 15112.01 toks/s, output: 14.76 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:31<00:40, 13.89it/s, est. speed input: 15098.80 toks/s, output: 14.74 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:32<00:39, 13.99it/s, est. speed input: 15089.62 toks/s, output: 14.74 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:32<00:38, 14.02it/s, est. speed input: 15078.36 toks/s, output: 14.72 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:33<00:37, 14.08it/s, est. speed input: 15069.24 toks/s, output: 14.72 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:33<00:37, 14.06it/s, est. speed input: 15057.48 toks/s, output: 14.70 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:34<00:36, 14.09it/s, est. speed input: 15048.33 toks/s, output: 14.70 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:34<00:36, 14.14it/s, est. speed input: 15040.99 toks/s, output: 14.69 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:35<00:35, 14.10it/s, est. speed input: 15029.98 toks/s, output: 14.68 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:36<00:34, 14.15it/s, est. speed input: 15023.25 toks/s, output: 14.67 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:36<00:34, 14.13it/s, est. speed input: 15013.94 toks/s, output: 14.66 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:37<00:33, 14.17it/s, est. speed input: 15008.08 toks/s, output: 14.66 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:37<00:33, 14.16it/s, est. speed input: 15000.22 toks/s, output: 14.65 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:38<00:32, 14.16it/s, est. speed input: 14992.87 toks/s, output: 14.64 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:38<00:32, 14.13it/s, est. speed input: 14984.28 toks/s, output: 14.63 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:39<00:31, 14.15it/s, est. speed input: 14977.89 toks/s, output: 14.63 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:40<00:30, 14.14it/s, est. speed input: 14970.25 toks/s, output: 14.62 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:40<00:30, 14.17it/s, est. speed input: 14964.78 toks/s, output: 14.61 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:41<00:29, 14.13it/s, est. speed input: 14956.67 toks/s, output: 14.61 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:41<00:29, 14.16it/s, est. speed input: 14951.52 toks/s, output: 14.60 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:42<00:28, 14.13it/s, est. speed input: 14944.17 toks/s, output: 14.59 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:42<00:28, 14.16it/s, est. speed input: 14939.27 toks/s, output: 14.59 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:43<00:27, 14.13it/s, est. speed input: 14932.27 toks/s, output: 14.58 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:44<00:26, 14.15it/s, est. speed input: 14927.09 toks/s, output: 14.58 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:44<00:26, 14.12it/s, est. speed input: 14920.16 toks/s, output: 14.57 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:45<00:25, 14.12it/s, est. speed input: 14914.40 toks/s, output: 14.56 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:45<00:25, 14.15it/s, est. speed input: 14909.89 toks/s, output: 14.56 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:46<00:24, 14.12it/s, est. speed input: 14903.55 toks/s, output: 14.55 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:46<00:24, 14.14it/s, est. speed input: 14899.21 toks/s, output: 14.55 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:47<00:23, 14.10it/s, est. speed input: 14892.57 toks/s, output: 14.54 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:48<00:23, 14.13it/s, est. speed input: 14888.34 toks/s, output: 14.54 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:48<00:22, 14.12it/s, est. speed input: 14883.11 toks/s, output: 14.53 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:49<00:21, 14.16it/s, est. speed input: 14879.83 toks/s, output: 14.53 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:49<00:21, 14.15it/s, est. speed input: 14875.19 toks/s, output: 14.53 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:50<00:20, 14.17it/s, est. speed input: 14871.42 toks/s, output: 14.52 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:50<00:20, 14.15it/s, est. speed input: 14866.67 toks/s, output: 14.52 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:51<00:19, 14.14it/s, est. speed input: 14862.33 toks/s, output: 14.51 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:51<00:19, 14.13it/s, est. speed input: 14857.51 toks/s, output: 14.51 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:52<00:18, 14.13it/s, est. speed input: 14853.45 toks/s, output: 14.51 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:53<00:17, 14.12it/s, est. speed input: 14848.83 toks/s, output: 14.50 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:53<00:17, 14.12it/s, est. speed input: 14844.86 toks/s, output: 14.50 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:54<00:16, 14.14it/s, est. speed input: 14841.36 toks/s, output: 14.49 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:54<00:16, 14.11it/s, est. speed input: 14836.82 toks/s, output: 14.49 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:55<00:15, 14.13it/s, est. speed input: 14833.29 toks/s, output: 14.49 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:55<00:15, 14.13it/s, est. speed input: 14829.61 toks/s, output: 14.48 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:56<00:14, 14.14it/s, est. speed input: 14826.35 toks/s, output: 14.48 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:57<00:14, 14.13it/s, est. speed input: 14822.51 toks/s, output: 14.48 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:57<00:13, 14.14it/s, est. speed input: 14819.56 toks/s, output: 14.47 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [00:58<00:12, 14.13it/s, est. speed input: 14815.92 toks/s, output: 14.47 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [00:58<00:12, 14.14it/s, est. speed input: 14812.72 toks/s, output: 14.47 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [00:59<00:11, 14.14it/s, est. speed input: 14809.55 toks/s, output: 14.46 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [00:59<00:11, 14.16it/s, est. speed input: 14807.00 toks/s, output: 14.46 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:00<00:10, 14.15it/s, est. speed input: 14803.88 toks/s, output: 14.46 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:01<00:10, 14.15it/s, est. speed input: 14801.01 toks/s, output: 14.45 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:01<00:09, 14.12it/s, est. speed input: 14797.25 toks/s, output: 14.45 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:02<00:08, 14.11it/s, est. speed input: 14793.64 toks/s, output: 14.45 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:02<00:08, 14.11it/s, est. speed input: 14790.48 toks/s, output: 14.44 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:03<00:07, 13.96it/s, est. speed input: 14782.84 toks/s, output: 14.44 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:03<00:07, 14.04it/s, est. speed input: 14780.98 toks/s, output: 14.43 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:04<00:06, 14.06it/s, est. speed input: 14778.00 toks/s, output: 14.43 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:04<00:05, 14.52it/s, est. speed input: 14788.46 toks/s, output: 14.44 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:05<00:05, 14.39it/s, est. speed input: 14785.24 toks/s, output: 14.44 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:06<00:04, 14.32it/s, est. speed input: 14782.78 toks/s, output: 14.44 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:06<00:04, 14.25it/s, est. speed input: 14779.90 toks/s, output: 14.43 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:07<00:03, 14.22it/s, est. speed input: 14777.52 toks/s, output: 14.43 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:07<00:03, 14.18it/s, est. speed input: 14774.61 toks/s, output: 14.43 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:08<00:02, 14.64it/s, est. speed input: 14785.19 toks/s, output: 14.44 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:08<00:02, 14.49it/s, est. speed input: 14782.77 toks/s, output: 14.44 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:09<00:01, 14.38it/s, est. speed input: 14780.10 toks/s, output: 14.43 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:09<00:00, 14.29it/s, est. speed input: 14777.17 toks/s, output: 14.43 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:10<00:00, 14.58it/s, est. speed input: 14783.95 toks/s, output: 14.44 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:10<00:00, 14.58it/s, est. speed input: 14871.04 toks/s, output: 14.52 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:10<00:00, 14.52it/s, est. speed input: 14871.04 toks/s, output: 14.52 toks/s]
[rank0]:[W128 09:22:05.864806271 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 109.8s

测试结果:
  Requests/s:   14.14
  Tokens/s:     14489.86
  Total Reqs:   1024
  Elapsed:      72.44s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     14475.72

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:22:17 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:22:17 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3742012) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3742012) WARNING 01-28 09:22:47 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.39 requests/s, 14748.03 total tokens/s, 14.39 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 09:22:17] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:22:17] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:22:17] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:17] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:22:17] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:22:17] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:22:17] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:22:17] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:22:17] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:22:20] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:22:20] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:22:20] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:22:20] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:22:20] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:22:20] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:22:20] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:22:20] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:22:20] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:21] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3742012) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3742012) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.88s/it]
(EngineCore_DP0 pid=3742012) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.88s/it]
(EngineCore_DP0 pid=3742012) 
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3742012) [2026-01-28 09:22:39] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3742012) 2026-01-28 09:22:45,684 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3742012) 2026-01-28 09:22:45,754 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 64/2048 [00:00<00:03, 629.48it/s]
Adding requests:   6%|▌         | 127/2048 [00:00<00:03, 585.05it/s]
Adding requests:   9%|▉         | 186/2048 [00:00<00:03, 556.82it/s]
Adding requests:  12%|█▏        | 243/2048 [00:00<00:03, 558.69it/s]
Adding requests:  15%|█▍        | 299/2048 [00:00<00:03, 539.62it/s]
Adding requests:  17%|█▋        | 354/2048 [00:00<00:03, 534.22it/s]
Adding requests:  20%|█▉        | 409/2048 [00:00<00:03, 538.45it/s]
Adding requests:  23%|██▎       | 463/2048 [00:00<00:02, 537.99it/s]
Adding requests:  25%|██▌       | 517/2048 [00:00<00:02, 531.98it/s]
Adding requests:  28%|██▊       | 571/2048 [00:01<00:02, 533.51it/s]
Adding requests:  31%|███       | 627/2048 [00:01<00:02, 540.22it/s]
Adding requests:  33%|███▎      | 684/2048 [00:01<00:02, 545.82it/s]
Adding requests:  36%|███▌      | 739/2048 [00:01<00:02, 547.05it/s]
Adding requests:  39%|███▉      | 794/2048 [00:01<00:02, 518.98it/s]
Adding requests:  41%|████▏     | 847/2048 [00:01<00:02, 518.88it/s]
Adding requests:  44%|████▍     | 900/2048 [00:02<00:05, 207.67it/s]
Adding requests:  46%|████▋     | 952/2048 [00:02<00:04, 251.75it/s]
Adding requests:  49%|████▉     | 1006/2048 [00:02<00:03, 299.68it/s]
Adding requests:  52%|█████▏    | 1058/2048 [00:02<00:02, 341.98it/s]
Adding requests:  54%|█████▍    | 1112/2048 [00:02<00:02, 384.71it/s]
Adding requests:  57%|█████▋    | 1165/2048 [00:02<00:02, 418.23it/s]
Adding requests:  60%|█████▉    | 1222/2048 [00:02<00:01, 454.77it/s]
Adding requests:  62%|██████▏   | 1275/2048 [00:02<00:01, 470.27it/s]
Adding requests:  65%|██████▍   | 1327/2048 [00:03<00:01, 482.86it/s]
Adding requests:  68%|██████▊   | 1383/2048 [00:03<00:01, 501.71it/s]
Adding requests:  70%|███████   | 1440/2048 [00:03<00:01, 519.25it/s]
Adding requests:  73%|███████▎  | 1495/2048 [00:03<00:01, 526.99it/s]
Adding requests:  76%|███████▌  | 1550/2048 [00:03<00:00, 531.44it/s]
Adding requests:  78%|███████▊  | 1607/2048 [00:03<00:00, 542.30it/s]
Adding requests:  81%|████████  | 1662/2048 [00:03<00:00, 540.37it/s]
Adding requests:  84%|████████▍ | 1718/2048 [00:03<00:00, 544.73it/s]
Adding requests:  87%|████████▋ | 1773/2048 [00:03<00:00, 541.33it/s]
Adding requests:  89%|████████▉ | 1829/2048 [00:03<00:00, 546.75it/s]
Adding requests:  92%|█████████▏| 1884/2048 [00:04<00:00, 547.58it/s]
Adding requests:  95%|█████████▍| 1939/2048 [00:04<00:00, 546.65it/s]
Adding requests:  97%|█████████▋| 1994/2048 [00:04<00:00, 543.91it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 472.46it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:00<00:12, 163.74it/s, est. speed input: 167686.88 toks/s, output: 163.75 toks/s]
Processed prompts:   3%|▎         | 67/2048 [00:01<00:50, 39.11it/s, est. speed input: 48273.85 toks/s, output: 47.14 toks/s]   
Processed prompts:   4%|▍         | 82/2048 [00:02<01:18, 25.18it/s, est. speed input: 33162.73 toks/s, output: 32.39 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:03<01:35, 20.44it/s, est. speed input: 27525.17 toks/s, output: 26.88 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:04<01:46, 18.10it/s, est. speed input: 24521.91 toks/s, output: 23.95 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:05<01:54, 16.79it/s, est. speed input: 22672.72 toks/s, output: 22.14 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:06<01:58, 16.00it/s, est. speed input: 21421.75 toks/s, output: 20.92 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:08<02:01, 15.48it/s, est. speed input: 20504.15 toks/s, output: 20.02 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:09<02:03, 15.11it/s, est. speed input: 19796.01 toks/s, output: 19.33 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:10<02:04, 14.89it/s, est. speed input: 19250.39 toks/s, output: 18.80 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:11<02:04, 14.73it/s, est. speed input: 18811.21 toks/s, output: 18.37 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:12<02:04, 14.63it/s, est. speed input: 18449.10 toks/s, output: 18.02 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:13<02:04, 14.55it/s, est. speed input: 18145.87 toks/s, output: 17.72 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:14<02:03, 14.50it/s, est. speed input: 17887.96 toks/s, output: 17.47 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:15<02:02, 14.48it/s, est. speed input: 17670.22 toks/s, output: 17.26 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:16<02:01, 14.45it/s, est. speed input: 17477.24 toks/s, output: 17.07 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:18<02:00, 14.42it/s, est. speed input: 17305.63 toks/s, output: 16.90 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:19<01:59, 14.41it/s, est. speed input: 17156.97 toks/s, output: 16.75 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:20<01:57, 14.54it/s, est. speed input: 17053.36 toks/s, output: 16.65 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:21<01:56, 14.50it/s, est. speed input: 16933.36 toks/s, output: 16.54 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:22<01:56, 14.46it/s, est. speed input: 16824.15 toks/s, output: 16.43 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:23<01:55, 14.43it/s, est. speed input: 16724.13 toks/s, output: 16.33 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:24<01:54, 14.40it/s, est. speed input: 16631.52 toks/s, output: 16.24 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:25<01:53, 14.38it/s, est. speed input: 16547.64 toks/s, output: 16.16 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:26<01:52, 14.38it/s, est. speed input: 16472.93 toks/s, output: 16.09 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:28<01:52, 14.24it/s, est. speed input: 16382.63 toks/s, output: 16.00 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:29<01:50, 14.28it/s, est. speed input: 16319.46 toks/s, output: 15.94 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:30<01:49, 14.30it/s, est. speed input: 16259.93 toks/s, output: 15.88 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:31<01:48, 14.32it/s, est. speed input: 16204.71 toks/s, output: 15.82 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:32<01:46, 14.34it/s, est. speed input: 16154.89 toks/s, output: 15.78 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:33<01:45, 14.36it/s, est. speed input: 16107.87 toks/s, output: 15.73 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:34<01:44, 14.35it/s, est. speed input: 16062.12 toks/s, output: 15.69 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:35<01:43, 14.35it/s, est. speed input: 16019.75 toks/s, output: 15.64 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:37<01:42, 14.36it/s, est. speed input: 15981.42 toks/s, output: 15.61 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:38<01:41, 14.35it/s, est. speed input: 15942.81 toks/s, output: 15.57 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:39<01:40, 14.34it/s, est. speed input: 15906.61 toks/s, output: 15.53 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:40<01:39, 14.35it/s, est. speed input: 15873.26 toks/s, output: 15.50 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:41<01:38, 14.33it/s, est. speed input: 15840.29 toks/s, output: 15.47 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:42<01:36, 14.35it/s, est. speed input: 15811.37 toks/s, output: 15.44 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:43<01:35, 14.34it/s, est. speed input: 15782.26 toks/s, output: 15.41 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:44<01:34, 14.35it/s, est. speed input: 15755.58 toks/s, output: 15.39 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:45<01:33, 14.36it/s, est. speed input: 15730.45 toks/s, output: 15.36 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:47<01:32, 14.34it/s, est. speed input: 15704.51 toks/s, output: 15.34 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:48<01:31, 14.34it/s, est. speed input: 15681.06 toks/s, output: 15.31 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:49<01:30, 14.34it/s, est. speed input: 15658.75 toks/s, output: 15.29 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:50<01:29, 14.34it/s, est. speed input: 15637.21 toks/s, output: 15.27 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:51<01:27, 14.34it/s, est. speed input: 15616.75 toks/s, output: 15.25 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:52<01:26, 14.35it/s, est. speed input: 15597.24 toks/s, output: 15.23 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:53<01:25, 14.35it/s, est. speed input: 15578.41 toks/s, output: 15.21 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:54<01:24, 14.35it/s, est. speed input: 15560.68 toks/s, output: 15.20 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:56<01:23, 14.33it/s, est. speed input: 15542.12 toks/s, output: 15.18 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:57<01:22, 14.34it/s, est. speed input: 15526.01 toks/s, output: 15.16 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [00:58<01:21, 14.34it/s, est. speed input: 15509.55 toks/s, output: 15.15 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [00:59<01:20, 14.33it/s, est. speed input: 15493.65 toks/s, output: 15.13 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:00<01:19, 14.28it/s, est. speed input: 15475.21 toks/s, output: 15.11 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:01<01:16, 14.53it/s, est. speed input: 15475.93 toks/s, output: 15.11 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:02<01:16, 14.47it/s, est. speed input: 15461.40 toks/s, output: 15.10 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:03<01:15, 14.43it/s, est. speed input: 15447.64 toks/s, output: 15.09 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:04<01:12, 14.66it/s, est. speed input: 15450.22 toks/s, output: 15.09 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:05<01:12, 14.55it/s, est. speed input: 15436.54 toks/s, output: 15.07 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:07<01:11, 14.50it/s, est. speed input: 15424.89 toks/s, output: 15.06 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:08<01:10, 14.44it/s, est. speed input: 15411.89 toks/s, output: 15.05 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:09<01:09, 14.40it/s, est. speed input: 15399.71 toks/s, output: 15.04 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:10<01:08, 14.36it/s, est. speed input: 15387.03 toks/s, output: 15.03 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:11<01:07, 14.35it/s, est. speed input: 15376.01 toks/s, output: 15.02 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:12<01:06, 14.33it/s, est. speed input: 15364.61 toks/s, output: 15.00 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:13<01:05, 14.33it/s, est. speed input: 15354.01 toks/s, output: 14.99 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:14<01:04, 14.33it/s, est. speed input: 15343.77 toks/s, output: 14.98 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:15<01:03, 14.32it/s, est. speed input: 15333.23 toks/s, output: 14.97 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:17<01:01, 14.57it/s, est. speed input: 15336.44 toks/s, output: 14.98 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:18<01:00, 14.49it/s, est. speed input: 15326.69 toks/s, output: 14.97 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:19<00:59, 14.44it/s, est. speed input: 15317.14 toks/s, output: 14.96 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:20<00:58, 14.40it/s, est. speed input: 15308.18 toks/s, output: 14.95 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:21<00:57, 14.38it/s, est. speed input: 15299.48 toks/s, output: 14.94 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:22<00:56, 14.36it/s, est. speed input: 15290.61 toks/s, output: 14.93 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:23<00:55, 14.34it/s, est. speed input: 15282.07 toks/s, output: 14.92 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:24<00:53, 14.60it/s, est. speed input: 15286.09 toks/s, output: 14.93 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:25<00:52, 14.52it/s, est. speed input: 15278.22 toks/s, output: 14.92 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:26<00:50, 14.73it/s, est. speed input: 15282.15 toks/s, output: 14.92 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:28<00:50, 14.59it/s, est. speed input: 15273.90 toks/s, output: 14.92 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:29<00:49, 14.51it/s, est. speed input: 15266.33 toks/s, output: 14.91 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:30<00:48, 14.45it/s, est. speed input: 15258.91 toks/s, output: 14.90 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:31<00:47, 14.41it/s, est. speed input: 15251.32 toks/s, output: 14.89 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:32<00:46, 14.31it/s, est. speed input: 15241.27 toks/s, output: 14.88 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:33<00:45, 14.33it/s, est. speed input: 15235.05 toks/s, output: 14.88 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:34<00:44, 14.31it/s, est. speed input: 15227.70 toks/s, output: 14.87 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:35<00:43, 14.32it/s, est. speed input: 15221.24 toks/s, output: 14.86 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:37<00:42, 14.32it/s, est. speed input: 15214.96 toks/s, output: 14.86 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:38<00:41, 14.32it/s, est. speed input: 15208.76 toks/s, output: 14.85 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:39<00:40, 14.33it/s, est. speed input: 15202.83 toks/s, output: 14.85 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:40<00:38, 14.32it/s, est. speed input: 15196.54 toks/s, output: 14.84 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:41<00:37, 14.32it/s, est. speed input: 15190.61 toks/s, output: 14.83 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:42<00:36, 14.31it/s, est. speed input: 15184.74 toks/s, output: 14.83 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:43<00:35, 14.32it/s, est. speed input: 15179.43 toks/s, output: 14.82 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:44<00:34, 14.31it/s, est. speed input: 15173.57 toks/s, output: 14.82 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:45<00:33, 14.32it/s, est. speed input: 15168.34 toks/s, output: 14.81 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:47<00:31, 14.57it/s, est. speed input: 15172.04 toks/s, output: 14.82 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:48<00:30, 14.50it/s, est. speed input: 15167.12 toks/s, output: 14.81 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:49<00:29, 14.45it/s, est. speed input: 15162.22 toks/s, output: 14.81 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:50<00:28, 14.42it/s, est. speed input: 15157.27 toks/s, output: 14.80 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:51<00:27, 14.64it/s, est. speed input: 15161.06 toks/s, output: 14.81 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:52<00:26, 14.55it/s, est. speed input: 15156.20 toks/s, output: 14.80 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:53<00:25, 14.48it/s, est. speed input: 15151.35 toks/s, output: 14.80 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:54<00:24, 14.43it/s, est. speed input: 15146.74 toks/s, output: 14.79 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [01:55<00:23, 14.40it/s, est. speed input: 15142.17 toks/s, output: 14.79 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [01:57<00:22, 14.38it/s, est. speed input: 15137.57 toks/s, output: 14.78 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [01:58<00:21, 14.37it/s, est. speed input: 15133.47 toks/s, output: 14.78 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [01:59<00:19, 14.36it/s, est. speed input: 15129.11 toks/s, output: 14.77 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:00<00:18, 14.34it/s, est. speed input: 15124.49 toks/s, output: 14.77 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:01<00:17, 14.33it/s, est. speed input: 15120.08 toks/s, output: 14.77 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:02<00:16, 14.32it/s, est. speed input: 15115.86 toks/s, output: 14.76 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:03<00:15, 14.33it/s, est. speed input: 15111.92 toks/s, output: 14.76 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:04<00:14, 14.30it/s, est. speed input: 15107.26 toks/s, output: 14.75 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:05<00:13, 14.30it/s, est. speed input: 15103.10 toks/s, output: 14.75 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:07<00:11, 14.55it/s, est. speed input: 15106.69 toks/s, output: 14.75 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:08<00:10, 14.48it/s, est. speed input: 15102.81 toks/s, output: 14.75 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:09<00:09, 14.45it/s, est. speed input: 15099.55 toks/s, output: 14.75 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:10<00:08, 14.42it/s, est. speed input: 15095.98 toks/s, output: 14.74 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:11<00:07, 14.40it/s, est. speed input: 15092.53 toks/s, output: 14.74 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:12<00:06, 14.64it/s, est. speed input: 15096.52 toks/s, output: 14.74 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:13<00:05, 14.55it/s, est. speed input: 15093.16 toks/s, output: 14.74 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:14<00:04, 14.75it/s, est. speed input: 15097.13 toks/s, output: 14.74 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:15<00:03, 14.63it/s, est. speed input: 15093.84 toks/s, output: 14.74 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:16<00:02, 14.53it/s, est. speed input: 15090.18 toks/s, output: 14.74 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:18<00:00, 14.69it/s, est. speed input: 15092.78 toks/s, output: 14.74 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:18<00:00, 14.69it/s, est. speed input: 15196.63 toks/s, output: 14.84 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:18<00:00, 14.84it/s, est. speed input: 15196.63 toks/s, output: 14.84 toks/s]
[rank0]:[W128 09:25:10.161980092 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 184.4s

测试结果:
  Requests/s:   14.39
  Tokens/s:     14748.03
  Total Reqs:   2048
  Elapsed:      142.34s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     14733.64

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:8)                                │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:25:27 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:25:27 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3744814) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3744814) WARNING 01-28 09:26:00 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.02 requests/s, 14374.44 total tokens/s, 14.02 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 09:25:27] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:25:27] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:25:27] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:27] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:25:27] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:25:27] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:25:27] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:25:27] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:25:27] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:25:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:25:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:25:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:25:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:25:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:25:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:25:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:25:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:25:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:8, expand_ratio=1.333
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:31] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3744814) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3744814) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.51s/it]
(EngineCore_DP0 pid=3744814) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:16<00:00, 16.51s/it]
(EngineCore_DP0 pid=3744814) 
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 3840] -> 1D uint8
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9216000 bytes
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 3840] -> 1D uint8
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6144000 bytes
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 3840] -> 1D uint8
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 33177600 bytes
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 10368] -> 1D uint8
(EngineCore_DP0 pid=3744814) [2026-01-28 09:25:49] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 16588800 bytes
(EngineCore_DP0 pid=3744814) 2026-01-28 09:25:56,619 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3744814) 2026-01-28 09:25:56,911 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 67/4096 [00:00<00:06, 667.18it/s]
Adding requests:   3%|▎         | 134/4096 [00:00<00:06, 632.88it/s]
Adding requests:   5%|▍         | 198/4096 [00:00<00:06, 566.80it/s]
Adding requests:   6%|▋         | 256/4096 [00:00<00:06, 555.05it/s]
Adding requests:   8%|▊         | 312/4096 [00:00<00:06, 546.77it/s]
Adding requests:   9%|▉         | 367/4096 [00:00<00:06, 546.48it/s]
Adding requests:  10%|█         | 422/4096 [00:00<00:06, 545.21it/s]
Adding requests:  12%|█▏        | 477/4096 [00:00<00:06, 542.70it/s]
Adding requests:  13%|█▎        | 532/4096 [00:00<00:06, 524.90it/s]
Adding requests:  14%|█▍        | 590/4096 [00:01<00:06, 539.07it/s]
Adding requests:  16%|█▌        | 645/4096 [00:01<00:06, 532.96it/s]
Adding requests:  17%|█▋        | 700/4096 [00:01<00:06, 536.63it/s]
Adding requests:  18%|█▊        | 754/4096 [00:01<00:06, 534.27it/s]
Adding requests:  20%|█▉        | 808/4096 [00:01<00:06, 523.67it/s]
Adding requests:  21%|██        | 863/4096 [00:01<00:06, 529.31it/s]
Adding requests:  22%|██▏       | 919/4096 [00:01<00:05, 537.58it/s]
Adding requests:  24%|██▍       | 973/4096 [00:01<00:05, 537.71it/s]
Adding requests:  25%|██▌       | 1028/4096 [00:01<00:05, 541.11it/s]
Adding requests:  26%|██▋       | 1083/4096 [00:01<00:05, 532.48it/s]
Adding requests:  28%|██▊       | 1137/4096 [00:02<00:05, 527.83it/s]
Adding requests:  29%|██▉       | 1190/4096 [00:02<00:05, 519.76it/s]
Adding requests:  30%|███       | 1243/4096 [00:02<00:05, 517.34it/s]
Adding requests:  32%|███▏      | 1297/4096 [00:02<00:05, 522.77it/s]
Adding requests:  33%|███▎      | 1351/4096 [00:02<00:05, 523.92it/s]
Adding requests:  34%|███▍      | 1405/4096 [00:02<00:05, 525.33it/s]
Adding requests:  36%|███▌      | 1460/4096 [00:02<00:04, 529.66it/s]
Adding requests:  37%|███▋      | 1516/4096 [00:02<00:04, 535.97it/s]
Adding requests:  38%|███▊      | 1571/4096 [00:02<00:04, 538.13it/s]
Adding requests:  40%|███▉      | 1627/4096 [00:03<00:04, 541.53it/s]
Adding requests:  41%|████      | 1682/4096 [00:03<00:04, 542.55it/s]
Adding requests:  42%|████▏     | 1738/4096 [00:03<00:04, 546.56it/s]
Adding requests:  44%|████▍     | 1793/4096 [00:03<00:04, 540.14it/s]
Adding requests:  45%|████▌     | 1848/4096 [00:03<00:04, 542.22it/s]
Adding requests:  46%|████▋     | 1903/4096 [00:03<00:04, 537.49it/s]
Adding requests:  48%|████▊     | 1957/4096 [00:03<00:03, 537.87it/s]
Adding requests:  49%|████▉     | 2013/4096 [00:03<00:03, 542.01it/s]
Adding requests:  50%|█████     | 2068/4096 [00:03<00:03, 543.94it/s]
Adding requests:  52%|█████▏    | 2123/4096 [00:03<00:03, 540.04it/s]
Adding requests:  53%|█████▎    | 2178/4096 [00:04<00:03, 534.65it/s]
Adding requests:  54%|█████▍    | 2232/4096 [00:04<00:03, 525.54it/s]
Adding requests:  56%|█████▌    | 2286/4096 [00:04<00:03, 527.49it/s]
Adding requests:  57%|█████▋    | 2341/4096 [00:04<00:03, 530.72it/s]
Adding requests:  58%|█████▊    | 2396/4096 [00:04<00:03, 533.49it/s]
Adding requests:  60%|█████▉    | 2450/4096 [00:04<00:03, 502.72it/s]
Adding requests:  61%|██████    | 2503/4096 [00:04<00:03, 510.34it/s]
Adding requests:  62%|██████▎   | 2560/4096 [00:04<00:02, 519.97it/s]
Adding requests:  64%|██████▍   | 2624/4096 [00:04<00:02, 551.50it/s]
Adding requests:  65%|██████▌   | 2680/4096 [00:04<00:02, 540.11it/s]
Adding requests:  67%|██████▋   | 2735/4096 [00:05<00:02, 532.19it/s]
Adding requests:  68%|██████▊   | 2789/4096 [00:05<00:02, 531.83it/s]
Adding requests:  69%|██████▉   | 2845/4096 [00:05<00:02, 539.78it/s]
Adding requests:  71%|███████   | 2900/4096 [00:05<00:02, 534.35it/s]
Adding requests:  72%|███████▏  | 2954/4096 [00:05<00:02, 527.90it/s]
Adding requests:  73%|███████▎  | 3008/4096 [00:05<00:02, 531.21it/s]
Adding requests:  75%|███████▍  | 3062/4096 [00:05<00:01, 529.55it/s]
Adding requests:  76%|███████▌  | 3117/4096 [00:05<00:01, 534.53it/s]
Adding requests:  77%|███████▋  | 3172/4096 [00:05<00:01, 537.94it/s]
Adding requests:  79%|███████▉  | 3228/4096 [00:06<00:01, 541.59it/s]
Adding requests:  80%|████████  | 3285/4096 [00:06<00:01, 547.24it/s]
Adding requests:  82%|████████▏ | 3340/4096 [00:06<00:01, 538.66it/s]
Adding requests:  83%|████████▎ | 3394/4096 [00:06<00:01, 537.80it/s]
Adding requests:  84%|████████▍ | 3450/4096 [00:06<00:01, 538.33it/s]
Adding requests:  86%|████████▌ | 3504/4096 [00:06<00:01, 526.72it/s]
Adding requests:  87%|████████▋ | 3560/4096 [00:06<00:01, 533.61it/s]
Adding requests:  88%|████████▊ | 3614/4096 [00:06<00:00, 534.83it/s]
Adding requests:  90%|████████▉ | 3669/4096 [00:06<00:00, 538.06it/s]
Adding requests:  91%|█████████ | 3724/4096 [00:06<00:00, 540.42it/s]
Adding requests:  92%|█████████▏| 3783/4096 [00:07<00:00, 554.06it/s]
Adding requests:  94%|█████████▎| 3839/4096 [00:07<00:00, 517.95it/s]
Adding requests:  95%|█████████▌| 3892/4096 [00:07<00:00, 520.00it/s]
Adding requests:  96%|█████████▋| 3947/4096 [00:07<00:00, 528.36it/s]
Adding requests:  98%|█████████▊| 4003/4096 [00:07<00:00, 535.71it/s]
Adding requests:  99%|█████████▉| 4057/4096 [00:07<00:00, 534.46it/s]
Adding requests: 100%|██████████| 4096/4096 [00:07<00:00, 536.03it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:01<01:14, 54.01it/s, est. speed input: 55306.62 toks/s, output: 54.01 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:04<02:20, 28.24it/s, est. speed input: 32420.84 toks/s, output: 31.66 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:06<03:03, 21.45it/s, est. speed input: 25968.41 toks/s, output: 25.36 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:08<03:31, 18.42it/s, est. speed input: 22897.35 toks/s, output: 22.36 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:10<03:50, 16.80it/s, est. speed input: 21113.91 toks/s, output: 20.62 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:13<04:02, 15.83it/s, est. speed input: 19938.57 toks/s, output: 19.47 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:15<04:10, 15.21it/s, est. speed input: 19106.67 toks/s, output: 18.66 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:17<04:13, 14.89it/s, est. speed input: 18529.35 toks/s, output: 18.09 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:20<04:16, 14.60it/s, est. speed input: 18047.51 toks/s, output: 17.62 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:22<04:17, 14.41it/s, est. speed input: 17665.16 toks/s, output: 17.25 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:24<04:17, 14.28it/s, est. speed input: 17355.67 toks/s, output: 16.95 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:26<04:15, 14.26it/s, est. speed input: 17120.04 toks/s, output: 16.72 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:29<04:15, 14.17it/s, est. speed input: 16899.82 toks/s, output: 16.50 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:31<04:16, 13.94it/s, est. speed input: 16661.97 toks/s, output: 16.27 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:33<04:14, 13.94it/s, est. speed input: 16500.12 toks/s, output: 16.11 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:36<04:12, 13.95it/s, est. speed input: 16360.46 toks/s, output: 15.98 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:38<04:09, 13.95it/s, est. speed input: 16237.69 toks/s, output: 15.86 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:40<04:07, 13.95it/s, est. speed input: 16128.11 toks/s, output: 15.75 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:43<04:05, 13.95it/s, est. speed input: 16030.59 toks/s, output: 15.65 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:45<04:02, 13.96it/s, est. speed input: 15943.30 toks/s, output: 15.57 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:47<04:00, 13.95it/s, est. speed input: 15862.91 toks/s, output: 15.49 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:49<03:58, 13.96it/s, est. speed input: 15791.31 toks/s, output: 15.42 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:52<03:55, 13.96it/s, est. speed input: 15726.09 toks/s, output: 15.36 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:54<03:53, 13.96it/s, est. speed input: 15666.22 toks/s, output: 15.30 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:56<03:51, 13.96it/s, est. speed input: 15611.25 toks/s, output: 15.25 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:59<03:49, 13.96it/s, est. speed input: 15559.79 toks/s, output: 15.20 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:01<03:45, 14.05it/s, est. speed input: 15524.68 toks/s, output: 15.16 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [01:03<03:42, 14.11it/s, est. speed input: 15491.75 toks/s, output: 15.13 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [01:05<03:41, 13.99it/s, est. speed input: 15440.25 toks/s, output: 15.08 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [01:08<03:39, 13.98it/s, est. speed input: 15402.14 toks/s, output: 15.04 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:10<03:37, 13.98it/s, est. speed input: 15366.28 toks/s, output: 15.01 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:12<03:35, 13.97it/s, est. speed input: 15331.93 toks/s, output: 14.97 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [01:15<03:32, 13.97it/s, est. speed input: 15300.77 toks/s, output: 14.94 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [01:17<03:29, 14.05it/s, est. speed input: 15280.03 toks/s, output: 14.92 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [01:19<03:27, 14.02it/s, est. speed input: 15251.63 toks/s, output: 14.89 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:21<03:25, 14.01it/s, est. speed input: 15225.29 toks/s, output: 14.87 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:24<03:21, 14.09it/s, est. speed input: 15209.31 toks/s, output: 14.85 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:26<03:19, 14.14it/s, est. speed input: 15193.41 toks/s, output: 14.84 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:28<03:17, 14.08it/s, est. speed input: 15170.01 toks/s, output: 14.81 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:30<03:15, 14.05it/s, est. speed input: 15147.98 toks/s, output: 14.79 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:33<03:13, 14.02it/s, est. speed input: 15127.07 toks/s, output: 14.77 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:35<03:11, 13.99it/s, est. speed input: 15106.11 toks/s, output: 14.75 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:37<03:10, 13.94it/s, est. speed input: 15083.58 toks/s, output: 14.73 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:40<03:07, 13.95it/s, est. speed input: 15066.02 toks/s, output: 14.71 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:42<03:05, 13.95it/s, est. speed input: 15048.13 toks/s, output: 14.70 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:44<03:03, 13.96it/s, est. speed input: 15032.08 toks/s, output: 14.68 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:47<02:59, 14.06it/s, est. speed input: 15023.95 toks/s, output: 14.67 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:49<02:57, 14.02it/s, est. speed input: 15007.96 toks/s, output: 14.66 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:51<02:54, 14.09it/s, est. speed input: 15000.00 toks/s, output: 14.65 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:53<02:52, 14.06it/s, est. speed input: 14986.28 toks/s, output: 14.64 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:56<02:51, 14.02it/s, est. speed input: 14972.20 toks/s, output: 14.62 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:58<02:48, 14.00it/s, est. speed input: 14958.85 toks/s, output: 14.61 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [02:00<02:46, 13.99it/s, est. speed input: 14946.61 toks/s, output: 14.60 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [02:03<02:44, 13.99it/s, est. speed input: 14934.65 toks/s, output: 14.58 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [02:05<02:42, 13.97it/s, est. speed input: 14922.68 toks/s, output: 14.57 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [02:07<02:39, 14.05it/s, est. speed input: 14916.69 toks/s, output: 14.57 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [02:09<02:37, 13.96it/s, est. speed input: 14901.87 toks/s, output: 14.55 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [02:12<02:35, 13.97it/s, est. speed input: 14891.53 toks/s, output: 14.54 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [02:14<02:32, 14.06it/s, est. speed input: 14887.03 toks/s, output: 14.54 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [02:16<02:29, 14.12it/s, est. speed input: 14882.22 toks/s, output: 14.53 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [02:18<02:27, 14.07it/s, est. speed input: 14872.34 toks/s, output: 14.52 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [02:21<02:25, 14.02it/s, est. speed input: 14862.38 toks/s, output: 14.51 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [02:23<02:23, 14.00it/s, est. speed input: 14853.21 toks/s, output: 14.51 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [02:25<02:21, 13.99it/s, est. speed input: 14844.72 toks/s, output: 14.50 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [02:28<02:19, 13.99it/s, est. speed input: 14836.72 toks/s, output: 14.49 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [02:30<02:17, 13.98it/s, est. speed input: 14828.09 toks/s, output: 14.48 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:32<02:12, 14.20it/s, est. speed input: 14832.00 toks/s, output: 14.48 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:34<02:11, 14.13it/s, est. speed input: 14824.01 toks/s, output: 14.48 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:37<02:08, 14.15it/s, est. speed input: 14820.27 toks/s, output: 14.47 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:39<02:07, 14.09it/s, est. speed input: 14812.52 toks/s, output: 14.47 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:41<02:04, 14.11it/s, est. speed input: 14807.93 toks/s, output: 14.46 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:43<02:00, 14.31it/s, est. speed input: 14812.36 toks/s, output: 14.47 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:46<01:58, 14.30it/s, est. speed input: 14809.69 toks/s, output: 14.46 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:48<01:57, 14.18it/s, est. speed input: 14802.22 toks/s, output: 14.46 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:50<01:55, 14.12it/s, est. speed input: 14795.39 toks/s, output: 14.45 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:52<01:52, 14.16it/s, est. speed input: 14792.86 toks/s, output: 14.45 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:55<01:51, 14.09it/s, est. speed input: 14786.00 toks/s, output: 14.44 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:57<01:48, 14.15it/s, est. speed input: 14783.87 toks/s, output: 14.44 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:59<01:46, 14.09it/s, est. speed input: 14777.61 toks/s, output: 14.43 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [03:02<01:44, 14.05it/s, est. speed input: 14771.57 toks/s, output: 14.43 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [03:04<01:42, 14.03it/s, est. speed input: 14765.77 toks/s, output: 14.42 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [03:06<01:39, 14.10it/s, est. speed input: 14763.81 toks/s, output: 14.42 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [03:08<01:37, 14.06it/s, est. speed input: 14758.22 toks/s, output: 14.41 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [03:11<01:35, 14.02it/s, est. speed input: 14752.27 toks/s, output: 14.41 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [03:13<01:33, 13.94it/s, est. speed input: 14744.29 toks/s, output: 14.40 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [03:15<01:31, 13.95it/s, est. speed input: 14739.33 toks/s, output: 14.39 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [03:18<01:28, 14.04it/s, est. speed input: 14737.82 toks/s, output: 14.39 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [03:20<01:26, 14.02it/s, est. speed input: 14732.91 toks/s, output: 14.39 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [03:22<01:24, 14.00it/s, est. speed input: 14727.65 toks/s, output: 14.38 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [03:24<01:22, 13.98it/s, est. speed input: 14722.54 toks/s, output: 14.38 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [03:27<01:20, 13.97it/s, est. speed input: 14717.80 toks/s, output: 14.37 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [03:29<01:17, 13.97it/s, est. speed input: 14713.08 toks/s, output: 14.37 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [03:31<01:15, 13.97it/s, est. speed input: 14708.63 toks/s, output: 14.36 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [03:34<01:13, 13.97it/s, est. speed input: 14704.40 toks/s, output: 14.36 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [03:36<01:09, 14.21it/s, est. speed input: 14708.86 toks/s, output: 14.36 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [03:38<01:07, 14.22it/s, est. speed input: 14707.51 toks/s, output: 14.36 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [03:40<01:05, 14.14it/s, est. speed input: 14703.20 toks/s, output: 14.36 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:43<01:03, 14.07it/s, est. speed input: 14698.45 toks/s, output: 14.35 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:45<01:01, 14.12it/s, est. speed input: 14697.37 toks/s, output: 14.35 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:47<00:58, 14.07it/s, est. speed input: 14693.35 toks/s, output: 14.35 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:49<00:56, 14.04it/s, est. speed input: 14689.43 toks/s, output: 14.35 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:52<00:54, 14.02it/s, est. speed input: 14685.50 toks/s, output: 14.34 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:54<00:52, 14.00it/s, est. speed input: 14681.56 toks/s, output: 14.34 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:56<00:50, 13.99it/s, est. speed input: 14677.85 toks/s, output: 14.33 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:59<00:47, 14.05it/s, est. speed input: 14676.69 toks/s, output: 14.33 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [04:01<00:45, 14.03it/s, est. speed input: 14673.10 toks/s, output: 14.33 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [04:03<00:42, 14.25it/s, est. speed input: 14677.36 toks/s, output: 14.33 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [04:05<00:40, 14.17it/s, est. speed input: 14674.02 toks/s, output: 14.33 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [04:08<00:38, 14.11it/s, est. speed input: 14670.57 toks/s, output: 14.33 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [04:10<00:36, 14.05it/s, est. speed input: 14666.85 toks/s, output: 14.32 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [04:12<00:34, 14.03it/s, est. speed input: 14663.50 toks/s, output: 14.32 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [04:14<00:31, 14.00it/s, est. speed input: 14659.95 toks/s, output: 14.32 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [04:17<00:29, 13.98it/s, est. speed input: 14656.47 toks/s, output: 14.31 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [04:19<00:27, 14.06it/s, est. speed input: 14655.79 toks/s, output: 14.31 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [04:21<00:24, 14.03it/s, est. speed input: 14652.59 toks/s, output: 14.31 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [04:24<00:22, 14.01it/s, est. speed input: 14649.55 toks/s, output: 14.31 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [04:26<00:20, 14.00it/s, est. speed input: 14646.64 toks/s, output: 14.30 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [04:28<00:18, 14.07it/s, est. speed input: 14646.19 toks/s, output: 14.30 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [04:30<00:15, 14.04it/s, est. speed input: 14643.19 toks/s, output: 14.30 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [04:33<00:13, 14.00it/s, est. speed input: 14639.95 toks/s, output: 14.30 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [04:35<00:11, 13.99it/s, est. speed input: 14637.10 toks/s, output: 14.29 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [04:37<00:09, 13.98it/s, est. speed input: 14634.36 toks/s, output: 14.29 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [04:40<00:06, 13.98it/s, est. speed input: 14631.63 toks/s, output: 14.29 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [04:42<00:04, 14.32it/s, est. speed input: 14638.58 toks/s, output: 14.30 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [04:44<00:02, 14.31it/s, est. speed input: 14638.32 toks/s, output: 14.30 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:44<00:00, 14.31it/s, est. speed input: 14746.31 toks/s, output: 14.40 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:44<00:00, 14.40it/s, est. speed input: 14746.31 toks/s, output: 14.40 toks/s]
[rank0]:[W128 09:30:52.847483187 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 342.7s

测试结果:
  Requests/s:   14.02
  Tokens/s:     14374.44
  Total Reqs:   4096
  Elapsed:      292.07s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     14360.42


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_8/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,27.5589,14137.7112,4.6446
1024,1024,1,128,128,14.6457,15011.8280,8.7398
2048,1024,2,256,128,14.8404,15211.3875,17.2502
4096,1024,4,512,128,14.0701,14421.8613,36.3892
8192,1024,8,1024,128,14.1364,14489.8556,72.4369
16384,1024,16,2048,128,14.3883,14748.0255,142.3377
32768,1024,32,4096,128,14.0238,14374.4418,292.0739

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败

============================================================
  BitNet-2B-FP8 | cuSPARSELt (2_10) | prefill
============================================================

[INFO] Checkpoint: /root/vllmbench/checkpoints_slidesparse/BitNet-2B-FP8-SlideSparse-2_10
[INFO] Output: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_10

============================================================
[1/7] 测试 M=512
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 512
│   M_prefill     = 512 (= 1 x 512)
│   M_decode      = 1
│   batched_tokens = 513 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 512
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 513
│   --max-num-batched-tokens = 513
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:30:58 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:30:58 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3749552) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3749552) WARNING 01-28 09:31:29 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 25.94 requests/s, 13307.47 total tokens/s, 25.94 output tokens/s
Total num prompt tokens:  65536
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:30:58] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:30:58] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:30:58] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:30:58] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:30:58] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:30:58] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:30:58] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:30:58] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:30:58] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:31:02] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:31:02] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:31:02] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:02] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:31:02] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:31:02] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:31:02] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:31:02] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:31:02] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:03] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3749552) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3749552) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:18<00:00, 18.10s/it]
(EngineCore_DP0 pid=3749552) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:18<00:00, 18.10s/it]
(EngineCore_DP0 pid=3749552) 
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3749552) [2026-01-28 09:31:22] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3749552) 2026-01-28 09:31:28,527 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3749552) 2026-01-28 09:31:28,544 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  97%|█████████▋| 124/128 [00:00<00:00, 1232.79it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 1231.39it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:20,  6.32it/s, est. speed input: 3236.75 toks/s, output: 6.32 toks/s]
Processed prompts:   3%|▎         | 4/128 [00:00<00:07, 16.98it/s, est. speed input: 7717.50 toks/s, output: 15.07 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:05, 21.34it/s, est. speed input: 9564.30 toks/s, output: 18.68 toks/s]
Processed prompts:   8%|▊         | 10/128 [00:00<00:05, 23.58it/s, est. speed input: 10565.57 toks/s, output: 20.64 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:04, 23.47it/s, est. speed input: 10851.14 toks/s, output: 21.19 toks/s]
Processed prompts:  12%|█▎        | 16/128 [00:00<00:04, 24.69it/s, est. speed input: 11325.34 toks/s, output: 22.12 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:00<00:04, 25.41it/s, est. speed input: 11656.33 toks/s, output: 22.77 toks/s]
Processed prompts:  17%|█▋        | 22/128 [00:00<00:04, 26.12it/s, est. speed input: 11948.50 toks/s, output: 23.34 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:03, 26.60it/s, est. speed input: 12178.86 toks/s, output: 23.79 toks/s]
Processed prompts:  22%|██▏       | 28/128 [00:01<00:03, 26.45it/s, est. speed input: 12297.05 toks/s, output: 24.02 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:01<00:03, 26.69it/s, est. speed input: 12438.63 toks/s, output: 24.29 toks/s]
Processed prompts:  27%|██▋       | 34/128 [00:01<00:03, 26.91it/s, est. speed input: 12565.24 toks/s, output: 24.54 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:01<00:03, 27.05it/s, est. speed input: 12672.14 toks/s, output: 24.75 toks/s]
Processed prompts:  31%|███▏      | 40/128 [00:01<00:03, 27.03it/s, est. speed input: 12751.60 toks/s, output: 24.91 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:01<00:03, 27.25it/s, est. speed input: 12843.81 toks/s, output: 25.09 toks/s]
Processed prompts:  36%|███▌      | 46/128 [00:01<00:03, 27.29it/s, est. speed input: 12914.07 toks/s, output: 25.22 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:01<00:02, 27.26it/s, est. speed input: 12971.77 toks/s, output: 25.34 toks/s]
Processed prompts:  41%|████      | 52/128 [00:02<00:02, 27.28it/s, est. speed input: 13026.22 toks/s, output: 25.44 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:02<00:02, 27.44it/s, est. speed input: 13087.68 toks/s, output: 25.56 toks/s]
Processed prompts:  45%|████▌     | 58/128 [00:02<00:02, 26.90it/s, est. speed input: 13091.70 toks/s, output: 25.57 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:02<00:02, 27.13it/s, est. speed input: 13141.40 toks/s, output: 25.67 toks/s]
Processed prompts:  50%|█████     | 64/128 [00:02<00:02, 27.29it/s, est. speed input: 13185.62 toks/s, output: 25.75 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:02<00:02, 27.05it/s, est. speed input: 13202.37 toks/s, output: 25.79 toks/s]
Processed prompts:  55%|█████▍    | 70/128 [00:02<00:02, 27.29it/s, est. speed input: 13244.59 toks/s, output: 25.87 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:02<00:02, 27.29it/s, est. speed input: 13273.37 toks/s, output: 25.92 toks/s]
Processed prompts:  59%|█████▉    | 76/128 [00:02<00:01, 27.38it/s, est. speed input: 13305.18 toks/s, output: 25.99 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:03<00:01, 27.44it/s, est. speed input: 13334.34 toks/s, output: 26.04 toks/s]
Processed prompts:  64%|██████▍   | 82/128 [00:03<00:01, 27.37it/s, est. speed input: 13355.44 toks/s, output: 26.08 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:03<00:01, 26.94it/s, est. speed input: 13353.24 toks/s, output: 26.08 toks/s]
Processed prompts:  69%|██████▉   | 88/128 [00:03<00:01, 27.02it/s, est. speed input: 13372.38 toks/s, output: 26.12 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:03<00:01, 27.14it/s, est. speed input: 13393.11 toks/s, output: 26.16 toks/s]
Processed prompts:  73%|███████▎  | 94/128 [00:03<00:01, 27.30it/s, est. speed input: 13417.07 toks/s, output: 26.21 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:03<00:01, 27.30it/s, est. speed input: 13433.81 toks/s, output: 26.24 toks/s]
Processed prompts:  78%|███████▊  | 100/128 [00:03<00:01, 27.27it/s, est. speed input: 13447.77 toks/s, output: 26.27 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:03<00:00, 27.40it/s, est. speed input: 13468.40 toks/s, output: 26.31 toks/s]
Processed prompts:  83%|████████▎ | 106/128 [00:04<00:00, 27.43it/s, est. speed input: 13485.02 toks/s, output: 26.34 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:04<00:00, 27.22it/s, est. speed input: 13490.55 toks/s, output: 26.35 toks/s]
Processed prompts:  88%|████████▊ | 112/128 [00:04<00:00, 27.36it/s, est. speed input: 13507.91 toks/s, output: 26.38 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:04<00:00, 27.02it/s, est. speed input: 13506.27 toks/s, output: 26.38 toks/s]
Processed prompts:  92%|█████████▏| 118/128 [00:04<00:00, 27.22it/s, est. speed input: 13522.80 toks/s, output: 26.41 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:04<00:00, 27.30it/s, est. speed input: 13535.97 toks/s, output: 26.44 toks/s]
Processed prompts:  97%|█████████▋| 124/128 [00:04<00:00, 27.46it/s, est. speed input: 13552.42 toks/s, output: 26.47 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:04<00:00, 27.53it/s, est. speed input: 13566.59 toks/s, output: 26.50 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 27.53it/s, est. speed input: 13570.36 toks/s, output: 26.50 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:04<00:00, 26.50it/s, est. speed input: 13570.36 toks/s, output: 26.50 toks/s]
[rank0]:[W128 09:31:34.315532224 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 41.4s

测试结果:
  Requests/s:   25.94
  Tokens/s:     13307.47
  Total Reqs:   128
  Elapsed:      4.93s

  [Prefill 分析]
  Total Prefill Tokens: 65536
  Prefill Tokens/s:     13281.53

============================================================
[2/7] 测试 M=1024
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 1024
│   M_prefill     = 1024 (= 1 x 1024)
│   M_decode      = 1
│   batched_tokens = 1025 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 128
│   --max-num-seqs           = 1
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 1025
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:31:40 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:31:40 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3750339) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3750339) WARNING 01-28 09:32:09 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.23 requests/s, 14587.68 total tokens/s, 14.23 output tokens/s
Total num prompt tokens:  131072
Total num output tokens:  128


─── STDERR ───
[2026-01-28 09:31:40] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:31:40] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:31:40] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:40] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:31:40] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:31:40] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:31:40] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:31:40] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:31:40] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:31:43] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:31:43] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:31:43] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:31:43] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:31:43] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:31:43] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:31:43] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:31:43] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:31:43] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3750339) [2026-01-28 09:31:44] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3750339) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3750339) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.46s/it]
(EngineCore_DP0 pid=3750339) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.46s/it]
(EngineCore_DP0 pid=3750339) 
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3750339) [2026-01-28 09:32:03] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3750339) 2026-01-28 09:32:08,768 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3750339) 2026-01-28 09:32:08,780 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/128 [00:00<?, ?it/s]
Adding requests:  53%|█████▎    | 68/128 [00:00<00:00, 679.63it/s]
Adding requests: 100%|██████████| 128/128 [00:00<00:00, 681.52it/s]

Processed prompts:   0%|          | 0/128 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   1%|          | 1/128 [00:00<00:14,  8.72it/s, est. speed input: 8927.30 toks/s, output: 8.72 toks/s]
Processed prompts:   2%|▏         | 3/128 [00:00<00:10, 12.40it/s, est. speed input: 12184.57 toks/s, output: 11.90 toks/s]
Processed prompts:   4%|▍         | 5/128 [00:00<00:09, 13.33it/s, est. speed input: 13080.01 toks/s, output: 12.77 toks/s]
Processed prompts:   5%|▌         | 7/128 [00:00<00:08, 13.89it/s, est. speed input: 13596.49 toks/s, output: 13.28 toks/s]
Processed prompts:   7%|▋         | 9/128 [00:00<00:08, 14.14it/s, est. speed input: 13872.79 toks/s, output: 13.55 toks/s]
Processed prompts:   9%|▊         | 11/128 [00:00<00:08, 14.15it/s, est. speed input: 13983.41 toks/s, output: 13.66 toks/s]
Processed prompts:  10%|█         | 13/128 [00:00<00:08, 14.31it/s, est. speed input: 14130.08 toks/s, output: 13.80 toks/s]
Processed prompts:  12%|█▏        | 15/128 [00:01<00:07, 14.52it/s, est. speed input: 14280.07 toks/s, output: 13.95 toks/s]
Processed prompts:  13%|█▎        | 17/128 [00:01<00:07, 14.61it/s, est. speed input: 14377.53 toks/s, output: 14.04 toks/s]
Processed prompts:  15%|█▍        | 19/128 [00:01<00:07, 14.57it/s, est. speed input: 14425.20 toks/s, output: 14.09 toks/s]
Processed prompts:  16%|█▋        | 21/128 [00:01<00:07, 14.57it/s, est. speed input: 14471.30 toks/s, output: 14.13 toks/s]
Processed prompts:  18%|█▊        | 23/128 [00:01<00:07, 14.58it/s, est. speed input: 14511.51 toks/s, output: 14.17 toks/s]
Processed prompts:  20%|█▉        | 25/128 [00:01<00:07, 14.65it/s, est. speed input: 14561.10 toks/s, output: 14.22 toks/s]
Processed prompts:  21%|██        | 27/128 [00:01<00:06, 14.46it/s, est. speed input: 14547.79 toks/s, output: 14.21 toks/s]
Processed prompts:  23%|██▎       | 29/128 [00:02<00:06, 14.51it/s, est. speed input: 14576.54 toks/s, output: 14.23 toks/s]
Processed prompts:  24%|██▍       | 31/128 [00:02<00:06, 14.57it/s, est. speed input: 14606.68 toks/s, output: 14.26 toks/s]
Processed prompts:  26%|██▌       | 33/128 [00:02<00:06, 14.63it/s, est. speed input: 14637.91 toks/s, output: 14.29 toks/s]
Processed prompts:  27%|██▋       | 35/128 [00:02<00:06, 14.61it/s, est. speed input: 14653.77 toks/s, output: 14.31 toks/s]
Processed prompts:  29%|██▉       | 37/128 [00:02<00:06, 14.69it/s, est. speed input: 14684.35 toks/s, output: 14.34 toks/s]
Processed prompts:  30%|███       | 39/128 [00:02<00:06, 14.80it/s, est. speed input: 14720.88 toks/s, output: 14.38 toks/s]
Processed prompts:  32%|███▏      | 41/128 [00:02<00:05, 14.64it/s, est. speed input: 14715.08 toks/s, output: 14.37 toks/s]
Processed prompts:  34%|███▎      | 43/128 [00:02<00:05, 14.62it/s, est. speed input: 14724.45 toks/s, output: 14.38 toks/s]
Processed prompts:  35%|███▌      | 45/128 [00:03<00:05, 14.68it/s, est. speed input: 14744.97 toks/s, output: 14.40 toks/s]
Processed prompts:  37%|███▋      | 47/128 [00:03<00:05, 14.66it/s, est. speed input: 14754.25 toks/s, output: 14.41 toks/s]
Processed prompts:  38%|███▊      | 49/128 [00:03<00:05, 14.66it/s, est. speed input: 14764.57 toks/s, output: 14.42 toks/s]
Processed prompts:  40%|███▉      | 51/128 [00:03<00:05, 14.65it/s, est. speed input: 14772.80 toks/s, output: 14.43 toks/s]
Processed prompts:  41%|████▏     | 53/128 [00:03<00:05, 14.66it/s, est. speed input: 14782.40 toks/s, output: 14.44 toks/s]
Processed prompts:  43%|████▎     | 55/128 [00:03<00:04, 14.75it/s, est. speed input: 14801.36 toks/s, output: 14.45 toks/s]
Processed prompts:  45%|████▍     | 57/128 [00:03<00:04, 14.56it/s, est. speed input: 14789.89 toks/s, output: 14.44 toks/s]
Processed prompts:  46%|████▌     | 59/128 [00:04<00:04, 14.51it/s, est. speed input: 14788.06 toks/s, output: 14.44 toks/s]
Processed prompts:  48%|████▊     | 61/128 [00:04<00:04, 14.61it/s, est. speed input: 14801.24 toks/s, output: 14.45 toks/s]
Processed prompts:  49%|████▉     | 63/128 [00:04<00:04, 14.72it/s, est. speed input: 14817.80 toks/s, output: 14.47 toks/s]
Processed prompts:  51%|█████     | 65/128 [00:04<00:04, 14.71it/s, est. speed input: 14824.72 toks/s, output: 14.48 toks/s]
Processed prompts:  52%|█████▏    | 67/128 [00:04<00:04, 14.70it/s, est. speed input: 14830.42 toks/s, output: 14.48 toks/s]
Processed prompts:  54%|█████▍    | 69/128 [00:04<00:04, 14.73it/s, est. speed input: 14839.42 toks/s, output: 14.49 toks/s]
Processed prompts:  55%|█████▌    | 71/128 [00:04<00:03, 14.72it/s, est. speed input: 14845.59 toks/s, output: 14.50 toks/s]
Processed prompts:  57%|█████▋    | 73/128 [00:05<00:03, 14.51it/s, est. speed input: 14832.21 toks/s, output: 14.48 toks/s]
Processed prompts:  59%|█████▊    | 75/128 [00:05<00:03, 14.54it/s, est. speed input: 14835.59 toks/s, output: 14.49 toks/s]
Processed prompts:  60%|██████    | 77/128 [00:05<00:03, 14.61it/s, est. speed input: 14842.97 toks/s, output: 14.50 toks/s]
Processed prompts:  62%|██████▏   | 79/128 [00:05<00:03, 14.58it/s, est. speed input: 14843.99 toks/s, output: 14.50 toks/s]
Processed prompts:  63%|██████▎   | 81/128 [00:05<00:03, 14.61it/s, est. speed input: 14848.45 toks/s, output: 14.50 toks/s]
Processed prompts:  65%|██████▍   | 83/128 [00:05<00:03, 14.63it/s, est. speed input: 14852.46 toks/s, output: 14.50 toks/s]
Processed prompts:  66%|██████▋   | 85/128 [00:05<00:02, 14.58it/s, est. speed input: 14851.46 toks/s, output: 14.50 toks/s]
Processed prompts:  68%|██████▊   | 87/128 [00:05<00:02, 14.67it/s, est. speed input: 14860.43 toks/s, output: 14.51 toks/s]
Processed prompts:  70%|██████▉   | 89/128 [00:06<00:02, 14.51it/s, est. speed input: 14852.02 toks/s, output: 14.50 toks/s]
Processed prompts:  71%|███████   | 91/128 [00:06<00:02, 14.54it/s, est. speed input: 14853.98 toks/s, output: 14.51 toks/s]
Processed prompts:  73%|███████▎  | 93/128 [00:06<00:02, 14.58it/s, est. speed input: 14857.86 toks/s, output: 14.51 toks/s]
Processed prompts:  74%|███████▍  | 95/128 [00:06<00:02, 14.56it/s, est. speed input: 14858.24 toks/s, output: 14.51 toks/s]
Processed prompts:  76%|███████▌  | 97/128 [00:06<00:02, 14.60it/s, est. speed input: 14862.08 toks/s, output: 14.51 toks/s]
Processed prompts:  77%|███████▋  | 99/128 [00:06<00:01, 14.60it/s, est. speed input: 14863.42 toks/s, output: 14.52 toks/s]
Processed prompts:  79%|███████▉  | 101/128 [00:06<00:01, 14.64it/s, est. speed input: 14867.75 toks/s, output: 14.52 toks/s]
Processed prompts:  80%|████████  | 103/128 [00:07<00:01, 14.54it/s, est. speed input: 14863.42 toks/s, output: 14.52 toks/s]
Processed prompts:  82%|████████▏ | 105/128 [00:07<00:01, 14.55it/s, est. speed input: 14864.49 toks/s, output: 14.52 toks/s]
Processed prompts:  84%|████████▎ | 107/128 [00:07<00:01, 14.51it/s, est. speed input: 14862.71 toks/s, output: 14.51 toks/s]
Processed prompts:  85%|████████▌ | 109/128 [00:07<00:01, 14.60it/s, est. speed input: 14868.43 toks/s, output: 14.52 toks/s]
Processed prompts:  87%|████████▋ | 111/128 [00:07<00:01, 14.61it/s, est. speed input: 14870.71 toks/s, output: 14.52 toks/s]
Processed prompts:  88%|████████▊ | 113/128 [00:07<00:01, 14.72it/s, est. speed input: 14878.52 toks/s, output: 14.53 toks/s]
Processed prompts:  90%|████████▉ | 115/128 [00:07<00:00, 14.65it/s, est. speed input: 14878.00 toks/s, output: 14.53 toks/s]
Processed prompts:  91%|█████████▏| 117/128 [00:08<00:00, 14.63it/s, est. speed input: 14878.95 toks/s, output: 14.53 toks/s]
Processed prompts:  93%|█████████▎| 119/128 [00:08<00:00, 14.53it/s, est. speed input: 14875.06 toks/s, output: 14.53 toks/s]
Processed prompts:  95%|█████████▍| 121/128 [00:08<00:00, 14.55it/s, est. speed input: 14876.00 toks/s, output: 14.53 toks/s]
Processed prompts:  96%|█████████▌| 123/128 [00:08<00:00, 14.63it/s, est. speed input: 14881.05 toks/s, output: 14.53 toks/s]
Processed prompts:  98%|█████████▊| 125/128 [00:08<00:00, 14.64it/s, est. speed input: 14882.98 toks/s, output: 14.53 toks/s]
Processed prompts:  99%|█████████▉| 127/128 [00:08<00:00, 14.68it/s, est. speed input: 14886.87 toks/s, output: 14.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.68it/s, est. speed input: 14885.79 toks/s, output: 14.54 toks/s]
Processed prompts: 100%|██████████| 128/128 [00:08<00:00, 14.54it/s, est. speed input: 14885.79 toks/s, output: 14.54 toks/s]
[rank0]:[W128 09:32:18.550810400 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 44.1s

测试结果:
  Requests/s:   14.23
  Tokens/s:     14587.68
  Total Reqs:   128
  Elapsed:      8.99s

  [Prefill 分析]
  Total Prefill Tokens: 131072
  Prefill Tokens/s:     14573.45

============================================================
[3/7] 测试 M=2048
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 2048
│   M_prefill     = 2048 (= 2 x 1024)
│   M_decode      = 2
│   batched_tokens = 2048 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 256
│   --max-num-seqs           = 2
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 2048
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:32:24 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:32:25 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3751146) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3751146) WARNING 01-28 09:32:54 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.35 requests/s, 14707.68 total tokens/s, 14.35 output tokens/s
Total num prompt tokens:  262144
Total num output tokens:  256


─── STDERR ───
[2026-01-28 09:32:24] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:32:24] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:32:24] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:24] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:32:24] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:32:24] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:32:24] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:32:24] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:32:24] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:32:28] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:32:28] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:32:28] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:32:28] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:32:28] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:32:28] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:32:28] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:32:28] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:32:28] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:29] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3751146) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3751146) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.74s/it]
(EngineCore_DP0 pid=3751146) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.74s/it]
(EngineCore_DP0 pid=3751146) 
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3751146) [2026-01-28 09:32:47] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3751146) 2026-01-28 09:32:53,571 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3751146) 2026-01-28 09:32:53,583 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/256 [00:00<?, ?it/s]
Adding requests:  25%|██▌       | 64/256 [00:00<00:00, 630.17it/s]
Adding requests:  50%|█████     | 128/256 [00:00<00:00, 585.26it/s]
Adding requests:  73%|███████▎  | 187/256 [00:00<00:00, 571.95it/s]
Adding requests:  96%|█████████▌| 245/256 [00:00<00:00, 564.10it/s]
Adding requests: 100%|██████████| 256/256 [00:00<00:00, 574.29it/s]

Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 6/256 [00:00<00:08, 28.54it/s, est. speed input: 29228.17 toks/s, output: 28.54 toks/s]
Processed prompts:   4%|▎         | 9/256 [00:00<00:09, 25.20it/s, est. speed input: 26426.66 toks/s, output: 25.81 toks/s]
Processed prompts:   5%|▍         | 12/256 [00:00<00:14, 16.97it/s, est. speed input: 19742.45 toks/s, output: 19.28 toks/s]
Processed prompts:   5%|▌         | 14/256 [00:00<00:14, 16.16it/s, est. speed input: 18792.53 toks/s, output: 18.35 toks/s]
Processed prompts:   6%|▋         | 16/256 [00:00<00:15, 15.67it/s, est. speed input: 18189.87 toks/s, output: 17.76 toks/s]
Processed prompts:   7%|▋         | 18/256 [00:01<00:15, 15.39it/s, est. speed input: 17781.17 toks/s, output: 17.36 toks/s]
Processed prompts:   8%|▊         | 20/256 [00:01<00:15, 15.24it/s, est. speed input: 17488.98 toks/s, output: 17.08 toks/s]
Processed prompts:   9%|▊         | 22/256 [00:01<00:15, 15.00it/s, est. speed input: 17203.17 toks/s, output: 16.80 toks/s]
Processed prompts:   9%|▉         | 24/256 [00:01<00:15, 14.90it/s, est. speed input: 16995.21 toks/s, output: 16.60 toks/s]
Processed prompts:  10%|█         | 26/256 [00:01<00:15, 14.75it/s, est. speed input: 16799.86 toks/s, output: 16.41 toks/s]
Processed prompts:  11%|█         | 28/256 [00:01<00:15, 14.64it/s, est. speed input: 16631.55 toks/s, output: 16.24 toks/s]
Processed prompts:  12%|█▏        | 30/256 [00:01<00:15, 14.45it/s, est. speed input: 16458.84 toks/s, output: 16.07 toks/s]
Processed prompts:  12%|█▎        | 32/256 [00:02<00:15, 14.49it/s, est. speed input: 16354.62 toks/s, output: 15.97 toks/s]
Processed prompts:  13%|█▎        | 34/256 [00:02<00:15, 14.49it/s, est. speed input: 16257.27 toks/s, output: 15.88 toks/s]
Processed prompts:  14%|█▍        | 36/256 [00:02<00:15, 14.62it/s, est. speed input: 16200.43 toks/s, output: 15.82 toks/s]
Processed prompts:  15%|█▍        | 38/256 [00:02<00:14, 14.62it/s, est. speed input: 16131.41 toks/s, output: 15.75 toks/s]
Processed prompts:  16%|█▌        | 40/256 [00:02<00:14, 14.66it/s, est. speed input: 16075.91 toks/s, output: 15.70 toks/s]
Processed prompts:  16%|█▋        | 42/256 [00:02<00:14, 14.59it/s, est. speed input: 16009.26 toks/s, output: 15.63 toks/s]
Processed prompts:  17%|█▋        | 44/256 [00:02<00:14, 14.64it/s, est. speed input: 15965.82 toks/s, output: 15.59 toks/s]
Processed prompts:  18%|█▊        | 46/256 [00:02<00:14, 14.51it/s, est. speed input: 15899.65 toks/s, output: 15.53 toks/s]
Processed prompts:  19%|█▉        | 48/256 [00:03<00:14, 14.56it/s, est. speed input: 15861.28 toks/s, output: 15.49 toks/s]
Processed prompts:  20%|█▉        | 50/256 [00:03<00:14, 14.54it/s, est. speed input: 15817.54 toks/s, output: 15.45 toks/s]
Processed prompts:  20%|██        | 52/256 [00:03<00:14, 14.49it/s, est. speed input: 15772.42 toks/s, output: 15.40 toks/s]
Processed prompts:  21%|██        | 54/256 [00:03<00:13, 14.55it/s, est. speed input: 15744.03 toks/s, output: 15.37 toks/s]
Processed prompts:  22%|██▏       | 56/256 [00:03<00:13, 14.59it/s, est. speed input: 15717.69 toks/s, output: 15.35 toks/s]
Processed prompts:  23%|██▎       | 58/256 [00:03<00:13, 14.65it/s, est. speed input: 15697.40 toks/s, output: 15.33 toks/s]
Processed prompts:  23%|██▎       | 60/256 [00:03<00:13, 14.59it/s, est. speed input: 15665.40 toks/s, output: 15.30 toks/s]
Processed prompts:  24%|██▍       | 62/256 [00:04<00:13, 14.53it/s, est. speed input: 15633.46 toks/s, output: 15.27 toks/s]
Processed prompts:  25%|██▌       | 64/256 [00:04<00:13, 14.55it/s, est. speed input: 15611.44 toks/s, output: 15.25 toks/s]
Processed prompts:  26%|██▌       | 66/256 [00:04<00:13, 14.57it/s, est. speed input: 15590.94 toks/s, output: 15.23 toks/s]
Processed prompts:  27%|██▋       | 68/256 [00:04<00:12, 14.62it/s, est. speed input: 15575.34 toks/s, output: 15.21 toks/s]
Processed prompts:  27%|██▋       | 70/256 [00:04<00:12, 14.56it/s, est. speed input: 15551.30 toks/s, output: 15.19 toks/s]
Processed prompts:  28%|██▊       | 72/256 [00:04<00:12, 14.59it/s, est. speed input: 15535.77 toks/s, output: 15.17 toks/s]
Processed prompts:  29%|██▉       | 74/256 [00:04<00:12, 14.55it/s, est. speed input: 15515.24 toks/s, output: 15.15 toks/s]
Processed prompts:  30%|██▉       | 76/256 [00:05<00:12, 14.40it/s, est. speed input: 15483.88 toks/s, output: 15.12 toks/s]
Processed prompts:  30%|███       | 78/256 [00:05<00:12, 14.35it/s, est. speed input: 15459.07 toks/s, output: 15.10 toks/s]
Processed prompts:  31%|███▏      | 80/256 [00:05<00:12, 14.45it/s, est. speed input: 15448.59 toks/s, output: 15.09 toks/s]
Processed prompts:  32%|███▏      | 82/256 [00:05<00:12, 14.47it/s, est. speed input: 15433.60 toks/s, output: 15.07 toks/s]
Processed prompts:  33%|███▎      | 84/256 [00:05<00:11, 14.48it/s, est. speed input: 15419.46 toks/s, output: 15.06 toks/s]
Processed prompts:  34%|███▎      | 86/256 [00:05<00:11, 14.47it/s, est. speed input: 15404.24 toks/s, output: 15.04 toks/s]
Processed prompts:  34%|███▍      | 88/256 [00:05<00:11, 14.50it/s, est. speed input: 15392.94 toks/s, output: 15.03 toks/s]
Processed prompts:  35%|███▌      | 90/256 [00:05<00:11, 14.53it/s, est. speed input: 15382.40 toks/s, output: 15.02 toks/s]
Processed prompts:  36%|███▌      | 92/256 [00:06<00:11, 14.31it/s, est. speed input: 15353.57 toks/s, output: 14.99 toks/s]
Processed prompts:  37%|███▋      | 94/256 [00:06<00:11, 14.36it/s, est. speed input: 15341.64 toks/s, output: 14.98 toks/s]
Processed prompts:  38%|███▊      | 96/256 [00:06<00:11, 14.41it/s, est. speed input: 15331.54 toks/s, output: 14.97 toks/s]
Processed prompts:  38%|███▊      | 98/256 [00:06<00:10, 14.42it/s, est. speed input: 15320.21 toks/s, output: 14.96 toks/s]
Processed prompts:  39%|███▉      | 100/256 [00:06<00:10, 14.42it/s, est. speed input: 15308.89 toks/s, output: 14.95 toks/s]
Processed prompts:  40%|███▉      | 102/256 [00:06<00:10, 14.53it/s, est. speed input: 15305.60 toks/s, output: 14.95 toks/s]
Processed prompts:  41%|████      | 104/256 [00:06<00:10, 14.56it/s, est. speed input: 15299.10 toks/s, output: 14.94 toks/s]
Processed prompts:  41%|████▏     | 106/256 [00:07<00:10, 14.41it/s, est. speed input: 15281.55 toks/s, output: 14.92 toks/s]
Processed prompts:  42%|████▏     | 108/256 [00:07<00:10, 14.40it/s, est. speed input: 15270.77 toks/s, output: 14.91 toks/s]
Processed prompts:  43%|████▎     | 110/256 [00:07<00:10, 14.48it/s, est. speed input: 15266.39 toks/s, output: 14.91 toks/s]
Processed prompts:  44%|████▍     | 112/256 [00:07<00:09, 14.45it/s, est. speed input: 15256.05 toks/s, output: 14.90 toks/s]
Processed prompts:  45%|████▍     | 114/256 [00:07<00:09, 14.48it/s, est. speed input: 15249.76 toks/s, output: 14.89 toks/s]
Processed prompts:  45%|████▌     | 116/256 [00:07<00:09, 14.53it/s, est. speed input: 15245.59 toks/s, output: 14.89 toks/s]
Processed prompts:  46%|████▌     | 118/256 [00:07<00:09, 14.55it/s, est. speed input: 15240.12 toks/s, output: 14.88 toks/s]
Processed prompts:  47%|████▋     | 120/256 [00:08<00:09, 14.54it/s, est. speed input: 15233.66 toks/s, output: 14.88 toks/s]
Processed prompts:  48%|████▊     | 122/256 [00:08<00:09, 14.38it/s, est. speed input: 15218.60 toks/s, output: 14.86 toks/s]
Processed prompts:  48%|████▊     | 124/256 [00:08<00:09, 14.42it/s, est. speed input: 15212.87 toks/s, output: 14.86 toks/s]
Processed prompts:  49%|████▉     | 126/256 [00:08<00:08, 14.49it/s, est. speed input: 15209.24 toks/s, output: 14.85 toks/s]
Processed prompts:  50%|█████     | 128/256 [00:08<00:08, 14.50it/s, est. speed input: 15203.90 toks/s, output: 14.85 toks/s]
Processed prompts:  51%|█████     | 130/256 [00:08<00:08, 14.51it/s, est. speed input: 15198.60 toks/s, output: 14.84 toks/s]
Processed prompts:  52%|█████▏    | 132/256 [00:08<00:08, 14.53it/s, est. speed input: 15194.43 toks/s, output: 14.84 toks/s]
Processed prompts:  52%|█████▏    | 134/256 [00:09<00:08, 14.58it/s, est. speed input: 15192.26 toks/s, output: 14.84 toks/s]
Processed prompts:  53%|█████▎    | 136/256 [00:09<00:08, 14.56it/s, est. speed input: 15187.60 toks/s, output: 14.83 toks/s]
Processed prompts:  54%|█████▍    | 138/256 [00:09<00:08, 14.39it/s, est. speed input: 15174.63 toks/s, output: 14.82 toks/s]
Processed prompts:  55%|█████▍    | 140/256 [00:09<00:08, 14.39it/s, est. speed input: 15167.84 toks/s, output: 14.81 toks/s]
Processed prompts:  55%|█████▌    | 142/256 [00:09<00:07, 14.41it/s, est. speed input: 15162.66 toks/s, output: 14.81 toks/s]
Processed prompts:  56%|█████▋    | 144/256 [00:09<00:07, 14.45it/s, est. speed input: 15159.14 toks/s, output: 14.80 toks/s]
Processed prompts:  57%|█████▋    | 146/256 [00:09<00:07, 14.43it/s, est. speed input: 15152.92 toks/s, output: 14.80 toks/s]
Processed prompts:  58%|█████▊    | 148/256 [00:10<00:07, 14.40it/s, est. speed input: 15146.19 toks/s, output: 14.79 toks/s]
Processed prompts:  59%|█████▊    | 150/256 [00:10<00:07, 14.44it/s, est. speed input: 15142.64 toks/s, output: 14.79 toks/s]
Processed prompts:  59%|█████▉    | 152/256 [00:10<00:07, 14.30it/s, est. speed input: 15131.39 toks/s, output: 14.78 toks/s]
Processed prompts:  60%|██████    | 154/256 [00:10<00:07, 14.38it/s, est. speed input: 15128.36 toks/s, output: 14.77 toks/s]
Processed prompts:  61%|██████    | 156/256 [00:10<00:06, 14.51it/s, est. speed input: 15129.05 toks/s, output: 14.77 toks/s]
Processed prompts:  62%|██████▏   | 158/256 [00:10<00:06, 14.43it/s, est. speed input: 15122.04 toks/s, output: 14.77 toks/s]
Processed prompts:  62%|██████▎   | 160/256 [00:10<00:06, 14.51it/s, est. speed input: 15121.22 toks/s, output: 14.77 toks/s]
Processed prompts:  63%|██████▎   | 162/256 [00:10<00:06, 14.61it/s, est. speed input: 15122.08 toks/s, output: 14.77 toks/s]
Processed prompts:  64%|██████▍   | 164/256 [00:11<00:06, 14.62it/s, est. speed input: 15120.66 toks/s, output: 14.77 toks/s]
Processed prompts:  65%|██████▍   | 166/256 [00:11<00:06, 14.56it/s, est. speed input: 15116.08 toks/s, output: 14.76 toks/s]
Processed prompts:  66%|██████▌   | 168/256 [00:11<00:06, 14.35it/s, est. speed input: 15104.81 toks/s, output: 14.75 toks/s]
Processed prompts:  66%|██████▋   | 170/256 [00:11<00:05, 14.41it/s, est. speed input: 15102.37 toks/s, output: 14.75 toks/s]
Processed prompts:  67%|██████▋   | 172/256 [00:11<00:05, 14.46it/s, est. speed input: 15100.23 toks/s, output: 14.75 toks/s]
Processed prompts:  68%|██████▊   | 174/256 [00:11<00:05, 14.44it/s, est. speed input: 15096.21 toks/s, output: 14.74 toks/s]
Processed prompts:  69%|██████▉   | 176/256 [00:11<00:05, 14.44it/s, est. speed input: 15092.36 toks/s, output: 14.74 toks/s]
Processed prompts:  70%|██████▉   | 178/256 [00:12<00:05, 14.46it/s, est. speed input: 15089.90 toks/s, output: 14.74 toks/s]
Processed prompts:  70%|███████   | 180/256 [00:12<00:05, 14.49it/s, est. speed input: 15087.89 toks/s, output: 14.73 toks/s]
Processed prompts:  71%|███████   | 182/256 [00:12<00:05, 14.50it/s, est. speed input: 15085.24 toks/s, output: 14.73 toks/s]
Processed prompts:  72%|███████▏  | 184/256 [00:12<00:04, 14.42it/s, est. speed input: 15079.54 toks/s, output: 14.73 toks/s]
Processed prompts:  73%|███████▎  | 186/256 [00:12<00:04, 14.53it/s, est. speed input: 15080.42 toks/s, output: 14.73 toks/s]
Processed prompts:  73%|███████▎  | 188/256 [00:12<00:04, 14.51it/s, est. speed input: 15077.34 toks/s, output: 14.72 toks/s]
Processed prompts:  74%|███████▍  | 190/256 [00:12<00:04, 14.51it/s, est. speed input: 15075.15 toks/s, output: 14.72 toks/s]
Processed prompts:  75%|███████▌  | 192/256 [00:13<00:04, 14.52it/s, est. speed input: 15073.03 toks/s, output: 14.72 toks/s]
Processed prompts:  76%|███████▌  | 194/256 [00:13<00:04, 14.53it/s, est. speed input: 15071.35 toks/s, output: 14.72 toks/s]
Processed prompts:  77%|███████▋  | 196/256 [00:13<00:04, 14.50it/s, est. speed input: 15068.44 toks/s, output: 14.72 toks/s]
Processed prompts:  77%|███████▋  | 198/256 [00:13<00:04, 14.38it/s, est. speed input: 15061.75 toks/s, output: 14.71 toks/s]
Processed prompts:  78%|███████▊  | 200/256 [00:13<00:03, 14.40it/s, est. speed input: 15058.92 toks/s, output: 14.71 toks/s]
Processed prompts:  79%|███████▉  | 202/256 [00:13<00:03, 14.50it/s, est. speed input: 15059.43 toks/s, output: 14.71 toks/s]
Processed prompts:  80%|███████▉  | 204/256 [00:13<00:03, 14.51it/s, est. speed input: 15057.54 toks/s, output: 14.70 toks/s]
Processed prompts:  80%|████████  | 206/256 [00:14<00:03, 14.50it/s, est. speed input: 15055.30 toks/s, output: 14.70 toks/s]
Processed prompts:  81%|████████▏ | 208/256 [00:14<00:03, 14.57it/s, est. speed input: 15055.60 toks/s, output: 14.70 toks/s]
Processed prompts:  82%|████████▏ | 210/256 [00:14<00:03, 14.57it/s, est. speed input: 15054.21 toks/s, output: 14.70 toks/s]
Processed prompts:  83%|████████▎ | 212/256 [00:14<00:03, 14.64it/s, est. speed input: 15055.40 toks/s, output: 14.70 toks/s]
Processed prompts:  84%|████████▎ | 214/256 [00:14<00:02, 14.45it/s, est. speed input: 15048.56 toks/s, output: 14.70 toks/s]
Processed prompts:  84%|████████▍ | 216/256 [00:14<00:02, 14.48it/s, est. speed input: 15046.99 toks/s, output: 14.69 toks/s]
Processed prompts:  85%|████████▌ | 218/256 [00:14<00:02, 14.52it/s, est. speed input: 15046.44 toks/s, output: 14.69 toks/s]
Processed prompts:  86%|████████▌ | 220/256 [00:14<00:02, 14.52it/s, est. speed input: 15044.66 toks/s, output: 14.69 toks/s]
Processed prompts:  87%|████████▋ | 222/256 [00:15<00:02, 14.54it/s, est. speed input: 15043.74 toks/s, output: 14.69 toks/s]
Processed prompts:  88%|████████▊ | 224/256 [00:15<00:02, 14.53it/s, est. speed input: 15042.14 toks/s, output: 14.69 toks/s]
Processed prompts:  88%|████████▊ | 226/256 [00:15<00:02, 14.54it/s, est. speed input: 15040.86 toks/s, output: 14.69 toks/s]
Processed prompts:  89%|████████▉ | 228/256 [00:15<00:01, 14.51it/s, est. speed input: 15038.53 toks/s, output: 14.69 toks/s]
Processed prompts:  90%|████████▉ | 230/256 [00:15<00:01, 14.36it/s, est. speed input: 15032.55 toks/s, output: 14.68 toks/s]
Processed prompts:  91%|█████████ | 232/256 [00:15<00:01, 14.38it/s, est. speed input: 15030.31 toks/s, output: 14.68 toks/s]
Processed prompts:  91%|█████████▏| 234/256 [00:15<00:01, 14.49it/s, est. speed input: 15030.97 toks/s, output: 14.68 toks/s]
Processed prompts:  92%|█████████▏| 236/256 [00:16<00:01, 14.50it/s, est. speed input: 15029.48 toks/s, output: 14.68 toks/s]
Processed prompts:  93%|█████████▎| 238/256 [00:16<00:01, 14.51it/s, est. speed input: 15028.23 toks/s, output: 14.68 toks/s]
Processed prompts:  94%|█████████▍| 240/256 [00:16<00:01, 14.53it/s, est. speed input: 15027.32 toks/s, output: 14.68 toks/s]
Processed prompts:  95%|█████████▍| 242/256 [00:16<00:00, 14.50it/s, est. speed input: 15025.41 toks/s, output: 14.67 toks/s]
Processed prompts:  95%|█████████▌| 244/256 [00:16<00:00, 14.38it/s, est. speed input: 15020.42 toks/s, output: 14.67 toks/s]
Processed prompts:  96%|█████████▌| 246/256 [00:16<00:00, 14.42it/s, est. speed input: 15019.20 toks/s, output: 14.67 toks/s]
Processed prompts:  97%|█████████▋| 248/256 [00:16<00:00, 14.44it/s, est. speed input: 15017.74 toks/s, output: 14.67 toks/s]
Processed prompts:  98%|█████████▊| 250/256 [00:17<00:00, 14.46it/s, est. speed input: 15016.31 toks/s, output: 14.66 toks/s]
Processed prompts:  98%|█████████▊| 252/256 [00:17<00:00, 14.40it/s, est. speed input: 15013.11 toks/s, output: 14.66 toks/s]
Processed prompts:  99%|█████████▉| 254/256 [00:17<00:00, 14.42it/s, est. speed input: 15011.49 toks/s, output: 14.66 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.42it/s, est. speed input: 15070.63 toks/s, output: 14.72 toks/s]
Processed prompts: 100%|██████████| 256/256 [00:17<00:00, 14.72it/s, est. speed input: 15070.63 toks/s, output: 14.72 toks/s]
[rank0]:[W128 09:33:12.367141260 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 53.8s

测试结果:
  Requests/s:   14.35
  Tokens/s:     14707.68
  Total Reqs:   256
  Elapsed:      17.84s

  [Prefill 分析]
  Total Prefill Tokens: 262144
  Prefill Tokens/s:     14693.33

============================================================
[4/7] 测试 M=4096
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 4096
│   M_prefill     = 4096 (= 4 x 1024)
│   M_decode      = 4
│   batched_tokens = 4096 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 512
│   --max-num-seqs           = 4
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 4096
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:33:19 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:33:19 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3752097) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3752097) WARNING 01-28 09:33:48 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 13.79 requests/s, 14136.32 total tokens/s, 13.79 output tokens/s
Total num prompt tokens:  524288
Total num output tokens:  512


─── STDERR ───
[2026-01-28 09:33:19] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:33:19] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:33:19] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:19] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:33:19] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:33:19] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:33:19] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:33:19] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:33:19] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:33:22] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:33:22] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:33:22] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:33:22] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:33:22] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:33:22] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:33:22] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:33:22] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:33:22] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:23] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3752097) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3752097) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.35s/it]
(EngineCore_DP0 pid=3752097) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.35s/it]
(EngineCore_DP0 pid=3752097) 
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3752097) [2026-01-28 09:33:41] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3752097) 2026-01-28 09:33:47,579 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3752097) 2026-01-28 09:33:47,591 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/512 [00:00<?, ?it/s]
Adding requests:  12%|█▏        | 62/512 [00:00<00:00, 609.72it/s]
Adding requests:  24%|██▍       | 123/512 [00:00<00:00, 583.25it/s]
Adding requests:  36%|███▌      | 182/512 [00:00<00:00, 534.63it/s]
Adding requests:  47%|████▋     | 240/512 [00:00<00:00, 549.08it/s]
Adding requests:  58%|█████▊    | 296/512 [00:00<00:00, 545.61it/s]
Adding requests:  69%|██████▊   | 351/512 [00:00<00:00, 546.84it/s]
Adding requests:  80%|███████▉  | 408/512 [00:00<00:00, 553.23it/s]
Adding requests:  91%|█████████ | 464/512 [00:00<00:00, 552.97it/s]
Adding requests: 100%|██████████| 512/512 [00:00<00:00, 551.35it/s]

Processed prompts:   0%|          | 0/512 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 10/512 [00:00<00:06, 80.15it/s, est. speed input: 82086.12 toks/s, output: 80.16 toks/s]
Processed prompts:   4%|▎         | 19/512 [00:00<00:20, 24.14it/s, est. speed input: 27782.02 toks/s, output: 27.13 toks/s]
Processed prompts:   5%|▍         | 24/512 [00:00<00:22, 21.55it/s, est. speed input: 24873.31 toks/s, output: 24.29 toks/s]
Processed prompts:   5%|▌         | 28/512 [00:01<00:25, 18.78it/s, est. speed input: 22420.31 toks/s, output: 21.89 toks/s]
Processed prompts:   6%|▌         | 31/512 [00:01<00:30, 16.03it/s, est. speed input: 20296.21 toks/s, output: 19.82 toks/s]
Processed prompts:   7%|▋         | 34/512 [00:01<00:33, 14.18it/s, est. speed input: 18781.79 toks/s, output: 18.34 toks/s]
Processed prompts:   7%|▋         | 38/512 [00:02<00:33, 14.03it/s, est. speed input: 18135.80 toks/s, output: 17.71 toks/s]
Processed prompts:   8%|▊         | 42/512 [00:02<00:33, 13.99it/s, est. speed input: 17673.84 toks/s, output: 17.26 toks/s]
Processed prompts:   9%|▉         | 46/512 [00:02<00:33, 13.96it/s, est. speed input: 17310.55 toks/s, output: 16.90 toks/s]
Processed prompts:  10%|▉         | 50/512 [00:03<00:33, 13.97it/s, est. speed input: 17027.40 toks/s, output: 16.63 toks/s]
Processed prompts:  11%|█         | 54/512 [00:03<00:33, 13.87it/s, est. speed input: 16756.24 toks/s, output: 16.36 toks/s]
Processed prompts:  11%|█▏        | 58/512 [00:03<00:32, 13.85it/s, est. speed input: 16542.88 toks/s, output: 16.16 toks/s]
Processed prompts:  12%|█▏        | 62/512 [00:03<00:32, 13.87it/s, est. speed input: 16373.74 toks/s, output: 15.99 toks/s]
Processed prompts:  13%|█▎        | 66/512 [00:04<00:32, 13.88it/s, est. speed input: 16226.45 toks/s, output: 15.85 toks/s]
Processed prompts:  14%|█▎        | 70/512 [00:04<00:31, 13.84it/s, est. speed input: 16087.01 toks/s, output: 15.71 toks/s]
Processed prompts:  14%|█▍        | 74/512 [00:04<00:31, 13.86it/s, est. speed input: 15974.22 toks/s, output: 15.60 toks/s]
Processed prompts:  15%|█▌        | 78/512 [00:05<00:31, 13.87it/s, est. speed input: 15873.73 toks/s, output: 15.50 toks/s]
Processed prompts:  16%|█▌        | 82/512 [00:05<00:31, 13.78it/s, est. speed input: 15764.96 toks/s, output: 15.40 toks/s]
Processed prompts:  17%|█▋        | 86/512 [00:05<00:30, 13.83it/s, est. speed input: 15689.42 toks/s, output: 15.32 toks/s]
Processed prompts:  18%|█▊        | 90/512 [00:05<00:30, 13.85it/s, est. speed input: 15617.92 toks/s, output: 15.25 toks/s]
Processed prompts:  18%|█▊        | 94/512 [00:06<00:30, 13.86it/s, est. speed input: 15553.40 toks/s, output: 15.19 toks/s]
Processed prompts:  19%|█▉        | 98/512 [00:06<00:29, 13.81it/s, est. speed input: 15483.87 toks/s, output: 15.12 toks/s]
Processed prompts:  20%|█▉        | 102/512 [00:06<00:29, 13.82it/s, est. speed input: 15427.99 toks/s, output: 15.07 toks/s]
Processed prompts:  21%|██        | 106/512 [00:07<00:29, 13.82it/s, est. speed input: 15375.34 toks/s, output: 15.01 toks/s]
Processed prompts:  21%|██▏       | 110/512 [00:07<00:29, 13.83it/s, est. speed input: 15328.29 toks/s, output: 14.97 toks/s]
Processed prompts:  22%|██▏       | 114/512 [00:07<00:28, 13.76it/s, est. speed input: 15275.26 toks/s, output: 14.92 toks/s]
Processed prompts:  23%|██▎       | 118/512 [00:07<00:28, 13.79it/s, est. speed input: 15235.99 toks/s, output: 14.88 toks/s]
Processed prompts:  24%|██▍       | 122/512 [00:08<00:28, 13.82it/s, est. speed input: 15200.12 toks/s, output: 14.84 toks/s]
Processed prompts:  25%|██▍       | 126/512 [00:08<00:28, 13.76it/s, est. speed input: 15156.77 toks/s, output: 14.80 toks/s]
Processed prompts:  25%|██▌       | 130/512 [00:08<00:27, 13.79it/s, est. speed input: 15125.54 toks/s, output: 14.77 toks/s]
Processed prompts:  26%|██▌       | 134/512 [00:09<00:27, 13.77it/s, est. speed input: 15090.98 toks/s, output: 14.74 toks/s]
Processed prompts:  27%|██▋       | 138/512 [00:09<00:27, 13.81it/s, est. speed input: 15064.93 toks/s, output: 14.71 toks/s]
Processed prompts:  28%|██▊       | 142/512 [00:09<00:26, 13.74it/s, est. speed input: 15029.61 toks/s, output: 14.68 toks/s]
Processed prompts:  29%|██▊       | 146/512 [00:09<00:26, 13.76it/s, est. speed input: 15003.73 toks/s, output: 14.65 toks/s]
Processed prompts:  29%|██▉       | 150/512 [00:10<00:26, 13.79it/s, est. speed input: 14980.78 toks/s, output: 14.63 toks/s]
Processed prompts:  30%|███       | 154/512 [00:10<00:26, 13.77it/s, est. speed input: 14954.74 toks/s, output: 14.60 toks/s]
Processed prompts:  31%|███       | 158/512 [00:10<00:25, 13.78it/s, est. speed input: 14932.68 toks/s, output: 14.58 toks/s]
Processed prompts:  32%|███▏      | 162/512 [00:11<00:25, 13.84it/s, est. speed input: 14917.31 toks/s, output: 14.57 toks/s]
Processed prompts:  32%|███▏      | 166/512 [00:11<00:24, 13.94it/s, est. speed input: 14907.25 toks/s, output: 14.56 toks/s]
Processed prompts:  33%|███▎      | 170/512 [00:11<00:24, 13.82it/s, est. speed input: 14881.52 toks/s, output: 14.53 toks/s]
Processed prompts:  34%|███▍      | 174/512 [00:11<00:24, 13.85it/s, est. speed input: 14866.64 toks/s, output: 14.52 toks/s]
Processed prompts:  35%|███▍      | 178/512 [00:12<00:24, 13.83it/s, est. speed input: 14848.61 toks/s, output: 14.50 toks/s]
Processed prompts:  36%|███▌      | 182/512 [00:12<00:23, 13.87it/s, est. speed input: 14836.41 toks/s, output: 14.49 toks/s]
Processed prompts:  36%|███▋      | 186/512 [00:12<00:23, 13.84it/s, est. speed input: 14819.37 toks/s, output: 14.47 toks/s]
Processed prompts:  37%|███▋      | 190/512 [00:13<00:23, 13.88it/s, est. speed input: 14808.28 toks/s, output: 14.46 toks/s]
Processed prompts:  38%|███▊      | 194/512 [00:13<00:22, 13.89it/s, est. speed input: 14796.43 toks/s, output: 14.45 toks/s]
Processed prompts:  39%|███▊      | 198/512 [00:13<00:22, 13.88it/s, est. speed input: 14783.60 toks/s, output: 14.44 toks/s]
Processed prompts:  39%|███▉      | 202/512 [00:14<00:22, 13.81it/s, est. speed input: 14766.46 toks/s, output: 14.42 toks/s]
Processed prompts:  40%|████      | 206/512 [00:14<00:22, 13.82it/s, est. speed input: 14754.65 toks/s, output: 14.41 toks/s]
Processed prompts:  41%|████      | 210/512 [00:14<00:21, 13.79it/s, est. speed input: 14740.80 toks/s, output: 14.40 toks/s]
Processed prompts:  42%|████▏     | 214/512 [00:14<00:21, 13.75it/s, est. speed input: 14725.54 toks/s, output: 14.38 toks/s]
Processed prompts:  43%|████▎     | 218/512 [00:15<00:21, 13.80it/s, est. speed input: 14716.40 toks/s, output: 14.37 toks/s]
Processed prompts:  43%|████▎     | 222/512 [00:15<00:20, 13.82it/s, est. speed input: 14706.73 toks/s, output: 14.36 toks/s]
Processed prompts:  44%|████▍     | 226/512 [00:15<00:20, 13.82it/s, est. speed input: 14696.93 toks/s, output: 14.35 toks/s]
Processed prompts:  45%|████▍     | 230/512 [00:16<00:20, 13.77it/s, est. speed input: 14683.58 toks/s, output: 14.34 toks/s]
Processed prompts:  46%|████▌     | 234/512 [00:16<00:20, 13.82it/s, est. speed input: 14676.41 toks/s, output: 14.33 toks/s]
Processed prompts:  46%|████▋     | 238/512 [00:16<00:19, 13.82it/s, est. speed input: 14667.49 toks/s, output: 14.32 toks/s]
Processed prompts:  47%|████▋     | 242/512 [00:16<00:19, 13.86it/s, est. speed input: 14660.69 toks/s, output: 14.32 toks/s]
Processed prompts:  48%|████▊     | 246/512 [00:17<00:19, 13.79it/s, est. speed input: 14648.80 toks/s, output: 14.31 toks/s]
Processed prompts:  49%|████▉     | 250/512 [00:17<00:18, 13.83it/s, est. speed input: 14642.18 toks/s, output: 14.30 toks/s]
Processed prompts:  50%|████▉     | 254/512 [00:17<00:18, 13.84it/s, est. speed input: 14635.11 toks/s, output: 14.29 toks/s]
Processed prompts:  50%|█████     | 258/512 [00:18<00:18, 13.79it/s, est. speed input: 14625.01 toks/s, output: 14.28 toks/s]
Processed prompts:  51%|█████     | 262/512 [00:18<00:18, 13.83it/s, est. speed input: 14619.12 toks/s, output: 14.28 toks/s]
Processed prompts:  52%|█████▏    | 266/512 [00:18<00:17, 13.83it/s, est. speed input: 14612.08 toks/s, output: 14.27 toks/s]
Processed prompts:  53%|█████▎    | 270/512 [00:18<00:17, 13.84it/s, est. speed input: 14605.89 toks/s, output: 14.26 toks/s]
Processed prompts:  54%|█████▎    | 274/512 [00:19<00:17, 13.75it/s, est. speed input: 14594.70 toks/s, output: 14.25 toks/s]
Processed prompts:  54%|█████▍    | 278/512 [00:19<00:16, 13.80it/s, est. speed input: 14589.39 toks/s, output: 14.25 toks/s]
Processed prompts:  55%|█████▌    | 282/512 [00:19<00:16, 13.80it/s, est. speed input: 14582.93 toks/s, output: 14.24 toks/s]
Processed prompts:  56%|█████▌    | 286/512 [00:20<00:16, 13.82it/s, est. speed input: 14577.36 toks/s, output: 14.24 toks/s]
Processed prompts:  57%|█████▋    | 290/512 [00:20<00:16, 13.75it/s, est. speed input: 14567.97 toks/s, output: 14.23 toks/s]
Processed prompts:  57%|█████▋    | 294/512 [00:20<00:15, 13.78it/s, est. speed input: 14562.25 toks/s, output: 14.22 toks/s]
Processed prompts:  58%|█████▊    | 298/512 [00:20<00:15, 13.81it/s, est. speed input: 14557.70 toks/s, output: 14.22 toks/s]
Processed prompts:  59%|█████▉    | 302/512 [00:21<00:15, 13.76it/s, est. speed input: 14549.54 toks/s, output: 14.21 toks/s]
Processed prompts:  60%|█████▉    | 306/512 [00:21<00:14, 13.79it/s, est. speed input: 14544.78 toks/s, output: 14.20 toks/s]
Processed prompts:  61%|██████    | 310/512 [00:21<00:14, 13.80it/s, est. speed input: 14539.77 toks/s, output: 14.20 toks/s]
Processed prompts:  61%|██████▏   | 314/512 [00:22<00:14, 13.80it/s, est. speed input: 14534.24 toks/s, output: 14.19 toks/s]
Processed prompts:  62%|██████▏   | 318/512 [00:22<00:14, 13.73it/s, est. speed input: 14525.77 toks/s, output: 14.19 toks/s]
Processed prompts:  63%|██████▎   | 322/512 [00:22<00:13, 13.75it/s, est. speed input: 14520.92 toks/s, output: 14.18 toks/s]
Processed prompts:  64%|██████▎   | 326/512 [00:22<00:13, 13.77it/s, est. speed input: 14515.97 toks/s, output: 14.18 toks/s]
Processed prompts:  64%|██████▍   | 330/512 [00:23<00:13, 13.79it/s, est. speed input: 14511.79 toks/s, output: 14.17 toks/s]
Processed prompts:  65%|██████▌   | 334/512 [00:23<00:12, 13.74it/s, est. speed input: 14504.85 toks/s, output: 14.16 toks/s]
Processed prompts:  66%|██████▌   | 338/512 [00:23<00:12, 13.80it/s, est. speed input: 14502.08 toks/s, output: 14.16 toks/s]
Processed prompts:  67%|██████▋   | 342/512 [00:24<00:11, 14.31it/s, est. speed input: 14518.50 toks/s, output: 14.18 toks/s]
Processed prompts:  68%|██████▊   | 346/512 [00:24<00:11, 14.12it/s, est. speed input: 14512.32 toks/s, output: 14.17 toks/s]
Processed prompts:  68%|██████▊   | 350/512 [00:24<00:11, 14.02it/s, est. speed input: 14507.94 toks/s, output: 14.17 toks/s]
Processed prompts:  69%|██████▉   | 354/512 [00:24<00:11, 13.98it/s, est. speed input: 14504.70 toks/s, output: 14.16 toks/s]
Processed prompts:  70%|██████▉   | 358/512 [00:25<00:11, 13.94it/s, est. speed input: 14500.97 toks/s, output: 14.16 toks/s]
Processed prompts:  71%|███████   | 362/512 [00:25<00:10, 13.83it/s, est. speed input: 14493.98 toks/s, output: 14.15 toks/s]
Processed prompts:  71%|███████▏  | 366/512 [00:25<00:10, 13.87it/s, est. speed input: 14491.97 toks/s, output: 14.15 toks/s]
Processed prompts:  72%|███████▏  | 370/512 [00:26<00:10, 13.83it/s, est. speed input: 14487.15 toks/s, output: 14.15 toks/s]
Processed prompts:  73%|███████▎  | 374/512 [00:26<00:09, 13.87it/s, est. speed input: 14485.05 toks/s, output: 14.15 toks/s]
Processed prompts:  74%|███████▍  | 378/512 [00:26<00:09, 13.76it/s, est. speed input: 14477.80 toks/s, output: 14.14 toks/s]
Processed prompts:  75%|███████▍  | 382/512 [00:27<00:09, 13.82it/s, est. speed input: 14475.94 toks/s, output: 14.14 toks/s]
Processed prompts:  75%|███████▌  | 386/512 [00:27<00:09, 13.83it/s, est. speed input: 14472.79 toks/s, output: 14.13 toks/s]
Processed prompts:  76%|███████▌  | 390/512 [00:27<00:08, 13.74it/s, est. speed input: 14466.40 toks/s, output: 14.13 toks/s]
Processed prompts:  77%|███████▋  | 394/512 [00:27<00:08, 13.74it/s, est. speed input: 14462.11 toks/s, output: 14.12 toks/s]
Processed prompts:  78%|███████▊  | 398/512 [00:28<00:08, 13.77it/s, est. speed input: 14459.02 toks/s, output: 14.12 toks/s]
Processed prompts:  79%|███████▊  | 402/512 [00:28<00:07, 13.81it/s, est. speed input: 14456.74 toks/s, output: 14.12 toks/s]
Processed prompts:  79%|███████▉  | 406/512 [00:28<00:07, 13.73it/s, est. speed input: 14450.90 toks/s, output: 14.11 toks/s]
Processed prompts:  80%|████████  | 410/512 [00:29<00:07, 13.78it/s, est. speed input: 14448.66 toks/s, output: 14.11 toks/s]
Processed prompts:  81%|████████  | 414/512 [00:29<00:07, 13.79it/s, est. speed input: 14445.83 toks/s, output: 14.11 toks/s]
Processed prompts:  82%|████████▏ | 418/512 [00:29<00:06, 13.82it/s, est. speed input: 14443.47 toks/s, output: 14.10 toks/s]
Processed prompts:  82%|████████▏ | 422/512 [00:29<00:06, 13.75it/s, est. speed input: 14438.46 toks/s, output: 14.10 toks/s]
Processed prompts:  83%|████████▎ | 426/512 [00:30<00:06, 13.78it/s, est. speed input: 14435.79 toks/s, output: 14.10 toks/s]
Processed prompts:  84%|████████▍ | 430/512 [00:30<00:05, 13.79it/s, est. speed input: 14433.19 toks/s, output: 14.09 toks/s]
Processed prompts:  85%|████████▍ | 434/512 [00:30<00:05, 13.77it/s, est. speed input: 14429.61 toks/s, output: 14.09 toks/s]
Processed prompts:  86%|████████▌ | 438/512 [00:31<00:05, 13.79it/s, est. speed input: 14426.99 toks/s, output: 14.09 toks/s]
Processed prompts:  86%|████████▋ | 442/512 [00:31<00:05, 13.84it/s, est. speed input: 14425.92 toks/s, output: 14.09 toks/s]
Processed prompts:  87%|████████▋ | 446/512 [00:31<00:04, 13.84it/s, est. speed input: 14423.62 toks/s, output: 14.09 toks/s]
Processed prompts:  88%|████████▊ | 450/512 [00:31<00:04, 14.54it/s, est. speed input: 14442.25 toks/s, output: 14.10 toks/s]
Processed prompts:  89%|████████▊ | 454/512 [00:32<00:04, 14.34it/s, est. speed input: 14440.47 toks/s, output: 14.10 toks/s]
Processed prompts:  89%|████████▉ | 458/512 [00:32<00:03, 14.21it/s, est. speed input: 14438.65 toks/s, output: 14.10 toks/s]
Processed prompts:  90%|█████████ | 462/512 [00:32<00:03, 14.06it/s, est. speed input: 14435.33 toks/s, output: 14.10 toks/s]
Processed prompts:  91%|█████████ | 466/512 [00:33<00:03, 13.95it/s, est. speed input: 14431.54 toks/s, output: 14.09 toks/s]
Processed prompts:  92%|█████████▏| 470/512 [00:33<00:03, 13.93it/s, est. speed input: 14429.63 toks/s, output: 14.09 toks/s]
Processed prompts:  93%|█████████▎| 474/512 [00:33<00:02, 13.89it/s, est. speed input: 14427.13 toks/s, output: 14.09 toks/s]
Processed prompts:  93%|█████████▎| 478/512 [00:33<00:02, 13.83it/s, est. speed input: 14423.73 toks/s, output: 14.09 toks/s]
Processed prompts:  94%|█████████▍| 482/512 [00:34<00:02, 13.82it/s, est. speed input: 14421.17 toks/s, output: 14.08 toks/s]
Processed prompts:  95%|█████████▍| 486/512 [00:34<00:01, 13.89it/s, est. speed input: 14420.83 toks/s, output: 14.08 toks/s]
Processed prompts:  96%|█████████▌| 490/512 [00:34<00:01, 13.87it/s, est. speed input: 14418.71 toks/s, output: 14.08 toks/s]
Processed prompts:  96%|█████████▋| 494/512 [00:35<00:01, 13.81it/s, est. speed input: 14415.07 toks/s, output: 14.08 toks/s]
Processed prompts:  97%|█████████▋| 498/512 [00:35<00:01, 13.83it/s, est. speed input: 14413.36 toks/s, output: 14.08 toks/s]
Processed prompts:  98%|█████████▊| 502/512 [00:35<00:00, 13.83it/s, est. speed input: 14411.39 toks/s, output: 14.07 toks/s]
Processed prompts:  99%|█████████▉| 506/512 [00:35<00:00, 13.85it/s, est. speed input: 14410.09 toks/s, output: 14.07 toks/s]
Processed prompts: 100%|█████████▉| 510/512 [00:36<00:00, 14.64it/s, est. speed input: 14428.81 toks/s, output: 14.09 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:36<00:00, 14.64it/s, est. speed input: 14485.35 toks/s, output: 14.15 toks/s]
Processed prompts: 100%|██████████| 512/512 [00:36<00:00, 14.15it/s, est. speed input: 14485.35 toks/s, output: 14.15 toks/s]
[rank0]:[W128 09:34:25.744290214 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 73.3s

测试结果:
  Requests/s:   13.79
  Tokens/s:     14136.32
  Total Reqs:   512
  Elapsed:      37.12s

  [Prefill 分析]
  Total Prefill Tokens: 524288
  Prefill Tokens/s:     14122.52

============================================================
[5/7] 测试 M=8192
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 8192
│   M_prefill     = 8192 (= 8 x 1024)
│   M_decode      = 8
│   batched_tokens = 8192 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 1024
│   --max-num-seqs           = 8
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 8192
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:34:34 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:34:34 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3753313) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3753313) WARNING 01-28 09:35:04 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 13.70 requests/s, 14043.34 total tokens/s, 13.70 output tokens/s
Total num prompt tokens:  1048576
Total num output tokens:  1024


─── STDERR ───
[2026-01-28 09:34:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:34:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:34:34] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:34:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:34:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:34:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:34:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:34:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:34:37] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:34:37] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:34:37] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:34:37] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:34:37] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:34:37] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:34:37] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:34:37] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:34:37] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:38] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3753313) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3753313) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.54s/it]
(EngineCore_DP0 pid=3753313) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.54s/it]
(EngineCore_DP0 pid=3753313) 
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3753313) [2026-01-28 09:34:57] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3753313) 2026-01-28 09:35:03,129 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3753313) 2026-01-28 09:35:03,180 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/1024 [00:00<?, ?it/s]
Adding requests:   6%|▌         | 63/1024 [00:00<00:01, 628.11it/s]
Adding requests:  12%|█▏        | 126/1024 [00:00<00:01, 598.45it/s]
Adding requests:  18%|█▊        | 186/1024 [00:00<00:01, 559.83it/s]
Adding requests:  24%|██▎       | 243/1024 [00:00<00:01, 562.83it/s]
Adding requests:  29%|██▉       | 300/1024 [00:00<00:01, 547.56it/s]
Adding requests:  35%|███▍      | 356/1024 [00:00<00:01, 548.78it/s]
Adding requests:  40%|████      | 411/1024 [00:00<00:01, 548.74it/s]
Adding requests:  46%|████▌     | 466/1024 [00:00<00:01, 539.80it/s]
Adding requests:  51%|█████     | 521/1024 [00:00<00:00, 529.82it/s]
Adding requests:  56%|█████▌    | 575/1024 [00:01<00:00, 518.65it/s]
Adding requests:  61%|██████▏   | 628/1024 [00:01<00:00, 521.14it/s]
Adding requests:  67%|██████▋   | 682/1024 [00:01<00:00, 524.65it/s]
Adding requests:  72%|███████▏  | 737/1024 [00:01<00:00, 531.91it/s]
Adding requests:  77%|███████▋  | 791/1024 [00:01<00:00, 522.31it/s]
Adding requests:  82%|████████▏ | 844/1024 [00:01<00:00, 517.33it/s]
Adding requests:  88%|████████▊ | 902/1024 [00:01<00:00, 533.70it/s]
Adding requests:  93%|█████████▎| 956/1024 [00:01<00:00, 531.02it/s]
Adding requests:  99%|█████████▊| 1010/1024 [00:01<00:00, 532.76it/s]
Adding requests: 100%|██████████| 1024/1024 [00:01<00:00, 537.75it/s]

Processed prompts:   0%|          | 0/1024 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   3%|▎         | 26/1024 [00:00<00:23, 42.32it/s, est. speed input: 43339.28 toks/s, output: 42.32 toks/s]
Processed prompts:   3%|▎         | 34/1024 [00:01<00:38, 25.92it/s, est. speed input: 29128.36 toks/s, output: 28.44 toks/s]
Processed prompts:   4%|▍         | 42/1024 [00:01<00:48, 20.33it/s, est. speed input: 24115.66 toks/s, output: 23.55 toks/s]
Processed prompts:   5%|▍         | 50/1024 [00:02<00:54, 17.72it/s, est. speed input: 21620.01 toks/s, output: 21.11 toks/s]
Processed prompts:   6%|▌         | 58/1024 [00:02<00:59, 16.28it/s, est. speed input: 20117.17 toks/s, output: 19.65 toks/s]
Processed prompts:   6%|▋         | 66/1024 [00:03<01:02, 15.40it/s, est. speed input: 19111.36 toks/s, output: 18.66 toks/s]
Processed prompts:   7%|▋         | 74/1024 [00:04<01:03, 14.86it/s, est. speed input: 18398.66 toks/s, output: 17.97 toks/s]
Processed prompts:   8%|▊         | 82/1024 [00:04<01:05, 14.49it/s, est. speed input: 17852.57 toks/s, output: 17.43 toks/s]
Processed prompts:   9%|▉         | 90/1024 [00:05<01:05, 14.27it/s, est. speed input: 17441.14 toks/s, output: 17.03 toks/s]
Processed prompts:  10%|▉         | 98/1024 [00:05<01:05, 14.06it/s, est. speed input: 17090.68 toks/s, output: 16.69 toks/s]
Processed prompts:  10%|█         | 106/1024 [00:06<01:05, 13.99it/s, est. speed input: 16827.43 toks/s, output: 16.43 toks/s]
Processed prompts:  11%|█         | 114/1024 [00:07<01:05, 13.90it/s, est. speed input: 16594.18 toks/s, output: 16.21 toks/s]
Processed prompts:  12%|█▏        | 122/1024 [00:07<01:05, 13.84it/s, est. speed input: 16398.30 toks/s, output: 16.01 toks/s]
Processed prompts:  13%|█▎        | 130/1024 [00:08<01:04, 13.79it/s, est. speed input: 16228.16 toks/s, output: 15.85 toks/s]
Processed prompts:  13%|█▎        | 138/1024 [00:08<01:04, 13.75it/s, est. speed input: 16079.29 toks/s, output: 15.70 toks/s]
Processed prompts:  14%|█▍        | 146/1024 [00:09<01:03, 13.76it/s, est. speed input: 15957.95 toks/s, output: 15.58 toks/s]
Processed prompts:  15%|█▌        | 154/1024 [00:09<01:03, 13.72it/s, est. speed input: 15838.24 toks/s, output: 15.47 toks/s]
Processed prompts:  16%|█▌        | 162/1024 [00:10<01:02, 13.71it/s, est. speed input: 15737.06 toks/s, output: 15.37 toks/s]
Processed prompts:  17%|█▋        | 170/1024 [00:11<01:02, 13.69it/s, est. speed input: 15643.60 toks/s, output: 15.28 toks/s]
Processed prompts:  17%|█▋        | 178/1024 [00:11<01:01, 13.71it/s, est. speed input: 15566.91 toks/s, output: 15.20 toks/s]
Processed prompts:  18%|█▊        | 186/1024 [00:12<01:01, 13.68it/s, est. speed input: 15488.76 toks/s, output: 15.13 toks/s]
Processed prompts:  19%|█▉        | 194/1024 [00:12<01:00, 13.73it/s, est. speed input: 15429.80 toks/s, output: 15.07 toks/s]
Processed prompts:  20%|█▉        | 202/1024 [00:13<00:59, 13.72it/s, est. speed input: 15369.19 toks/s, output: 15.01 toks/s]
Processed prompts:  21%|██        | 210/1024 [00:14<00:59, 13.70it/s, est. speed input: 15310.66 toks/s, output: 14.95 toks/s]
Processed prompts:  21%|██▏       | 218/1024 [00:14<00:58, 13.71it/s, est. speed input: 15262.09 toks/s, output: 14.90 toks/s]
Processed prompts:  22%|██▏       | 226/1024 [00:15<00:58, 13.70it/s, est. speed input: 15212.78 toks/s, output: 14.86 toks/s]
Processed prompts:  23%|██▎       | 234/1024 [00:15<00:57, 13.71it/s, est. speed input: 15170.58 toks/s, output: 14.82 toks/s]
Processed prompts:  24%|██▎       | 242/1024 [00:16<00:57, 13.70it/s, est. speed input: 15129.40 toks/s, output: 14.77 toks/s]
Processed prompts:  24%|██▍       | 250/1024 [00:16<00:56, 13.73it/s, est. speed input: 15095.58 toks/s, output: 14.74 toks/s]
Processed prompts:  25%|██▌       | 258/1024 [00:17<00:55, 13.71it/s, est. speed input: 15058.83 toks/s, output: 14.71 toks/s]
Processed prompts:  26%|██▌       | 266/1024 [00:18<00:55, 13.73it/s, est. speed input: 15028.14 toks/s, output: 14.68 toks/s]
Processed prompts:  27%|██▋       | 274/1024 [00:18<00:54, 13.70it/s, est. speed input: 14994.59 toks/s, output: 14.64 toks/s]
Processed prompts:  28%|██▊       | 282/1024 [00:19<00:54, 13.70it/s, est. speed input: 14965.27 toks/s, output: 14.61 toks/s]
Processed prompts:  28%|██▊       | 290/1024 [00:19<00:53, 13.68it/s, est. speed input: 14936.05 toks/s, output: 14.59 toks/s]
Processed prompts:  29%|██▉       | 298/1024 [00:20<00:52, 13.70it/s, est. speed input: 14911.39 toks/s, output: 14.56 toks/s]
Processed prompts:  30%|██▉       | 306/1024 [00:21<00:52, 13.72it/s, est. speed input: 14889.05 toks/s, output: 14.54 toks/s]
Processed prompts:  31%|███       | 314/1024 [00:21<00:51, 13.69it/s, est. speed input: 14862.98 toks/s, output: 14.51 toks/s]
Processed prompts:  31%|███▏      | 322/1024 [00:22<00:51, 13.72it/s, est. speed input: 14843.52 toks/s, output: 14.50 toks/s]
Processed prompts:  32%|███▏      | 330/1024 [00:22<00:50, 13.71it/s, est. speed input: 14822.24 toks/s, output: 14.47 toks/s]
Processed prompts:  33%|███▎      | 338/1024 [00:23<00:48, 14.04it/s, est. speed input: 14831.72 toks/s, output: 14.48 toks/s]
Processed prompts:  34%|███▍      | 346/1024 [00:23<00:48, 13.91it/s, est. speed input: 14810.23 toks/s, output: 14.46 toks/s]
Processed prompts:  35%|███▍      | 354/1024 [00:24<00:48, 13.85it/s, est. speed input: 14791.68 toks/s, output: 14.44 toks/s]
Processed prompts:  35%|███▌      | 362/1024 [00:25<00:48, 13.78it/s, est. speed input: 14772.32 toks/s, output: 14.43 toks/s]
Processed prompts:  36%|███▌      | 370/1024 [00:25<00:47, 13.76it/s, est. speed input: 14755.86 toks/s, output: 14.41 toks/s]
Processed prompts:  37%|███▋      | 378/1024 [00:26<00:46, 13.78it/s, est. speed input: 14742.17 toks/s, output: 14.40 toks/s]
Processed prompts:  38%|███▊      | 386/1024 [00:26<00:46, 13.74it/s, est. speed input: 14725.44 toks/s, output: 14.38 toks/s]
Processed prompts:  38%|███▊      | 394/1024 [00:27<00:45, 13.74it/s, est. speed input: 14711.96 toks/s, output: 14.37 toks/s]
Processed prompts:  39%|███▉      | 402/1024 [00:28<00:45, 13.70it/s, est. speed input: 14695.48 toks/s, output: 14.35 toks/s]
Processed prompts:  40%|████      | 410/1024 [00:28<00:44, 13.71it/s, est. speed input: 14682.53 toks/s, output: 14.34 toks/s]
Processed prompts:  41%|████      | 418/1024 [00:29<00:44, 13.67it/s, est. speed input: 14666.91 toks/s, output: 14.32 toks/s]
Processed prompts:  42%|████▏     | 426/1024 [00:29<00:43, 13.69it/s, est. speed input: 14654.84 toks/s, output: 14.31 toks/s]
Processed prompts:  42%|████▏     | 434/1024 [00:30<00:43, 13.65it/s, est. speed input: 14639.86 toks/s, output: 14.30 toks/s]
Processed prompts:  43%|████▎     | 442/1024 [00:30<00:42, 13.67it/s, est. speed input: 14629.12 toks/s, output: 14.29 toks/s]
Processed prompts:  44%|████▍     | 450/1024 [00:31<00:41, 13.98it/s, est. speed input: 14636.99 toks/s, output: 14.29 toks/s]
Processed prompts:  45%|████▍     | 458/1024 [00:32<00:40, 13.88it/s, est. speed input: 14625.30 toks/s, output: 14.28 toks/s]
Processed prompts:  46%|████▌     | 466/1024 [00:32<00:40, 13.83it/s, est. speed input: 14614.85 toks/s, output: 14.27 toks/s]
Processed prompts:  46%|████▋     | 474/1024 [00:33<00:39, 13.80it/s, est. speed input: 14604.82 toks/s, output: 14.26 toks/s]
Processed prompts:  47%|████▋     | 482/1024 [00:33<00:39, 13.77it/s, est. speed input: 14594.76 toks/s, output: 14.25 toks/s]
Processed prompts:  48%|████▊     | 490/1024 [00:34<00:38, 13.73it/s, est. speed input: 14584.41 toks/s, output: 14.24 toks/s]
Processed prompts:  49%|████▊     | 498/1024 [00:34<00:38, 13.73it/s, est. speed input: 14575.68 toks/s, output: 14.23 toks/s]
Processed prompts:  49%|████▉     | 506/1024 [00:35<00:37, 13.70it/s, est. speed input: 14565.36 toks/s, output: 14.22 toks/s]
Processed prompts:  50%|█████     | 514/1024 [00:36<00:37, 13.72it/s, est. speed input: 14557.90 toks/s, output: 14.22 toks/s]
Processed prompts:  51%|█████     | 522/1024 [00:36<00:36, 13.69it/s, est. speed input: 14547.93 toks/s, output: 14.21 toks/s]
Processed prompts:  52%|█████▏    | 530/1024 [00:37<00:36, 13.70it/s, est. speed input: 14540.54 toks/s, output: 14.20 toks/s]
Processed prompts:  53%|█████▎    | 538/1024 [00:37<00:35, 13.67it/s, est. speed input: 14531.04 toks/s, output: 14.19 toks/s]
Processed prompts:  53%|█████▎    | 546/1024 [00:38<00:34, 13.67it/s, est. speed input: 14522.56 toks/s, output: 14.18 toks/s]
Processed prompts:  54%|█████▍    | 554/1024 [00:39<00:34, 13.70it/s, est. speed input: 14516.28 toks/s, output: 14.18 toks/s]
Processed prompts:  55%|█████▍    | 562/1024 [00:39<00:33, 13.68it/s, est. speed input: 14508.32 toks/s, output: 14.17 toks/s]
Processed prompts:  56%|█████▌    | 570/1024 [00:40<00:33, 13.70it/s, est. speed input: 14502.23 toks/s, output: 14.16 toks/s]
Processed prompts:  56%|█████▋    | 578/1024 [00:40<00:32, 13.66it/s, est. speed input: 14493.02 toks/s, output: 14.15 toks/s]
Processed prompts:  57%|█████▋    | 586/1024 [00:41<00:31, 13.69it/s, est. speed input: 14487.66 toks/s, output: 14.15 toks/s]
Processed prompts:  58%|█████▊    | 594/1024 [00:42<00:31, 13.66it/s, est. speed input: 14479.70 toks/s, output: 14.14 toks/s]
Processed prompts:  59%|█████▉    | 602/1024 [00:42<00:30, 13.68it/s, est. speed input: 14473.60 toks/s, output: 14.13 toks/s]
Processed prompts:  60%|█████▉    | 610/1024 [00:43<00:30, 13.68it/s, est. speed input: 14467.37 toks/s, output: 14.13 toks/s]
Processed prompts:  60%|██████    | 618/1024 [00:43<00:29, 13.67it/s, est. speed input: 14461.05 toks/s, output: 14.12 toks/s]
Processed prompts:  61%|██████    | 626/1024 [00:44<00:29, 13.71it/s, est. speed input: 14456.40 toks/s, output: 14.12 toks/s]
Processed prompts:  62%|██████▏   | 634/1024 [00:44<00:28, 13.69it/s, est. speed input: 14450.04 toks/s, output: 14.11 toks/s]
Processed prompts:  63%|██████▎   | 642/1024 [00:45<00:27, 13.72it/s, est. speed input: 14445.97 toks/s, output: 14.11 toks/s]
Processed prompts:  63%|██████▎   | 650/1024 [00:46<00:27, 13.70it/s, est. speed input: 14440.18 toks/s, output: 14.10 toks/s]
Processed prompts:  64%|██████▍   | 658/1024 [00:46<00:26, 13.72it/s, est. speed input: 14435.90 toks/s, output: 14.10 toks/s]
Processed prompts:  65%|██████▌   | 666/1024 [00:47<00:26, 13.68it/s, est. speed input: 14429.42 toks/s, output: 14.09 toks/s]
Processed prompts:  66%|██████▌   | 674/1024 [00:47<00:25, 13.69it/s, est. speed input: 14424.68 toks/s, output: 14.09 toks/s]
Processed prompts:  67%|██████▋   | 682/1024 [00:48<00:25, 13.65it/s, est. speed input: 14418.13 toks/s, output: 14.08 toks/s]
Processed prompts:  67%|██████▋   | 690/1024 [00:49<00:24, 13.68it/s, est. speed input: 14413.90 toks/s, output: 14.08 toks/s]
Processed prompts:  68%|██████▊   | 698/1024 [00:49<00:23, 13.68it/s, est. speed input: 14409.19 toks/s, output: 14.07 toks/s]
Processed prompts:  69%|██████▉   | 706/1024 [00:50<00:23, 13.65it/s, est. speed input: 14403.25 toks/s, output: 14.07 toks/s]
Processed prompts:  70%|██████▉   | 714/1024 [00:50<00:22, 13.67it/s, est. speed input: 14399.34 toks/s, output: 14.06 toks/s]
Processed prompts:  71%|███████   | 722/1024 [00:51<00:22, 13.65it/s, est. speed input: 14393.82 toks/s, output: 14.06 toks/s]
Processed prompts:  71%|███████▏  | 730/1024 [00:51<00:21, 13.66it/s, est. speed input: 14389.65 toks/s, output: 14.05 toks/s]
Processed prompts:  72%|███████▏  | 738/1024 [00:52<00:20, 13.64it/s, est. speed input: 14384.21 toks/s, output: 14.05 toks/s]
Processed prompts:  73%|███████▎  | 746/1024 [00:53<00:20, 13.65it/s, est. speed input: 14379.94 toks/s, output: 14.04 toks/s]
Processed prompts:  74%|███████▎  | 754/1024 [00:53<00:19, 13.65it/s, est. speed input: 14375.50 toks/s, output: 14.04 toks/s]
Processed prompts:  74%|███████▍  | 762/1024 [00:54<00:19, 13.66it/s, est. speed input: 14371.69 toks/s, output: 14.03 toks/s]
Processed prompts:  75%|███████▌  | 770/1024 [00:54<00:18, 13.64it/s, est. speed input: 14366.91 toks/s, output: 14.03 toks/s]
Processed prompts:  76%|███████▌  | 778/1024 [00:55<00:18, 13.64it/s, est. speed input: 14362.65 toks/s, output: 14.03 toks/s]
Processed prompts:  77%|███████▋  | 786/1024 [00:56<00:17, 13.68it/s, est. speed input: 14359.94 toks/s, output: 14.02 toks/s]
Processed prompts:  78%|███████▊  | 794/1024 [00:56<00:16, 13.68it/s, est. speed input: 14356.17 toks/s, output: 14.02 toks/s]
Processed prompts:  78%|███████▊  | 802/1024 [00:57<00:16, 13.67it/s, est. speed input: 14352.24 toks/s, output: 14.02 toks/s]
Processed prompts:  79%|███████▉  | 810/1024 [00:57<00:15, 13.64it/s, est. speed input: 14347.68 toks/s, output: 14.01 toks/s]
Processed prompts:  80%|███████▉  | 818/1024 [00:58<00:15, 13.67it/s, est. speed input: 14344.92 toks/s, output: 14.01 toks/s]
Processed prompts:  81%|████████  | 826/1024 [00:58<00:14, 13.66it/s, est. speed input: 14341.11 toks/s, output: 14.00 toks/s]
Processed prompts:  81%|████████▏ | 834/1024 [00:59<00:13, 13.70it/s, est. speed input: 14338.85 toks/s, output: 14.00 toks/s]
Processed prompts:  82%|████████▏ | 842/1024 [01:00<00:13, 13.68it/s, est. speed input: 14335.22 toks/s, output: 14.00 toks/s]
Processed prompts:  83%|████████▎ | 850/1024 [01:00<00:12, 13.67it/s, est. speed input: 14331.89 toks/s, output: 14.00 toks/s]
Processed prompts:  84%|████████▍ | 858/1024 [01:01<00:12, 13.68it/s, est. speed input: 14328.85 toks/s, output: 13.99 toks/s]
Processed prompts:  85%|████████▍ | 866/1024 [01:01<00:11, 13.67it/s, est. speed input: 14325.65 toks/s, output: 13.99 toks/s]
Processed prompts:  85%|████████▌ | 874/1024 [01:02<00:10, 13.70it/s, est. speed input: 14323.47 toks/s, output: 13.99 toks/s]
Processed prompts:  86%|████████▌ | 882/1024 [01:03<00:10, 13.67it/s, est. speed input: 14319.91 toks/s, output: 13.98 toks/s]
Processed prompts:  87%|████████▋ | 890/1024 [01:03<00:09, 13.69it/s, est. speed input: 14317.37 toks/s, output: 13.98 toks/s]
Processed prompts:  88%|████████▊ | 898/1024 [01:04<00:09, 13.66it/s, est. speed input: 14313.66 toks/s, output: 13.98 toks/s]
Processed prompts:  88%|████████▊ | 906/1024 [01:04<00:08, 13.64it/s, est. speed input: 14310.33 toks/s, output: 13.97 toks/s]
Processed prompts:  89%|████████▉ | 914/1024 [01:05<00:08, 13.64it/s, est. speed input: 14307.29 toks/s, output: 13.97 toks/s]
Processed prompts:  90%|█████████ | 922/1024 [01:05<00:07, 13.67it/s, est. speed input: 14305.22 toks/s, output: 13.97 toks/s]
Processed prompts:  91%|█████████ | 930/1024 [01:06<00:06, 13.68it/s, est. speed input: 14302.62 toks/s, output: 13.97 toks/s]
Processed prompts:  92%|█████████▏| 938/1024 [01:07<00:06, 14.14it/s, est. speed input: 14313.68 toks/s, output: 13.98 toks/s]
Processed prompts:  92%|█████████▏| 946/1024 [01:07<00:05, 14.00it/s, est. speed input: 14310.94 toks/s, output: 13.98 toks/s]
Processed prompts:  93%|█████████▎| 954/1024 [01:08<00:05, 13.89it/s, est. speed input: 14307.94 toks/s, output: 13.97 toks/s]
Processed prompts:  94%|█████████▍| 962/1024 [01:08<00:04, 13.84it/s, est. speed input: 14305.85 toks/s, output: 13.97 toks/s]
Processed prompts:  95%|█████████▍| 970/1024 [01:09<00:03, 13.77it/s, est. speed input: 14302.74 toks/s, output: 13.97 toks/s]
Processed prompts:  96%|█████████▌| 978/1024 [01:10<00:03, 13.74it/s, est. speed input: 14300.21 toks/s, output: 13.97 toks/s]
Processed prompts:  96%|█████████▋| 986/1024 [01:10<00:02, 14.22it/s, est. speed input: 14311.49 toks/s, output: 13.98 toks/s]
Processed prompts:  97%|█████████▋| 994/1024 [01:11<00:02, 14.08it/s, est. speed input: 14309.82 toks/s, output: 13.97 toks/s]
Processed prompts:  98%|█████████▊| 1002/1024 [01:11<00:01, 13.94it/s, est. speed input: 14306.77 toks/s, output: 13.97 toks/s]
Processed prompts:  99%|█████████▊| 1010/1024 [01:12<00:01, 13.87it/s, est. speed input: 14304.79 toks/s, output: 13.97 toks/s]
Processed prompts:  99%|█████████▉| 1018/1024 [01:12<00:00, 14.19it/s, est. speed input: 14312.46 toks/s, output: 13.98 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:12<00:00, 14.19it/s, est. speed input: 14396.77 toks/s, output: 14.06 toks/s]
Processed prompts: 100%|██████████| 1024/1024 [01:12<00:00, 14.06it/s, est. speed input: 14396.77 toks/s, output: 14.06 toks/s]
[rank0]:[W128 09:36:19.248406836 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 113.5s

测试结果:
  Requests/s:   13.70
  Tokens/s:     14043.34
  Total Reqs:   1024
  Elapsed:      74.74s

  [Prefill 分析]
  Total Prefill Tokens: 1048576
  Prefill Tokens/s:     14029.64

============================================================
[6/7] 测试 M=16384
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 16384
│   M_prefill     = 16384 (= 16 x 1024)
│   M_decode      = 16
│   batched_tokens = 16384 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 2048
│   --max-num-seqs           = 16
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 16384
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:36:30 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:36:30 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3755105) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3755105) WARNING 01-28 09:37:01 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 13.83 requests/s, 14171.71 total tokens/s, 13.83 output tokens/s
Total num prompt tokens:  2097152
Total num output tokens:  2048


─── STDERR ───
[2026-01-28 09:36:30] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:36:30] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:36:30] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:30] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:36:30] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:36:30] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:36:30] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:36:30] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:36:30] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:36:34] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:36:34] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:36:34] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:36:34] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:36:34] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:36:34] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:36:34] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:36:34] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:36:34] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:35] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3755105) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3755105) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.38s/it]
(EngineCore_DP0 pid=3755105) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.38s/it]
(EngineCore_DP0 pid=3755105) 
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3755105) [2026-01-28 09:36:53] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3755105) 2026-01-28 09:36:59,664 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3755105) 2026-01-28 09:36:59,770 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/2048 [00:00<?, ?it/s]
Adding requests:   3%|▎         | 62/2048 [00:00<00:03, 615.97it/s]
Adding requests:   6%|▌         | 124/2048 [00:00<00:03, 579.20it/s]
Adding requests:   9%|▉         | 183/2048 [00:00<00:03, 537.91it/s]
Adding requests:  12%|█▏        | 238/2048 [00:00<00:03, 535.39it/s]
Adding requests:  14%|█▍        | 292/2048 [00:00<00:03, 518.53it/s]
Adding requests:  17%|█▋        | 344/2048 [00:00<00:03, 517.55it/s]
Adding requests:  19%|█▉        | 396/2048 [00:00<00:03, 514.69it/s]
Adding requests:  22%|██▏       | 448/2048 [00:00<00:03, 515.75it/s]
Adding requests:  24%|██▍       | 500/2048 [00:00<00:03, 509.11it/s]
Adding requests:  27%|██▋       | 551/2048 [00:01<00:02, 509.27it/s]
Adding requests:  29%|██▉       | 602/2048 [00:01<00:02, 508.01it/s]
Adding requests:  32%|███▏      | 657/2048 [00:01<00:02, 517.31it/s]
Adding requests:  35%|███▍      | 712/2048 [00:01<00:02, 524.39it/s]
Adding requests:  37%|███▋      | 765/2048 [00:01<00:02, 511.75it/s]
Adding requests:  40%|███▉      | 817/2048 [00:01<00:02, 496.72it/s]
Adding requests:  42%|████▏     | 867/2048 [00:01<00:02, 480.02it/s]
Adding requests:  45%|████▍     | 919/2048 [00:01<00:02, 490.84it/s]
Adding requests:  47%|████▋     | 969/2048 [00:02<00:05, 181.85it/s]
Adding requests:  50%|████▉     | 1018/2048 [00:02<00:04, 222.07it/s]
Adding requests:  52%|█████▏    | 1069/2048 [00:02<00:03, 267.01it/s]
Adding requests:  55%|█████▍    | 1120/2048 [00:02<00:02, 310.94it/s]
Adding requests:  57%|█████▋    | 1172/2048 [00:02<00:02, 353.45it/s]
Adding requests:  60%|█████▉    | 1224/2048 [00:02<00:02, 391.46it/s]
Adding requests:  62%|██████▏   | 1274/2048 [00:03<00:01, 416.87it/s]
Adding requests:  65%|██████▍   | 1327/2048 [00:03<00:01, 443.48it/s]
Adding requests:  67%|██████▋   | 1380/2048 [00:03<00:01, 464.23it/s]
Adding requests:  70%|██████▉   | 1433/2048 [00:03<00:01, 480.66it/s]
Adding requests:  73%|███████▎  | 1487/2048 [00:03<00:01, 497.08it/s]
Adding requests:  75%|███████▌  | 1541/2048 [00:03<00:00, 507.68it/s]
Adding requests:  78%|███████▊  | 1595/2048 [00:03<00:00, 514.96it/s]
Adding requests:  80%|████████  | 1648/2048 [00:03<00:00, 512.80it/s]
Adding requests:  83%|████████▎ | 1701/2048 [00:03<00:00, 504.05it/s]
Adding requests:  86%|████████▌ | 1752/2048 [00:04<00:00, 505.18it/s]
Adding requests:  88%|████████▊ | 1804/2048 [00:04<00:00, 509.12it/s]
Adding requests:  91%|█████████ | 1857/2048 [00:04<00:00, 514.43it/s]
Adding requests:  93%|█████████▎| 1910/2048 [00:04<00:00, 518.33it/s]
Adding requests:  96%|█████████▌| 1962/2048 [00:04<00:00, 515.34it/s]
Adding requests:  98%|█████████▊| 2017/2048 [00:04<00:00, 525.45it/s]
Adding requests: 100%|██████████| 2048/2048 [00:04<00:00, 447.12it/s]

Processed prompts:   0%|          | 0/2048 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 50/2048 [00:00<00:09, 204.01it/s, est. speed input: 208946.75 toks/s, output: 204.02 toks/s]
Processed prompts:   3%|▎         | 71/2048 [00:01<00:47, 42.02it/s, est. speed input: 51704.14 toks/s, output: 50.49 toks/s]   
Processed prompts:   4%|▍         | 82/2048 [00:02<01:22, 23.97it/s, est. speed input: 32698.53 toks/s, output: 31.93 toks/s]
Processed prompts:   5%|▍         | 98/2048 [00:03<01:40, 19.49it/s, est. speed input: 26933.90 toks/s, output: 26.30 toks/s]
Processed prompts:   6%|▌         | 114/2048 [00:04<01:51, 17.28it/s, est. speed input: 23888.25 toks/s, output: 23.33 toks/s]
Processed prompts:   6%|▋         | 130/2048 [00:06<01:59, 16.05it/s, est. speed input: 22022.48 toks/s, output: 21.51 toks/s]
Processed prompts:   7%|▋         | 146/2048 [00:07<02:04, 15.29it/s, est. speed input: 20753.90 toks/s, output: 20.27 toks/s]
Processed prompts:   8%|▊         | 162/2048 [00:08<02:07, 14.80it/s, est. speed input: 19833.17 toks/s, output: 19.37 toks/s]
Processed prompts:   9%|▊         | 178/2048 [00:09<02:09, 14.46it/s, est. speed input: 19127.39 toks/s, output: 18.68 toks/s]
Processed prompts:   9%|▉         | 194/2048 [00:10<02:10, 14.25it/s, est. speed input: 18584.58 toks/s, output: 18.15 toks/s]
Processed prompts:  10%|█         | 210/2048 [00:11<02:10, 14.10it/s, est. speed input: 18143.38 toks/s, output: 17.72 toks/s]
Processed prompts:  11%|█         | 226/2048 [00:13<02:09, 14.03it/s, est. speed input: 17792.86 toks/s, output: 17.38 toks/s]
Processed prompts:  12%|█▏        | 242/2048 [00:14<02:09, 13.95it/s, est. speed input: 17490.72 toks/s, output: 17.08 toks/s]
Processed prompts:  13%|█▎        | 258/2048 [00:15<02:08, 13.91it/s, est. speed input: 17236.82 toks/s, output: 16.83 toks/s]
Processed prompts:  13%|█▎        | 274/2048 [00:16<02:07, 13.87it/s, est. speed input: 17016.70 toks/s, output: 16.62 toks/s]
Processed prompts:  14%|█▍        | 290/2048 [00:17<02:06, 13.84it/s, est. speed input: 16826.32 toks/s, output: 16.43 toks/s]
Processed prompts:  15%|█▍        | 306/2048 [00:18<02:05, 13.83it/s, est. speed input: 16658.98 toks/s, output: 16.27 toks/s]
Processed prompts:  16%|█▌        | 322/2048 [00:19<02:04, 13.82it/s, est. speed input: 16512.71 toks/s, output: 16.13 toks/s]
Processed prompts:  17%|█▋        | 338/2048 [00:21<02:02, 13.99it/s, est. speed input: 16419.12 toks/s, output: 16.03 toks/s]
Processed prompts:  17%|█▋        | 354/2048 [00:22<02:01, 13.91it/s, est. speed input: 16296.49 toks/s, output: 15.91 toks/s]
Processed prompts:  18%|█▊        | 370/2048 [00:23<02:00, 13.88it/s, est. speed input: 16189.36 toks/s, output: 15.81 toks/s]
Processed prompts:  19%|█▉        | 386/2048 [00:24<02:00, 13.85it/s, est. speed input: 16090.83 toks/s, output: 15.71 toks/s]
Processed prompts:  20%|█▉        | 402/2048 [00:25<01:59, 13.83it/s, est. speed input: 16001.14 toks/s, output: 15.63 toks/s]
Processed prompts:  20%|██        | 418/2048 [00:26<01:57, 13.82it/s, est. speed input: 15920.55 toks/s, output: 15.55 toks/s]
Processed prompts:  21%|██        | 434/2048 [00:28<01:56, 13.81it/s, est. speed input: 15845.49 toks/s, output: 15.47 toks/s]
Processed prompts:  22%|██▏       | 450/2048 [00:29<01:54, 14.01it/s, est. speed input: 15807.92 toks/s, output: 15.44 toks/s]
Processed prompts:  23%|██▎       | 466/2048 [00:30<01:53, 13.95it/s, est. speed input: 15744.73 toks/s, output: 15.38 toks/s]
Processed prompts:  24%|██▎       | 482/2048 [00:31<01:52, 13.90it/s, est. speed input: 15683.75 toks/s, output: 15.32 toks/s]
Processed prompts:  24%|██▍       | 498/2048 [00:32<01:51, 13.85it/s, est. speed input: 15626.19 toks/s, output: 15.26 toks/s]
Processed prompts:  25%|██▌       | 514/2048 [00:33<01:51, 13.82it/s, est. speed input: 15572.58 toks/s, output: 15.21 toks/s]
Processed prompts:  26%|██▌       | 530/2048 [00:34<01:50, 13.78it/s, est. speed input: 15521.32 toks/s, output: 15.16 toks/s]
Processed prompts:  27%|██▋       | 546/2048 [00:36<01:48, 13.78it/s, est. speed input: 15476.25 toks/s, output: 15.11 toks/s]
Processed prompts:  27%|██▋       | 562/2048 [00:37<01:47, 13.78it/s, est. speed input: 15432.78 toks/s, output: 15.07 toks/s]
Processed prompts:  28%|██▊       | 578/2048 [00:38<01:46, 13.77it/s, est. speed input: 15392.14 toks/s, output: 15.03 toks/s]
Processed prompts:  29%|██▉       | 594/2048 [00:39<01:45, 13.76it/s, est. speed input: 15353.07 toks/s, output: 14.99 toks/s]
Processed prompts:  30%|██▉       | 610/2048 [00:40<01:44, 13.77it/s, est. speed input: 15317.83 toks/s, output: 14.96 toks/s]
Processed prompts:  31%|███       | 626/2048 [00:41<01:43, 13.76it/s, est. speed input: 15283.28 toks/s, output: 14.93 toks/s]
Processed prompts:  31%|███▏      | 642/2048 [00:43<01:42, 13.77it/s, est. speed input: 15251.61 toks/s, output: 14.89 toks/s]
Processed prompts:  32%|███▏      | 658/2048 [00:44<01:40, 13.76it/s, est. speed input: 15221.09 toks/s, output: 14.86 toks/s]
Processed prompts:  33%|███▎      | 674/2048 [00:45<01:39, 13.76it/s, est. speed input: 15191.92 toks/s, output: 14.84 toks/s]
Processed prompts:  34%|███▎      | 690/2048 [00:46<01:38, 13.75it/s, est. speed input: 15163.71 toks/s, output: 14.81 toks/s]
Processed prompts:  34%|███▍      | 706/2048 [00:47<01:37, 13.73it/s, est. speed input: 15135.44 toks/s, output: 14.78 toks/s]
Processed prompts:  35%|███▌      | 722/2048 [00:48<01:36, 13.73it/s, est. speed input: 15109.98 toks/s, output: 14.76 toks/s]
Processed prompts:  36%|███▌      | 738/2048 [00:50<01:35, 13.73it/s, est. speed input: 15085.63 toks/s, output: 14.73 toks/s]
Processed prompts:  37%|███▋      | 754/2048 [00:51<01:34, 13.74it/s, est. speed input: 15063.39 toks/s, output: 14.71 toks/s]
Processed prompts:  38%|███▊      | 770/2048 [00:52<01:32, 13.76it/s, est. speed input: 15042.36 toks/s, output: 14.69 toks/s]
Processed prompts:  38%|███▊      | 786/2048 [00:53<01:31, 13.75it/s, est. speed input: 15020.85 toks/s, output: 14.67 toks/s]
Processed prompts:  39%|███▉      | 802/2048 [00:54<01:30, 13.73it/s, est. speed input: 14999.33 toks/s, output: 14.65 toks/s]
Processed prompts:  40%|███▉      | 818/2048 [00:55<01:29, 13.74it/s, est. speed input: 14980.72 toks/s, output: 14.63 toks/s]
Processed prompts:  41%|████      | 834/2048 [00:57<01:28, 13.76it/s, est. speed input: 14963.38 toks/s, output: 14.61 toks/s]
Processed prompts:  42%|████▏     | 850/2048 [00:58<01:27, 13.75it/s, est. speed input: 14945.28 toks/s, output: 14.59 toks/s]
Processed prompts:  42%|████▏     | 866/2048 [00:59<01:25, 13.76it/s, est. speed input: 14928.80 toks/s, output: 14.58 toks/s]
Processed prompts:  43%|████▎     | 882/2048 [01:00<01:24, 13.75it/s, est. speed input: 14912.10 toks/s, output: 14.56 toks/s]
Processed prompts:  44%|████▍     | 898/2048 [01:01<01:23, 13.74it/s, est. speed input: 14896.03 toks/s, output: 14.55 toks/s]
Processed prompts:  45%|████▍     | 914/2048 [01:02<01:22, 13.76it/s, est. speed input: 14881.59 toks/s, output: 14.53 toks/s]
Processed prompts:  45%|████▌     | 930/2048 [01:03<01:19, 14.01it/s, est. speed input: 14883.50 toks/s, output: 14.53 toks/s]
Processed prompts:  46%|████▌     | 946/2048 [01:05<01:19, 13.93it/s, est. speed input: 14868.99 toks/s, output: 14.52 toks/s]
Processed prompts:  47%|████▋     | 962/2048 [01:06<01:18, 13.88it/s, est. speed input: 14855.42 toks/s, output: 14.51 toks/s]
Processed prompts:  48%|████▊     | 978/2048 [01:07<01:15, 14.12it/s, est. speed input: 14858.82 toks/s, output: 14.51 toks/s]
Processed prompts:  49%|████▊     | 994/2048 [01:08<01:15, 14.01it/s, est. speed input: 14845.82 toks/s, output: 14.50 toks/s]
Processed prompts:  49%|████▉     | 1010/2048 [01:09<01:14, 13.93it/s, est. speed input: 14833.16 toks/s, output: 14.49 toks/s]
Processed prompts:  50%|█████     | 1026/2048 [01:10<01:13, 13.89it/s, est. speed input: 14821.30 toks/s, output: 14.47 toks/s]
Processed prompts:  51%|█████     | 1042/2048 [01:12<01:12, 13.85it/s, est. speed input: 14809.66 toks/s, output: 14.46 toks/s]
Processed prompts:  52%|█████▏    | 1058/2048 [01:13<01:11, 13.82it/s, est. speed input: 14798.00 toks/s, output: 14.45 toks/s]
Processed prompts:  52%|█████▏    | 1074/2048 [01:14<01:10, 13.79it/s, est. speed input: 14786.45 toks/s, output: 14.44 toks/s]
Processed prompts:  53%|█████▎    | 1090/2048 [01:15<01:09, 13.79it/s, est. speed input: 14775.97 toks/s, output: 14.43 toks/s]
Processed prompts:  54%|█████▍    | 1106/2048 [01:16<01:08, 13.77it/s, est. speed input: 14765.20 toks/s, output: 14.42 toks/s]
Processed prompts:  55%|█████▍    | 1122/2048 [01:17<01:07, 13.76it/s, est. speed input: 14754.85 toks/s, output: 14.41 toks/s]
Processed prompts:  56%|█████▌    | 1138/2048 [01:19<01:06, 13.76it/s, est. speed input: 14745.07 toks/s, output: 14.40 toks/s]
Processed prompts:  56%|█████▋    | 1154/2048 [01:20<01:03, 14.03it/s, est. speed input: 14749.03 toks/s, output: 14.40 toks/s]
Processed prompts:  57%|█████▋    | 1170/2048 [01:21<01:03, 13.94it/s, est. speed input: 14739.14 toks/s, output: 14.39 toks/s]
Processed prompts:  58%|█████▊    | 1186/2048 [01:22<01:02, 13.89it/s, est. speed input: 14730.50 toks/s, output: 14.39 toks/s]
Processed prompts:  59%|█████▊    | 1202/2048 [01:23<01:01, 13.84it/s, est. speed input: 14721.05 toks/s, output: 14.38 toks/s]
Processed prompts:  59%|█████▉    | 1218/2048 [01:24<01:00, 13.81it/s, est. speed input: 14712.24 toks/s, output: 14.37 toks/s]
Processed prompts:  60%|██████    | 1234/2048 [01:25<00:59, 13.80it/s, est. speed input: 14703.69 toks/s, output: 14.36 toks/s]
Processed prompts:  61%|██████    | 1250/2048 [01:27<00:57, 13.79it/s, est. speed input: 14695.85 toks/s, output: 14.35 toks/s]
Processed prompts:  62%|██████▏   | 1266/2048 [01:28<00:55, 14.04it/s, est. speed input: 14699.64 toks/s, output: 14.36 toks/s]
Processed prompts:  63%|██████▎   | 1282/2048 [01:29<00:54, 13.95it/s, est. speed input: 14691.33 toks/s, output: 14.35 toks/s]
Processed prompts:  63%|██████▎   | 1298/2048 [01:30<00:53, 14.15it/s, est. speed input: 14695.08 toks/s, output: 14.35 toks/s]
Processed prompts:  64%|██████▍   | 1314/2048 [01:31<00:52, 14.04it/s, est. speed input: 14687.73 toks/s, output: 14.34 toks/s]
Processed prompts:  65%|██████▍   | 1330/2048 [01:32<00:51, 13.96it/s, est. speed input: 14680.31 toks/s, output: 14.34 toks/s]
Processed prompts:  66%|██████▌   | 1346/2048 [01:33<00:50, 13.89it/s, est. speed input: 14672.83 toks/s, output: 14.33 toks/s]
Processed prompts:  67%|██████▋   | 1362/2048 [01:35<00:49, 13.86it/s, est. speed input: 14665.91 toks/s, output: 14.32 toks/s]
Processed prompts:  67%|██████▋   | 1378/2048 [01:36<00:48, 13.81it/s, est. speed input: 14658.39 toks/s, output: 14.31 toks/s]
Processed prompts:  68%|██████▊   | 1394/2048 [01:37<00:47, 13.79it/s, est. speed input: 14651.07 toks/s, output: 14.31 toks/s]
Processed prompts:  69%|██████▉   | 1410/2048 [01:38<00:46, 13.78it/s, est. speed input: 14644.69 toks/s, output: 14.30 toks/s]
Processed prompts:  70%|██████▉   | 1426/2048 [01:39<00:45, 13.78it/s, est. speed input: 14638.34 toks/s, output: 14.30 toks/s]
Processed prompts:  70%|███████   | 1442/2048 [01:40<00:43, 13.78it/s, est. speed input: 14632.50 toks/s, output: 14.29 toks/s]
Processed prompts:  71%|███████   | 1458/2048 [01:42<00:42, 13.75it/s, est. speed input: 14625.11 toks/s, output: 14.28 toks/s]
Processed prompts:  72%|███████▏  | 1474/2048 [01:43<00:41, 13.77it/s, est. speed input: 14619.64 toks/s, output: 14.28 toks/s]
Processed prompts:  73%|███████▎  | 1490/2048 [01:44<00:40, 13.76it/s, est. speed input: 14613.72 toks/s, output: 14.27 toks/s]
Processed prompts:  74%|███████▎  | 1506/2048 [01:45<00:39, 13.78it/s, est. speed input: 14608.46 toks/s, output: 14.27 toks/s]
Processed prompts:  74%|███████▍  | 1522/2048 [01:46<00:38, 13.77it/s, est. speed input: 14602.83 toks/s, output: 14.26 toks/s]
Processed prompts:  75%|███████▌  | 1538/2048 [01:47<00:37, 13.76it/s, est. speed input: 14597.04 toks/s, output: 14.25 toks/s]
Processed prompts:  76%|███████▌  | 1554/2048 [01:49<00:35, 13.76it/s, est. speed input: 14591.57 toks/s, output: 14.25 toks/s]
Processed prompts:  77%|███████▋  | 1570/2048 [01:50<00:34, 13.75it/s, est. speed input: 14586.00 toks/s, output: 14.24 toks/s]
Processed prompts:  77%|███████▋  | 1586/2048 [01:51<00:32, 14.02it/s, est. speed input: 14590.40 toks/s, output: 14.25 toks/s]
Processed prompts:  78%|███████▊  | 1602/2048 [01:52<00:31, 13.95it/s, est. speed input: 14585.42 toks/s, output: 14.24 toks/s]
Processed prompts:  79%|███████▉  | 1618/2048 [01:53<00:30, 13.88it/s, est. speed input: 14580.13 toks/s, output: 14.24 toks/s]
Processed prompts:  80%|███████▉  | 1634/2048 [01:54<00:29, 13.82it/s, est. speed input: 14574.28 toks/s, output: 14.23 toks/s]
Processed prompts:  81%|████████  | 1650/2048 [01:55<00:28, 14.06it/s, est. speed input: 14578.43 toks/s, output: 14.24 toks/s]
Processed prompts:  81%|████████▏ | 1666/2048 [01:57<00:27, 13.97it/s, est. speed input: 14573.43 toks/s, output: 14.23 toks/s]
Processed prompts:  82%|████████▏ | 1682/2048 [01:58<00:26, 13.90it/s, est. speed input: 14568.41 toks/s, output: 14.23 toks/s]
Processed prompts:  83%|████████▎ | 1698/2048 [01:59<00:25, 13.86it/s, est. speed input: 14563.79 toks/s, output: 14.22 toks/s]
Processed prompts:  84%|████████▎ | 1714/2048 [02:00<00:24, 13.82it/s, est. speed input: 14558.97 toks/s, output: 14.22 toks/s]
Processed prompts:  84%|████████▍ | 1730/2048 [02:01<00:23, 13.81it/s, est. speed input: 14554.83 toks/s, output: 14.21 toks/s]
Processed prompts:  85%|████████▌ | 1746/2048 [02:02<00:21, 13.80it/s, est. speed input: 14550.40 toks/s, output: 14.21 toks/s]
Processed prompts:  86%|████████▌ | 1762/2048 [02:04<00:20, 13.79it/s, est. speed input: 14546.12 toks/s, output: 14.21 toks/s]
Processed prompts:  87%|████████▋ | 1778/2048 [02:05<00:19, 13.77it/s, est. speed input: 14541.72 toks/s, output: 14.20 toks/s]
Processed prompts:  88%|████████▊ | 1794/2048 [02:06<00:18, 13.76it/s, est. speed input: 14537.36 toks/s, output: 14.20 toks/s]
Processed prompts:  88%|████████▊ | 1810/2048 [02:07<00:17, 13.76it/s, est. speed input: 14533.21 toks/s, output: 14.19 toks/s]
Processed prompts:  89%|████████▉ | 1826/2048 [02:08<00:16, 13.76it/s, est. speed input: 14529.26 toks/s, output: 14.19 toks/s]
Processed prompts:  90%|████████▉ | 1842/2048 [02:09<00:14, 13.76it/s, est. speed input: 14525.21 toks/s, output: 14.18 toks/s]
Processed prompts:  91%|█████████ | 1858/2048 [02:11<00:13, 13.76it/s, est. speed input: 14521.25 toks/s, output: 14.18 toks/s]
Processed prompts:  92%|█████████▏| 1874/2048 [02:12<00:12, 14.02it/s, est. speed input: 14525.48 toks/s, output: 14.19 toks/s]
Processed prompts:  92%|█████████▏| 1890/2048 [02:13<00:11, 13.94it/s, est. speed input: 14521.58 toks/s, output: 14.18 toks/s]
Processed prompts:  93%|█████████▎| 1906/2048 [02:14<00:10, 13.89it/s, est. speed input: 14518.08 toks/s, output: 14.18 toks/s]
Processed prompts:  94%|█████████▍| 1922/2048 [02:15<00:09, 13.84it/s, est. speed input: 14514.06 toks/s, output: 14.17 toks/s]
Processed prompts:  95%|█████████▍| 1938/2048 [02:16<00:07, 13.82it/s, est. speed input: 14510.44 toks/s, output: 14.17 toks/s]
Processed prompts:  95%|█████████▌| 1954/2048 [02:17<00:06, 14.07it/s, est. speed input: 14514.66 toks/s, output: 14.17 toks/s]
Processed prompts:  96%|█████████▌| 1970/2048 [02:19<00:05, 13.98it/s, est. speed input: 14511.31 toks/s, output: 14.17 toks/s]
Processed prompts:  97%|█████████▋| 1986/2048 [02:20<00:04, 14.18it/s, est. speed input: 14515.22 toks/s, output: 14.18 toks/s]
Processed prompts:  98%|█████████▊| 2002/2048 [02:21<00:03, 14.04it/s, est. speed input: 14511.35 toks/s, output: 14.17 toks/s]
Processed prompts:  99%|█████████▊| 2018/2048 [02:22<00:02, 13.95it/s, est. speed input: 14507.90 toks/s, output: 14.17 toks/s]
Processed prompts:  99%|█████████▉| 2034/2048 [02:23<00:00, 14.09it/s, est. speed input: 14509.91 toks/s, output: 14.17 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:23<00:00, 14.09it/s, est. speed input: 14609.77 toks/s, output: 14.27 toks/s]
Processed prompts: 100%|██████████| 2048/2048 [02:23<00:00, 14.27it/s, est. speed input: 14609.77 toks/s, output: 14.27 toks/s]
[rank0]:[W128 09:39:29.746472371 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 190.5s

测试结果:
  Requests/s:   13.83
  Tokens/s:     14171.71
  Total Reqs:   2048
  Elapsed:      148.13s

  [Prefill 分析]
  Total Prefill Tokens: 2097152
  Prefill Tokens/s:     14157.88

============================================================
[7/7] 测试 M=32768
============================================================

┌─────────────────────────────────────────────────────────────┐
│                    测试参数                                  │
├─────────────────────────────────────────────────────────────┤
│ 模型:     BitNet-2B-FP8                                   │
│ Backend:  cuSPARSELt (2:10)                               │
│ 阶段:     prefill                                         │
├─────────────────────────────────────────────────────────────┤
│ GEMM M 维度 (精确控制):
│   目标 M        = 32768
│   M_prefill     = 32768 (= 32 x 1024)
│   M_decode      = 32
│   batched_tokens = 32768 (控制 M 的关键参数)
├─────────────────────────────────────────────────────────────┤
│ vLLM 参数:
│   --input-len              = 1024
│   --output-len             = 1
│   --num-prompts            = 4096
│   --max-num-seqs           = 32
│   --max-model-len          = 1025
│   --max-num-batched-tokens = 32768
│   --no-enable-chunked-prefill
├─────────────────────────────────────────────────────────────┤
│ 迭代次数:
│   N_prefill = 128
│   N_decode  = 0
├─────────────────────────────────────────────────────────────┤
│ 编译模式: --enforce-eager
└─────────────────────────────────────────────────────────────┘

[INFO] 开始测试...

─── STDOUT ───
When dataset path is not set, it will default to random dataset
WARNING 01-28 09:39:46 [arg_utils.py:1869] This model does not officially support disabling chunked prefill. Disabling this manually may cause the engine to crash or produce incorrect outputs.
WARNING 01-28 09:39:46 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
(EngineCore_DP0 pid=3757986) [INFO] Loading compress extension: cusparselt_compress_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3757986) WARNING 01-28 09:40:20 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
Throughput: 14.00 requests/s, 14346.47 total tokens/s, 14.00 output tokens/s
Total num prompt tokens:  4194304
Total num output tokens:  4096


─── STDERR ───
[2026-01-28 09:39:46] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:39:46] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:39:46] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:46] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:39:46] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:39:46] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:39:46] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:39:46] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:39:46] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
[2026-01-28 09:39:50] INFO kernels.py:578: Triton kernel custom ops registered
/usr/local/lib/python3.12/dist-packages/torch/cuda/__init__.py:283: UserWarning: 
    Found GPU0 NVIDIA GB10 which is of cuda capability 12.1.
    Minimum and Maximum cuda capability supported by this version of PyTorch is
    (8.0) - (12.0)
    
  warnings.warn(
[2026-01-28 09:39:50] INFO kernels.py:627: Optimization enabled: Only preloading kernels for model 'BitNet-2B-FP8'
[2026-01-28 09:39:50] INFO kernels.py:109: Loaded tuned kernel for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO kernels.py:155: Dequant+bias kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO kernels.py:224: FP8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO kernels.py:348: INT8 quant kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO kernels.py:284: FP8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO kernels.py:408: INT8 quant+slide kernel loaded for model: BitNet-2B-FP8
[2026-01-28 09:39:50] INFO gemm_wrapper.py:157: Optimization enabled: Only loading GEMM configs for model 'BitNet-2B-FP8'
[2026-01-28 09:39:50] INFO gemm_wrapper.py:172: Loaded algorithm configs: cuBLASLt=1, cuSPARSELt=1 models
[2026-01-28 09:39:50] INFO gemm_wrapper.py:944: cuBLASLt FP8 custom op registered: slidesparse::cublaslt_fp8_mm
[2026-01-28 09:39:50] INFO gemm_wrapper.py:1009: cuSPARSELt FP8 custom op registered: slidesparse::cusparselt_fp8_mm
[2026-01-28 09:39:50] INFO gemm_wrapper.py:1075: cuBLASLt INT8 custom op registered: slidesparse::cublaslt_int8_mm
[2026-01-28 09:39:50] INFO gemm_wrapper.py:1141: cuSPARSELt INT8 custom op registered: slidesparse::cusparselt_int8_mm
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO SlideSparseLinearMethod_FP8.py:734: Wrapping CompressedTensorsW8A8Fp8 with SlideSparse (cuSPARSELt)
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO gemm_wrapper.py:870: cusparselt GEMM extension loaded: cusparselt_gemm_GB10_cc121_py312_cu129_aarch64.so
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO SlideSparseLinearMethod_FP8.py:392: SlideSparseFp8LinearOp initialized (kernel=cuSPARSELt)
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO SlideSparseLinearMethod_FP8.py:539: SlideSparseFp8LinearMethod: cuSPARSELt sparsity=2:10, expand_ratio=1.250
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO SlideSparseLinearMethod_FP8.py:556: Preloaded FP8 Triton kernels for model: BitNet-2B-FP8
(EngineCore_DP0 pid=3757986) [2026-01-28 09:39:51] INFO SlideSparseLinearMethod_FP8.py:560: SlideSparseFp8LinearMethod initialized, kernel=cuSPARSELt
(EngineCore_DP0 pid=3757986) 
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
(EngineCore_DP0 pid=3757986) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.57s/it]
(EngineCore_DP0 pid=3757986) 
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:17<00:00, 17.58s/it]
(EngineCore_DP0 pid=3757986) 
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [3840, 4096] -> 1D uint8
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 9830400 bytes
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 4096] -> 1D uint8
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 6553600 bytes
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [13824, 4096] -> 1D uint8
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 35389440 bytes
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:660: cuSPARSELt compression: [2560, 11072] -> 1D uint8
(EngineCore_DP0 pid=3757986) [2026-01-28 09:40:09] INFO SlideSparseLinearMethod_FP8.py:670: cuSPARSELt compression done: 17735680 bytes
(EngineCore_DP0 pid=3757986) 2026-01-28 09:40:17,379 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
(EngineCore_DP0 pid=3757986) 2026-01-28 09:40:17,569 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends

Adding requests:   0%|          | 0/4096 [00:00<?, ?it/s]
Adding requests:   2%|▏         | 64/4096 [00:00<00:06, 638.08it/s]
Adding requests:   3%|▎         | 128/4096 [00:00<00:06, 608.62it/s]
Adding requests:   5%|▍         | 189/4096 [00:00<00:07, 551.07it/s]
Adding requests:   6%|▌         | 245/4096 [00:00<00:07, 539.60it/s]
Adding requests:   7%|▋         | 300/4096 [00:00<00:07, 523.70it/s]
Adding requests:   9%|▊         | 356/4096 [00:00<00:06, 534.39it/s]
Adding requests:  10%|█         | 411/4096 [00:00<00:06, 535.79it/s]
Adding requests:  11%|█▏        | 465/4096 [00:00<00:06, 532.96it/s]
Adding requests:  13%|█▎        | 519/4096 [00:00<00:06, 522.04it/s]
Adding requests:  14%|█▍        | 572/4096 [00:01<00:06, 521.76it/s]
Adding requests:  15%|█▌        | 625/4096 [00:01<00:06, 511.52it/s]
Adding requests:  17%|█▋        | 677/4096 [00:01<00:06, 512.94it/s]
Adding requests:  18%|█▊        | 731/4096 [00:01<00:06, 518.15it/s]
Adding requests:  19%|█▉        | 783/4096 [00:01<00:06, 508.83it/s]
Adding requests:  20%|██        | 834/4096 [00:01<00:06, 501.46it/s]
Adding requests:  22%|██▏       | 892/4096 [00:01<00:06, 523.61it/s]
Adding requests:  23%|██▎       | 945/4096 [00:01<00:06, 517.83it/s]
Adding requests:  24%|██▍       | 997/4096 [00:01<00:05, 517.25it/s]
Adding requests:  26%|██▌       | 1051/4096 [00:01<00:05, 523.30it/s]
Adding requests:  27%|██▋       | 1104/4096 [00:02<00:05, 514.29it/s]
Adding requests:  28%|██▊       | 1157/4096 [00:02<00:05, 515.96it/s]
Adding requests:  30%|██▉       | 1209/4096 [00:02<00:05, 496.30it/s]
Adding requests:  31%|███       | 1259/4096 [00:02<00:05, 496.30it/s]
Adding requests:  32%|███▏      | 1309/4096 [00:02<00:05, 492.80it/s]
Adding requests:  33%|███▎      | 1359/4096 [00:02<00:05, 487.87it/s]
Adding requests:  34%|███▍      | 1412/4096 [00:02<00:05, 496.78it/s]
Adding requests:  36%|███▌      | 1464/4096 [00:02<00:05, 502.18it/s]
Adding requests:  37%|███▋      | 1515/4096 [00:02<00:05, 504.08it/s]
Adding requests:  38%|███▊      | 1568/4096 [00:03<00:04, 511.47it/s]
Adding requests:  40%|███▉      | 1620/4096 [00:03<00:04, 507.17it/s]
Adding requests:  41%|████      | 1671/4096 [00:03<00:04, 501.88it/s]
Adding requests:  42%|████▏     | 1725/4096 [00:03<00:04, 509.44it/s]
Adding requests:  43%|████▎     | 1776/4096 [00:03<00:04, 506.79it/s]
Adding requests:  45%|████▍     | 1827/4096 [00:03<00:04, 506.02it/s]
Adding requests:  46%|████▌     | 1880/4096 [00:03<00:04, 511.57it/s]
Adding requests:  47%|████▋     | 1933/4096 [00:03<00:04, 516.09it/s]
Adding requests:  48%|████▊     | 1985/4096 [00:03<00:04, 510.92it/s]
Adding requests:  50%|████▉     | 2037/4096 [00:03<00:04, 510.47it/s]
Adding requests:  51%|█████     | 2089/4096 [00:04<00:03, 512.23it/s]
Adding requests:  52%|█████▏    | 2141/4096 [00:04<00:03, 506.78it/s]
Adding requests:  54%|█████▎    | 2192/4096 [00:04<00:03, 500.66it/s]
Adding requests:  55%|█████▍    | 2245/4096 [00:04<00:03, 508.69it/s]
Adding requests:  56%|█████▌    | 2298/4096 [00:04<00:03, 513.70it/s]
Adding requests:  57%|█████▋    | 2350/4096 [00:04<00:03, 513.80it/s]
Adding requests:  59%|█████▊    | 2404/4096 [00:04<00:03, 520.14it/s]
Adding requests:  60%|█████▉    | 2457/4096 [00:04<00:03, 499.64it/s]
Adding requests:  61%|██████▏   | 2510/4096 [00:04<00:03, 506.23it/s]
Adding requests:  63%|██████▎   | 2561/4096 [00:04<00:03, 506.17it/s]
Adding requests:  64%|██████▍   | 2612/4096 [00:05<00:02, 507.24it/s]
Adding requests:  65%|██████▌   | 2667/4096 [00:05<00:02, 516.93it/s]
Adding requests:  66%|██████▋   | 2719/4096 [00:05<00:02, 514.51it/s]
Adding requests:  68%|██████▊   | 2771/4096 [00:05<00:02, 508.77it/s]
Adding requests:  69%|██████▉   | 2823/4096 [00:05<00:02, 511.42it/s]
Adding requests:  70%|███████   | 2878/4096 [00:05<00:02, 522.51it/s]
Adding requests:  72%|███████▏  | 2931/4096 [00:05<00:02, 511.92it/s]
Adding requests:  73%|███████▎  | 2984/4096 [00:05<00:02, 516.04it/s]
Adding requests:  74%|███████▍  | 3036/4096 [00:05<00:02, 511.95it/s]
Adding requests:  75%|███████▌  | 3088/4096 [00:06<00:01, 514.11it/s]
Adding requests:  77%|███████▋  | 3140/4096 [00:06<00:01, 509.45it/s]
Adding requests:  78%|███████▊  | 3192/4096 [00:06<00:01, 511.65it/s]
Adding requests:  79%|███████▉  | 3244/4096 [00:06<00:01, 509.03it/s]
Adding requests:  81%|████████  | 3298/4096 [00:06<00:01, 517.21it/s]
Adding requests:  82%|████████▏ | 3351/4096 [00:06<00:01, 518.72it/s]
Adding requests:  83%|████████▎ | 3403/4096 [00:06<00:01, 511.81it/s]
Adding requests:  84%|████████▍ | 3457/4096 [00:06<00:01, 516.00it/s]
Adding requests:  86%|████████▌ | 3509/4096 [00:06<00:01, 517.10it/s]
Adding requests:  87%|████████▋ | 3561/4096 [00:06<00:01, 514.53it/s]
Adding requests:  88%|████████▊ | 3613/4096 [00:07<00:00, 514.24it/s]
Adding requests:  90%|████████▉ | 3667/4096 [00:07<00:00, 520.31it/s]
Adding requests:  91%|█████████ | 3720/4096 [00:07<00:00, 512.38it/s]
Adding requests:  92%|█████████▏| 3774/4096 [00:07<00:00, 518.45it/s]
Adding requests:  93%|█████████▎| 3826/4096 [00:07<00:00, 475.33it/s]
Adding requests:  95%|█████████▍| 3881/4096 [00:07<00:00, 495.42it/s]
Adding requests:  96%|█████████▌| 3935/4096 [00:07<00:00, 506.49it/s]
Adding requests:  97%|█████████▋| 3987/4096 [00:07<00:00, 509.25it/s]
Adding requests:  99%|█████████▊| 4041/4096 [00:07<00:00, 518.07it/s]
Adding requests: 100%|█████████▉| 4095/4096 [00:07<00:00, 522.21it/s]
Adding requests: 100%|██████████| 4096/4096 [00:07<00:00, 513.46it/s]

Processed prompts:   0%|          | 0/4096 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
Processed prompts:   2%|▏         | 98/4096 [00:01<00:57, 69.58it/s, est. speed input: 71248.66 toks/s, output: 69.58 toks/s]
Processed prompts:   3%|▎         | 130/4096 [00:03<02:09, 30.71it/s, est. speed input: 35995.34 toks/s, output: 35.15 toks/s]
Processed prompts:   4%|▍         | 162/4096 [00:05<02:56, 22.32it/s, est. speed input: 27678.34 toks/s, output: 27.03 toks/s]
Processed prompts:   5%|▍         | 194/4096 [00:08<03:26, 18.85it/s, est. speed input: 23985.74 toks/s, output: 23.42 toks/s]
Processed prompts:   6%|▌         | 226/4096 [00:10<03:47, 17.03it/s, est. speed input: 21890.32 toks/s, output: 21.38 toks/s]
Processed prompts:   6%|▋         | 258/4096 [00:12<04:00, 15.96it/s, est. speed input: 20536.32 toks/s, output: 20.05 toks/s]
Processed prompts:   7%|▋         | 290/4096 [00:15<04:08, 15.29it/s, est. speed input: 19589.56 toks/s, output: 19.13 toks/s]
Processed prompts:   8%|▊         | 322/4096 [00:17<04:12, 14.96it/s, est. speed input: 18940.95 toks/s, output: 18.50 toks/s]
Processed prompts:   9%|▊         | 354/4096 [00:19<04:15, 14.63it/s, est. speed input: 18396.81 toks/s, output: 17.97 toks/s]
Processed prompts:   9%|▉         | 386/4096 [00:21<04:17, 14.43it/s, est. speed input: 17970.17 toks/s, output: 17.55 toks/s]
Processed prompts:  10%|█         | 418/4096 [00:24<04:17, 14.28it/s, est. speed input: 17623.46 toks/s, output: 17.21 toks/s]
Processed prompts:  11%|█         | 450/4096 [00:26<04:16, 14.24it/s, est. speed input: 17354.92 toks/s, output: 16.95 toks/s]
Processed prompts:  12%|█▏        | 482/4096 [00:28<04:15, 14.14it/s, est. speed input: 17108.85 toks/s, output: 16.71 toks/s]
Processed prompts:  13%|█▎        | 514/4096 [00:31<04:14, 14.08it/s, est. speed input: 16898.06 toks/s, output: 16.50 toks/s]
Processed prompts:  13%|█▎        | 546/4096 [00:33<04:12, 14.04it/s, est. speed input: 16719.87 toks/s, output: 16.33 toks/s]
Processed prompts:  14%|█▍        | 578/4096 [00:35<04:11, 14.01it/s, est. speed input: 16562.70 toks/s, output: 16.17 toks/s]
Processed prompts:  15%|█▍        | 610/4096 [00:38<04:09, 13.99it/s, est. speed input: 16424.88 toks/s, output: 16.04 toks/s]
Processed prompts:  16%|█▌        | 642/4096 [00:40<04:07, 13.98it/s, est. speed input: 16303.01 toks/s, output: 15.92 toks/s]
Processed prompts:  16%|█▋        | 674/4096 [00:42<04:05, 13.97it/s, est. speed input: 16193.73 toks/s, output: 15.81 toks/s]
Processed prompts:  17%|█▋        | 706/4096 [00:44<04:03, 13.95it/s, est. speed input: 16093.56 toks/s, output: 15.72 toks/s]
Processed prompts:  18%|█▊        | 738/4096 [00:47<04:00, 13.94it/s, est. speed input: 16003.39 toks/s, output: 15.63 toks/s]
Processed prompts:  19%|█▉        | 770/4096 [00:49<03:58, 13.94it/s, est. speed input: 15923.19 toks/s, output: 15.55 toks/s]
Processed prompts:  20%|█▉        | 802/4096 [00:51<03:56, 13.93it/s, est. speed input: 15849.17 toks/s, output: 15.48 toks/s]
Processed prompts:  20%|██        | 834/4096 [00:54<03:54, 13.93it/s, est. speed input: 15781.87 toks/s, output: 15.41 toks/s]
Processed prompts:  21%|██        | 866/4096 [00:56<03:51, 13.94it/s, est. speed input: 15721.71 toks/s, output: 15.35 toks/s]
Processed prompts:  22%|██▏       | 898/4096 [00:58<03:49, 13.93it/s, est. speed input: 15664.22 toks/s, output: 15.30 toks/s]
Processed prompts:  23%|██▎       | 930/4096 [01:00<03:46, 14.01it/s, est. speed input: 15622.01 toks/s, output: 15.26 toks/s]
Processed prompts:  23%|██▎       | 962/4096 [01:03<03:42, 14.06it/s, est. speed input: 15582.59 toks/s, output: 15.22 toks/s]
Processed prompts:  24%|██▍       | 994/4096 [01:05<03:41, 14.02it/s, est. speed input: 15536.13 toks/s, output: 15.17 toks/s]
Processed prompts:  25%|██▌       | 1026/4096 [01:07<03:39, 13.99it/s, est. speed input: 15492.36 toks/s, output: 15.13 toks/s]
Processed prompts:  26%|██▌       | 1058/4096 [01:10<03:37, 13.97it/s, est. speed input: 15452.55 toks/s, output: 15.09 toks/s]
Processed prompts:  27%|██▋       | 1090/4096 [01:12<03:35, 13.96it/s, est. speed input: 15414.49 toks/s, output: 15.05 toks/s]
Processed prompts:  27%|██▋       | 1122/4096 [01:14<03:33, 13.94it/s, est. speed input: 15378.38 toks/s, output: 15.02 toks/s]
Processed prompts:  28%|██▊       | 1154/4096 [01:16<03:29, 14.01it/s, est. speed input: 15353.32 toks/s, output: 14.99 toks/s]
Processed prompts:  29%|██▉       | 1186/4096 [01:19<03:28, 13.98it/s, est. speed input: 15320.77 toks/s, output: 14.96 toks/s]
Processed prompts:  30%|██▉       | 1218/4096 [01:21<03:26, 13.97it/s, est. speed input: 15291.35 toks/s, output: 14.93 toks/s]
Processed prompts:  31%|███       | 1250/4096 [01:23<03:22, 14.03it/s, est. speed input: 15270.87 toks/s, output: 14.91 toks/s]
Processed prompts:  31%|███▏      | 1282/4096 [01:26<03:19, 14.08it/s, est. speed input: 15251.79 toks/s, output: 14.89 toks/s]
Processed prompts:  32%|███▏      | 1314/4096 [01:28<03:18, 14.03it/s, est. speed input: 15225.68 toks/s, output: 14.87 toks/s]
Processed prompts:  33%|███▎      | 1346/4096 [01:30<03:16, 14.00it/s, est. speed input: 15201.34 toks/s, output: 14.85 toks/s]
Processed prompts:  34%|███▎      | 1378/4096 [01:32<03:14, 13.96it/s, est. speed input: 15176.50 toks/s, output: 14.82 toks/s]
Processed prompts:  34%|███▍      | 1410/4096 [01:35<03:12, 13.95it/s, est. speed input: 15154.18 toks/s, output: 14.80 toks/s]
Processed prompts:  35%|███▌      | 1442/4096 [01:37<03:10, 13.94it/s, est. speed input: 15133.36 toks/s, output: 14.78 toks/s]
Processed prompts:  36%|███▌      | 1474/4096 [01:39<03:08, 13.94it/s, est. speed input: 15113.49 toks/s, output: 14.76 toks/s]
Processed prompts:  37%|███▋      | 1506/4096 [01:42<03:05, 13.93it/s, est. speed input: 15094.00 toks/s, output: 14.74 toks/s]
Processed prompts:  38%|███▊      | 1538/4096 [01:44<03:03, 13.93it/s, est. speed input: 15075.70 toks/s, output: 14.72 toks/s]
Processed prompts:  38%|███▊      | 1570/4096 [01:46<03:00, 14.01it/s, est. speed input: 15064.34 toks/s, output: 14.71 toks/s]
Processed prompts:  39%|███▉      | 1602/4096 [01:49<02:58, 13.97it/s, est. speed input: 15046.60 toks/s, output: 14.69 toks/s]
Processed prompts:  40%|███▉      | 1634/4096 [01:51<02:55, 14.04it/s, est. speed input: 15036.49 toks/s, output: 14.68 toks/s]
Processed prompts:  41%|████      | 1666/4096 [01:53<02:53, 14.01it/s, est. speed input: 15020.92 toks/s, output: 14.67 toks/s]
Processed prompts:  41%|████▏     | 1698/4096 [01:55<02:51, 13.99it/s, est. speed input: 15006.04 toks/s, output: 14.65 toks/s]
Processed prompts:  42%|████▏     | 1730/4096 [01:58<02:49, 13.97it/s, est. speed input: 14991.70 toks/s, output: 14.64 toks/s]
Processed prompts:  43%|████▎     | 1762/4096 [02:00<02:47, 13.96it/s, est. speed input: 14978.00 toks/s, output: 14.63 toks/s]
Processed prompts:  44%|████▍     | 1794/4096 [02:02<02:45, 13.94it/s, est. speed input: 14963.82 toks/s, output: 14.61 toks/s]
Processed prompts:  45%|████▍     | 1826/4096 [02:05<02:42, 13.93it/s, est. speed input: 14950.74 toks/s, output: 14.60 toks/s]
Processed prompts:  45%|████▌     | 1858/4096 [02:07<02:39, 14.01it/s, est. speed input: 14943.22 toks/s, output: 14.59 toks/s]
Processed prompts:  46%|████▌     | 1890/4096 [02:09<02:37, 13.99it/s, est. speed input: 14931.29 toks/s, output: 14.58 toks/s]
Processed prompts:  47%|████▋     | 1922/4096 [02:11<02:35, 13.97it/s, est. speed input: 14919.62 toks/s, output: 14.57 toks/s]
Processed prompts:  48%|████▊     | 1954/4096 [02:14<02:32, 14.04it/s, est. speed input: 14913.36 toks/s, output: 14.56 toks/s]
Processed prompts:  48%|████▊     | 1986/4096 [02:16<02:29, 14.08it/s, est. speed input: 14906.87 toks/s, output: 14.56 toks/s]
Processed prompts:  49%|████▉     | 2018/4096 [02:18<02:28, 14.04it/s, est. speed input: 14896.43 toks/s, output: 14.55 toks/s]
Processed prompts:  50%|█████     | 2050/4096 [02:21<02:26, 14.00it/s, est. speed input: 14885.83 toks/s, output: 14.54 toks/s]
Processed prompts:  51%|█████     | 2082/4096 [02:23<02:24, 13.97it/s, est. speed input: 14875.53 toks/s, output: 14.53 toks/s]
Processed prompts:  52%|█████▏    | 2114/4096 [02:25<02:21, 13.96it/s, est. speed input: 14865.75 toks/s, output: 14.52 toks/s]
Processed prompts:  52%|█████▏    | 2146/4096 [02:27<02:19, 13.95it/s, est. speed input: 14856.48 toks/s, output: 14.51 toks/s]
Processed prompts:  53%|█████▎    | 2178/4096 [02:30<02:17, 13.95it/s, est. speed input: 14847.62 toks/s, output: 14.50 toks/s]
Processed prompts:  54%|█████▍    | 2210/4096 [02:32<02:13, 14.17it/s, est. speed input: 14850.71 toks/s, output: 14.50 toks/s]
Processed prompts:  55%|█████▍    | 2242/4096 [02:34<02:11, 14.10it/s, est. speed input: 14842.27 toks/s, output: 14.49 toks/s]
Processed prompts:  56%|█████▌    | 2274/4096 [02:36<02:09, 14.12it/s, est. speed input: 14837.20 toks/s, output: 14.49 toks/s]
Processed prompts:  56%|█████▋    | 2306/4096 [02:39<02:07, 14.06it/s, est. speed input: 14828.80 toks/s, output: 14.48 toks/s]
Processed prompts:  57%|█████▋    | 2338/4096 [02:41<02:04, 14.09it/s, est. speed input: 14824.45 toks/s, output: 14.48 toks/s]
Processed prompts:  58%|█████▊    | 2370/4096 [02:43<02:00, 14.29it/s, est. speed input: 14828.50 toks/s, output: 14.48 toks/s]
Processed prompts:  59%|█████▊    | 2402/4096 [02:45<01:58, 14.26it/s, est. speed input: 14824.41 toks/s, output: 14.48 toks/s]
Processed prompts:  59%|█████▉    | 2434/4096 [02:48<01:57, 14.16it/s, est. speed input: 14816.66 toks/s, output: 14.47 toks/s]
Processed prompts:  60%|██████    | 2466/4096 [02:50<01:55, 14.09it/s, est. speed input: 14809.14 toks/s, output: 14.46 toks/s]
Processed prompts:  61%|██████    | 2498/4096 [02:52<01:53, 14.11it/s, est. speed input: 14804.98 toks/s, output: 14.46 toks/s]
Processed prompts:  62%|██████▏   | 2530/4096 [02:55<01:51, 14.04it/s, est. speed input: 14797.10 toks/s, output: 14.45 toks/s]
Processed prompts:  63%|██████▎   | 2562/4096 [02:57<01:48, 14.08it/s, est. speed input: 14793.61 toks/s, output: 14.45 toks/s]
Processed prompts:  63%|██████▎   | 2594/4096 [02:59<01:47, 14.03it/s, est. speed input: 14786.79 toks/s, output: 14.44 toks/s]
Processed prompts:  64%|██████▍   | 2626/4096 [03:01<01:45, 13.99it/s, est. speed input: 14779.84 toks/s, output: 14.43 toks/s]
Processed prompts:  65%|██████▍   | 2658/4096 [03:04<01:42, 13.97it/s, est. speed input: 14773.09 toks/s, output: 14.43 toks/s]
Processed prompts:  66%|██████▌   | 2690/4096 [03:06<01:40, 14.03it/s, est. speed input: 14769.97 toks/s, output: 14.42 toks/s]
Processed prompts:  66%|██████▋   | 2722/4096 [03:08<01:38, 14.00it/s, est. speed input: 14763.69 toks/s, output: 14.42 toks/s]
Processed prompts:  67%|██████▋   | 2754/4096 [03:11<01:36, 13.97it/s, est. speed input: 14757.29 toks/s, output: 14.41 toks/s]
Processed prompts:  68%|██████▊   | 2786/4096 [03:13<01:33, 13.94it/s, est. speed input: 14750.97 toks/s, output: 14.41 toks/s]
Processed prompts:  69%|██████▉   | 2818/4096 [03:15<01:31, 13.93it/s, est. speed input: 14744.94 toks/s, output: 14.40 toks/s]
Processed prompts:  70%|██████▉   | 2850/4096 [03:17<01:28, 14.01it/s, est. speed input: 14742.54 toks/s, output: 14.40 toks/s]
Processed prompts:  70%|███████   | 2882/4096 [03:20<01:26, 13.98it/s, est. speed input: 14736.86 toks/s, output: 14.39 toks/s]
Processed prompts:  71%|███████   | 2914/4096 [03:22<01:24, 13.96it/s, est. speed input: 14731.20 toks/s, output: 14.39 toks/s]
Processed prompts:  72%|███████▏  | 2946/4096 [03:24<01:22, 13.93it/s, est. speed input: 14725.14 toks/s, output: 14.38 toks/s]
Processed prompts:  73%|███████▎  | 2978/4096 [03:27<01:20, 13.93it/s, est. speed input: 14719.99 toks/s, output: 14.37 toks/s]
Processed prompts:  73%|███████▎  | 3010/4096 [03:29<01:18, 13.92it/s, est. speed input: 14714.76 toks/s, output: 14.37 toks/s]
Processed prompts:  74%|███████▍  | 3042/4096 [03:31<01:15, 13.92it/s, est. speed input: 14709.72 toks/s, output: 14.36 toks/s]
Processed prompts:  75%|███████▌  | 3074/4096 [03:34<01:13, 13.92it/s, est. speed input: 14704.83 toks/s, output: 14.36 toks/s]
Processed prompts:  76%|███████▌  | 3106/4096 [03:36<01:09, 14.17it/s, est. speed input: 14709.26 toks/s, output: 14.36 toks/s]
Processed prompts:  77%|███████▋  | 3138/4096 [03:38<01:07, 14.17it/s, est. speed input: 14707.25 toks/s, output: 14.36 toks/s]
Processed prompts:  77%|███████▋  | 3170/4096 [03:40<01:05, 14.08it/s, est. speed input: 14702.01 toks/s, output: 14.36 toks/s]
Processed prompts:  78%|███████▊  | 3202/4096 [03:43<01:03, 14.03it/s, est. speed input: 14697.46 toks/s, output: 14.35 toks/s]
Processed prompts:  79%|███████▉  | 3234/4096 [03:45<01:01, 14.08it/s, est. speed input: 14695.67 toks/s, output: 14.35 toks/s]
Processed prompts:  80%|███████▉  | 3266/4096 [03:47<00:59, 14.03it/s, est. speed input: 14691.10 toks/s, output: 14.35 toks/s]
Processed prompts:  81%|████████  | 3298/4096 [03:49<00:57, 14.00it/s, est. speed input: 14686.82 toks/s, output: 14.34 toks/s]
Processed prompts:  81%|████████▏ | 3330/4096 [03:52<00:54, 13.98it/s, est. speed input: 14682.61 toks/s, output: 14.34 toks/s]
Processed prompts:  82%|████████▏ | 3362/4096 [03:54<00:52, 13.95it/s, est. speed input: 14678.05 toks/s, output: 14.33 toks/s]
Processed prompts:  83%|████████▎ | 3394/4096 [03:56<00:50, 13.93it/s, est. speed input: 14673.60 toks/s, output: 14.33 toks/s]
Processed prompts:  84%|████████▎ | 3426/4096 [03:59<00:47, 14.00it/s, est. speed input: 14672.18 toks/s, output: 14.33 toks/s]
Processed prompts:  84%|████████▍ | 3458/4096 [04:01<00:45, 13.98it/s, est. speed input: 14668.09 toks/s, output: 14.32 toks/s]
Processed prompts:  85%|████████▌ | 3490/4096 [04:03<00:42, 14.21it/s, est. speed input: 14672.40 toks/s, output: 14.33 toks/s]
Processed prompts:  86%|████████▌ | 3522/4096 [04:05<00:40, 14.13it/s, est. speed input: 14668.57 toks/s, output: 14.32 toks/s]
Processed prompts:  87%|████████▋ | 3554/4096 [04:08<00:38, 14.06it/s, est. speed input: 14664.63 toks/s, output: 14.32 toks/s]
Processed prompts:  88%|████████▊ | 3586/4096 [04:10<00:36, 14.01it/s, est. speed input: 14660.67 toks/s, output: 14.32 toks/s]
Processed prompts:  88%|████████▊ | 3618/4096 [04:12<00:34, 13.96it/s, est. speed input: 14656.35 toks/s, output: 14.31 toks/s]
Processed prompts:  89%|████████▉ | 3650/4096 [04:15<00:31, 13.95it/s, est. speed input: 14652.82 toks/s, output: 14.31 toks/s]
Processed prompts:  90%|████████▉ | 3682/4096 [04:17<00:29, 13.95it/s, est. speed input: 14649.29 toks/s, output: 14.31 toks/s]
Processed prompts:  91%|█████████ | 3714/4096 [04:19<00:27, 14.01it/s, est. speed input: 14648.02 toks/s, output: 14.30 toks/s]
Processed prompts:  91%|█████████▏| 3746/4096 [04:21<00:25, 13.98it/s, est. speed input: 14644.59 toks/s, output: 14.30 toks/s]
Processed prompts:  92%|█████████▏| 3778/4096 [04:24<00:22, 13.97it/s, est. speed input: 14641.41 toks/s, output: 14.30 toks/s]
Processed prompts:  93%|█████████▎| 3810/4096 [04:26<00:20, 13.94it/s, est. speed input: 14637.72 toks/s, output: 14.29 toks/s]
Processed prompts:  94%|█████████▍| 3842/4096 [04:28<00:18, 14.01it/s, est. speed input: 14636.63 toks/s, output: 14.29 toks/s]
Processed prompts:  95%|█████████▍| 3874/4096 [04:31<00:15, 13.98it/s, est. speed input: 14633.42 toks/s, output: 14.29 toks/s]
Processed prompts:  95%|█████████▌| 3906/4096 [04:33<00:13, 13.96it/s, est. speed input: 14630.03 toks/s, output: 14.29 toks/s]
Processed prompts:  96%|█████████▌| 3938/4096 [04:35<00:11, 13.95it/s, est. speed input: 14627.08 toks/s, output: 14.28 toks/s]
Processed prompts:  97%|█████████▋| 3970/4096 [04:37<00:09, 13.94it/s, est. speed input: 14623.83 toks/s, output: 14.28 toks/s]
Processed prompts:  98%|█████████▊| 4002/4096 [04:40<00:06, 13.94it/s, est. speed input: 14620.90 toks/s, output: 14.28 toks/s]
Processed prompts:  98%|█████████▊| 4034/4096 [04:42<00:04, 14.27it/s, est. speed input: 14627.22 toks/s, output: 14.28 toks/s]
Processed prompts:  99%|█████████▉| 4066/4096 [04:44<00:02, 14.24it/s, est. speed input: 14626.31 toks/s, output: 14.28 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:44<00:00, 14.24it/s, est. speed input: 14734.22 toks/s, output: 14.39 toks/s]
Processed prompts: 100%|██████████| 4096/4096 [04:44<00:00, 14.39it/s, est. speed input: 14734.22 toks/s, output: 14.39 toks/s]
[rank0]:[W128 09:45:13.200122521 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())

[SUCCESS] 测试完成! 耗时: 343.5s

测试结果:
  Requests/s:   14.00
  Tokens/s:     14346.47
  Total Reqs:   4096
  Elapsed:      292.64s

  [Prefill 分析]
  Total Prefill Tokens: 4194304
  Prefill Tokens/s:     14332.47


------------------------------------------------------------
  生成 CSV: BitNet-2B-FP8
------------------------------------------------------------
[SUCCESS] CSV 保存到: /root/vllmbench/slidesparse/tools/throughput_benchmark_results/prefill/GB10_cc121_FP8E4M3_py312_cu129_aarch64/cusparselt/2_10/BitNet-2B-FP8_prefill.csv

预览:
------------------------------------------------------------
M_prefill,prompt_len,max_num_seqs,num_prompts,N_prefill,requests_per_s,tokens_per_s,elapsed_time_s
512,512,1,128,128,25.9405,13307.4681,4.9344
1024,1024,1,128,128,14.2319,14587.6825,8.9939
2048,1024,2,256,128,14.3490,14707.6755,17.8410
4096,1024,4,512,128,13.7915,14136.3157,37.1242
8192,1024,8,1024,128,13.7008,14043.3442,74.7400
16384,1024,16,2048,128,13.8261,14171.7056,148.1261
32768,1024,32,4096,128,13.9966,14346.4665,292.6435

------------------------------------------------------------

[INFO] 完成: 7 成功, 0 失败


============================================================
  Benchmark 完成!
============================================================


总计: 35 成功, 0 失败
============================================================
